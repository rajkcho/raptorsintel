<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Raptors Intel | Game Day Scouting Dashboard</title>
    <meta name="description" content="Raptors Intel â€” the ultimate Toronto Raptors scouting dashboard. Live scores, standings, draft intel, trade tracker, rotation simulator, injury reports, awards watch, and 100+ analytics widgets. Free, real-time, and updated every game day." />
    <meta name="keywords" content="Toronto Raptors, NBA, scouting, analytics, game preview, rotation simulator, injury report" />
    <meta property="og:title" content="Raptors Intel | Game Day Scouting" />
    <meta property="og:description" content="The ultimate Raptors fan scouting dashboard. Deep analytics, rotation simulator, and matchup intelligence." />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="https://cdn.nba.com/logos/nba/1610612761/primary/L/logo.svg" />
    <meta property="og:url" content="https://raptors-intel.app" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Raptors Intel | Game Day Scouting" />
    <meta name="twitter:description" content="The ultimate Raptors fan scouting dashboard. Deep analytics, rotation simulator, and matchup intelligence." />
    <meta name="twitter:image" content="https://cdn.nba.com/logos/nba/1610612761/primary/L/logo.svg" />
    <link rel="canonical" href="https://rajkcho.github.io/raptorsintel/" />
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "Raptors Intel",
      "description": "Advanced Toronto Raptors game day scouting dashboard with live scores, rotation simulator, playbook analysis, injury reports, standings, draft intel, and real-time matchup intelligence.",
      "url": "https://rajkcho.github.io/raptorsintel/",
      "applicationCategory": "SportsApplication",
      "operatingSystem": "Web",
      "author": {
        "@type": "Organization",
        "name": "Raptors Intel"
      },
      "about": {
        "@type": "SportsTeam",
        "name": "Toronto Raptors",
        "sport": "Basketball",
        "memberOf": {
          "@type": "SportsOrganization",
          "name": "NBA"
        }
      },
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      }
    }
    </script>
    <link rel="icon" href="https://cdn.nba.com/logos/nba/1610612761/primary/L/logo.svg" type="image/svg+xml" />
    <link rel="manifest" href="manifest.json" />
    <meta name="theme-color" content="#CE1141" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="apple-mobile-web-app-title" content="Raptors Intel" />
    <link rel="apple-touch-icon" href="https://cdn.nba.com/logos/nba/1610612761/primary/L/logo.svg" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        darkMode: 'class',
        theme: {
          extend: {
            fontFamily: {
              sans: ['Inter', '-apple-system', 'BlinkMacSystemFont', 'Segoe UI', 'sans-serif'],
            },
            colors: {
              raptors: {
                red: '#CE1141',
                black: '#000000',
                silver: '#A1A1A4',
                purple: '#3E2680',
              },
              cmd: {
                bg: '#0a0e17',
                surface: '#111827',
                card: '#1a1f2e',
                border: '#1e293b',
                'border-light': '#334155',
              },
              light: {
                bg: '#f8fafc',
                surface: '#ffffff',
                card: '#f1f5f9',
                border: '#e2e8f0',
                'border-light': '#cbd5e1',
              }
            },
            animation: {
              'slide-up': 'slide-up 0.6s ease-out both',
              'slide-up-1': 'slide-up 0.6s ease-out 0.15s both',
              'slide-up-2': 'slide-up 0.6s ease-out 0.3s both',
              'slide-up-3': 'slide-up 0.6s ease-out 0.45s both',
              'glow-pulse': 'glow-pulse 2s ease-in-out infinite',
              'shimmer': 'shimmer 2s linear infinite',
              'float': 'float 6s ease-in-out infinite',
              'gradient-shift': 'gradient-shift 4s ease infinite',
              'bar-grow': 'bar-grow 1s ease-out both',
              'ring-fill': 'ring-fill 1.5s ease-out both',
              'border-glow': 'border-glow 3s ease-in-out infinite',
              'text-reveal': 'text-reveal 0.8s ease-out both',
            }
          }
        }
      }
    </script>
    <style>
      body {
        background-color: #0a0e17;
        color: #e2e8f0;
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        transition: background-color 0.3s ease, color 0.3s ease;
      }
      .light body, body.light-mode {
        background-color: #f8fafc;
        color: #1e293b;
      }
      ::-webkit-scrollbar {
        width: 6px;
        height: 6px;
      }
      ::-webkit-scrollbar-track {
        background: #111827;
      }
      ::-webkit-scrollbar-thumb {
        background: #334155;
        border-radius: 4px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #CE1141;
      }
      
      /* Light mode overrides for hardcoded dark elements */
      .light .glass-card, .light .premium-glass, .light .glass-premium {
        background: rgba(255, 255, 255, 0.9) !important;
        border-color: rgba(0, 0, 0, 0.08) !important;
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.06), 0 1px 0 rgba(0, 0, 0, 0.02) !important;
      }
      .light .glass-card:hover, .light .premium-glass:hover {
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1), 0 0 12px rgba(206, 17, 65, 0.05) !important;
      }
      .light .gradient-mesh { background: none; }
      .light .noise-overlay::before { opacity: 0.01; }
      .light .animated-border::after { background: #f8fafc; }
      .light .skeleton-bar {
        background: linear-gradient(90deg, #e2e8f0 25%, #f1f5f9 50%, #e2e8f0 75%);
        background-size: 200% 100%;
      }
      .light .polished-footer {
        background: rgba(248, 250, 252, 0.9);
        border-top-color: rgba(0, 0, 0, 0.06);
        color: #64748b;
      }
      
      /* Accessibility */
      .sr-only {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
      }
      
      *:focus-visible {
        outline: 2px solid #CE1141;
        outline-offset: 2px;
      }
      
      .skip-link {
        position: absolute;
        top: -40px;
        left: 0;
        background: #CE1141;
        color: white;
        padding: 8px 16px;
        z-index: 100;
        transition: top 0.3s;
      }
      .skip-link:focus {
        top: 0;
      }
      
      /* Print styles */
      @media print {
        .no-print, .section-nav, .polished-footer, .particles-container, .cursor-glow,
        .glow-orb, .blob-bg, button, [role="button"], .btn-magnetic, .mobile-bottom-nav,
        input[type="range"], .poll-widget, details summary, .noise-overlay::before { display: none !important; }
        body { background: white !important; color: black !important; font-size: 11pt !important; }
        * { box-shadow: none !important; text-shadow: none !important; animation: none !important; backdrop-filter: none !important; -webkit-backdrop-filter: none !important; }
        .glass-card, .premium-glass, .glass-premium { background: white !important; border: 1px solid #ddd !important; }
        .print-header { display: block !important; text-align: center; padding: 1rem 0; border-bottom: 2px solid #CE1141; margin-bottom: 1rem; }
        .print-header h1 { font-size: 18pt; color: #CE1141; margin: 0; }
        .print-header p { font-size: 10pt; color: #666; margin: 4px 0 0; }
        @page { size: A4; margin: 1.5cm; }
      }
      .print-header { display: none; }
      
      /* Reduced motion */
      @media (prefers-reduced-motion: reduce) {
        *, *::before, *::after {
          animation-duration: 0.01ms !important;
          animation-iteration-count: 1 !important;
          transition-duration: 0.01ms !important;
        }
      }

      /* Live Game Mode */
      .live-game-banner {
        background: linear-gradient(90deg, #CE1141 0%, #1a1f2e 40%, #1a1f2e 60%, #CE1141 100%);
        background-size: 200% 100%;
        animation: live-banner-shift 3s ease-in-out infinite;
      }
      @keyframes live-banner-shift {
        0%, 100% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
      }
      .gameday-badge-live {
        animation: glow-pulse 0.8s ease-in-out infinite !important;
      }
      .live-pulse-dot {
        animation: pulse-dot 1s ease-in-out infinite;
      }
      @keyframes pulse-dot {
        0%, 100% { opacity: 1; transform: scale(1); }
        50% { opacity: 0.4; transform: scale(1.3); }
      }

      /* Standings Bar Chart */
      .standings-bar {
        transition: width 1s ease-out;
      }

      /* ======== PREMIUM DESIGN ELEMENTS ======== */
      
      /* Noise Texture Overlay */
      .noise-overlay::before {
        content: '';
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        opacity: 0.03;
        z-index: 1000;
        pointer-events: none;
        background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
      }
      
      /* Game Day Mode */
      @keyframes gameday-gradient {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
      }
      .gameday-bg {
        background: linear-gradient(135deg, #0a0e17 0%, #1a0008 25%, #0a0e17 50%, #0d0005 75%, #0a0e17 100%);
        background-size: 400% 400%;
        animation: gameday-gradient 8s ease infinite;
      }
      @keyframes gameday-pulse-badge {
        0%, 100% { opacity: 1; transform: scale(1); }
        50% { opacity: 0.7; transform: scale(1.05); }
      }
      .gameday-badge {
        animation: gameday-pulse-badge 1.5s ease-in-out infinite;
        will-change: transform, opacity;
      }

      /* Glassmorphism 2.0 */
      .glass-premium {
        background: rgba(17, 24, 39, 0.6);
        backdrop-filter: blur(20px) saturate(180%);
        -webkit-backdrop-filter: blur(20px) saturate(180%);
        border: 1px solid rgba(255, 255, 255, 0.08);
        box-shadow: 
          0 8px 32px rgba(0, 0, 0, 0.4),
          inset 0 1px 0 rgba(255, 255, 255, 0.05),
          inset 0 -1px 0 rgba(0, 0, 0, 0.1);
      }
      
      /* 3D Card Hover Effect */
      .card-3d {
        transform-style: preserve-3d;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        will-change: transform;
      }
      .card-3d:hover {
        transform: perspective(1000px) rotateX(2deg) rotateY(-2deg) translateY(-4px);
        box-shadow: 
          0 20px 40px rgba(0, 0, 0, 0.4),
          0 0 40px rgba(206, 17, 65, 0.1);
      }
      
      /* Animated Gradient Border */
      .gradient-border {
        position: relative;
        background: linear-gradient(135deg, #0a0e17, #111827);
        border-radius: 16px;
      }
      .gradient-border::before {
        content: '';
        position: absolute;
        inset: -2px;
        border-radius: 18px;
        background: linear-gradient(135deg, #CE1141, #3E2680, #CE1141, #3E2680);
        background-size: 300% 300%;
        animation: gradient-rotate 4s ease infinite;
        z-index: -1;
        opacity: 0.6;
      }
      
      /* Magnetic Button Effect */
      .btn-magnetic {
        position: relative;
        transition: transform 0.2s cubic-bezier(0.33, 1, 0.68, 1);
      }
      .btn-magnetic::after {
        content: '';
        position: absolute;
        inset: -10px;
        border-radius: inherit;
      }
      
      /* Glow Text */
      .text-glow {
        text-shadow: 
          0 0 10px currentColor,
          0 0 20px currentColor,
          0 0 40px currentColor;
      }
      
      /* Animated Gradient Text */
      .gradient-text {
        background: linear-gradient(90deg, #CE1141, #ff6b6b, #CE1141);
        background-size: 200% auto;
        -webkit-background-clip: text;
        background-clip: text;
        -webkit-text-fill-color: transparent;
        animation: gradient-text-flow 3s ease infinite;
      }
      
      /* Scroll Reveal */
      .scroll-reveal {
        opacity: 0;
        transform: translateY(20px);
        transition: opacity 0.6s ease, transform 0.6s ease;
      }
      .scroll-reveal.revealed {
        opacity: 1;
        transform: translateY(0);
      }
      
      /* Skeleton Loading */
      .skeleton {
        background: linear-gradient(90deg, #1a1f2e 25%, #2a3040 50%, #1a1f2e 75%);
        background-size: 200% 100%;
        animation: skeleton-shimmer 1.5s infinite;
        border-radius: 8px;
      }
      
      /* Floating Animation */
      .float-subtle {
        animation: float-subtle 6s ease-in-out infinite;
      }
      
      /* Pulse Ring */
      .pulse-ring {
        position: relative;
      }
      .pulse-ring::after {
        content: '';
        position: absolute;
        inset: -4px;
        border-radius: 50%;
        border: 2px solid #CE1141;
        animation: pulse-ring-expand 2s ease-out infinite;
      }
      
      /* Hover Lift */
      .hover-lift {
        transition: transform 0.3s ease, box-shadow 0.3s ease;
      }
      .hover-lift:hover {
        transform: translateY(-4px);
        box-shadow: 0 12px 24px rgba(0, 0, 0, 0.3);
      }

      /* Card hover glow + lift for all widget cards */
      .glass-card, .premium-glass, [class*="rounded-2xl"][class*="border"] {
        transition: transform 0.3s ease, box-shadow 0.3s ease, border-color 0.3s ease !important;
      }
      .glass-card:hover, .premium-glass:hover {
        transform: translateY(-3px);
        box-shadow: 0 12px 32px rgba(0, 0, 0, 0.3), 0 0 20px rgba(206, 17, 65, 0.08);
      }

      /* Smooth dark mode transitions */
      *, *::before, *::after {
        transition-property: background-color, border-color, color, fill, stroke, box-shadow;
        transition-duration: 0.3s;
        transition-timing-function: ease;
      }
      /* Exclude animations from the global transition */
      [class*="animate-"], .skeleton, [style*="translateX"] {
        transition-property: none !important;
      }

      /* Parallax hero header */
      .parallax-hero {
        transform: translateZ(0);
        will-change: transform;
      }
      
      /* Stagger Animation for Lists */
      .stagger-item { opacity: 0; animation: stagger-in 0.4s ease forwards; }
      .stagger-item:nth-child(1) { animation-delay: 0.05s; }
      .stagger-item:nth-child(2) { animation-delay: 0.1s; }
      .stagger-item:nth-child(3) { animation-delay: 0.15s; }
      .stagger-item:nth-child(4) { animation-delay: 0.2s; }
      .stagger-item:nth-child(5) { animation-delay: 0.25s; }
      
      /* Neon Glow Box */
      .neon-box {
        box-shadow: 
          0 0 5px #CE1141,
          0 0 10px #CE1141,
          0 0 20px #CE1141,
          0 0 40px #CE1141;
      }
      
      /* Morphing Blob Background */
      .blob-bg {
        position: absolute;
        width: 400px;
        height: 400px;
        background: radial-gradient(circle, rgba(206,17,65,0.15) 0%, transparent 70%);
        border-radius: 50%;
        filter: blur(60px);
        animation: blob-morph 20s ease-in-out infinite;
        pointer-events: none;
      }
      
      /* Typewriter Effect */
      .typewriter {
        overflow: hidden;
        border-right: 2px solid #CE1141;
        white-space: nowrap;
        animation: typing 3s steps(30) 1s forwards, blink-caret 0.75s step-end infinite;
      }
      
      /* Interactive Cursor Glow */
      .cursor-glow {
        position: fixed;
        width: 300px;
        height: 300px;
        background: radial-gradient(circle, rgba(206,17,65,0.08) 0%, transparent 70%);
        border-radius: 50%;
        pointer-events: none;
        z-index: 9999;
        transform: translate(-50%, -50%);
        transition: opacity 0.3s;
      }
      
      /* Animated Underline */
      .animated-underline {
        position: relative;
      }
      .animated-underline::after {
        content: '';
        position: absolute;
        bottom: -2px;
        left: 0;
        width: 0;
        height: 2px;
        background: linear-gradient(90deg, #CE1141, #3E2680);
        transition: width 0.3s ease;
      }
      .animated-underline:hover::after {
        width: 100%;
      }
      
      /* Glitch Effect */
      .glitch {
        position: relative;
      }
      .glitch::before,
      .glitch::after {
        content: attr(data-text);
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
      }
      .glitch::before {
        animation: glitch-1 0.3s infinite linear alternate-reverse;
        color: #ff0000;
        z-index: -1;
      }
      .glitch::after {
        animation: glitch-2 0.3s infinite linear alternate-reverse;
        color: #00ffff;
        z-index: -2;
      }

      /* ======== KEYFRAMES ======== */
      @keyframes gradient-rotate {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
      }
      
      @keyframes gradient-text-flow {
        0% { background-position: 0% center; }
        100% { background-position: 200% center; }
      }
      
      @keyframes skeleton-shimmer {
        0% { background-position: -200% 0; }
        100% { background-position: 200% 0; }
      }
      
      @keyframes float-subtle {
        0%, 100% { transform: translateY(0) rotate(0deg); }
        25% { transform: translateY(-5px) rotate(0.5deg); }
        75% { transform: translateY(5px) rotate(-0.5deg); }
      }
      
      @keyframes pulse-ring-expand {
        0% { transform: scale(1); opacity: 1; }
        100% { transform: scale(1.5); opacity: 0; }
      }
      
      @keyframes stagger-in {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
      }
      
      @keyframes blob-morph {
        0%, 100% { transform: translate(0, 0) scale(1); }
        25% { transform: translate(50px, -50px) scale(1.1); }
        50% { transform: translate(100px, 50px) scale(0.9); }
        75% { transform: translate(-50px, 100px) scale(1.05); }
      }
      
      @keyframes typing {
        from { width: 0; }
        to { width: 100%; }
      }
      
      @keyframes blink-caret {
        from, to { border-color: transparent; }
        50% { border-color: #CE1141; }
      }
      
      @keyframes glitch-1 {
        0% { clip-path: inset(20% 0 60% 0); transform: translate(-2px, 2px); }
        20% { clip-path: inset(60% 0 20% 0); transform: translate(2px, -2px); }
        40% { clip-path: inset(40% 0 40% 0); transform: translate(-2px, 0); }
        60% { clip-path: inset(80% 0 5% 0); transform: translate(0, 2px); }
        80% { clip-path: inset(5% 0 80% 0); transform: translate(2px, -2px); }
        100% { clip-path: inset(50% 0 30% 0); transform: translate(-2px, 2px); }
      }
      
      @keyframes glitch-2 {
        0% { clip-path: inset(60% 0 20% 0); transform: translate(2px, -2px); }
        20% { clip-path: inset(20% 0 60% 0); transform: translate(-2px, 2px); }
        40% { clip-path: inset(80% 0 5% 0); transform: translate(0, -2px); }
        60% { clip-path: inset(40% 0 40% 0); transform: translate(2px, 0); }
        80% { clip-path: inset(5% 0 80% 0); transform: translate(-2px, 2px); }
        100% { clip-path: inset(30% 0 50% 0); transform: translate(2px, -2px); }
      }
      
      @keyframes aurora {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
      }
      
      @keyframes marquee-scroll {
        0% { transform: translateX(0); }
        100% { transform: translateX(-50%); }
      }
      .animate-marquee {
        display: inline-block;
        animation: marquee-scroll 30s linear infinite;
      }
      
      .aurora-bg {
        background: linear-gradient(135deg, 
          rgba(206,17,65,0.1) 0%, 
          rgba(62,38,128,0.1) 25%, 
          rgba(17,24,39,0.1) 50%,
          rgba(62,38,128,0.1) 75%,
          rgba(206,17,65,0.1) 100%);
        background-size: 400% 400%;
        animation: aurora 15s ease infinite;
      }

      /* ---- Keyframe Animations ---- */
      @keyframes fade-in {
        from { opacity: 0; transform: translateY(8px); }
        to { opacity: 1; transform: translateY(0); }
      }
      .animate-fade-in { animation: fade-in 0.3s ease-out; }

      @keyframes slide-up {
        from { opacity: 0; transform: translateY(30px); }
        to { opacity: 1; transform: translateY(0); }
      }
      @keyframes glow-pulse {
        0%, 100% { box-shadow: 0 0 15px rgba(206,17,65,0.3), 0 0 30px rgba(206,17,65,0.1); }
        50% { box-shadow: 0 0 25px rgba(206,17,65,0.5), 0 0 50px rgba(206,17,65,0.2); }
      }
      @keyframes shimmer {
        0% { background-position: -200% 0; }
        100% { background-position: 200% 0; }
      }
      @keyframes bounce {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-5px); }
      }
      @keyframes confetti {
        0% { transform: translateY(0) rotate(0deg); opacity: 1; }
        100% { transform: translateY(100px) rotate(720deg); opacity: 0; }
      }
      @keyframes pulse-glow {
        0%, 100% { opacity: 0.5; }
        50% { opacity: 1; }
      }
      @keyframes ticker-scroll {
        0% { transform: translateX(0); }
        100% { transform: translateX(-50%); }
      }
      .animate-bounce { animation: bounce 0.6s ease-in-out infinite; }
      @keyframes float {
        0%, 100% { transform: translateY(0px) rotate(0deg); }
        50% { transform: translateY(-10px) rotate(2deg); }
      }
      @keyframes gradient-shift {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
      }
      @keyframes bar-grow {
        from { transform: scaleX(0); }
        to { transform: scaleX(1); }
      }
      @keyframes ring-fill {
        from { stroke-dashoffset: 283; }
      }
      @keyframes border-glow {
        0%, 100% { border-color: rgba(206,17,65,0.3); }
        50% { border-color: rgba(206,17,65,0.7); }
      }
      @keyframes text-reveal {
        from { opacity: 0; clip-path: inset(0 100% 0 0); }
        to { opacity: 1; clip-path: inset(0 0 0 0); }
      }
      @keyframes pulse-dot {
        0%, 100% { opacity: 1; transform: scale(1); }
        50% { opacity: 0.5; transform: scale(1.5); }
      }
      @keyframes drive {
        0% { transform: translate(0, 0); }
        50% { transform: translate(10px, -15px); }
        100% { transform: translate(20px, -20px); }
      }
      @keyframes screen-anim {
        0% { transform: translate(0, 0); opacity: 0; }
        20% { opacity: 1; }
        80% { opacity: 1; }
        100% { transform: translate(5px, -5px); opacity: 0; }
      }
      
      /* === PREMIUM ANIMATIONS === */
      @keyframes particle-float {
        0%, 100% { transform: translateY(0) translateX(0) rotate(0deg); opacity: 0.6; }
        25% { transform: translateY(-20px) translateX(10px) rotate(90deg); opacity: 0.8; }
        50% { transform: translateY(-40px) translateX(-5px) rotate(180deg); opacity: 0.4; }
        75% { transform: translateY(-20px) translateX(-15px) rotate(270deg); opacity: 0.7; }
      }
      @keyframes basketball-bounce {
        0%, 100% { transform: translateY(0) scaleY(1); }
        40% { transform: translateY(-30px) scaleY(1.1); }
        60% { transform: translateY(-15px) scaleY(1); }
        80% { transform: translateY(0) scaleY(0.9) scaleX(1.1); }
        90% { transform: translateY(-5px) scaleY(1); }
      }
      @keyframes orbit {
        0% { transform: rotate(0deg) translateX(50px) rotate(0deg); }
        100% { transform: rotate(360deg) translateX(50px) rotate(-360deg); }
      }
      @keyframes ripple {
        0% { transform: scale(0); opacity: 1; }
        100% { transform: scale(4); opacity: 0; }
      }
      @keyframes score-flash {
        0% { background-color: rgba(74, 222, 128, 0); }
        20% { background-color: rgba(74, 222, 128, 0.3); }
        100% { background-color: rgba(74, 222, 128, 0); }
      }
      @keyframes card-entrance {
        0% { opacity: 0; transform: translateY(40px) scale(0.9) rotateX(10deg); }
        60% { transform: translateY(-5px) scale(1.02) rotateX(-2deg); }
        100% { opacity: 1; transform: translateY(0) scale(1) rotateX(0deg); }
      }
      @keyframes gradient-rotate {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
      @keyframes neon-flicker {
        0%, 19%, 21%, 23%, 25%, 54%, 56%, 100% {
          text-shadow: 0 0 10px #CE1141, 0 0 20px #CE1141, 0 0 30px #CE1141, 0 0 40px #CE1141;
        }
        20%, 24%, 55% {
          text-shadow: none;
        }
      }
      @keyframes mesh-shift {
        0%, 100% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
      }
      @keyframes star-twinkle {
        0%, 100% { opacity: 0.3; transform: scale(1); }
        50% { opacity: 1; transform: scale(1.2); }
      }
      @keyframes slide-in-left {
        0% { opacity: 0; transform: translateX(-100px); }
        100% { opacity: 1; transform: translateX(0); }
      }
      @keyframes slide-in-right {
        0% { opacity: 0; transform: translateX(100px); }
        100% { opacity: 1; transform: translateX(0); }
      }
      @keyframes confetti-fall {
        0% { transform: translateY(-100%) rotate(0deg); opacity: 1; }
        100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
      }
      @keyframes pulse-ring {
        0% { transform: scale(0.8); opacity: 0.8; }
        50% { transform: scale(1.2); opacity: 0.4; }
        100% { transform: scale(0.8); opacity: 0.8; }
      }
      @keyframes court-line-draw {
        0% { stroke-dashoffset: 1000; }
        100% { stroke-dashoffset: 0; }
      }
      @keyframes stat-count-up {
        0% { opacity: 0; transform: translateY(20px); }
        100% { opacity: 1; transform: translateY(0); }
      }
      @keyframes holo-shift {
        0% { background-position: 0% 0%; }
        50% { background-position: 100% 100%; }
        100% { background-position: 0% 0%; }
      }
      
      /* Particle container */
      .particles-container {
        position: fixed;
        inset: 0;
        pointer-events: none;
        overflow: hidden;
        z-index: 0;
      }
      .particle {
        position: absolute;
        border-radius: 50%;
        animation: particle-float 8s ease-in-out infinite;
      }
      .particle-basketball {
        width: 20px;
        height: 20px;
        background: radial-gradient(circle at 30% 30%, #ff6b35, #CE1141);
        box-shadow: inset -3px -3px 6px rgba(0,0,0,0.3);
        animation: basketball-bounce 2s ease-in-out infinite;
      }
      
      /* Gradient mesh background */
      .gradient-mesh {
        background: 
          radial-gradient(at 40% 20%, rgba(206,17,65,0.15) 0px, transparent 50%),
          radial-gradient(at 80% 0%, rgba(62,38,128,0.15) 0px, transparent 50%),
          radial-gradient(at 0% 50%, rgba(206,17,65,0.1) 0px, transparent 50%),
          radial-gradient(at 80% 50%, rgba(62,38,128,0.1) 0px, transparent 50%),
          radial-gradient(at 0% 100%, rgba(206,17,65,0.1) 0px, transparent 50%),
          radial-gradient(at 80% 100%, rgba(62,38,128,0.1) 0px, transparent 50%);
        animation: mesh-shift 20s ease infinite;
        background-size: 200% 200%;
      }
      
      /* Holographic card effect */
      .holo-card {
        background: linear-gradient(
          135deg,
          rgba(206,17,65,0.1) 0%,
          rgba(62,38,128,0.1) 25%,
          rgba(206,17,65,0.05) 50%,
          rgba(62,38,128,0.1) 75%,
          rgba(206,17,65,0.1) 100%
        );
        background-size: 400% 400%;
        animation: holo-shift 8s ease infinite;
      }
      .holo-card::before {
        content: '';
        position: absolute;
        inset: 0;
        background: linear-gradient(
          105deg,
          transparent 40%,
          rgba(255,255,255,0.1) 45%,
          rgba(255,255,255,0.2) 50%,
          rgba(255,255,255,0.1) 55%,
          transparent 60%
        );
        background-size: 200% 200%;
        animation: holo-shift 3s ease infinite;
        pointer-events: none;
        border-radius: inherit;
      }
      
      /* Animated border gradient */
      .animated-border {
        position: relative;
        border-radius: 1rem;
        overflow: hidden;
      }
      .animated-border::before {
        content: '';
        position: absolute;
        inset: -2px;
        background: conic-gradient(from 0deg, #CE1141, #3E2680, #CE1141, #3E2680, #CE1141);
        animation: gradient-rotate 4s linear infinite;
        z-index: -1;
      }
      .animated-border::after {
        content: '';
        position: absolute;
        inset: 2px;
        background: #0a0e17;
        border-radius: calc(1rem - 2px);
        z-index: -1;
      }
      
      /* Card entrance classes */
      .card-enter { animation: card-entrance 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) both; }
      .card-enter-1 { animation-delay: 0.1s; }
      .card-enter-2 { animation-delay: 0.2s; }
      .card-enter-3 { animation-delay: 0.3s; }
      .card-enter-4 { animation-delay: 0.4s; }
      .card-enter-5 { animation-delay: 0.5s; }
      
      /* Neon text effect */
      .neon-flicker {
        animation: neon-flicker 4s ease-in-out infinite;
      }
      
      /* Ripple button effect */
      .btn-ripple-v2 {
        position: relative;
        overflow: hidden;
      }
      .btn-ripple-v2 .ripple-effect {
        position: absolute;
        border-radius: 50%;
        background: rgba(255,255,255,0.4);
        animation: ripple 0.6s linear;
        pointer-events: none;
      }
      
      /* Score flash effect */
      .score-flash-anim {
        animation: score-flash 1s ease-out;
      }
      
      /* Confetti */
      .confetti-piece {
        position: fixed;
        width: 10px;
        height: 10px;
        top: -10px;
        animation: confetti-fall 3s linear forwards;
        z-index: 100;
      }
      
      /* Glowing orbs */
      .glow-orb {
        position: absolute;
        border-radius: 50%;
        filter: blur(40px);
        opacity: 0.3;
        animation: pulse-ring 4s ease-in-out infinite;
      }
      
      /* 3D tilt effect on hover */
      .tilt-3d {
        transition: transform 0.3s ease;
        transform-style: preserve-3d;
        perspective: 1000px;
      }
      .tilt-3d:hover {
        transform: rotateY(5deg) rotateX(-5deg) translateZ(10px);
      }
      
      /* Stat bar glow */
      .stat-bar-glow {
        box-shadow: 0 0 20px currentColor;
      }
      
      /* Court line SVG animation */
      .court-line-animated {
        stroke-dasharray: 1000;
        animation: court-line-draw 2s ease forwards;
      }
      
      /* Premium glass effect */
      .premium-glass {
        background: rgba(17, 24, 39, 0.6);
        backdrop-filter: blur(20px) saturate(180%);
        -webkit-backdrop-filter: blur(20px) saturate(180%);
        border: 1px solid rgba(206,17,65,0.2);
        box-shadow: 
          0 8px 32px rgba(0,0,0,0.4),
          inset 0 1px 0 rgba(255,255,255,0.05),
          0 0 0 1px rgba(206,17,65,0.1);
        transform-style: preserve-3d;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
      }
      .premium-glass:hover {
        transform: perspective(1000px) rotateX(1deg) rotateY(-1deg) translateY(-3px);
        box-shadow: 
          0 16px 40px rgba(0, 0, 0, 0.4),
          0 0 30px rgba(206, 17, 65, 0.08);
      }
      /* Unify glass-card with card-3d hover */
      .glass-card {
        transform-style: preserve-3d;
      }
      
      /* Cyberpunk scan line */
      .scan-line::after {
        content: '';
        position: absolute;
        inset: 0;
        background: linear-gradient(
          transparent 50%,
          rgba(206,17,65,0.02) 50%
        );
        background-size: 100% 4px;
        pointer-events: none;
      }
      
      /* Entrance animations */
      .animate-slide-left { animation: slide-in-left 0.6s ease-out both; }
      .animate-slide-right { animation: slide-in-right 0.6s ease-out both; }
      @keyframes pass {
        0% { stroke-dashoffset: 100; opacity: 0; }
        20% { opacity: 1; }
        100% { stroke-dashoffset: 0; opacity: 1; }
      }
      @keyframes pulse-svg {
        0%, 100% { r: 1.5; opacity: 1; }
        50% { r: 2.5; opacity: 0.5; }
      }
      @keyframes spin-glow {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }

      /* ---- Utility Classes ---- */
      .glass-card {
        background: rgba(17, 24, 39, 0.75);
        backdrop-filter: blur(20px) saturate(180%);
        -webkit-backdrop-filter: blur(20px) saturate(180%);
        border: 1px solid rgba(255, 255, 255, 0.08);
        border-radius: 1rem;
        box-shadow: 
          0 8px 32px rgba(0, 0, 0, 0.3),
          inset 0 1px 0 rgba(255, 255, 255, 0.05);
        transition: transform 0.3s ease, box-shadow 0.3s ease, border-color 0.3s ease;
      }
      .glass-card:hover {
        transform: translateY(-2px);
        box-shadow: 
          0 12px 40px rgba(0, 0, 0, 0.4),
          inset 0 1px 0 rgba(255, 255, 255, 0.08),
          0 0 20px rgba(206, 17, 65, 0.05);
        border-color: rgba(206, 17, 65, 0.2);
      }

      /* ======== STICKY SECTION NAV ======== */
      .section-nav {
        position: sticky;
        top: 0;
        z-index: 25;
        background: rgba(10, 14, 23, 0.7);
        backdrop-filter: blur(20px) saturate(180%);
        -webkit-backdrop-filter: blur(20px) saturate(180%);
        border-bottom: 1px solid rgba(255, 255, 255, 0.06);
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        padding: 0.5rem 1rem;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
        scrollbar-width: none;
      }
      .section-nav::-webkit-scrollbar { display: none; }
      .section-nav a {
        white-space: nowrap;
        padding: 0.375rem 0.875rem;
        border-radius: 9999px;
        font-size: 0.7rem;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        color: rgba(148, 163, 184, 0.8);
        transition: all 0.2s ease;
        text-decoration: none;
      }
      .section-nav a:hover, .section-nav a.active {
        color: #fff;
        background: rgba(206, 17, 65, 0.2);
        box-shadow: 0 0 12px rgba(206, 17, 65, 0.15);
      }
      .light .section-nav {
        background: rgba(248, 250, 252, 0.8);
        border-bottom-color: rgba(0, 0, 0, 0.06);
      }
      .light .section-nav a { color: rgba(71, 85, 105, 0.8); }
      .light .section-nav a:hover, .light .section-nav a.active {
        color: #1e293b;
        background: rgba(206, 17, 65, 0.1);
      }

      /* ======== COMPACT WIDGETS ======== */
      .glass-card > .p-4, .premium-glass > .p-4,
      .glass-card.p-4, .premium-glass.p-4,
      [class*="rounded-2xl"].p-4 {
        padding: 0.75rem !important;
      }
      [class*="rounded-2xl"].p-5, [class*="rounded-2xl"].p-6 {
        padding: 0.75rem !important;
      }
      /* Reduce margin/gap in widget internals */
      [class*="rounded-2xl"] .mb-3 { margin-bottom: 0.5rem !important; }
      [class*="rounded-2xl"] .mb-4 { margin-bottom: 0.5rem !important; }
      [class*="rounded-2xl"] .space-y-3 > * + * { margin-top: 0.5rem !important; }
      [class*="rounded-2xl"] .space-y-4 > * + * { margin-top: 0.5rem !important; }

      /* ======== SECTION HEADERS ======== */
      .section-heading {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        margin-bottom: 1rem;
        animation: fade-in 0.5s ease-out both;
      }
      .section-heading .section-num {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 1.75rem;
        height: 1.75rem;
        border-radius: 0.5rem;
        background: linear-gradient(135deg, #CE1141, #3E2680);
        color: #fff;
        font-size: 0.7rem;
        font-weight: 800;
        flex-shrink: 0;
      }
      .section-heading h2 {
        font-size: 1rem;
        font-weight: 800;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        position: relative;
        padding-bottom: 0.375rem;
      }
      .section-heading h2::after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 0;
        width: 3rem;
        height: 2px;
        background: linear-gradient(90deg, #CE1141, #3E2680);
        border-radius: 2px;
      }

      /* ======== SKELETON LOADING ======== */
      .skeleton-bar {
        background: linear-gradient(90deg, rgba(26, 31, 46, 0.8) 25%, rgba(42, 48, 64, 0.8) 50%, rgba(26, 31, 46, 0.8) 75%);
        background-size: 200% 100%;
        animation: skeleton-shimmer 1.5s infinite;
        border-radius: 6px;
      }
      .skeleton-row { display: flex; gap: 0.5rem; margin-bottom: 0.5rem; }
      .skeleton-row .skeleton-bar:first-child { width: 2rem; height: 1rem; }
      .skeleton-row .skeleton-bar:last-child { flex: 1; height: 1rem; }

      /* ======== POLISHED FOOTER ======== */
      .polished-footer {
        background: rgba(10, 14, 23, 0.8);
        backdrop-filter: blur(16px);
        border-top: 1px solid rgba(255, 255, 255, 0.06);
        padding: 1.25rem 1.5rem;
        text-align: center;
        font-size: 0.75rem;
        color: #64748b;
      }
      .polished-footer .back-to-top {
        display: inline-flex;
        align-items: center;
        gap: 0.25rem;
        padding: 0.375rem 1rem;
        border-radius: 9999px;
        background: rgba(206, 17, 65, 0.15);
        color: #CE1141;
        font-size: 0.7rem;
        font-weight: 700;
        cursor: pointer;
        border: 1px solid rgba(206, 17, 65, 0.3);
        transition: all 0.2s;
        margin-top: 0.75rem;
      }
      .polished-footer .back-to-top:hover {
        background: rgba(206, 17, 65, 0.3);
        transform: translateY(-2px);
      }

      /* ======== MASONRY LAYOUT ======== */
      /* ======== DASHBOARD GRID ======== */
      .dashboard-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        grid-auto-flow: dense;
        gap: 3px;
      }
      .widget-wide { grid-column: span 2; }
      .widget-tall { grid-row: span 2; }
      .widget-large { grid-column: span 2; grid-row: span 2; }
      @media (max-width: 1280px) { .dashboard-grid { grid-template-columns: repeat(3, 1fr); } }
      @media (max-width: 1024px) { .dashboard-grid { grid-template-columns: repeat(2, 1fr); } .widget-wide, .widget-large { grid-column: span 1; } .widget-tall, .widget-large { grid-row: span 1; } }
      @media (max-width: 640px) { .dashboard-grid { grid-template-columns: 1fr 1fr; gap: 2px; } }

      /* Category border accents */
      .dg-gameday { border-left: 2px solid #CE1141; }
      .dg-stats { border-left: 2px solid #3b82f6; }
      .dg-players { border-left: 2px solid #22c55e; }
      .dg-analytics { border-left: 2px solid #8b5cf6; }
      .dg-oncourt { border-left: 2px solid #f97316; }
      .dg-season { border-left: 2px solid #14b8a6; }
      .dg-community { border-left: 2px solid #ec4899; }

      /* Ultra-compact widget internals */
      .dashboard-grid > div {
        padding: 0 !important;
        border-radius: 6px !important;
        overflow: hidden;
      }
      .dashboard-grid > div > div {
        padding: 5px !important;
        border-radius: 6px !important;
        height: 100%;
      }
      .dashboard-grid h3 {
        font-size: 9px !important;
        font-weight: 800 !important;
        text-transform: uppercase !important;
        letter-spacing: 0.05em !important;
        margin-bottom: 4px !important;
        opacity: 0.7;
      }
      .dashboard-grid .text-xs { font-size: 10px !important; }
      .dashboard-grid .text-sm { font-size: 11px !important; }
      .dashboard-grid .space-y-2 > * + * { margin-top: 2px !important; }
      .dashboard-grid .space-y-3 > * + * { margin-top: 3px !important; }
      .dashboard-grid .space-y-4 > * + * { margin-top: 4px !important; }
      .dashboard-grid .p-2 { padding: 3px !important; }
      .dashboard-grid .p-3 { padding: 4px !important; }
      .dashboard-grid .p-4 { padding: 6px !important; }
      .dashboard-grid [class*="p-5"] { padding: 6px !important; }
      .dashboard-grid [class*="p-6"] { padding: 6px !important; }
      .dashboard-grid .gap-2 { gap: 2px !important; }
      .dashboard-grid .gap-3 { gap: 3px !important; }
      .dashboard-grid .gap-4 { gap: 4px !important; }
      .dashboard-grid .mb-3 { margin-bottom: 3px !important; }
      .dashboard-grid .mb-4 { margin-bottom: 4px !important; }
      .dashboard-grid .rounded-2xl { border-radius: 6px !important; }
      .dashboard-grid .rounded-xl { border-radius: 4px !important; }
      .dashboard-grid .rounded-lg { border-radius: 3px !important; }
      .dashboard-grid .max-h-64 { max-height: 120px !important; }
      .dashboard-grid .max-h-\[300px\] { max-height: 120px !important; }
      .dashboard-grid .overflow-y-auto { max-height: 120px !important; }
      /* Constrain all widgets to avoid sprawl */
      .dashboard-grid > div { max-height: 280px; overflow: hidden; }
      .dashboard-grid > .widget-tall { max-height: 560px; }
      .dashboard-grid > .widget-large { max-height: 560px; }

      #sidebar-panel > div { padding: 0.375rem !important; }
      #sidebar-panel h3 { margin-bottom: 0.25rem !important; font-size: 0.6rem !important; }
      .max-h-64 { max-height: 10rem !important; }
      .max-h-\[300px\] { max-height: 160px !important; }

      /* Mobile: 2-col, no spans */
      @media (max-width: 1023px) {
        .dashboard-grid {
          grid-template-columns: repeat(2, 1fr) !important;
        }
        .widget-wide, .widget-tall, .widget-large {
          grid-column: span 1 !important;
          grid-row: span 1 !important;
        }
      }

      /* Mobile sidebar toggle */
      .mobile-sidebar-hidden { display: none !important; }
      @media (min-width: 1024px) { .mobile-sidebar-hidden { display: block !important; } }
      
      /* ======== MOBILE RESPONSIVE OVERRIDES ======== */
      @media (max-width: 768px) {
        .grid-cols-12 { grid-template-columns: 1fr !important; }
        .col-span-12.lg\:col-span-2,
        .col-span-12.lg\:col-span-3,
        .col-span-12.lg\:col-span-9,
        .col-span-12.lg\:col-span-10 {
          grid-column: span 1 !important;
          max-height: none !important;
          overflow: visible !important;
        }
        .grid-cols-2 { grid-template-columns: 1fr !important; }
        .grid-cols-3 { grid-template-columns: 1fr !important; }
        .grid-cols-4 { grid-template-columns: repeat(2, 1fr) !important; }
        .section-nav { padding: 0.375rem 0.5rem; }
        .section-nav a { font-size: 0.6rem; padding: 0.25rem 0.625rem; min-height: 44px; display: inline-flex; align-items: center; }

        /* Hero compact on mobile */
        .hero-star-field { display: none !important; }
        .hero-title { font-size: 1.5rem !important; }
        .hero-stats-label { font-size: 0.75rem !important; }

        /* Card spacing on mobile */
        .gap-4 { gap: 0.75rem !important; }
        .p-4 { padding: 0.75rem !important; }

        /* Touch targets: min 44x44 */
        button, a[role="button"], [role="button"], .btn-magnetic {
          min-height: 44px;
          min-width: 44px;
        }

        /* Bottom nav safe area for notched phones */
        .mobile-bottom-nav {
          padding-bottom: calc(0.5rem + env(safe-area-inset-bottom)) !important;
        }
      }

      /* Disable 3D hover effects on touch devices */
      @media (hover: none) {
        .card-3d:hover {
          transform: none !important;
          box-shadow: none !important;
        }
        .hover-lift:hover {
          transform: none !important;
        }
      }

      .gradient-border {
        position: relative;
        border: none;
      }
      .gradient-border::before {
        content: '';
        position: absolute;
        inset: 0;
        border-radius: inherit;
        padding: 1.5px;
        background: linear-gradient(135deg, #CE1141, #3E2680, #CE1141, #3E2680);
        background-size: 300% 300%;
        animation: gradient-shift 4s ease infinite;
        -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
        -webkit-mask-composite: xor;
        mask-composite: exclude;
        pointer-events: none;
        z-index: 1;
      }
      .card-3d {
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        transform-style: preserve-3d;
        perspective: 800px;
      }
      .card-3d:hover {
        transform: rotateX(-3deg) rotateY(3deg) translateY(-4px);
        box-shadow: 0 20px 40px rgba(206,17,65,0.15), 0 0 20px rgba(206,17,65,0.1);
      }
      .neon-text {
        text-shadow: 
          0 0 5px rgba(206,17,65,0.8),
          0 0 10px rgba(206,17,65,0.6), 
          0 0 20px rgba(206,17,65,0.4), 
          0 0 40px rgba(206,17,65,0.2),
          0 0 80px rgba(206,17,65,0.1);
        animation: neon-pulse 2s ease-in-out infinite;
      }
      @keyframes neon-pulse {
        0%, 100% { filter: brightness(1); }
        50% { filter: brightness(1.2); }
      }
      .neon-text-subtle {
        text-shadow: 0 0 8px rgba(206,17,65,0.3), 0 0 16px rgba(206,17,65,0.1);
      }
      
      /* Enhanced Hover States */
      .interactive-glow {
        position: relative;
        overflow: hidden;
      }
      .interactive-glow::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
        transition: left 0.5s ease;
      }
      .interactive-glow:hover::before {
        left: 100%;
      }
      
      /* Animated Border Gradient */
      .border-gradient-animated {
        position: relative;
        border: none !important;
      }
      .border-gradient-animated::before {
        content: '';
        position: absolute;
        inset: 0;
        border-radius: inherit;
        padding: 1px;
        background: linear-gradient(90deg, #CE1141, #3E2680, #CE1141);
        background-size: 200% 100%;
        animation: border-flow 3s linear infinite;
        -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
        mask-composite: exclude;
        pointer-events: none;
      }
      @keyframes border-flow {
        0% { background-position: 0% 50%; }
        100% { background-position: 200% 50%; }
      }
      
      /* Shine Effect */
      .shine-effect {
        position: relative;
        overflow: hidden;
      }
      .shine-effect::after {
        content: '';
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: linear-gradient(
          45deg,
          transparent 30%,
          rgba(255,255,255,0.08) 50%,
          transparent 70%
        );
        animation: shine 4s ease-in-out infinite;
        pointer-events: none;
      }
      @keyframes shine {
        0% { transform: translateX(-100%) rotate(45deg); }
        100% { transform: translateX(100%) rotate(45deg); }
      }
      
      /* Ripple Button Effect */
      .btn-ripple {
        position: relative;
        overflow: hidden;
      }
      .btn-ripple::after {
        content: '';
        position: absolute;
        width: 100%;
        height: 100%;
        top: 0;
        left: 0;
        pointer-events: none;
        background-image: radial-gradient(circle, rgba(255,255,255,0.3) 10%, transparent 10%);
        background-repeat: no-repeat;
        background-position: 50%;
        transform: scale(10, 10);
        opacity: 0;
        transition: transform 0.5s, opacity 0.5s;
      }
      .btn-ripple:active::after {
        transform: scale(0, 0);
        opacity: 0.3;
        transition: 0s;
      }
      
      /* Animated Counter */
      .counter-animate {
        display: inline-block;
        font-variant-numeric: tabular-nums;
      }
      
      /* Premium Gradients */
      .gradient-fire {
        background: linear-gradient(135deg, #CE1141, #ff6b35, #f7b733);
      }
      .gradient-ice {
        background: linear-gradient(135deg, #667eea, #764ba2, #f093fb);
      }
      .gradient-gold {
        background: linear-gradient(135deg, #f7b733, #fc4a1a, #f7b733);
        background-size: 200% 200%;
        animation: gradient-shift 3s ease infinite;
      }
      .gradient-raptors {
        background: linear-gradient(135deg, #CE1141, #3E2680, #CE1141);
        background-size: 200% 200%;
        animation: gradient-shift 4s ease infinite;
      }
      
      /* Spotlight Effect */
      .spotlight {
        position: relative;
        overflow: hidden;
      }
      .spotlight::before {
        content: '';
        position: absolute;
        width: 200px;
        height: 200px;
        background: radial-gradient(circle, rgba(206,17,65,0.15) 0%, transparent 70%);
        top: var(--mouse-y, 50%);
        left: var(--mouse-x, 50%);
        transform: translate(-50%, -50%);
        pointer-events: none;
        transition: opacity 0.3s;
        opacity: 0;
      }
      .spotlight:hover::before {
        opacity: 1;
      }
      
      /* Stat Card Animation */
      .stat-card-enter {
        animation: stat-card-in 0.5s ease-out both;
      }
      @keyframes stat-card-in {
        from {
          opacity: 0;
          transform: translateY(20px) scale(0.95);
        }
        to {
          opacity: 1;
          transform: translateY(0) scale(1);
        }
      }
      
      /* Pulsing Dot */
      .pulse-dot {
        position: relative;
      }
      .pulse-dot::before {
        content: '';
        position: absolute;
        width: 100%;
        height: 100%;
        border-radius: 50%;
        background: inherit;
        animation: pulse-dot-expand 1.5s ease-out infinite;
      }
      @keyframes pulse-dot-expand {
        0% { transform: scale(1); opacity: 0.7; }
        100% { transform: scale(2.5); opacity: 0; }
      }
      
      /* Number Pop */
      .number-pop {
        animation: number-pop 0.3s ease-out;
      }
      @keyframes number-pop {
        0% { transform: scale(1); }
        50% { transform: scale(1.2); }
        100% { transform: scale(1); }
      }
      
      /* Slide In */
      .slide-in-left { animation: slide-in-left 0.4s ease-out both; }
      .slide-in-right { animation: slide-in-right 0.4s ease-out both; }
      @keyframes slide-in-left {
        from { opacity: 0; transform: translateX(-20px); }
        to { opacity: 1; transform: translateX(0); }
      }
      @keyframes slide-in-right {
        from { opacity: 0; transform: translateX(20px); }
        to { opacity: 1; transform: translateX(0); }
      }
      
      /* Scale In */
      .scale-in {
        animation: scale-in 0.3s ease-out both;
      }
      @keyframes scale-in {
        from { opacity: 0; transform: scale(0.9); }
        to { opacity: 1; transform: scale(1); }
      }
      
      /* Breathe Animation */
      .breathe {
        animation: breathe 4s ease-in-out infinite;
      }
      @keyframes breathe {
        0%, 100% { transform: scale(1); opacity: 0.8; }
        50% { transform: scale(1.05); opacity: 1; }
      }
      
      /* Progress Bar Fill */
      .progress-fill {
        animation: progress-fill 1s ease-out both;
        transform-origin: left;
      }
      @keyframes progress-fill {
        from { transform: scaleX(0); }
        to { transform: scaleX(1); }
      }
      
      /* Icon Bounce */
      .icon-bounce:hover {
        animation: icon-bounce 0.5s ease;
      }
      @keyframes icon-bounce {
        0%, 100% { transform: translateY(0); }
        25% { transform: translateY(-5px); }
        50% { transform: translateY(0); }
        75% { transform: translateY(-3px); }
      }
      
      /* Rotate In */
      .rotate-in {
        animation: rotate-in 0.5s ease-out both;
      }
      @keyframes rotate-in {
        from { opacity: 0; transform: rotate(-10deg) scale(0.9); }
        to { opacity: 1; transform: rotate(0) scale(1); }
      }
      
      /* Flip Card */
      .flip-card {
        perspective: 1000px;
      }
      .flip-card-inner {
        transition: transform 0.6s;
        transform-style: preserve-3d;
      }
      .flip-card:hover .flip-card-inner {
        transform: rotateY(180deg);
      }
      .flip-card-front, .flip-card-back {
        backface-visibility: hidden;
      }
      .flip-card-back {
        transform: rotateY(180deg);
      }
      
      /* Elastic */
      .elastic {
        transition: transform 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      }
      .elastic:hover {
        transform: scale(1.05);
      }
      
      /* Morph Button */
      .morph-btn {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }
      .morph-btn:hover {
        border-radius: 50px;
        padding-left: 2rem;
        padding-right: 2rem;
      }
      
      /* Text Shimmer */
      .text-shimmer {
        background: linear-gradient(90deg, 
          rgba(255,255,255,0.1) 0%, 
          rgba(255,255,255,0.3) 50%, 
          rgba(255,255,255,0.1) 100%);
        background-size: 200% 100%;
        -webkit-background-clip: text;
        background-clip: text;
        animation: text-shimmer 2s linear infinite;
      }
      @keyframes text-shimmer {
        0% { background-position: -200% 0; }
        100% { background-position: 200% 0; }
      }
      
      /* Loading Spinner */
      .spinner-premium {
        width: 40px;
        height: 40px;
        border: 3px solid rgba(206,17,65,0.1);
        border-top-color: #CE1141;
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }
      @keyframes spin {
        to { transform: rotate(360deg); }
      }
      
      /* Custom Scrollbar Premium */
      .custom-scrollbar-premium::-webkit-scrollbar {
        width: 8px;
      }
      .custom-scrollbar-premium::-webkit-scrollbar-track {
        background: rgba(17, 24, 39, 0.5);
        border-radius: 4px;
      }
      .custom-scrollbar-premium::-webkit-scrollbar-thumb {
        background: linear-gradient(180deg, #CE1141, #3E2680);
        border-radius: 4px;
      }
      .custom-scrollbar-premium::-webkit-scrollbar-thumb:hover {
        background: linear-gradient(180deg, #ff1a4d, #5a3d9e);
      }
      .hover-lift {
        transition: transform 0.3s ease, box-shadow 0.3s ease;
      }
      .hover-lift:hover {
        transform: translateY(-4px);
        box-shadow: 0 12px 24px rgba(0,0,0,0.4), 0 0 12px rgba(206,17,65,0.1);
      }
      .bg-grid {
        background-image:
          linear-gradient(rgba(206,17,65,0.03) 1px, transparent 1px),
          linear-gradient(90deg, rgba(206,17,65,0.03) 1px, transparent 1px);
        background-size: 40px 40px;
      }
      .shimmer-bg {
        background: linear-gradient(90deg, transparent, rgba(206,17,65,0.08), transparent);
        background-size: 200% 100%;
        animation: shimmer 2s linear infinite;
      }
      .btn-ripple {
        position: relative;
        overflow: hidden;
      }
      .btn-ripple::after {
        content: '';
        position: absolute;
        inset: 0;
        background: radial-gradient(circle at var(--ripple-x, 50%) var(--ripple-y, 50%), rgba(206,17,65,0.3), transparent 70%);
        opacity: 0;
        transition: opacity 0.3s;
      }
      .btn-ripple:active::after {
        opacity: 1;
      }
      .glow-border {
        box-shadow: 0 0 15px rgba(206,17,65,0.2), inset 0 0 15px rgba(206,17,65,0.05);
      }
      .win-ring-glow {
        filter: drop-shadow(0 0 8px rgba(206,17,65,0.5));
      }

      /* === PREMIUM MICRO-INTERACTIONS === */
      button, [role="button"], a.btn, .btn-magnetic {
        transition: transform 0.2s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow 0.2s ease, background-color 0.2s ease, border-color 0.2s ease !important;
      }
      button:hover, [role="button"]:hover {
        transform: scale(1.03);
      }
      button:active, [role="button"]:active {
        transform: scale(0.97);
      }
      /* Card hover glow - raptors red */
      .glass-card:hover, .premium-glass:hover, .glass-premium:hover {
        border-color: rgba(206, 17, 65, 0.3) !important;
        box-shadow: 0 12px 32px rgba(0,0,0,0.3), 0 0 20px rgba(206,17,65,0.08) !important;
      }
      /* Smooth accordion */
      details[open] summary ~ * {
        animation: accordion-open 0.3s ease-out;
      }
      @keyframes accordion-open {
        from { opacity: 0; transform: translateY(-8px); }
        to { opacity: 1; transform: translateY(0); }
      }

      /* Kill ALL padding on widget wrappers in grid */
      .dashboard-grid > div { padding: 0 !important; margin: 0 !important; }
      .dashboard-grid .glass-card,
      .dashboard-grid .premium-glass,
      .dashboard-grid [class*="bg-white"][class*="border"] {
        margin: 0 !important;
        height: 100%;
      }
      .dashboard-grid .glass-card > div:first-child,
      .dashboard-grid .premium-glass > div:first-child {
        padding-top: 4px !important;
      }
      /* ======== AGGRESSIVE COMPACT SPACING v13.0 ======== */
      /* Force tight spacing everywhere */
      .dashboard-grid .space-y-3 > * + *,
      .dashboard-grid .space-y-4 > * + *,
      #sidebar-panel .space-y-3 > * + *,
      #sidebar-panel .space-y-4 > * + * { margin-top: 0.25rem !important; }
      .dashboard-grid .space-y-2 > * + *,
      #sidebar-panel .space-y-2 > * + * { margin-top: 0.125rem !important; }
      .dashboard-grid .gap-3, #sidebar-panel .gap-3 { gap: 0.25rem !important; }
      .dashboard-grid .gap-4, #sidebar-panel .gap-4 { gap: 0.375rem !important; }
      .dashboard-grid .gap-2, #sidebar-panel .gap-2 { gap: 0.125rem !important; }
      .dashboard-grid .rounded-lg, #sidebar-panel .rounded-lg { border-radius: 0.25rem !important; }
      .dashboard-grid .rounded-2xl, #sidebar-panel .rounded-2xl { border-radius: 0.5rem !important; }
      /* Compact text */
      .dashboard-grid .text-xs, #sidebar-panel .text-xs { font-size: 0.65rem !important; line-height: 1.1 !important; }
      .dashboard-grid .text-sm, #sidebar-panel .text-sm { font-size: 0.7rem !important; line-height: 1.2 !important; }
      .dashboard-grid .text-\[10px\], #sidebar-panel .text-\[10px\] { font-size: 9px !important; }
      .dashboard-grid .text-\[11px\], #sidebar-panel .text-\[11px\] { font-size: 10px !important; }
      .dashboard-grid .text-\[9px\], #sidebar-panel .text-\[9px\] { font-size: 8px !important; }

      /* Sidebar compact */
      #sidebar-panel > * { margin-bottom: 0.375rem !important; }
      #sidebar-panel [class*="p-4"] { padding: 0.375rem !important; }
      #sidebar-panel [class*="p-3"] { padding: 0.25rem !important; }
    </style>
  </head>
  <body>
    <div id="root"></div>

    <script src="https://cdn.jsdelivr.net/npm/react@18.3.1/umd/react.production.min.js" crossorigin></script>
    <script src="https://cdn.jsdelivr.net/npm/react-dom@18.3.1/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://cdn.jsdelivr.net/npm/@babel/standalone@7.26.5/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prop-types@15.8.1/prop-types.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/recharts@2.15.3/umd/Recharts.js"></script>
    <script>window.react = window.React;</script>
    <script src="https://cdn.jsdelivr.net/npm/lucide-react@0.460.0/dist/umd/lucide-react.min.js"></script>

    <script type="text/babel" data-type="module">
// ============================================================
// TYPES (just used as documentation, no runtime TypeScript)
// ============================================================

// ============================================================
// DATA SERVICE
// ============================================================
const fmt = (num) => Number(num.toFixed(1));

// Live NBA Scores (simulated)
const LIVE_NBA_SCORES = [
  { home: "CLE", away: "BOS", homeScore: 108, awayScore: 102, status: "Final", homeId: "1610612739", awayId: "1610612738" },
  { home: "NYK", away: "MIA", homeScore: 118, awayScore: 115, status: "Final", homeId: "1610612752", awayId: "1610612748" },
  { home: "DEN", away: "LAL", homeScore: 95, awayScore: 88, status: "Q4 5:32", homeId: "1610612743", awayId: "1610612747" },
  { home: "GSW", away: "PHX", homeScore: 72, awayScore: 68, status: "Q3 8:15", homeId: "1610612744", awayId: "1610612756" },
  { home: "MIL", away: "CHI", homeScore: 0, awayScore: 0, status: "7:30 PM", homeId: "1610612749", awayId: "1610612741" },
  { home: "DAL", away: "OKC", homeScore: 0, awayScore: 0, status: "8:00 PM", homeId: "1610612742", awayId: "1610612760" },
];

// Comprehensive Betting Intelligence Data
const BETTING_INTEL = {
  // Odds from multiple sportsbooks
  odds: {
    opponent: "CLE",
    gameTime: "2026-02-10T00:00:00Z",
    books: {
      DraftKings: { spread: { line: -3.5, vig: -110 }, ml: { raptors: -155, opp: 135 }, ou: { line: 225.5, overVig: -110, underVig: -110 }, updated: "6:45 PM" },
      FanDuel: { spread: { line: -3, vig: -108 }, ml: { raptors: -148, opp: 126 }, ou: { line: 226, overVig: -112, underVig: -108 }, updated: "6:42 PM" },
      bet365: { spread: { line: -3.5, vig: -105 }, ml: { raptors: -150, opp: 130 }, ou: { line: 225.5, overVig: -108, underVig: -112 }, updated: "6:38 PM" },
      BetMGM: { spread: { line: -3, vig: -115 }, ml: { raptors: -160, opp: 140 }, ou: { line: 226, overVig: -110, underVig: -110 }, updated: "6:40 PM" }
    },
    opening: { spread: -2.5, ml: -130, ou: 224 },
    movements: [
      { time: "10:00 AM", spread: -2.5, ou: 224, note: "Open" },
      { time: "12:30 PM", spread: -3, ou: 224.5, note: "Sharp action" },
      { time: "3:15 PM", spread: -3.5, ou: 225, note: "Injury news" },
      { time: "5:00 PM", spread: -3.5, ou: 225.5, note: "Steam move" },
      { time: "6:45 PM", spread: -3.5, ou: 225.5, note: "Current" }
    ]
  },
  // ATS records
  ats: {
    overall: { w: 28, l: 29, push: 1, pct: 49.1 },
    home: { w: 16, l: 12, push: 1, pct: 57.1 },
    away: { w: 12, l: 17, push: 0, pct: 41.4 },
    last10: { w: 6, l: 4, push: 0, pct: 60.0 },
    last20: { w: 11, l: 9, push: 0, pct: 55.0 },
    asFavorite: { w: 8, l: 12, push: 0, pct: 40.0 },
    asUnderdog: { w: 20, l: 17, push: 1, pct: 54.1 },
    margins: { "1-3": { w: 10, l: 8 }, "4-7": { w: 11, l: 12 }, "8+": { w: 7, l: 9 } },
    conference: { w: 18, l: 17, pct: 51.4 },
    division: { w: 7, l: 5, pct: 58.3 },
    afterWin: { w: 13, l: 14, pct: 48.1 },
    afterLoss: { w: 15, l: 15, pct: 50.0 }
  },
  // Over/Under trends
  ouTrends: {
    overall: { over: 30, under: 27, push: 1, pct: 52.6 },
    home: { over: 17, under: 12, pct: 58.6 },
    away: { over: 13, under: 15, pct: 46.4 },
    last10: { over: 7, under: 3, pct: 70.0 },
    avgTotal: 222.8,
    avgTeamPts: 113.4,
    avgOppPts: 109.4,
    paceRank: 8,
    paceFactor: 100.2,
    byQuarter: { Q1: { over: 32, under: 26 }, Q2: { over: 28, under: 30 }, Q3: { over: 31, under: 27 }, Q4: { over: 29, under: 29 } },
    streaks: ["Over in 7 of last 10 games", "Over 225 in 5 of last 7 home games", "Under in 4 of last 6 road games"]
  },
  // Player props
  playerProps: [
    { name: "Scottie Barnes", pos: "F", pts: { line: 22.5, overRate: 65, last10: [28,19,24,31,20,25,18,27,23,26] }, reb: { line: 7.5, overRate: 55, last10: [8,6,9,7,10,5,8,7,11,6] }, ast: { line: 6.5, overRate: 50, last10: [7,5,8,6,9,4,7,6,8,5] }, threes: { line: 1.5, overRate: 45 }, hot: true, matchupAdj: +1.2 },
    { name: "RJ Barrett", pos: "G/F", pts: { line: 20.5, overRate: 55, last10: [22,18,25,17,21,23,19,24,16,20] }, reb: { line: 5.5, overRate: 50, last10: [6,4,7,5,8,3,6,5,7,4] }, ast: { line: 4.5, overRate: 45, last10: [5,3,6,4,7,2,5,4,6,3] }, threes: { line: 2.5, overRate: 60 }, hot: false, matchupAdj: -0.5 },
    { name: "Immanuel Quickley", pos: "G", pts: { line: 17.5, overRate: 50, last10: [20,15,18,22,14,19,16,21,13,17] }, reb: { line: 4.5, overRate: 40, last10: [5,3,4,6,3,5,4,7,2,4] }, ast: { line: 6.5, overRate: 55, last10: [7,5,8,6,9,4,7,6,8,5] }, threes: { line: 2.5, overRate: 50 }, hot: false, matchupAdj: +0.3 },
    { name: "Jakob Poeltl", pos: "C", pts: { line: 14.5, overRate: 48, last10: [16,12,18,11,15,14,17,10,16,13] }, reb: { line: 9.5, overRate: 60, last10: [11,8,12,9,10,7,11,10,13,8] }, ast: { line: 2.5, overRate: 35, last10: [3,1,4,2,3,1,2,3,4,1] }, threes: { line: 0.5, overRate: 10 }, hot: false, matchupAdj: -1.0 },
    { name: "Gradey Dick", pos: "G", pts: { line: 15.5, overRate: 52, last10: [18,13,16,20,12,17,14,19,11,15] }, reb: { line: 3.5, overRate: 42, last10: [4,2,5,3,4,2,3,4,5,2] }, ast: { line: 2.5, overRate: 38, last10: [3,1,4,2,3,1,2,3,4,1] }, threes: { line: 2.5, overRate: 55 }, hot: true, matchupAdj: +0.8 }
  ],
  // Sharp money
  sharp: {
    spreadPublic: { raptors: 62, opp: 38 },
    spreadMoney: { raptors: 45, opp: 55 },
    ouPublic: { over: 58, under: 42 },
    ouMoney: { over: 40, under: 60 },
    mlPublic: { raptors: 68, opp: 32 },
    mlMoney: { raptors: 52, opp: 48 },
    steamMoves: [
      { time: "12:32 PM", type: "spread", direction: "TOR -3", book: "Pinnacle", alert: true },
      { time: "3:18 PM", type: "total", direction: "Over 225", book: "Circa", alert: false }
    ],
    reverseLineMovement: { detected: true, detail: "68% public on TOR ML but line moved from -155 to -148 at FanDuel" }
  },
  // Situational angles
  situations: {
    b2b: { w: 4, l: 8, pct: 33.3, note: "Raptors 4-8 ATS on back-to-backs" },
    restAdvantage: { w: 15, l: 9, pct: 62.5, note: "62.5% ATS with rest advantage" },
    afterBreak: { w: 3, l: 1, pct: 75.0, note: "3-1 ATS after 3+ days rest" },
    divisionRivals: { w: 7, l: 5, pct: 58.3, note: "Strong vs Atlantic Division" },
    nationalTV: { w: 3, l: 5, pct: 37.5, note: "Struggle in spotlight games" },
    postASB: { w: 0, l: 0, pct: 0, note: "Post All-Star data pending" },
    monthly: { Oct: { w: 5, l: 4 }, Nov: { w: 7, l: 8 }, Dec: { w: 6, l: 7 }, Jan: { w: 8, l: 7 }, Feb: { w: 2, l: 3 } }
  },
  // Model predictions
  model: {
    compositeScore: 72,
    raptorsPower: 4.8,
    oppPower: 3.2,
    predictedScore: { raptors: 114, opp: 109 },
    spreadPick: { pick: "TOR -3.5", confidence: 68, edge: 1.2 },
    mlPick: { pick: "TOR ML", confidence: 72, edge: 3.5 },
    ouPick: { pick: "Over 225.5", confidence: 61, edge: 0.8 },
    factors: [
      "Raptors 6-4 ATS L10 with improving defensive metrics",
      "Opponent missing key rotation player (questionable)",
      "Pace matchup favors over: both teams top-12 in pace",
      "Home court advantage: TOR 16-12 ATS at home",
      "Sharp money aligning with TOR spread"
    ]
  },
  // Prop builder correlations
  correlations: [
    { trigger: "Barnes scores 25+", result: "Raptors 8-3 ATS", strength: 72 },
    { trigger: "Barrett hits 3+ threes", result: "Game goes Over 78%", strength: 78 },
    { trigger: "Poeltl 12+ rebounds", result: "Raptors win by 5+", strength: 65 },
    { trigger: "Quickley 8+ assists", result: "Raptors 6-2 ATS", strength: 75 },
    { trigger: "Dick hits 4+ threes", result: "Game goes Over 82%", strength: 82 }
  ],
  // Legacy compat
  spread: { line: -3.5, raptorsPct: 58, opponentPct: 42 },
  overUnder: { line: 225.5, overPct: 52, underPct: 48 },
  moneyline: { raptors: -155, opponent: 135, raptorsPct: 62, opponentPct: 38 }
};

// 2025-26 NBA Salary Cap Info
const NBA_SALARY_CAP = {
  cap: 140588000,        // $140.588M
  luxuryTax: 170814000,  // $170.814M
  apron1: 178132000,     // First apron $178.132M
  apron2: 188931000,     // Second apron $188.931M
  minimum: 126529200,    // Minimum team salary
};

// Format salary for display
const formatSalary = (amount) => {
  if (!amount) return 'N/A';
  if (amount >= 1000000) return `$${(amount / 1000000).toFixed(1)}M`;
  if (amount >= 1000) return `$${(amount / 1000).toFixed(0)}K`;
  return `$${amount.toLocaleString()}`;
};

// Look up player name from any roster by ID
const findPlayerName = (playerId, teamHint = null) => {
  // Check Raptors roster first (will be defined later)
  // This function will be called after RAPTORS_ROSTER is defined
  if (typeof RAPTORS_ROSTER !== 'undefined') {
    const raptorsPlayer = RAPTORS_ROSTER.find(p => p.id === playerId);
    if (raptorsPlayer) return raptorsPlayer.name;
  }
  
  // Check opponent rosters
  if (typeof OPPONENT_DATA !== 'undefined') {
    // If we have a team hint, check that team first
    if (teamHint && OPPONENT_DATA[teamHint]?.roster) {
      const player = OPPONENT_DATA[teamHint].roster.find(p => p.id === playerId);
      if (player) return player.name;
    }
    // Check all opponent rosters
    for (const teamName of Object.keys(OPPONENT_DATA)) {
      const team = OPPONENT_DATA[teamName];
      if (team.roster) {
        const player = team.roster.find(p => p.id === playerId);
        if (player) return player.name;
      }
    }
  }
  
  return null;
};

// Team Salary Data (2025-26 season)
const TEAM_SALARIES = {
  "Raptors": {
    total: 156800000,
    capSpace: -16212000,
    luxuryTaxBill: 0,
    roster: {
      "1630567": { salary: 28372000, years: 4, expiry: 2029, type: "Rookie Max Extension" }, // Scottie Barnes
      "1629628": { salary: 25550000, years: 3, expiry: 2027, type: "Standard" }, // RJ Barrett
      "1630193": { salary: 26900000, years: 4, expiry: 2029, type: "Extension" }, // Immanuel Quickley
      "1627751": { salary: 19500000, years: 2, expiry: 2027, type: "Standard" }, // Jakob Poeltl
      "1630572": { salary: 2200000, years: 2, expiry: 2027, type: "Standard" }, // Sandro Mamukelashvili
      "1642347": { salary: 3500000, years: 4, expiry: 2029, type: "Rookie" }, // Jamal Shead
      "1642867": { salary: 5200000, years: 4, expiry: 2029, type: "Rookie" }, // Collin Murray-Boyles
      "1642266": { salary: 4200000, years: 3, expiry: 2028, type: "Rookie" }, // Ja'Kobe Walter
      "1641711": { salary: 4800000, years: 3, expiry: 2028, type: "Rookie" }, // Gradey Dick
      "1631218": { salary: 2100000, years: 2, expiry: 2027, type: "Standard" }, // Trayce Jackson-Davis
      "1642367": { salary: 1200000, years: 2, expiry: 2027, type: "Two-Way" }, // Jonathan Mogbo
      "1642419": { salary: 1800000, years: 2, expiry: 2027, type: "Standard" }, // Jamison Battle
      "202066": { salary: 2100000, years: 1, expiry: 2026, type: "Veteran Min" }, // Garrett Temple
      "1630639": { salary: 580000, years: 1, expiry: 2026, type: "Two-Way" }, // A.J. Lawson
      "1642918": { salary: 580000, years: 1, expiry: 2026, type: "Two-Way" }, // Alijah Martin
      "1642935": { salary: 580000, years: 1, expiry: 2026, type: "Two-Way" }, // Chucky Hepburn
      "101108": { salary: 11400000, years: 1, expiry: 2026, type: "Standard" }, // Chris Paul
    }
  },
  "Pistons": {
    total: 128500000,
    capSpace: 12088000,
    luxuryTaxBill: 0,
    roster: {
      "1630595": { salary: 13200000, years: 2, expiry: 2027, type: "Rookie Extension" }, // Cade Cunningham
      "1630217": { salary: 8600000, years: 2, expiry: 2027, type: "Rookie" }, // Jaden Ivey
      "1631105": { salary: 6000000, years: 3, expiry: 2028, type: "Rookie" }, // Jalen Duren
      "1631223": { salary: 5800000, years: 3, expiry: 2028, type: "Rookie" }, // Ausar Thompson
      "203082": { salary: 23500000, years: 2, expiry: 2027, type: "Standard" }, // Tobias Harris
      "1628381": { salary: 6500000, years: 1, expiry: 2026, type: "Standard" }, // Malik Beasley
      "203501": { salary: 16800000, years: 2, expiry: 2027, type: "Standard" }, // Tim Hardaway Jr.
      "1631326": { salary: 5500000, years: 4, expiry: 2029, type: "Rookie" }, // Ron Holland
    }
  },
  "Pacers": {
    total: 175200000,
    capSpace: -34612000,
    luxuryTaxBill: 4400000,
    roster: {
      "1629029": { salary: 45000000, years: 4, expiry: 2029, type: "Max Extension" }, // Tyrese Haliburton
      "1628988": { salary: 37900000, years: 3, expiry: 2028, type: "Max" }, // Pascal Siakam
      "1631114": { salary: 8200000, years: 2, expiry: 2027, type: "Rookie" }, // Bennedict Mathurin
      "203490": { salary: 19900000, years: 2, expiry: 2027, type: "Standard" }, // Myles Turner
      "1629303": { salary: 8500000, years: 3, expiry: 2028, type: "Standard" }, // Andrew Nembhard
      "1627763": { salary: 2100000, years: 1, expiry: 2026, type: "Veteran Min" }, // T.J. McConnell
      "1627734": { salary: 13500000, years: 2, expiry: 2027, type: "Standard" }, // Obi Toppin
      "1629659": { salary: 6400000, years: 3, expiry: 2028, type: "Standard" }, // Aaron Nesmith
    }
  },
  "Bulls": {
    total: 169800000,
    capSpace: -29212000,
    luxuryTaxBill: 0,
    roster: {
      "1627853": { salary: 43000000, years: 3, expiry: 2028, type: "Max" }, // Zach LaVine
      "1628374": { salary: 18500000, years: 4, expiry: 2029, type: "Extension" }, // Coby White
      "1630533": { salary: 8800000, years: 3, expiry: 2028, type: "Trade" }, // Josh Giddey
      "203897": { salary: 20000000, years: 2, expiry: 2027, type: "Standard" }, // Nikola Vucevic
      "1628990": { salary: 12900000, years: 3, expiry: 2028, type: "Extension" }, // Patrick Williams
      "1630173": { salary: 7000000, years: 3, expiry: 2028, type: "Standard" }, // Ayo Dosunmu
      "1631210": { salary: 5000000, years: 4, expiry: 2029, type: "Rookie" }, // Matas Buzelis
      "1629655": { salary: 2100000, years: 1, expiry: 2026, type: "Standard" }, // Talen Horton-Tucker
    }
  },
  "Bucks": {
    total: 192500000,
    capSpace: -51912000,
    luxuryTaxBill: 48200000,
    roster: {
      "203507": { salary: 48800000, years: 3, expiry: 2028, type: "Supermax" }, // Giannis Antetokounmpo
      "203114": { salary: 31700000, years: 2, expiry: 2027, type: "Standard" }, // Khris Middleton
      "201572": { salary: 23000000, years: 2, expiry: 2027, type: "Standard" }, // Brook Lopez
      "1627739": { salary: 4000000, years: 2, expiry: 2027, type: "Standard" }, // Taurean Prince
      "101108": { salary: 16400000, years: 1, expiry: 2026, type: "Trade" }, // Chris Paul
      "1631100": { salary: 2000000, years: 3, expiry: 2028, type: "Standard" }, // AJ Green
      "1630226": { salary: 9400000, years: 2, expiry: 2027, type: "Standard" }, // Pat Connaughton
      "1628978": { salary: 10800000, years: 2, expiry: 2027, type: "Standard" }, // Bobby Portis
    }
  },
  "Thunder": {
    total: 165400000,
    capSpace: -24812000,
    luxuryTaxBill: 0,
    roster: {
      "1630532": { salary: 35000000, years: 5, expiry: 2030, type: "Designated Max" }, // Shai Gilgeous-Alexander
      "1630581": { salary: 8000000, years: 2, expiry: 2027, type: "Rookie" }, // Jalen Williams
      "1630549": { salary: 12100000, years: 3, expiry: 2028, type: "Rookie" }, // Chet Holmgren
      "1629008": { salary: 15300000, years: 4, expiry: 2029, type: "Extension" }, // Lu Dort
      "1630537": { salary: 3200000, years: 3, expiry: 2028, type: "Standard" }, // Isaiah Joe
      "1628412": { salary: 4200000, years: 2, expiry: 2027, type: "Standard" }, // Kenrich Williams
      "1629743": { salary: 29000000, years: 3, expiry: 2028, type: "Standard" }, // Isaiah Hartenstein
      "1630585": { salary: 6000000, years: 3, expiry: 2028, type: "Standard" }, // Aaron Wiggins
    }
  },
  "Spurs": {
    total: 118900000,
    capSpace: 21688000,
    luxuryTaxBill: 0,
    roster: {
      "1641706": { salary: 12200000, years: 3, expiry: 2028, type: "Rookie" }, // Victor Wembanyama
      "1631104": { salary: 7200000, years: 4, expiry: 2029, type: "Rookie" }, // Stephon Castle
      "1628464": { salary: 18500000, years: 4, expiry: 2029, type: "Extension" }, // Devin Vassell
      "1629649": { salary: 11000000, years: 3, expiry: 2028, type: "Extension" }, // Keldon Johnson
      "1630537": { salary: 8500000, years: 3, expiry: 2028, type: "Rookie" }, // Jeremy Sochan
      "201566": { salary: 18000000, years: 2, expiry: 2027, type: "Standard" }, // Harrison Barnes
      "1628499": { salary: 2200000, years: 2, expiry: 2027, type: "Standard" }, // Julian Champagnie
    }
  },
  "Wizards": {
    total: 105600000,
    capSpace: 34988000,
    luxuryTaxBill: 0,
    roster: {
      "1630178": { salary: 28400000, years: 3, expiry: 2028, type: "Extension" }, // Jordan Poole
      "1630217": { salary: 8500000, years: 3, expiry: 2028, type: "Extension" }, // Corey Kispert
      "1629008": { salary: 23500000, years: 2, expiry: 2027, type: "Standard" }, // Kyle Kuzma
      "1631097": { salary: 10900000, years: 4, expiry: 2029, type: "Rookie" }, // Alexandre Sarr
      "1631101": { salary: 5500000, years: 3, expiry: 2028, type: "Rookie" }, // Bilal Coulibaly
      "1629635": { salary: 7000000, years: 3, expiry: 2028, type: "Standard" }, // Deni Avdija
      "1630206": { salary: 16800000, years: 2, expiry: 2027, type: "Standard" }, // Malcolm Brogdon
      "1631107": { salary: 4500000, years: 3, expiry: 2028, type: "Rookie" }, // Johnny Davis
    }
  },
  // EASTERN CONFERENCE
  "Celtics": {
    total: 193500000,
    capSpace: -52912000,
    luxuryTaxBill: 52000000,
    roster: {
      "1628369": { salary: 34848000, years: 4, expiry: 2029, type: "Max Extension" }, // Jayson Tatum
      "1627759": { salary: 31500000, years: 3, expiry: 2028, type: "Max" }, // Jaylen Brown
      "204001": { salary: 29300000, years: 3, expiry: 2028, type: "Standard" }, // Kristaps Porzingis
      "1628401": { salary: 20000000, years: 4, expiry: 2029, type: "Extension" }, // Derrick White
      "201950": { salary: 30000000, years: 3, expiry: 2028, type: "Trade" }, // Jrue Holiday
      "201143": { salary: 9500000, years: 1, expiry: 2026, type: "Veteran" }, // Al Horford
      "1630174": { salary: 6800000, years: 3, expiry: 2028, type: "Extension" }, // Payton Pritchard
      "1628382": { salary: 3200000, years: 2, expiry: 2027, type: "Standard" }, // Sam Hauser
    }
  },
  "Cavaliers": {
    total: 175800000,
    capSpace: -35212000,
    luxuryTaxBill: 5000000,
    roster: {
      "1629636": { salary: 36000000, years: 5, expiry: 2030, type: "Max Extension" }, // Darius Garland
      "1628386": { salary: 35000000, years: 4, expiry: 2029, type: "Max" }, // Donovan Mitchell
      "203954": { salary: 26000000, years: 2, expiry: 2027, type: "Standard" }, // Jarrett Allen
      "1629012": { salary: 21000000, years: 4, expiry: 2029, type: "Extension" }, // Evan Mobley
      "1628372": { salary: 12000000, years: 2, expiry: 2027, type: "Standard" }, // Caris LeVert
      "1630569": { salary: 6500000, years: 3, expiry: 2028, type: "Rookie" }, // Isaac Okoro
      "203915": { salary: 4500000, years: 2, expiry: 2027, type: "Standard" }, // Max Strus
      "1627745": { salary: 3000000, years: 1, expiry: 2026, type: "Veteran Min" }, // Georges Niang
    }
  },
  "Knicks": {
    total: 188400000,
    capSpace: -47812000,
    luxuryTaxBill: 38000000,
    roster: {
      "203944": { salary: 32000000, years: 2, expiry: 2027, type: "Trade" }, // Julius Randle (traded)
      "1629628": { salary: 25000000, years: 3, expiry: 2028, type: "Trade" }, // RJ Barrett (traded to TOR)
      "1628978": { salary: 15000000, years: 2, expiry: 2027, type: "Standard" }, // OG Anunoby
      "1629011": { salary: 30000000, years: 4, expiry: 2029, type: "Extension" }, // Jalen Brunson
      "1628373": { salary: 14000000, years: 3, expiry: 2028, type: "Standard" }, // Josh Hart
      "1629634": { salary: 13500000, years: 3, expiry: 2028, type: "Standard" }, // Donte DiVincenzo
      "1630536": { salary: 8000000, years: 2, expiry: 2027, type: "Standard" }, // Isaiah Hartenstein (traded)
      "203901": { salary: 3500000, years: 1, expiry: 2026, type: "Veteran Min" }, // Miles McBride
    }
  },
  "Heat": {
    total: 178200000,
    capSpace: -37612000,
    luxuryTaxBill: 7400000,
    roster: {
      "1628389": { salary: 35000000, years: 3, expiry: 2028, type: "Max" }, // Bam Adebayo
      "201142": { salary: 33000000, years: 2, expiry: 2027, type: "Standard" }, // Jimmy Butler
      "1629639": { salary: 25000000, years: 4, expiry: 2029, type: "Extension" }, // Tyler Herro
      "1628407": { salary: 16500000, years: 3, expiry: 2028, type: "Standard" }, // Duncan Robinson
      "1627790": { salary: 8500000, years: 2, expiry: 2027, type: "Standard" }, // Terry Rozier
      "1630539": { salary: 4500000, years: 3, expiry: 2028, type: "Rookie" }, // Nikola Jovic
      "203482": { salary: 3200000, years: 1, expiry: 2026, type: "Veteran Min" }, // Kevin Love
      "1629216": { salary: 2500000, years: 2, expiry: 2027, type: "Standard" }, // Haywood Highsmith
    }
  },
  "Magic": {
    total: 128700000,
    capSpace: 11888000,
    luxuryTaxBill: 0,
    roster: {
      "1630532": { salary: 12000000, years: 3, expiry: 2028, type: "Rookie" }, // Paolo Banchero
      "1630596": { salary: 9500000, years: 3, expiry: 2028, type: "Rookie" }, // Franz Wagner
      "1629002": { salary: 8500000, years: 3, expiry: 2028, type: "Rookie" }, // Wendell Carter Jr.
      "1630567": { salary: 7200000, years: 3, expiry: 2028, type: "Standard" }, // Jalen Suggs
      "1630175": { salary: 5500000, years: 3, expiry: 2028, type: "Rookie" }, // Cole Anthony
      "1630228": { salary: 4500000, years: 2, expiry: 2027, type: "Standard" }, // Jonathan Isaac
      "1629630": { salary: 3800000, years: 2, expiry: 2027, type: "Standard" }, // Gary Harris
      "1630571": { salary: 3200000, years: 2, expiry: 2027, type: "Rookie" }, // Moe Wagner
    }
  },
  "76ers": {
    total: 168500000,
    capSpace: -27912000,
    luxuryTaxBill: 0,
    roster: {
      "203954": { salary: 51400000, years: 3, expiry: 2028, type: "Supermax" }, // Joel Embiid
      "203078": { salary: 35000000, years: 3, expiry: 2028, type: "Trade" }, // Paul George
      "1629029": { salary: 32000000, years: 4, expiry: 2029, type: "Max" }, // Tyrese Maxey
      "1627814": { salary: 12500000, years: 2, expiry: 2027, type: "Standard" }, // Kelly Oubre Jr.
      "1630174": { salary: 6500000, years: 2, expiry: 2027, type: "Standard" }, // Kyle Lowry
      "1630591": { salary: 4200000, years: 3, expiry: 2028, type: "Rookie" }, // Jared McCain
      "1629651": { salary: 3500000, years: 2, expiry: 2027, type: "Standard" }, // Caleb Martin
      "203933": { salary: 2800000, years: 1, expiry: 2026, type: "Veteran Min" }, // Andre Drummond
    }
  },
  "Hawks": {
    total: 152800000,
    capSpace: -12212000,
    luxuryTaxBill: 0,
    roster: {
      "1629027": { salary: 43000000, years: 4, expiry: 2029, type: "Max" }, // Trae Young
      "203471": { salary: 27000000, years: 2, expiry: 2027, type: "Standard" }, // Dejounte Murray (traded)
      "1630169": { salary: 13000000, years: 4, expiry: 2029, type: "Extension" }, // Jalen Johnson
      "1630552": { salary: 8500000, years: 3, expiry: 2028, type: "Rookie" }, // Onyeka Okongwu
      "1630170": { salary: 7000000, years: 3, expiry: 2028, type: "Standard" }, // De'Andre Hunter
      "1631098": { salary: 5800000, years: 4, expiry: 2029, type: "Rookie" }, // Zaccharie Risacher
      "1629013": { salary: 3500000, years: 2, expiry: 2027, type: "Standard" }, // Bogdan Bogdanovic
      "1630574": { salary: 2500000, years: 2, expiry: 2027, type: "Standard" }, // Dyson Daniels
    }
  },
  "Nets": {
    total: 135200000,
    capSpace: 5388000,
    luxuryTaxBill: 0,
    roster: {
      "1629629": { salary: 28000000, years: 3, expiry: 2028, type: "Trade" }, // Cam Johnson
      "1627853": { salary: 19000000, years: 2, expiry: 2027, type: "Trade" }, // Mikal Bridges (traded)
      "1628991": { salary: 15000000, years: 3, expiry: 2028, type: "Standard" }, // Spencer Dinwiddie
      "1629651": { salary: 12000000, years: 2, expiry: 2027, type: "Standard" }, // Nic Claxton
      "1630544": { salary: 6500000, years: 3, expiry: 2028, type: "Rookie" }, // Day'Ron Sharpe
      "1631206": { salary: 4800000, years: 4, expiry: 2029, type: "Rookie" }, // Noah Clowney
      "1631099": { salary: 4200000, years: 4, expiry: 2029, type: "Rookie" }, // Dariq Whitehead
      "1629649": { salary: 3000000, years: 1, expiry: 2026, type: "Standard" }, // Dennis Schroder
    }
  },
  "Hornets": {
    total: 118500000,
    capSpace: 22088000,
    luxuryTaxBill: 0,
    roster: {
      "1630163": { salary: 26000000, years: 4, expiry: 2029, type: "Max Extension" }, // LaMelo Ball
      "1630577": { salary: 8800000, years: 3, expiry: 2028, type: "Rookie" }, // Mark Williams
      "1628389": { salary: 8000000, years: 2, expiry: 2027, type: "Standard" }, // Miles Bridges
      "1631106": { salary: 7500000, years: 4, expiry: 2029, type: "Rookie" }, // Brandon Miller
      "1631102": { salary: 5200000, years: 4, expiry: 2029, type: "Rookie" }, // Tidjane Salaun
      "1629607": { salary: 4500000, years: 3, expiry: 2028, type: "Standard" }, // P.J. Washington (traded)
      "1629649": { salary: 3500000, years: 2, expiry: 2027, type: "Standard" }, // Tre Mann
      "1629013": { salary: 2800000, years: 1, expiry: 2026, type: "Standard" }, // Grant Williams
    }
  },
  // WESTERN CONFERENCE
  "Lakers": {
    total: 184500000,
    capSpace: -43912000,
    luxuryTaxBill: 28000000,
    roster: {
      "2544": { salary: 47600000, years: 2, expiry: 2027, type: "Extension" }, // LeBron James
      "203076": { salary: 43200000, years: 3, expiry: 2028, type: "Max" }, // Anthony Davis
      "1627759": { salary: 18600000, years: 2, expiry: 2027, type: "Trade" }, // D'Angelo Russell
      "203458": { salary: 14800000, years: 2, expiry: 2027, type: "Standard" }, // Austin Reaves
      "1629639": { salary: 9500000, years: 3, expiry: 2028, type: "Standard" }, // Rui Hachimura
      "1628398": { salary: 6500000, years: 2, expiry: 2027, type: "Standard" }, // Gabe Vincent
      "1629014": { salary: 5200000, years: 2, expiry: 2027, type: "Standard" }, // Jarred Vanderbilt
      "1630559": { salary: 4500000, years: 3, expiry: 2028, type: "Rookie" }, // Max Christie
    }
  },
  "Clippers": {
    total: 168900000,
    capSpace: -28312000,
    luxuryTaxBill: 0,
    roster: {
      "201933": { salary: 42000000, years: 2, expiry: 2027, type: "Extension" }, // Kawhi Leonard
      "1628381": { salary: 28000000, years: 3, expiry: 2028, type: "Extension" }, // James Harden
      "203497": { salary: 16000000, years: 2, expiry: 2027, type: "Standard" }, // Norman Powell
      "1629002": { salary: 12500000, years: 3, expiry: 2028, type: "Standard" }, // Ivica Zubac
      "1628401": { salary: 10500000, years: 2, expiry: 2027, type: "Standard" }, // Terance Mann
      "1628416": { salary: 8000000, years: 3, expiry: 2028, type: "Standard" }, // P.J. Tucker
      "1630546": { salary: 4500000, years: 3, expiry: 2028, type: "Rookie" }, // Kobe Brown
      "101108": { salary: 11400000, years: 1, expiry: 2026, type: "Expiring" }, // Chris Paul (traded)
    }
  },
  "Warriors": {
    total: 195600000,
    capSpace: -55012000,
    luxuryTaxBill: 56000000,
    roster: {
      "201939": { salary: 55800000, years: 3, expiry: 2028, type: "Supermax" }, // Stephen Curry
      "203110": { salary: 29600000, years: 2, expiry: 2027, type: "Extension" }, // Draymond Green
      "1628398": { salary: 22300000, years: 3, expiry: 2028, type: "Max" }, // Andrew Wiggins
      "1628973": { salary: 14500000, years: 3, expiry: 2028, type: "Extension" }, // Jonathan Kuminga
      "1627780": { salary: 12000000, years: 2, expiry: 2027, type: "Standard" }, // Gary Payton II
      "1631218": { salary: 2100000, years: 2, expiry: 2027, type: "Standard" }, // Trayce Jackson-Davis (traded to TOR)
      "1630589": { salary: 4200000, years: 3, expiry: 2028, type: "Rookie" }, // Brandin Podziemski
      "1630540": { salary: 3800000, years: 2, expiry: 2027, type: "Standard" }, // Kevon Looney
    }
  },
  "Suns": {
    total: 218500000,
    capSpace: -77912000,
    luxuryTaxBill: 102000000,
    roster: {
      "201142": { salary: 49200000, years: 2, expiry: 2027, type: "Supermax" }, // Kevin Durant
      "1628983": { salary: 35000000, years: 3, expiry: 2028, type: "Max" }, // Devin Booker
      "203081": { salary: 46700000, years: 3, expiry: 2028, type: "Supermax" }, // Bradley Beal
      "1630224": { salary: 8800000, years: 2, expiry: 2027, type: "Standard" }, // Jusuf Nurkic
      "1629634": { salary: 6500000, years: 2, expiry: 2027, type: "Standard" }, // Grayson Allen
      "1629675": { salary: 5200000, years: 2, expiry: 2027, type: "Standard" }, // Royce O'Neale
      "1630536": { salary: 4500000, years: 3, expiry: 2028, type: "Standard" }, // Bol Bol
      "1629750": { salary: 2500000, years: 1, expiry: 2026, type: "Standard" }, // Eric Gordon
    }
  },
  "Kings": {
    total: 172400000,
    capSpace: -31812000,
    luxuryTaxBill: 1600000,
    roster: {
      "1628368": { salary: 35000000, years: 4, expiry: 2029, type: "Max Extension" }, // De'Aaron Fox
      "203943": { salary: 33000000, years: 3, expiry: 2028, type: "Max" }, // Domantas Sabonis
      "1627737": { salary: 24000000, years: 3, expiry: 2028, type: "Extension" }, // DeMar DeRozan
      "1627738": { salary: 16500000, years: 2, expiry: 2027, type: "Standard" }, // Malik Monk
      "203952": { salary: 12500000, years: 2, expiry: 2027, type: "Standard" }, // Harrison Barnes
      "1630169": { salary: 8500000, years: 3, expiry: 2028, type: "Standard" }, // Keegan Murray
      "1630549": { salary: 5500000, years: 3, expiry: 2028, type: "Rookie" }, // Keon Ellis
      "1629723": { salary: 3500000, years: 2, expiry: 2027, type: "Standard" }, // Kevin Huerter
    }
  },
  "Nuggets": {
    total: 188200000,
    capSpace: -47612000,
    luxuryTaxBill: 35000000,
    roster: {
      "203999": { salary: 51400000, years: 3, expiry: 2028, type: "Supermax" }, // Nikola Jokic
      "203914": { salary: 34000000, years: 3, expiry: 2028, type: "Max" }, // Jamal Murray
      "203932": { salary: 32000000, years: 3, expiry: 2028, type: "Max" }, // Aaron Gordon
      "1629008": { salary: 22000000, years: 3, expiry: 2028, type: "Extension" }, // Michael Porter Jr.
      "1630166": { salary: 8500000, years: 3, expiry: 2028, type: "Rookie" }, // Christian Braun
      "1629649": { salary: 4500000, years: 2, expiry: 2027, type: "Standard" }, // Kentavious Caldwell-Pope (left)
      "1631207": { salary: 3800000, years: 4, expiry: 2029, type: "Rookie" }, // Julian Strawther
      "1630583": { salary: 3200000, years: 2, expiry: 2027, type: "Standard" }, // Peyton Watson
    }
  },
  "Timberwolves": {
    total: 185300000,
    capSpace: -44712000,
    luxuryTaxBill: 29000000,
    roster: {
      "1630162": { salary: 42000000, years: 5, expiry: 2030, type: "Max Extension" }, // Anthony Edwards
      "203944": { salary: 30000000, years: 3, expiry: 2028, type: "Trade" }, // Julius Randle
      "203497": { salary: 43800000, years: 3, expiry: 2028, type: "Supermax" }, // Rudy Gobert
      "1630183": { salary: 18000000, years: 4, expiry: 2029, type: "Extension" }, // Jaden McDaniels
      "201144": { salary: 10500000, years: 1, expiry: 2026, type: "Veteran" }, // Mike Conley
      "1629675": { salary: 9000000, years: 3, expiry: 2028, type: "Standard" }, // Naz Reid
      "1628978": { salary: 12500000, years: 2, expiry: 2027, type: "Trade" }, // Donte DiVincenzo
      "1642265": { salary: 4200000, years: 4, expiry: 2029, type: "Rookie" }, // Rob Dillingham
    }
  },
  "Pelicans": {
    total: 165800000,
    capSpace: -25212000,
    luxuryTaxBill: 0,
    roster: {
      "1629627": { salary: 36000000, years: 4, expiry: 2029, type: "Max Extension" }, // Zion Williamson
      "1627742": { salary: 36000000, years: 3, expiry: 2028, type: "Max" }, // Brandon Ingram
      "203468": { salary: 26600000, years: 2, expiry: 2027, type: "Standard" }, // CJ McCollum
      "1627749": { salary: 20000000, years: 3, expiry: 2028, type: "Trade" }, // Dejounte Murray
      "1630529": { salary: 12500000, years: 4, expiry: 2029, type: "Extension" }, // Herbert Jones
      "1630530": { salary: 10000000, years: 4, expiry: 2029, type: "Extension" }, // Trey Murphy III
      "1630221": { salary: 4500000, years: 3, expiry: 2028, type: "Standard" }, // Jose Alvarado
      "1631103": { salary: 4200000, years: 4, expiry: 2029, type: "Rookie" }, // Yves Missi
    }
  },
  "Mavericks": {
    total: 192800000,
    capSpace: -52212000,
    luxuryTaxBill: 48000000,
    roster: {
      "1629029": { salary: 43000000, years: 4, expiry: 2029, type: "Supermax" }, // Luka Doncic
      "203124": { salary: 38200000, years: 3, expiry: 2028, type: "Max" }, // Kyrie Irving
      "1628372": { salary: 18500000, years: 3, expiry: 2028, type: "Trade" }, // Klay Thompson
      "1627827": { salary: 15500000, years: 2, expiry: 2027, type: "Standard" }, // P.J. Washington
      "203471": { salary: 12000000, years: 2, expiry: 2027, type: "Standard" }, // Daniel Gafford
      "1630224": { salary: 8500000, years: 3, expiry: 2028, type: "Standard" }, // Dereck Lively II
      "1630546": { salary: 5500000, years: 3, expiry: 2028, type: "Rookie" }, // Jaden Hardy
      "1629628": { salary: 4200000, years: 2, expiry: 2027, type: "Standard" }, // Maxi Kleber
    }
  },
  "Rockets": {
    total: 118200000,
    capSpace: 22388000,
    luxuryTaxBill: 0,
    roster: {
      "1630224": { salary: 10200000, years: 3, expiry: 2028, type: "Rookie" }, // Jalen Green
      "1630578": { salary: 8800000, years: 3, expiry: 2028, type: "Rookie" }, // Jabari Smith Jr.
      "1630598": { salary: 8200000, years: 3, expiry: 2028, type: "Rookie" }, // Alperen Sengun
      "1631108": { salary: 7500000, years: 4, expiry: 2029, type: "Rookie" }, // Amen Thompson
      "1629216": { salary: 6500000, years: 2, expiry: 2027, type: "Standard" }, // Dillon Brooks
      "1628378": { salary: 19500000, years: 2, expiry: 2027, type: "Trade" }, // Fred VanVleet
      "1631096": { salary: 5200000, years: 4, expiry: 2029, type: "Rookie" }, // Reed Sheppard
      "1629018": { salary: 4500000, years: 2, expiry: 2027, type: "Standard" }, // Tari Eason
    }
  },
  "Grizzlies": {
    total: 158900000,
    capSpace: -18312000,
    luxuryTaxBill: 0,
    roster: {
      "1629630": { salary: 38000000, years: 5, expiry: 2030, type: "Max Extension" }, // Ja Morant
      "1629635": { salary: 28000000, years: 4, expiry: 2029, type: "Max" }, // Desmond Bane
      "1629655": { salary: 16500000, years: 3, expiry: 2028, type: "Extension" }, // Jaren Jackson Jr.
      "1628991": { salary: 12500000, years: 2, expiry: 2027, type: "Standard" }, // Marcus Smart
      "1631109": { salary: 6500000, years: 4, expiry: 2029, type: "Rookie" }, // Zach Edey
      "1630530": { salary: 4800000, years: 3, expiry: 2028, type: "Standard" }, // Santi Aldama
      "1629655": { salary: 4200000, years: 2, expiry: 2027, type: "Standard" }, // Luke Kennard
      "1630545": { salary: 3800000, years: 2, expiry: 2027, type: "Standard" }, // GG Jackson
    }
  },
  "Trail Blazers": {
    total: 108500000,
    capSpace: 32088000,
    luxuryTaxBill: 0,
    roster: {
      "1630173": { salary: 28000000, years: 4, expiry: 2029, type: "Max Extension" }, // Anfernee Simons
      "1630175": { salary: 15000000, years: 3, expiry: 2028, type: "Extension" }, // Shaedon Sharpe
      "1629014": { salary: 12500000, years: 2, expiry: 2027, type: "Trade" }, // Jerami Grant
      "1629014": { salary: 8500000, years: 3, expiry: 2028, type: "Standard" }, // Deandre Ayton
      "1631100": { salary: 6800000, years: 4, expiry: 2029, type: "Rookie" }, // Scoot Henderson
      "1630544": { salary: 4500000, years: 3, expiry: 2028, type: "Rookie" }, // Toumani Camara
      "1630575": { salary: 3800000, years: 2, expiry: 2027, type: "Standard" }, // Kris Murray
      "1631110": { salary: 3200000, years: 4, expiry: 2029, type: "Rookie" }, // Donovan Clingan
    }
  },
  "Jazz": {
    total: 115600000,
    capSpace: 24988000,
    luxuryTaxBill: 0,
    roster: {
      "1627750": { salary: 24000000, years: 2, expiry: 2027, type: "Standard" }, // Jordan Clarkson
      "1628978": { salary: 18500000, years: 3, expiry: 2028, type: "Standard" }, // John Collins
      "1629649": { salary: 16000000, years: 2, expiry: 2027, type: "Standard" }, // Collin Sexton
      "1630224": { salary: 12000000, years: 3, expiry: 2028, type: "Rookie" }, // Walker Kessler
      "1630175": { salary: 8500000, years: 3, expiry: 2028, type: "Rookie" }, // Keyonte George
      "1630579": { salary: 7200000, years: 3, expiry: 2028, type: "Rookie" }, // Taylor Hendricks
      "1629655": { salary: 5500000, years: 2, expiry: 2027, type: "Standard" }, // Lauri Markkanen
      "1630533": { salary: 4200000, years: 2, expiry: 2027, type: "Standard" }, // Ochai Agbaji
    }
  },
};

// Arena Data
const ARENA_DATA = {
  name: "Scotiabank Arena",
  capacity: 19800,
  location: "Toronto, ON",
  opened: 1999,
  surface: "Hardwood Maple",
  weather: { temp: -5, condition: "Snow", icon: "â„ï¸" }
};

// Fan Poll Data
const FAN_POLL = {
  question: "Raptors win tonight?",
  options: [
    { text: "Yes! ðŸ”¥", votes: 847, pct: 72 },
    { text: "No ðŸ˜¢", votes: 328, pct: 28 }
  ],
  totalVotes: 1175
};

// Historical H2H
const HISTORICAL_H2H = {
  allTime: { raptors: 45, opponent: 38 },
  lastTen: { raptors: 6, opponent: 4 },
  atHome: { raptors: 28, opponent: 14 },
  playoffs: { raptors: 4, opponent: 2 }
};

// Injury Report
const INJURY_REPORT = {
  raptors: [
    { name: "Jakob Poeltl", status: "OUT", reason: "Back", updated: "Feb 8" },
    { name: "Collin Murray-Boyles", status: "GTD", reason: "Left thumb", updated: "Feb 8" }
  ],
  opponent: [] // Populated dynamically per opponent
};

// Trade Deadline (2025 deadline was Feb 6, 2025 - using 2026 estimate)
const TRADE_DEADLINE = {
  date: new Date('2026-02-05T15:00:00-05:00'), // 3pm ET
  rumorsActive: true,
  raptorsPlayers: [
    { name: "Chris Boucher", likelihood: "High", destination: "Contender" },
    { name: "Bruce Brown", likelihood: "Medium", destination: "TBD" }
  ]
};

const TRADE_RUMORS = [
  { id: 1, status: 'Completed', teams: ['Raptors', 'Clippers'], players: { sent: ['â€”'], received: ['Chris Paul'] }, picks: 'None', source: 'ESPN', impact: 7, date: 'Feb 5', summary: 'CP3 acquired from the Clippers. Veteran leadership and playmaking for a team pushing for the playoffs at 32-22.' },
  { id: 2, status: 'Completed', teams: ['Raptors', 'Warriors'], players: { sent: ['2026 2nd Round Pick'], received: ['Trayce Jackson-Davis'] }, picks: '2026 2nd (TOR) to GSW', source: 'ESPN', impact: 5, date: 'Feb 5', summary: 'Added frontcourt depth from Golden State in exchange for a second-round pick. TJD provides energy off the bench.' },
  { id: 3, status: 'Rumored', teams: ['Raptors', 'Various'], players: { sent: ['Jakob Poeltl'], received: ['TBD'] }, picks: 'N/A', source: 'League Sources', impact: 6, summary: 'Poeltl was reportedly available at the deadline but Toronto ultimately held firm, keeping their core intact for the playoff push.' },
  { id: 4, status: 'Dead', teams: ['Raptors', 'Pelicans'], players: { sent: ['TBD'], received: ['Brandon Ingram'] }, picks: 'N/A', source: 'Marc Stein', impact: 3, summary: 'Raptors were briefly linked to Ingram but never made a serious offer. Price was too steep and Toronto preferred to keep assets for the playoff push.' },
  { id: 5, status: 'Unlikely', teams: ['Raptors', 'Spurs'], players: { sent: ['Scottie Barnes'], received: ['Victor Wembanyama'] }, picks: 'N/A', source: 'Fan Twitter', impact: 1, summary: 'Pure fantasy. Neither side had any interest. Wemby and Scottie are both untouchable franchise cornerstones.' },
];

const ADVANCED_STATS = {
  raptors: { offRtg: 114.8, defRtg: 112.6, netRtg: 2.2, pace: 100.2, efgPct: 53.4, tsPct: 57.9, astPct: 62.8, rebPct: 51.2, tovPct: 12.8 },
  leagueAvg: { offRtg: 114.2, defRtg: 114.2, netRtg: 0.0, pace: 99.8, efgPct: 53.0, tsPct: 57.5, astPct: 60.5, rebPct: 50.0, tovPct: 13.5 },
  rank: { offRtg: 10, defRtg: 8, netRtg: 9, pace: 12, efgPct: 11, tsPct: 10 }
};

const SCHEDULE_DATA = {
  upcoming: [
    { date: 'Feb 11', opponent: 'Pistons', home: true, time: '7:30 PM ET', tv: 'TSN', oppRecord: '18-34', difficulty: 2 },
    { date: 'Feb 13', opponent: 'Cavaliers', home: false, time: '7:00 PM ET', tv: 'SN', oppRecord: '40-12', difficulty: 5 },
    { date: 'Feb 15', opponent: '76ers', home: true, time: '7:30 PM ET', tv: 'TSN', oppRecord: '22-30', difficulty: 3 },
    { date: 'Feb 18', opponent: 'Celtics', home: false, time: '7:30 PM ET', tv: 'SN', oppRecord: '38-14', difficulty: 5 },
    { date: 'Feb 20', opponent: 'Hawks', home: true, time: '7:30 PM ET', tv: 'TSN', oppRecord: '26-26', difficulty: 3 },
    { date: 'Feb 22', opponent: 'Bucks', home: false, time: '8:00 PM ET', tv: 'SN', oppRecord: '30-22', difficulty: 4 },
    { date: 'Feb 24', opponent: 'Magic', home: true, time: '7:30 PM ET', tv: 'TSN', oppRecord: '28-24', difficulty: 3 },
    { date: 'Feb 26', opponent: 'Bulls', home: false, time: '8:00 PM ET', tv: 'TSN', oppRecord: '20-32', difficulty: 2 },
    { date: 'Feb 28', opponent: 'Nets', home: true, time: '7:30 PM ET', tv: 'SN', oppRecord: '16-36', difficulty: 1 },
    { date: 'Mar 2', opponent: 'Heat', home: false, time: '6:00 PM ET', tv: 'SN', oppRecord: '29-23', difficulty: 4 }
  ],
  recent: [
    { date: 'Feb 8', opponent: 'Hawks', home: true, result: 'W', score: '118-105' },
    { date: 'Feb 6', opponent: 'Knicks', home: false, result: 'L', score: '98-112' },
    { date: 'Feb 4', opponent: 'Hornets', home: true, result: 'W', score: '124-101' },
    { date: 'Feb 2', opponent: 'Wizards', home: false, result: 'W', score: '115-98' },
    { date: 'Jan 31', opponent: 'Pacers', home: true, result: 'L', score: '108-116' }
  ]
};

// Rest/Fatigue Data
const REST_DATA = {
  lastGameDate: new Date('2026-02-08'), // Feb 8 vs Hawks
  nextGameDate: new Date('2026-02-11'), // Feb 11 vs Pistons
  isBackToBack: false,
  daysBetween: 3,
  milesLastWeek: 1250, // Toronto -> cities
  gamesLast7Days: 2,
  avgMinutesLast5: 34.2
};

// Fun Facts
const FUN_FACTS = [
  "The Raptors are 8-2 in their last 10 home games",
  "Scottie Barnes has 5 triple-doubles this season",
  "Toronto leads the league in fast break points",
  "The Raptors have won 15 straight vs teams below .500",
  "IQ has hit 4+ threes in 8 consecutive games"
];

// Live Viewers (simulated)
const LIVE_VIEWERS = Math.floor(Math.random() * 500) + 150;

const RAPTORS_ROSTER = [
  // --- STARTERS ---
  {
    id: "1630567", name: "Scottie Barnes", position: "PF", number: "4",
    seasonStats: { ppg: 19.4, rpg: 8.4, apg: 5.6, spg: 1.3, bpg: 1.6, oreb: 2.4, dreb: 6.0, fgPct: 50.3, threePtPct: 30.6, ftPct: 81.3, plusMinus: 3.2, turnovers: 2.7 },
    vsOpponentStats: { ppg: 21.5, rpg: 9.0, apg: 6.2, spg: 1.5, bpg: 1.8, oreb: 2.6, dreb: 6.4, fgPct: 51.0, threePtPct: 33.0, ftPct: 83.0, plusMinus: 4.0, turnovers: 2.5 },
    advanced: { per: 21.8, ts: 57.2, usg: 26.5, ortg: 116.0, drtg: 108.5 },
    last5: { ppg: 24.2, rpg: 9.8, apg: 6.5, fgPct: 54.0 }, // Hot!
    form: 'hot', // 'hot', 'cold', 'neutral'
    analysis: "The franchise cornerstone. Elite two-way force with All-NBA upside."
  },
  {
    id: "1629628", name: "RJ Barrett", position: "SF", number: "9",
    seasonStats: { ppg: 18.6, rpg: 5.2, apg: 3.5, spg: 0.8, bpg: 0.2, oreb: 1.0, dreb: 4.2, fgPct: 47.9, threePtPct: 33.8, ftPct: 70.1, plusMinus: 1.5, turnovers: 1.6 },
    vsOpponentStats: { ppg: 20.5, rpg: 5.8, apg: 4.0, spg: 1.0, bpg: 0.3, oreb: 1.1, dreb: 4.7, fgPct: 50.0, threePtPct: 36.0, ftPct: 73.0, plusMinus: 2.5, turnovers: 1.4 },
    advanced: { per: 17.5, ts: 54.8, usg: 24.0, ortg: 113.0, drtg: 112.5 },
    last5: { ppg: 16.2, rpg: 4.8, apg: 3.2, fgPct: 42.0 },
    form: 'neutral',
    analysis: "Aggressive downhill scorer with improved playmaking."
  },
  {
    id: "1630193", name: "Immanuel Quickley", position: "PG", number: "5",
    seasonStats: { ppg: 16.9, rpg: 4.5, apg: 6.1, spg: 1.3, bpg: 0.1, oreb: 0.6, dreb: 3.9, fgPct: 44.3, threePtPct: 37.9, ftPct: 80.1, plusMinus: 2.0, turnovers: 1.7 },
    vsOpponentStats: { ppg: 18.0, rpg: 5.0, apg: 7.0, spg: 1.5, bpg: 0.2, oreb: 0.7, dreb: 4.3, fgPct: 45.0, threePtPct: 39.0, ftPct: 82.0, plusMinus: 3.0, turnovers: 1.5 },
    advanced: { per: 18.2, ts: 57.5, usg: 24.5, ortg: 115.5, drtg: 111.0 },
    last5: { ppg: 21.4, rpg: 5.2, apg: 8.0, fgPct: 48.5 },
    form: 'hot',
    analysis: "Primary playmaker and floor general. Lethal three-point shooting off the dribble."
  },
  {
    id: "1627751", name: "Jakob Poeltl", position: "C", number: "19",
    seasonStats: { ppg: 9.7, rpg: 7.7, apg: 2.1, spg: 0.8, bpg: 0.5, oreb: 2.8, dreb: 4.9, fgPct: 69.3, threePtPct: 0.0, ftPct: 59.6, plusMinus: 3.5, turnovers: 1.6 },
    vsOpponentStats: { ppg: 10.5, rpg: 8.5, apg: 2.5, spg: 0.9, bpg: 0.8, oreb: 3.2, dreb: 5.3, fgPct: 71.0, threePtPct: 0.0, ftPct: 62.0, plusMinus: 4.0, turnovers: 1.4 },
    advanced: { per: 20.5, ts: 65.0, usg: 14.5, ortg: 125.0, drtg: 107.0 },
    analysis: "Elite rim protector and screen setter."
  },
  // --- BENCH ---
  {
    id: "1630572", name: "Sandro Mamukelashvili", position: "C", number: "54",
    seasonStats: { ppg: 11.3, rpg: 5.1, apg: 2.0, spg: 0.7, bpg: 0.6, oreb: 1.5, dreb: 3.6, fgPct: 52.6, threePtPct: 37.4, ftPct: 75.5, plusMinus: 1.8, turnovers: 0.9 },
    vsOpponentStats: { ppg: 12.0, rpg: 5.5, apg: 2.2, spg: 0.8, bpg: 0.7, oreb: 1.6, dreb: 3.9, fgPct: 54.0, threePtPct: 39.0, ftPct: 77.0, plusMinus: 2.5, turnovers: 0.8 },
    advanced: { per: 17.0, ts: 60.5, usg: 17.5, ortg: 118.0, drtg: 111.0 },
    analysis: "Breakout stretch-five off the bench."
  },
  {
    id: "1642347", name: "Jamal Shead", position: "PG", number: "23",
    seasonStats: { ppg: 7.0, rpg: 1.9, apg: 5.5, spg: 1.0, bpg: 0.1, oreb: 0.3, dreb: 1.6, fgPct: 37.0, threePtPct: 33.0, ftPct: 76.7, plusMinus: 0.5, turnovers: 1.3 },
    vsOpponentStats: { ppg: 7.5, rpg: 2.2, apg: 6.0, spg: 1.2, bpg: 0.2, oreb: 0.4, dreb: 1.8, fgPct: 38.5, threePtPct: 34.0, ftPct: 78.0, plusMinus: 1.0, turnovers: 1.1 },
    advanced: { per: 12.5, ts: 50.0, usg: 16.0, ortg: 107.0, drtg: 108.5 },
    analysis: "Tenacious defensive guard."
  },
  {
    id: "1642867", name: "Collin Murray-Boyles", position: "PF", number: "12",
    seasonStats: { ppg: 7.7, rpg: 5.1, apg: 2.1, spg: 0.9, bpg: 0.8, oreb: 1.8, dreb: 3.3, fgPct: 53.4, threePtPct: 34.1, ftPct: 64.4, plusMinus: 0.8, turnovers: 1.2 },
    vsOpponentStats: { ppg: 8.5, rpg: 5.5, apg: 2.3, spg: 1.0, bpg: 0.9, oreb: 2.0, dreb: 3.5, fgPct: 55.0, threePtPct: 36.0, ftPct: 66.0, plusMinus: 1.5, turnovers: 1.0 },
    advanced: { per: 15.0, ts: 56.5, usg: 14.0, ortg: 114.0, drtg: 109.0 },
    analysis: "2025 lottery pick making an immediate impact."
  },
  {
    id: "1642266", name: "Ja'Kobe Walter", position: "SG", number: "14",
    seasonStats: { ppg: 6.2, rpg: 2.1, apg: 0.9, spg: 0.9, bpg: 0.1, oreb: 0.3, dreb: 1.8, fgPct: 42.6, threePtPct: 34.6, ftPct: 80.0, plusMinus: -0.5, turnovers: 0.5 },
    vsOpponentStats: { ppg: 7.0, rpg: 2.5, apg: 1.2, spg: 1.0, bpg: 0.2, oreb: 0.4, dreb: 2.1, fgPct: 44.0, threePtPct: 36.0, ftPct: 82.0, plusMinus: 0.0, turnovers: 0.4 },
    advanced: { per: 10.5, ts: 54.0, usg: 13.5, ortg: 109.0, drtg: 112.0 },
    analysis: "Developing two-way wing with shooting upside."
  },
  {
    id: "1641711", name: "Gradey Dick", position: "SG", number: "1",
    seasonStats: { ppg: 6.5, rpg: 2.2, apg: 0.7, spg: 0.6, bpg: 0.1, oreb: 0.3, dreb: 1.9, fgPct: 42.0, threePtPct: 31.3, ftPct: 86.2, plusMinus: -1.5, turnovers: 0.5 },
    vsOpponentStats: { ppg: 7.0, rpg: 2.5, apg: 1.0, spg: 0.7, bpg: 0.1, oreb: 0.3, dreb: 2.2, fgPct: 44.0, threePtPct: 34.0, ftPct: 88.0, plusMinus: -0.5, turnovers: 0.4 },
    advanced: { per: 9.5, ts: 53.0, usg: 12.0, ortg: 108.0, drtg: 114.0 },
    analysis: "Sharpshooting wing with deep range."
  },
  {
    id: "1631218", name: "Trayce Jackson-Davis", position: "C", number: "32",
    seasonStats: { ppg: 4.2, rpg: 3.1, apg: 0.5, spg: 0.3, bpg: 0.6, oreb: 1.2, dreb: 1.9, fgPct: 58.8, threePtPct: 0.0, ftPct: 60.0, plusMinus: -0.5, turnovers: 0.6 },
    vsOpponentStats: { ppg: 4.5, rpg: 3.5, apg: 0.6, spg: 0.3, bpg: 0.7, oreb: 1.3, dreb: 2.2, fgPct: 60.0, threePtPct: 0.0, ftPct: 62.0, plusMinus: 0.0, turnovers: 0.5 },
    advanced: { per: 12.0, ts: 58.0, usg: 10.0, ortg: 112.0, drtg: 110.0 },
    analysis: "Acquired from Warriors at trade deadline. Athletic rim-running big."
  },
  {
    id: "1642367", name: "Jonathan Mogbo", position: "PF", number: "2",
    seasonStats: { ppg: 1.4, rpg: 1.8, apg: 0.5, spg: 0.1, bpg: 0.2, oreb: 0.6, dreb: 1.2, fgPct: 50.0, threePtPct: 0.0, ftPct: 40.0, plusMinus: -1.5, turnovers: 0.3 },
    vsOpponentStats: { ppg: 1.5, rpg: 2.0, apg: 0.6, spg: 0.2, bpg: 0.3, oreb: 0.7, dreb: 1.3, fgPct: 52.0, threePtPct: 0.0, ftPct: 45.0, plusMinus: -1.0, turnovers: 0.3 },
    advanced: { per: 7.0, ts: 47.0, usg: 8.0, ortg: 98.0, drtg: 110.0 },
    analysis: "High-motor developmental forward."
  },
  {
    id: "1642419", name: "Jamison Battle", position: "SF", number: "77",
    seasonStats: { ppg: 3.3, rpg: 1.4, apg: 0.4, spg: 0.1, bpg: 0.1, oreb: 0.2, dreb: 1.2, fgPct: 53.6, threePtPct: 44.9, ftPct: 66.7, plusMinus: 0.5, turnovers: 0.4 },
    vsOpponentStats: { ppg: 3.5, rpg: 1.5, apg: 0.5, spg: 0.2, bpg: 0.1, oreb: 0.2, dreb: 1.3, fgPct: 55.0, threePtPct: 46.0, ftPct: 70.0, plusMinus: 1.0, turnovers: 0.3 },
    advanced: { per: 11.0, ts: 62.0, usg: 9.0, ortg: 120.0, drtg: 113.0 },
    analysis: "Sharpshooter off the bench."
  },
  {
    id: "202066", name: "Garrett Temple", position: "SG", number: "17",
    seasonStats: { ppg: 0.3, rpg: 0.3, apg: 0.3, spg: 0.2, bpg: 0.1, oreb: 0.1, dreb: 0.2, fgPct: 14.3, threePtPct: 20.0, ftPct: 50.0, plusMinus: -0.5, turnovers: 0.2 },
    vsOpponentStats: { ppg: 0.5, rpg: 0.5, apg: 0.3, spg: 0.2, bpg: 0.1, oreb: 0.1, dreb: 0.4, fgPct: 15.0, threePtPct: 20.0, ftPct: 50.0, plusMinus: 0.0, turnovers: 0.2 },
    advanced: { per: 3.0, ts: 30.0, usg: 5.0, ortg: 90.0, drtg: 112.0 },
    analysis: "Veteran mentor and locker room leader."
  },
  // --- TWO-WAY PLAYERS ---
  {
    id: "1630639", name: "A.J. Lawson", position: "SG", number: "0",
    seasonStats: { ppg: 2.5, rpg: 1.2, apg: 0.5, spg: 0.3, bpg: 0.1, oreb: 0.2, dreb: 1.0, fgPct: 42.0, threePtPct: 30.0, ftPct: 75.0, plusMinus: -1.0, turnovers: 0.4 },
    vsOpponentStats: { ppg: 3.0, rpg: 1.5, apg: 0.6, spg: 0.4, bpg: 0.1, oreb: 0.3, dreb: 1.2, fgPct: 44.0, threePtPct: 32.0, ftPct: 77.0, plusMinus: -0.5, turnovers: 0.3 },
    advanced: { per: 6.0, ts: 48.0, usg: 8.0, ortg: 100.0, drtg: 113.0 },
    analysis: "Athletic two-way wing shuttling between NBA and G League."
  },
  {
    id: "1642918", name: "Alijah Martin", position: "SG", number: "55",
    seasonStats: { ppg: 2.0, rpg: 1.0, apg: 0.4, spg: 0.3, bpg: 0.1, oreb: 0.1, dreb: 0.9, fgPct: 40.0, threePtPct: 28.0, ftPct: 72.0, plusMinus: -1.5, turnovers: 0.3 },
    vsOpponentStats: { ppg: 2.5, rpg: 1.2, apg: 0.5, spg: 0.3, bpg: 0.1, oreb: 0.2, dreb: 1.0, fgPct: 42.0, threePtPct: 30.0, ftPct: 74.0, plusMinus: -1.0, turnovers: 0.3 },
    advanced: { per: 5.5, ts: 46.0, usg: 7.5, ortg: 98.0, drtg: 114.0 },
    analysis: "2025 second-round pick out of Florida. Developing guard with defensive energy."
  },
  {
    id: "1642935", name: "Chucky Hepburn", position: "PG", number: "24",
    seasonStats: { ppg: 1.8, rpg: 0.8, apg: 1.2, spg: 0.2, bpg: 0.0, oreb: 0.1, dreb: 0.7, fgPct: 38.0, threePtPct: 30.0, ftPct: 78.0, plusMinus: -1.2, turnovers: 0.5 },
    vsOpponentStats: { ppg: 2.0, rpg: 1.0, apg: 1.5, spg: 0.3, bpg: 0.0, oreb: 0.1, dreb: 0.9, fgPct: 40.0, threePtPct: 32.0, ftPct: 80.0, plusMinus: -0.8, turnovers: 0.4 },
    advanced: { per: 5.0, ts: 45.0, usg: 7.0, ortg: 96.0, drtg: 115.0 },
    analysis: "Two-way point guard developing his craft in the G League."
  },
  // --- TRADE DEADLINE ACQUISITIONS ---
  {
    id: "101108", name: "Chris Paul", position: "PG", number: "3",
    seasonStats: { ppg: 2.9, rpg: 1.8, apg: 3.3, spg: 0.6, bpg: 0.0, oreb: 0.2, dreb: 1.6, fgPct: 37.5, threePtPct: 30.0, ftPct: 75.0, plusMinus: -1.5, turnovers: 1.0 },
    vsOpponentStats: { ppg: 3.2, rpg: 2.0, apg: 3.5, spg: 0.7, bpg: 0.0, oreb: 0.2, dreb: 1.8, fgPct: 39.0, threePtPct: 32.0, ftPct: 77.0, plusMinus: -1.0, turnovers: 0.9 },
    advanced: { per: 8.5, ts: 45.0, usg: 14.0, ortg: 100.0, drtg: 112.0 },
    analysis: "Acquired from Clippers at trade deadline. Future Hall of Famer providing veteran leadership."
  }
];

// Eastern Conference Standings
// Team ID mapping
const TEAM_IDS = {
  "Atlanta Hawks": { abbr: "ATL", id: "1610612737" },
  "Boston Celtics": { abbr: "BOS", id: "1610612738" },
  "Brooklyn Nets": { abbr: "BKN", id: "1610612751" },
  "Charlotte Hornets": { abbr: "CHA", id: "1610612766" },
  "Chicago Bulls": { abbr: "CHI", id: "1610612741" },
  "Cleveland Cavaliers": { abbr: "CLE", id: "1610612739" },
  "Detroit Pistons": { abbr: "DET", id: "1610612765" },
  "Indiana Pacers": { abbr: "IND", id: "1610612754" },
  "Miami Heat": { abbr: "MIA", id: "1610612748" },
  "Milwaukee Bucks": { abbr: "MIL", id: "1610612749" },
  "New York Knicks": { abbr: "NYK", id: "1610612752" },
  "Orlando Magic": { abbr: "ORL", id: "1610612753" },
  "Philadelphia 76ers": { abbr: "PHI", id: "1610612755" },
  "Toronto Raptors": { abbr: "TOR", id: "1610612761" },
  "Washington Wizards": { abbr: "WAS", id: "1610612764" },
};

// Fallback standings (updated Feb 9, 2026)
const FALLBACK_STANDINGS_EAST = [
  { rank: 1, team: "Pistons", abbr: "DET", id: "1610612765", wins: 38, losses: 13, gb: "-", l10: "7-3" },
  { rank: 2, team: "Knicks", abbr: "NYK", id: "1610612752", wins: 34, losses: 19, gb: "5", l10: "9-1" },
  { rank: 3, team: "Celtics", abbr: "BOS", id: "1610612738", wins: 34, losses: 19, gb: "5", l10: "7-3" },
  { rank: 4, team: "Raptors", abbr: "TOR", id: "1610612761", wins: 32, losses: 22, gb: "7.5", l10: "7-3", highlight: true },
  { rank: 5, team: "Cavaliers", abbr: "CLE", id: "1610612739", wins: 32, losses: 21, gb: "7", l10: "8-2" },
  { rank: 6, team: "76ers", abbr: "PHI", id: "1610612755", wins: 30, losses: 22, gb: "8.5", l10: "7-3" },
  { rank: 7, team: "Heat", abbr: "MIA", id: "1610612748", wins: 28, losses: 26, gb: "11.5", l10: "5-5" },
  { rank: 8, team: "Magic", abbr: "ORL", id: "1610612753", wins: 27, losses: 24, gb: "11", l10: "4-6" },
  { rank: 9, team: "Hawks", abbr: "ATL", id: "1610612737", wins: 26, losses: 28, gb: "13.5", l10: "6-4" },
  { rank: 10, team: "Hornets", abbr: "CHA", id: "1610612766", wins: 25, losses: 28, gb: "14", l10: "9-1" },
  { rank: 11, team: "Bulls", abbr: "CHI", id: "1610612741", wins: 24, losses: 29, gb: "15", l10: "3-7" },
  { rank: 12, team: "Bucks", abbr: "MIL", id: "1610612749", wins: 21, losses: 29, gb: "16.5", l10: "4-6" },
  { rank: 13, team: "Nets", abbr: "BKN", id: "1610612751", wins: 14, losses: 37, gb: "24", l10: "2-8" },
  { rank: 14, team: "Wizards", abbr: "WAS", id: "1610612764", wins: 14, losses: 38, gb: "24.5", l10: "4-6" },
  { rank: 15, team: "Pacers", abbr: "IND", id: "1610612754", wins: 13, losses: 40, gb: "26", l10: "3-7" },
];

// ESPN API cache
const _espnCache = {};
const espnFetch = async (url, cacheKey, ttlMs = 300000) => {
  if (_espnCache[cacheKey] && (Date.now() - _espnCache[cacheKey].ts < ttlMs)) {
    return _espnCache[cacheKey].data;
  }
  const controller = new AbortController();
  const timeout = setTimeout(() => controller.abort(), 8000);
  try {
    const res = await fetch(url, { signal: controller.signal });
    clearTimeout(timeout);
    if (!res.ok) throw new Error(res.status);
    const data = await res.json();
    _espnCache[cacheKey] = { data, ts: Date.now() };
    return data;
  } catch (e) {
    clearTimeout(timeout);
    throw e;
  }
};

// ESPN team ID to NBA CDN ID mapping
const ESPN_TO_NBA_ID = {
  1: "1610612737", 2: "1610612738", 17: "1610612751", 30: "1610612766",
  4: "1610612741", 5: "1610612739", 8: "1610612765", 11: "1610612754",
  14: "1610612748", 15: "1610612749", 18: "1610612752", 19: "1610612753",
  20: "1610612755", 28: "1610612761", 27: "1610612764", 21: "1610612756",
  9: "1610612744", 13: "1610612747", 7: "1610612743", 25: "1610612760",
  6: "1610612742", 10: "1610612745", 16: "1610612750", 22: "1610612757",
  23: "1610612758", 24: "1610612759", 26: "1610612762", 12: "1610612754",
  3: "1610612740", 29: "1610612763"
};

// Fetch live standings from ESPN API
const fetchLiveStandings = async () => {
  try {
    const data = await espnFetch(
      'https://site.api.espn.com/apis/v2/sports/basketball/nba/standings',
      'standings',
      300000
    );
    const eastChildren = data.children?.find(c => c.name === 'Eastern Conference' || c.abbreviation === 'East');
    if (!eastChildren) throw new Error('No East data');
    const entries = eastChildren.standings?.entries || [];
    const parsed = entries.map((entry, i) => {
      const team = entry.team || {};
      const stats = {};
      (entry.stats || []).forEach(s => { stats[s.name] = s.displayValue || s.value; });
      const espnId = parseInt(team.id);
      const nbaId = ESPN_TO_NBA_ID[espnId] || team.id;
      const abbr = team.abbreviation || '';
      return {
        rank: i + 1,
        team: team.shortDisplayName || team.displayName || '',
        abbr,
        id: nbaId,
        wins: parseInt(stats.wins) || 0,
        losses: parseInt(stats.losses) || 0,
        pct: stats.winPercent || stats.winPct || '',
        gb: stats.gamesBehind === '0' || stats.gamesBehind === '-' ? '-' : (stats.gamesBehind || '-'),
        l10: stats.record || '',
        streak: stats.streak || '',
        highlight: abbr === 'TOR'
      };
    });
    // Sort by rank/wins
    parsed.sort((a, b) => b.wins - a.wins || a.losses - b.losses);
    parsed.forEach((t, i) => t.rank = i + 1);
    return parsed;
  } catch (e) {
    console.log('ESPN standings fetch failed, using fallback:', e.message);
  }
  return FALLBACK_STANDINGS_EAST;
};

// useLiveStandings hook
const useLiveStandings = () => {
  const [standings, setStandings] = useState(FALLBACK_STANDINGS_EAST);
  const [loading, setLoading] = useState(true);
  const [lastUpdated, setLastUpdated] = useState(null);
  const [raptorsRecord, setRaptorsRecord] = useState(null);

  useEffect(() => {
    let mounted = true;
    const load = async () => {
      setLoading(true);
      const data = await fetchLiveStandings();
      if (!mounted) return;
      setStandings(data);
      setLastUpdated(new Date());
      setLoading(false);
      const tor = data.find(t => t.abbr === 'TOR');
      if (tor) setRaptorsRecord({ wins: tor.wins, losses: tor.losses, pct: tor.pct, rank: tor.rank });
    };
    load();
    const interval = setInterval(load, 5 * 60 * 1000);
    return () => { mounted = false; clearInterval(interval); };
  }, []);

  return { standings, loading, lastUpdated, raptorsRecord };
};

// Fetch live scoreboard from ESPN
const fetchLiveScoreboard = async () => {
  try {
    const data = await espnFetch(
      'https://site.api.espn.com/apis/site/v2/sports/basketball/nba/scoreboard',
      'scoreboard',
      60000
    );
    const events = data.events || [];
    return events.map(ev => {
      const comp = ev.competitions?.[0] || {};
      const competitors = comp.competitors || [];
      const home = competitors.find(c => c.homeAway === 'home') || competitors[0] || {};
      const away = competitors.find(c => c.homeAway === 'away') || competitors[1] || {};
      const status = comp.status || ev.status || {};
      const statusType = status.type || {};
      let displayStatus;
      if (statusType.completed) {
        displayStatus = 'Final';
      } else if (statusType.state === 'in') {
        displayStatus = status.displayClock ? `${status.period ? 'Q' + status.period + ' ' : ''}${status.displayClock}` : 'Live';
      } else {
        const dt = new Date(ev.date || comp.date);
        displayStatus = dt.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit' });
      }
      const homeTeam = home.team || {};
      const awayTeam = away.team || {};
      const homeEspnId = parseInt(homeTeam.id);
      const awayEspnId = parseInt(awayTeam.id);
      const isRaptors = homeTeam.abbreviation === 'TOR' || awayTeam.abbreviation === 'TOR';
      return {
        home: homeTeam.abbreviation || '',
        away: awayTeam.abbreviation || '',
        homeScore: parseInt(home.score) || 0,
        awayScore: parseInt(away.score) || 0,
        status: displayStatus,
        homeId: ESPN_TO_NBA_ID[homeEspnId] || homeTeam.id,
        awayId: ESPN_TO_NBA_ID[awayEspnId] || awayTeam.id,
        isLive: statusType.state === 'in',
        isFinal: !!statusType.completed,
        isRaptors
      };
    });
  } catch (e) {
    console.log('ESPN scoreboard fetch failed:', e.message);
    return null;
  }
};

// Fallback West standings (updated Feb 9, 2026)
const FALLBACK_STANDINGS_WEST = [
  { rank: 1, team: "Thunder", abbr: "OKC", id: "1610612760", wins: 39, losses: 12, gb: "-", l10: "8-2" },
  { rank: 2, team: "Rockets", abbr: "HOU", id: "1610612745", wins: 34, losses: 18, gb: "5.5", l10: "7-3" },
  { rank: 3, team: "Grizzlies", abbr: "MEM", id: "1610612763", wins: 33, losses: 19, gb: "6.5", l10: "6-4" },
  { rank: 4, team: "Lakers", abbr: "LAL", id: "1610612747", wins: 31, losses: 21, gb: "8.5", l10: "5-5" },
  { rank: 5, team: "Nuggets", abbr: "DEN", id: "1610612743", wins: 30, losses: 22, gb: "9.5", l10: "6-4" },
  { rank: 6, team: "Mavericks", abbr: "DAL", id: "1610612742", wins: 29, losses: 23, gb: "10.5", l10: "5-5" },
  { rank: 7, team: "Timberwolves", abbr: "MIN", id: "1610612750", wins: 28, losses: 24, gb: "11.5", l10: "4-6" },
  { rank: 8, team: "Clippers", abbr: "LAC", id: "1610612746", wins: 27, losses: 25, gb: "12.5", l10: "5-5" },
  { rank: 9, team: "Kings", abbr: "SAC", id: "1610612758", wins: 26, losses: 26, gb: "13.5", l10: "6-4" },
  { rank: 10, team: "Warriors", abbr: "GSW", id: "1610612744", wins: 25, losses: 27, gb: "14.5", l10: "4-6" },
  { rank: 11, team: "Spurs", abbr: "SAS", id: "1610612759", wins: 24, losses: 28, gb: "15.5", l10: "5-5" },
  { rank: 12, team: "Suns", abbr: "PHX", id: "1610612756", wins: 23, losses: 29, gb: "16.5", l10: "3-7" },
  { rank: 13, team: "Trail Blazers", abbr: "POR", id: "1610612757", wins: 18, losses: 34, gb: "21.5", l10: "3-7" },
  { rank: 14, team: "Jazz", abbr: "UTA", id: "1610612762", wins: 14, losses: 37, gb: "25", l10: "2-8" },
  { rank: 15, team: "Pelicans", abbr: "NOP", id: "1610612740", wins: 12, losses: 40, gb: "27.5", l10: "2-8" },
];

// Fetch West standings from ESPN API  
const fetchWestStandings = async () => {
  try {
    const data = await espnFetch(
      'https://site.api.espn.com/apis/v2/sports/basketball/nba/standings',
      'standings_full',
      300000
    );
    const westChildren = data.children?.find(c => c.name === 'Western Conference' || c.abbreviation === 'West');
    if (!westChildren) throw new Error('No West data');
    const entries = westChildren.standings?.entries || [];
    const parsed = entries.map((entry, i) => {
      const team = entry.team || {};
      const stats = {};
      (entry.stats || []).forEach(s => { stats[s.name] = s.displayValue || s.value; });
      const espnId = parseInt(team.id);
      const nbaId = ESPN_TO_NBA_ID[espnId] || team.id;
      return {
        rank: i + 1,
        team: team.shortDisplayName || team.displayName || '',
        abbr: team.abbreviation || '',
        id: nbaId,
        wins: parseInt(stats.wins) || 0,
        losses: parseInt(stats.losses) || 0,
        gb: stats.gamesBehind === '0' || stats.gamesBehind === '-' ? '-' : (stats.gamesBehind || '-'),
        l10: stats.record || '',
      };
    });
    parsed.sort((a, b) => b.wins - a.wins || a.losses - b.losses);
    parsed.forEach((t, i) => t.rank = i + 1);
    return parsed;
  } catch (e) {
    return FALLBACK_STANDINGS_WEST;
  }
};

// Enhanced scoreboard fetch with quarter scores for live Raptors games
const fetchEnhancedScoreboard = async () => {
  try {
    const data = await espnFetch(
      'https://site.api.espn.com/apis/site/v2/sports/basketball/nba/scoreboard',
      'scoreboard_enhanced',
      30000
    );
    const events = data.events || [];
    for (const ev of events) {
      const comp = ev.competitions?.[0] || {};
      const competitors = comp.competitors || [];
      const home = competitors.find(c => c.homeAway === 'home') || {};
      const away = competitors.find(c => c.homeAway === 'away') || {};
      const homeTeam = home.team || {};
      const awayTeam = away.team || {};
      const isRaptors = homeTeam.abbreviation === 'TOR' || awayTeam.abbreviation === 'TOR';
      const status = comp.status || ev.status || {};
      const statusType = status.type || {};
      if (isRaptors && statusType.state === 'in') {
        const homeLinescores = (home.linescores || []).map(q => q.value || 0);
        const awayLinescores = (away.linescores || []).map(q => q.value || 0);
        return {
          live: true,
          home: homeTeam.abbreviation,
          away: awayTeam.abbreviation,
          homeScore: parseInt(home.score) || 0,
          awayScore: parseInt(away.score) || 0,
          period: status.period || 1,
          clock: status.displayClock || '',
          homeQuarters: homeLinescores,
          awayQuarters: awayLinescores,
          homeLogo: homeTeam.id,
          awayLogo: awayTeam.id,
          homeId: ESPN_TO_NBA_ID[parseInt(homeTeam.id)] || homeTeam.id,
          awayId: ESPN_TO_NBA_ID[parseInt(awayTeam.id)] || awayTeam.id,
        };
      }
    }
    return { live: false };
  } catch (e) {
    return { live: false };
  }
};

// Awards Watch data
const AWARDS_WATCH = [
  { category: 'MIP', emoji: 'ðŸ“ˆ', players: [{ name: 'Scottie Barnes', note: 'In the conversation â€” career-best numbers across the board', team: 'TOR', highlight: true }] },
  { category: 'All-Star', emoji: 'â­', players: [{ name: 'Scottie Barnes', note: 'Selected as 2026 All-Star starter', team: 'TOR', highlight: true }, { name: 'RJ Barrett', note: 'Borderline candidate â€” strong second-half push', team: 'TOR', highlight: true }] },
  { category: 'MVP', emoji: 'ðŸ†', players: [{ name: 'Scottie Barnes', note: 'Outside top-10 but making noise', team: 'TOR', highlight: true }] },
  { category: 'DPOY', emoji: 'ðŸ›¡ï¸', players: [{ name: 'Jakob Poeltl', note: 'Anchoring a top-10 defense â€” in the conversation', team: 'TOR', highlight: true }] },
  { category: '6MOY', emoji: 'ðŸ’ª', players: [{ name: 'Chris Boucher', note: 'Consistent spark off the bench', team: 'TOR', highlight: true }] },
  { category: 'ROY', emoji: 'ðŸŒŸ', players: [{ name: 'No Raptors rookies in the race this season', note: '', team: '', highlight: false }] },
];

// Raptors Team Stats (will be updated from standings)
// Raptors Team Stats (Feb 2026 - post All-Star)
const RAPTORS_STATS = { wins: 32, losses: 22, ppg: 114.8, oppPpg: 112.6, streak: "W3", lastUpdate: "Feb 9, 2026", rpg: 44.2, apg: 26.8, fgPct: 47.5, threePtPct: 36.2 };

// ============================================================
// DRAFT INTELLIGENCE DATA
// ============================================================
const DRAFT_DATA = {
  raptorsRecord: { wins: 32, losses: 22, pct: '.593', projectedSeed: 21 },
  lotteryOdds: [
    { seed: 1, first: 14.0, top4: 52.1 },
    { seed: 2, first: 14.0, top4: 52.1 },
    { seed: 3, first: 14.0, top4: 52.1 },
    { seed: 4, first: 12.5, top4: 47.9 },
    { seed: 5, first: 10.5, top4: 42.1 },
    { seed: 6, first: 9.0, top4: 37.2 },
    { seed: 7, first: 7.5, top4: 31.9 },
    { seed: 8, first: 6.0, top4: 26.1 },
    { seed: 9, first: 4.5, top4: 20.3 },
    { seed: 10, first: 3.0, top4: 14.0 },
    { seed: 11, first: 2.0, top4: 9.6 },
    { seed: 12, first: 1.5, top4: 7.2 },
    { seed: 13, first: 1.0, top4: 4.8 },
    { seed: 14, first: 0.5, top4: 2.4 },
  ],
  prospects: [
    { name: "Darryn Peterson", school: "Kansas", position: "SG", projected: "1-3", stats: "26.6 PPG, 5.4 RPG, 2.2 APG", comparison: "Kobe Bryant", emoji: "ðŸ”¥" },
    { name: "Cameron Boozer", school: "Duke", position: "PF", projected: "1-3", stats: "25.7 PPG, 11.0 RPG, 4.4 APG", comparison: "Al Horford / Kevin Love", emoji: "ðŸ’ª" },
    { name: "AJ Dybantsa", school: "BYU", position: "SF", projected: "1-4", stats: "26.7 PPG, 7.0 RPG, 3.9 APG", comparison: "Tracy McGrady", emoji: "âš¡" },
    { name: "Kingston Flemings", school: "Houston", position: "PG", projected: "3-6", stats: "19.8 PPG, 4.0 RPG, 6.3 APG", comparison: "De'Aaron Fox", emoji: "ðŸ’¨" },
    { name: "Caleb Wilson", school: "North Carolina", position: "PF/SF", projected: "3-6", stats: "23.0 PPG, 10.9 RPG, 3.2 APG", comparison: "Kevin Garnett", emoji: "ðŸŽ¯" },
    { name: "Keaton Wagler", school: "Illinois", position: "SG", projected: "5-8", stats: "19.7 PPG, 5.6 RPG, 4.7 APG", comparison: "SGA (lite)", emoji: "ðŸŽ¯" },
    { name: "Nate Ament", school: "Tennessee", position: "SF/PF", projected: "6-10", stats: "21.2 PPG, 7.8 RPG, 3.0 APG", comparison: "Alexandre Sarr", emoji: "ðŸ€" },
    { name: "Braylon Mullins", school: "UConn", position: "SG", projected: "7-12", stats: "16.1 PPG, 4.5 RPG, 1.9 APG", comparison: "Klay Thompson", emoji: "ðŸ”¥" },
    { name: "Labaron Philon", school: "Alabama", position: "PG", projected: "8-12", stats: "25.9 PPG, 4.3 RPG, 5.9 APG", comparison: "Tyrese Maxey", emoji: "âš¡" },
    { name: "Koa Peat", school: "Arizona", position: "SF", projected: "10-15", stats: "19.1 PPG, 7.3 RPG, 3.4 APG", comparison: "Jarace Walker+", emoji: "ðŸ›¡ï¸" },
  ],
  tankWatch: [
    { team: "SAC", wins: 14, losses: 40, pct: '.259', lotteryPos: 1 },
    { team: "IND", wins: 16, losses: 39, pct: '.291', lotteryPos: 2 },
    { team: "NOP", wins: 17, losses: 38, pct: '.309', lotteryPos: 3 },
    { team: "WAS", wins: 18, losses: 38, pct: '.321', lotteryPos: 4 },
    { team: "BKN", wins: 19, losses: 37, pct: '.339', lotteryPos: 5 },
    { team: "UTA", wins: 19, losses: 37, pct: '.339', lotteryPos: 6 },
    { team: "POR", wins: 20, losses: 36, pct: '.357', lotteryPos: 7 },
    { team: "CHI", wins: 21, losses: 35, pct: '.375', lotteryPos: 8 },
  ]
};

// ============================================================
// INJURY REPORT DATA
// ============================================================
const INJURY_DATA = [
  { player: "Jakob Poeltl", status: "Out", injury: "Back", returnDate: "TBD", gamesOut: 1, ppg: 14.2, mpg: 30.5, impact: 8.5 },
  { player: "Collin Murray-Boyles", status: "Questionable", injury: "Left thumb (aggravated vs Pacers)", returnDate: "Feb 11, 2026", gamesOut: 0, ppg: 8.6, mpg: 22.0, impact: 6.0 },
];

// ============================================================
// PLAYER LAST 5 GAMES SAMPLE DATA
// ============================================================
const PLAYER_LAST_5_GAMES = {
  "Scottie Barnes": [
    { date: "Jan 27", opp: "MIA", pts: 28, reb: 10, ast: 7, fgm: 11, fga: 19, min: 38, result: "W" },
    { date: "Jan 25", opp: "NYK", pts: 22, reb: 8, ast: 5, fgm: 9, fga: 20, min: 36, result: "L" },
    { date: "Jan 23", opp: "CHI", pts: 18, reb: 12, ast: 8, fgm: 7, fga: 16, min: 34, result: "W" },
    { date: "Jan 21", opp: "CLE", pts: 25, reb: 7, ast: 4, fgm: 10, fga: 18, min: 37, result: "W" },
    { date: "Jan 19", opp: "BOS", pts: 15, reb: 9, ast: 6, fgm: 6, fga: 17, min: 35, result: "L" },
  ],
  "RJ Barrett": [
    { date: "Feb 8", opp: "IND", pts: 24, reb: 6, ast: 4, fgm: 10, fga: 21, min: 36, result: "W" },
    { date: "Feb 6", opp: "DET", pts: 20, reb: 5, ast: 3, fgm: 8, fga: 18, min: 34, result: "W" },
    { date: "Feb 4", opp: "ATL", pts: 16, reb: 7, ast: 5, fgm: 6, fga: 15, min: 33, result: "W" },
    { date: "Feb 2", opp: "ORL", pts: 22, reb: 4, ast: 2, fgm: 9, fga: 19, min: 35, result: "L" },
    { date: "Jan 31", opp: "MIL", pts: 18, reb: 6, ast: 4, fgm: 7, fga: 16, min: 32, result: "L" },
  ],
  "Immanuel Quickley": [
    { date: "Feb 6", opp: "DET", pts: 22, reb: 3, ast: 8, fgm: 8, fga: 17, min: 34, result: "W" },
    { date: "Feb 4", opp: "ATL", pts: 18, reb: 5, ast: 7, fgm: 7, fga: 16, min: 33, result: "W" },
    { date: "Feb 2", opp: "ORL", pts: 14, reb: 4, ast: 5, fgm: 5, fga: 14, min: 30, result: "L" },
    { date: "Jan 31", opp: "MIL", pts: 20, reb: 6, ast: 9, fgm: 8, fga: 18, min: 36, result: "L" },
    { date: "Jan 29", opp: "BKN", pts: 25, reb: 3, ast: 6, fgm: 10, fga: 20, min: 35, result: "W" },
  ],
  "Jakob Poeltl": [
    { date: "Feb 8", opp: "IND", pts: 14, reb: 12, ast: 3, fgm: 7, fga: 9, min: 32, result: "W" },
    { date: "Feb 6", opp: "DET", pts: 10, reb: 8, ast: 2, fgm: 5, fga: 7, min: 28, result: "W" },
    { date: "Feb 4", opp: "ATL", pts: 8, reb: 10, ast: 1, fgm: 4, fga: 6, min: 30, result: "W" },
    { date: "Feb 2", opp: "ORL", pts: 12, reb: 14, ast: 3, fgm: 6, fga: 8, min: 34, result: "L" },
    { date: "Jan 31", opp: "MIL", pts: 6, reb: 9, ast: 2, fgm: 3, fga: 5, min: 26, result: "L" },
  ],
};

const RAPTORS_NEWS = [
  { id: 1, headline: "CP3 Brings Veteran Leadership After Trade from Clippers", source: "TSN", timeAgo: "3d ago", category: "Trade Rumor" },
  { id: 2, headline: "Poeltl Out with Back Injury â€” Timeline Uncertain", source: "Sportsnet", timeAgo: "1d ago", category: "Injury" },
  { id: 3, headline: "Raptors Host Pistons Tuesday in Key Playoff Positioning Game", source: "NBA.com", timeAgo: "6h ago", category: "Recap" },
  { id: 4, headline: "Barnes All-Star Selection Cements His Rise as Franchise Cornerstone", source: "The Athletic", timeAgo: "5d ago", category: "Award" },
  { id: 5, headline: "Trayce Jackson-Davis Acquired from Warriors at Deadline", source: "ESPN", timeAgo: "3d ago", category: "Trade Rumor" },
  { id: 6, headline: "Murray-Boyles Game-to-Game with Thumb Issue", source: "Raptors Republic", timeAgo: "1d ago", category: "Injury" },
];

const OPPONENT_DATA = {
  "Pistons": {
    id: "1610612765",
    roster: [
       { id: "1630595", name: "Cade Cunningham", position: "G", number: "2", seasonStats: { ppg: 24.2, rpg: 6.8, apg: 9.3 } },
       { id: "1630217", name: "Jaden Ivey", position: "G", number: "23", seasonStats: { ppg: 17.8, rpg: 3.5, apg: 4.2 } },
       { id: "1631105", name: "Jalen Duren", position: "C", number: "0", seasonStats: { ppg: 10.5, rpg: 10.8, apg: 2.1 } },
       { id: "1631223", name: "Ausar Thompson", position: "F", number: "9", seasonStats: { ppg: 8.2, rpg: 5.5, apg: 2.0 } },
       { id: "203082", name: "Tobias Harris", position: "F", number: "12", seasonStats: { ppg: 11.8, rpg: 5.2, apg: 2.5 } },
       { id: "1628381", name: "Malik Beasley", position: "G", number: "5", seasonStats: { ppg: 12.4, rpg: 2.8, apg: 1.5 } },
       { id: "203501", name: "Tim Hardaway Jr.", position: "G", number: "10", seasonStats: { ppg: 10.5, rpg: 2.2, apg: 1.8 } },
       { id: "1631326", name: "Ron Holland", position: "F", number: "7", seasonStats: { ppg: 6.5, rpg: 3.2, apg: 1.2 } }
    ],
    injuries: [
      { name: "Ausar Thompson", status: "OUT", reason: "Blood clot", updated: "Feb 9" }
    ],
    tendencies: ["Young Core Development", "Transition Offense", "Rim Protection"],
    playbook: [
      { id: "p1", name: "Cade PnR", type: "offense", description: "Cunningham pick and roll.", diagramType: "pnr", execution: ["Cade initiates at top", "Duren sets screen", "Roll or pop based on coverage"], raptorsCounter: "Blitz Cunningham, rotate quick." },
      { id: "p2", name: "Ivey Push", type: "offense", description: "Transition attack.", diagramType: "iso", execution: ["Ivey gets outlet", "Pushes in transition", "Attacks before D sets"], raptorsCounter: "Get back, contain the ball." }
    ]
  },
  "Pacers": {
    id: "1610612754",
    roster: [
       { id: "1629029", name: "Tyrese Haliburton", position: "G", number: "0", seasonStats: { ppg: 18.5, rpg: 4.0, apg: 9.8 } },
       { id: "1628988", name: "Pascal Siakam", position: "F", number: "43", seasonStats: { ppg: 19.8, rpg: 7.2, apg: 3.8 } },
       { id: "1631114", name: "Bennedict Mathurin", position: "G", number: "00", seasonStats: { ppg: 16.2, rpg: 4.2, apg: 2.5 } },
       { id: "203490", name: "Myles Turner", position: "C", number: "33", seasonStats: { ppg: 15.8, rpg: 6.8, apg: 1.5, bpg: 2.2 } },
       { id: "1629303", name: "Andrew Nembhard", position: "G", number: "2", seasonStats: { ppg: 10.5, rpg: 3.2, apg: 5.5 } },
       { id: "1627763", name: "T.J. McConnell", position: "G", number: "9", seasonStats: { ppg: 8.2, rpg: 2.5, apg: 4.8 } },
       { id: "1627734", name: "Obi Toppin", position: "F", number: "1", seasonStats: { ppg: 11.5, rpg: 4.5, apg: 1.8 } },
       { id: "1629659", name: "Aaron Nesmith", position: "F", number: "23", seasonStats: { ppg: 9.8, rpg: 3.8, apg: 1.2 } }
    ],
    injuries: [
      { name: "James Wiseman", status: "OUT", reason: "Achilles", updated: "Feb 8" }
    ],
    tendencies: ["Fast Pace", "Ball Movement", "3PT Shooting"],
    playbook: [
      { id: "p1", name: "Hali PnR", type: "offense", description: "Haliburton pick and roll action.", diagramType: "pnr", execution: ["Haliburton at top", "Turner or Siakam screens", "Lob threat or kick"], raptorsCounter: "ICE the screen, drop coverage." },
      { id: "p2", name: "Siakam Post", type: "offense", description: "Siakam post-up.", diagramType: "iso", execution: ["Entry to block", "Siakam spins baseline", "Kick to corner on double"], raptorsCounter: "Front the post, dig on catch." }
    ]
  },
  "Bulls": {
    id: "1610612741",
    roster: [
       { id: "1627853", name: "Zach LaVine", position: "G", number: "8", seasonStats: { ppg: 22.5, rpg: 4.2, apg: 4.0 } },
       { id: "1628374", name: "Coby White", position: "G", number: "0", seasonStats: { ppg: 18.5, rpg: 3.8, apg: 5.2 } },
       { id: "1630533", name: "Josh Giddey", position: "G", number: "3", seasonStats: { ppg: 12.8, rpg: 6.2, apg: 5.8 } },
       { id: "203897", name: "Nikola Vucevic", position: "C", number: "9", seasonStats: { ppg: 18.2, rpg: 10.5, apg: 3.2 } },
       { id: "1628990", name: "Patrick Williams", position: "F", number: "44", seasonStats: { ppg: 10.8, rpg: 4.5, apg: 2.2 } },
       { id: "1630173", name: "Ayo Dosunmu", position: "G", number: "12", seasonStats: { ppg: 8.5, rpg: 3.2, apg: 3.5 } },
       { id: "1631210", name: "Matas Buzelis", position: "F", number: "25", seasonStats: { ppg: 7.2, rpg: 3.8, apg: 1.5 } },
       { id: "1629655", name: "Talen Horton-Tucker", position: "G", number: "2", seasonStats: { ppg: 6.5, rpg: 2.5, apg: 2.8 } }
    ],
    injuries: [
      { name: "Lonzo Ball", status: "OUT", reason: "Knee", updated: "Feb 5" },
      { name: "Patrick Williams", status: "GTD", reason: "Ankle", updated: "Feb 9" }
    ],
    tendencies: ["Mid-Range Scoring", "Vucevic Post-Ups", "Transition Attack"],
    playbook: [
      { id: "p1", name: "Vooch High-Low", type: "offense", description: "Vucevic post action.", diagramType: "horns", execution: ["Entry to Vooch at elbow", "High-low with cutter", "Face-up jumper option"], raptorsCounter: "Push Vooch off the block." },
      { id: "p2", name: "LaVine Iso", type: "offense", description: "LaVine isolation.", diagramType: "iso", execution: ["Clear side", "LaVine attacks from wing", "Step-back option"], raptorsCounter: "Force left, contest the step-back." }
    ]
  },
  "Timberwolves": {
    id: "1610612750",
    roster: [
       { id: "1630162", name: "Anthony Edwards", position: "G", number: "5", seasonStats: { ppg: 28.1, rpg: 5.8, apg: 5.2 } },
       { id: "203944", name: "Julius Randle", position: "F", number: "30", seasonStats: { ppg: 21.6, rpg: 9.4, apg: 4.8 } },
       { id: "203497", name: "Rudy Gobert", position: "C", number: "27", seasonStats: { ppg: 10.9, rpg: 12.5, apg: 1.2, bpg: 2.1 } },
       { id: "1630183", name: "Jaden McDaniels", position: "F", number: "3", seasonStats: { ppg: 10.2, rpg: 3.5, apg: 1.4 } },
       { id: "201144", name: "Mike Conley", position: "G", number: "10", seasonStats: { ppg: 8.5, rpg: 2.8, apg: 6.2 } },
       { id: "1629675", name: "Naz Reid", position: "C-F", number: "11", seasonStats: { ppg: 13.8, rpg: 5.5, apg: 1.5 } },
       { id: "1628978", name: "Donte DiVincenzo", position: "G", number: "0", seasonStats: { ppg: 9.8, rpg: 3.4, apg: 3.1 } },
       { id: "1629638", name: "Nickeil Alexander-Walker", position: "G", number: "9", seasonStats: { ppg: 9.2, rpg: 2.2, apg: 2.5 } },
       { id: "1642265", name: "Rob Dillingham", position: "G", number: "4", seasonStats: { ppg: 6.2, rpg: 1.2, apg: 2.8 } },
       { id: "1630593", name: "Joe Ingles", position: "F", number: "7", seasonStats: { ppg: 3.2, rpg: 1.5, apg: 2.1 } },
       { id: "1631168", name: "Josh Minott", position: "F", number: "8", seasonStats: { ppg: 4.5, rpg: 2.1, apg: 0.8 } },
       { id: "1630233", name: "Luka Garza", position: "C", number: "55", seasonStats: { ppg: 3.8, rpg: 2.0, apg: 0.2 } },
       { id: "1641738", name: "Terrence Shannon Jr.", position: "G", number: "00", seasonStats: { ppg: 5.1, rpg: 1.8, apg: 0.9 } },
       { id: "1631169", name: "Leonard Miller", position: "F", number: "33", seasonStats: { ppg: 3.5, rpg: 2.5, apg: 0.5 } },
       { id: "1628416", name: "PJ Dozier", position: "G-F", number: "35", seasonStats: { ppg: 4.0, rpg: 2.0, apg: 1.0 } },
       { id: "1628966", name: "Keita Bates-Diop", position: "F", number: "31", seasonStats: { ppg: 2.5, rpg: 1.5, apg: 0.5 } }
    ],
    tendencies: ["Elite Rim Protection", "Explosive Scoring", "Physical Defense"],
    playbook: [
      { id: "p1", name: "Ant Iso", type: "offense", description: "Edwards isolation from top.", diagramType: "iso", execution: ["Clear out side", "Edwards attacks downhill", "Kick out if help comes"], raptorsCounter: "Gap help, wall up at rim." },
      { id: "p2", name: "Double Drag", type: "offense", description: "Gobert/Randle screen for Ant.", diagramType: "pnr", execution: ["Conley/Ant ball handler", "Two bigs set high screens", "One rolls, one pops"], raptorsCounter: "Navigate screens, drop big." },
      { id: "p3", name: "Horns Twist", type: "offense", description: "Complex screen action for shooters.", diagramType: "horns", execution: ["Bigs at elbows", "First screen for ball", "Second screen for first big"], raptorsCounter: "Switch the twist action." },
      { id: "p4", name: "Spain PnR", type: "offense", description: "Stack pick and roll.", diagramType: "pnr", execution: ["High ball screen", "Shooter back screens the roller's man", "Shooter pops"], raptorsCounter: "Communication is key, switch low." },
      { id: "p5", name: "Exit Screen", type: "offense", description: "Corner shooter action.", diagramType: "zone", execution: ["Drive baseline", "Screen for corner man", "Drift to wing"], raptorsCounter: "Stay attached to corner." }
    ]
  },
  "Pelicans": {
    id: "1610612740",
    roster: [
       { id: "1629627", name: "Zion Williamson", position: "F", number: "1" },
       { id: "1627742", name: "Brandon Ingram", position: "F", number: "14" },
       { id: "203468", name: "CJ McCollum", position: "G", number: "3" },
       { id: "1627749", name: "Dejounte Murray", position: "G", number: "5" },
       { id: "1630529", name: "Herbert Jones", position: "F", number: "5" },
       { id: "1630530", name: "Trey Murphy III", position: "F", number: "25" },
       { id: "1630221", name: "Jose Alvarado", position: "G", number: "15" },
       { id: "1631103", name: "Yves Missi", position: "C", number: "21" }
    ],
    tendencies: ["Paint Dominance", "Length on Defense", "Mid-Range Scoring"],
    playbook: [
      { id: "p1", name: "Zion Point", type: "offense", description: "Zion initiates from top of key.", diagramType: "iso", execution: ["Zion brings ball up", "Shooters space corners", "Zion attacks downhill"], raptorsCounter: "Build a wall, force kickouts." },
      { id: "p2", name: "Elbow Split", type: "offense", description: "Ingram post action.", diagramType: "horns", execution: ["Entry to elbow", "Guard cuts off", "Hand off option"], raptorsCounter: "Deny the entry pass." }
    ]
  },
  "Celtics": {
    id: "1610612738",
    roster: [
       { id: "1628369", name: "Jayson Tatum", position: "F", number: "0" },
       { id: "1627759", name: "Jaylen Brown", position: "G-F", number: "7" },
       { id: "204001", name: "Kristaps Porzingis", position: "C-F", number: "8" },
       { id: "1628401", name: "Derrick White", position: "G", number: "9" },
       { id: "201950", name: "Jrue Holiday", position: "G", number: "4" },
       { id: "201143", name: "Al Horford", position: "C-F", number: "42" },
       { id: "1630174", name: "Payton Pritchard", position: "G", number: "11" },
       { id: "1628382", name: "Sam Hauser", position: "F", number: "30" }
    ],
    tendencies: ["High Volume 3PT", "Switch Everything Defense", "Iso-Heavy Stars"],
    playbook: [
      { id: "p1", name: "5-Out Spacing", type: "offense", description: "All 5 players on perimeter.", diagramType: "iso", execution: ["Tatum isolation top of key", "Porzingis lifts to corner", "Corners stay wide"], raptorsCounter: "Stay home on shooters, force tough 2s." },
      { id: "p2", name: "Double Drag Screen", type: "offense", description: "Two high screens for ball handler.", diagramType: "pnr", execution: ["Holiday brings ball up", "Horford and Tatum set screens", "First screener rolls, second pops"], raptorsCounter: "Ice the first screen, switch the second." },
      { id: "p3", name: "Ghost Screen", type: "offense", description: "Fake screen to pop.", diagramType: "pnr", execution: ["Guard sprints to set screen", "Slips before contact", "Flares to 3pt line"], raptorsCounter: "Switch communication." }
    ]
  },
  "Bucks": {
    id: "1610612749",
    roster: [
       { id: "203507", name: "Giannis Antetokounmpo", position: "F", number: "34", seasonStats: { ppg: 31.5, rpg: 12.0, apg: 6.2, bpg: 1.5 } },
       { id: "203114", name: "Khris Middleton", position: "F", number: "22", seasonStats: { ppg: 15.2, rpg: 4.5, apg: 4.8 } },
       { id: "201572", name: "Brook Lopez", position: "C", number: "11", seasonStats: { ppg: 11.5, rpg: 5.2, apg: 1.5, bpg: 2.5 } },
       { id: "1627739", name: "Taurean Prince", position: "F", number: "35", seasonStats: { ppg: 8.5, rpg: 3.2, apg: 1.5 } },
       { id: "101108", name: "Chris Paul", position: "G", number: "3", seasonStats: { ppg: 6.8, rpg: 3.2, apg: 6.5 } },
       { id: "1631100", name: "AJ Green", position: "G", number: "20", seasonStats: { ppg: 8.8, rpg: 2.2, apg: 1.8 } },
       { id: "1630226", name: "Pat Connaughton", position: "G", number: "24", seasonStats: { ppg: 5.5, rpg: 3.0, apg: 1.2 } },
       { id: "1628978", name: "Bobby Portis", position: "F-C", number: "9", seasonStats: { ppg: 10.2, rpg: 7.5, apg: 1.5 } }
    ],
    tendencies: ["Giannis Drives", "Wall Defense", "Rim Protection"],
    playbook: [
      { id: "p1", name: "Giannis Freight Train", type: "offense", description: "Giannis drives from top.", diagramType: "iso", execution: ["Clear lane", "Giannis attacks rim", "Kick to shooters on help"], raptorsCounter: "Build a wall, don't reach." }
    ]
  },
  "Thunder": {
    id: "1610612760",
    roster: [
       { id: "1630532", name: "Shai Gilgeous-Alexander", position: "G", number: "2", seasonStats: { ppg: 32.8, rpg: 5.5, apg: 6.2 } },
       { id: "1630581", name: "Jalen Williams", position: "F", number: "8", seasonStats: { ppg: 21.5, rpg: 5.8, apg: 5.0 } },
       { id: "1630549", name: "Chet Holmgren", position: "C", number: "7", seasonStats: { ppg: 16.5, rpg: 8.8, apg: 2.5, bpg: 2.8 } },
       { id: "1629008", name: "Lu Dort", position: "G", number: "5", seasonStats: { ppg: 11.2, rpg: 4.2, apg: 2.0 } },
       { id: "1630537", name: "Isaiah Joe", position: "G", number: "11", seasonStats: { ppg: 9.5, rpg: 2.5, apg: 1.8 } },
       { id: "1628412", name: "Kenrich Williams", position: "F", number: "34", seasonStats: { ppg: 5.8, rpg: 4.0, apg: 2.2 } },
       { id: "1629743", name: "Isaiah Hartenstein", position: "C", number: "55", seasonStats: { ppg: 8.2, rpg: 8.5, apg: 3.0 } },
       { id: "1630585", name: "Aaron Wiggins", position: "G", number: "21", seasonStats: { ppg: 7.8, rpg: 3.2, apg: 1.5 } }
    ],
    tendencies: ["SGA Isolation", "Switchable Defense", "Length Everywhere"],
    playbook: [
      { id: "p1", name: "SGA ISO", type: "offense", description: "SGA isolation play.", diagramType: "iso", execution: ["Clear side", "SGA attacks downhill", "Mid-range or floater"], raptorsCounter: "Force tough 2s, wall up at rim." }
    ]
  },
  "Spurs": {
    id: "1610612759",
    roster: [
       { id: "1641706", name: "Victor Wembanyama", position: "C", number: "1", seasonStats: { ppg: 24.5, rpg: 10.8, apg: 4.0, bpg: 4.0 } },
       { id: "1631104", name: "Stephon Castle", position: "G", number: "5", seasonStats: { ppg: 11.5, rpg: 3.2, apg: 4.5 } },
       { id: "1628464", name: "Devin Vassell", position: "G", number: "24", seasonStats: { ppg: 16.8, rpg: 3.8, apg: 3.5 } },
       { id: "1629649", name: "Keldon Johnson", position: "F", number: "3", seasonStats: { ppg: 13.2, rpg: 5.0, apg: 2.5 } },
       { id: "1630537", name: "Jeremy Sochan", position: "F", number: "10", seasonStats: { ppg: 15.5, rpg: 7.2, apg: 4.0 } },
       { id: "201566", name: "Harrison Barnes", position: "F", number: "40", seasonStats: { ppg: 9.8, rpg: 4.5, apg: 1.5 } },
       { id: "1628499", name: "Julian Champagnie", position: "F", number: "30", seasonStats: { ppg: 7.5, rpg: 3.2, apg: 1.0 } },
       { id: "1629649", name: "Tre Jones", position: "G", number: "33", seasonStats: { ppg: 8.5, rpg: 2.5, apg: 5.2 } }
    ],
    tendencies: ["Wemby Rim Protection", "Young Core Development", "Ball Movement"],
    playbook: [
      { id: "p1", name: "Wemby Pop", type: "offense", description: "Wembanyama pick and pop.", diagramType: "pnr", execution: ["Guard initiates", "Wemby screens and pops", "3PT or drive kick"], raptorsCounter: "Contest the pop, don't leave him." }
    ]
  },
  "Wizards": {
    id: "1610612764",
    roster: [
       { id: "1630178", name: "Jordan Poole", position: "G", number: "13", seasonStats: { ppg: 17.8, rpg: 2.5, apg: 4.5 } },
       { id: "1630217", name: "Corey Kispert", position: "F", number: "24", seasonStats: { ppg: 12.5, rpg: 3.5, apg: 2.0 } },
       { id: "1629008", name: "Kyle Kuzma", position: "F", number: "33", seasonStats: { ppg: 15.5, rpg: 5.5, apg: 3.2 } },
       { id: "1631097", name: "Alexandre Sarr", position: "C", number: "20", seasonStats: { ppg: 10.5, rpg: 6.8, apg: 2.0, bpg: 1.8 } },
       { id: "1631101", name: "Bilal Coulibaly", position: "F", number: "0", seasonStats: { ppg: 10.2, rpg: 4.5, apg: 3.5 } },
       { id: "1629635", name: "Deni Avdija", position: "F", number: "8", seasonStats: { ppg: 11.8, rpg: 5.2, apg: 4.0 } },
       { id: "1630206", name: "Malcolm Brogdon", position: "G", number: "3", seasonStats: { ppg: 8.5, rpg: 2.8, apg: 3.2 } },
       { id: "1631107", name: "Johnny Davis", position: "G", number: "1", seasonStats: { ppg: 6.5, rpg: 2.5, apg: 2.0 } }
    ],
    tendencies: ["Pace and Space", "Young Development", "Transition"],
    playbook: [
      { id: "p1", name: "Poole Party", type: "offense", description: "Poole isolation.", diagramType: "iso", execution: ["Poole at top", "Step-back 3 option", "Drive and kick"], raptorsCounter: "Force him left, contest everything." }
    ]
  },
  "Celtics": {
    id: "1610612738",
    roster: [
       { id: "1628369", name: "Jayson Tatum", position: "F", number: "0", seasonStats: { ppg: 27.8, rpg: 8.5, apg: 5.2 } },
       { id: "1627759", name: "Jaylen Brown", position: "G-F", number: "7", seasonStats: { ppg: 24.2, rpg: 5.8, apg: 4.0 } },
       { id: "204001", name: "Kristaps Porzingis", position: "C", number: "8", seasonStats: { ppg: 20.5, rpg: 7.5, apg: 2.0, bpg: 2.0 } },
       { id: "1628401", name: "Derrick White", position: "G", number: "9", seasonStats: { ppg: 15.8, rpg: 4.2, apg: 5.0 } },
       { id: "201950", name: "Jrue Holiday", position: "G", number: "4", seasonStats: { ppg: 13.5, rpg: 5.0, apg: 4.8 } },
       { id: "201143", name: "Al Horford", position: "C", number: "42", seasonStats: { ppg: 8.5, rpg: 6.2, apg: 2.8 } },
       { id: "1630556", name: "Payton Pritchard", position: "G", number: "11", seasonStats: { ppg: 14.2, rpg: 2.5, apg: 3.0 } },
       { id: "1628432", name: "Sam Hauser", position: "F", number: "30", seasonStats: { ppg: 9.2, rpg: 3.0, apg: 1.5 } }
    ],
    tendencies: ["Switching Defense", "Balanced Scoring", "3PT Heavy"],
    playbook: [
      { id: "p1", name: "Tatum ISO", type: "offense", description: "Tatum isolation play.", diagramType: "iso", execution: ["Clear side", "Tatum attacks from wing", "Step-back or drive"], raptorsCounter: "Force baseline, wall up at rim." }
    ]
  },
  "Cavaliers": {
    id: "1610612739",
    roster: [
       { id: "1629630", name: "Darius Garland", position: "G", number: "10", seasonStats: { ppg: 22.5, rpg: 2.8, apg: 8.0 } },
       { id: "1629628", name: "Donovan Mitchell", position: "G", number: "45", seasonStats: { ppg: 26.5, rpg: 4.5, apg: 5.5 } },
       { id: "1628386", name: "Jarrett Allen", position: "C", number: "31", seasonStats: { ppg: 14.2, rpg: 10.5, apg: 1.5, bpg: 1.5 } },
       { id: "1628372", name: "Evan Mobley", position: "F-C", number: "4", seasonStats: { ppg: 18.5, rpg: 9.5, apg: 3.5, bpg: 1.2 } },
       { id: "203953", name: "Max Strus", position: "G", number: "1", seasonStats: { ppg: 12.8, rpg: 3.2, apg: 2.5 } },
       { id: "1629054", name: "Caris LeVert", position: "G-F", number: "3", seasonStats: { ppg: 11.5, rpg: 3.5, apg: 4.0 } },
       { id: "1631096", name: "Sam Merrill", position: "G", number: "14", seasonStats: { ppg: 8.2, rpg: 2.0, apg: 1.8 } },
       { id: "1628404", name: "Isaac Okoro", position: "F", number: "35", seasonStats: { ppg: 7.5, rpg: 2.8, apg: 1.5 } }
    ],
    tendencies: ["Twin Tower Lineup", "Elite Defense", "Mitchell-Garland PnR"],
    playbook: [
      { id: "p1", name: "Spida PnR", type: "offense", description: "Mitchell pick and roll.", diagramType: "pnr", execution: ["Mitchell at top", "Allen sets screen", "Roll or pop option"], raptorsCounter: "Blitz Mitchell, rotate to Allen." }
    ]
  },
  "Knicks": {
    id: "1610612752",
    roster: [
       { id: "1628373", name: "Jalen Brunson", position: "G", number: "11", seasonStats: { ppg: 28.5, rpg: 3.5, apg: 7.5 } },
       { id: "1628952", name: "Mikal Bridges", position: "F", number: "25", seasonStats: { ppg: 18.5, rpg: 4.2, apg: 3.5 } },
       { id: "1628449", name: "OG Anunoby", position: "F", number: "8", seasonStats: { ppg: 16.8, rpg: 5.5, apg: 2.0 } },
       { id: "1629651", name: "Karl-Anthony Towns", position: "C", number: "32", seasonStats: { ppg: 25.2, rpg: 12.5, apg: 3.0 } },
       { id: "203585", name: "Josh Hart", position: "G-F", number: "3", seasonStats: { ppg: 12.8, rpg: 8.5, apg: 5.0 } },
       { id: "1629011", name: "Donte DiVincenzo", position: "G", number: "0", seasonStats: { ppg: 10.5, rpg: 3.2, apg: 2.8 } },
       { id: "1628991", name: "Miles McBride", position: "G", number: "2", seasonStats: { ppg: 9.5, rpg: 2.2, apg: 3.5 } },
       { id: "203935", name: "Precious Achiuwa", position: "F-C", number: "5", seasonStats: { ppg: 7.5, rpg: 5.8, apg: 1.2 } }
    ],
    tendencies: ["Brunson Isolation", "Defensive Versatility", "Motion Offense"],
    playbook: [
      { id: "p1", name: "Brunson ISO", type: "offense", description: "Brunson isolation.", diagramType: "iso", execution: ["Clear side", "Brunson attacks", "Mid-range or drive-kick"], raptorsCounter: "Force tough 2s, help on drives." }
    ]
  },
  "Heat": {
    id: "1610612748",
    roster: [
       { id: "1628389", name: "Bam Adebayo", position: "C", number: "13", seasonStats: { ppg: 17.5, rpg: 10.5, apg: 5.0 } },
       { id: "202710", name: "Jimmy Butler", position: "F", number: "22", seasonStats: { ppg: 18.5, rpg: 5.2, apg: 4.8 } },
       { id: "1629216", name: "Tyler Herro", position: "G", number: "14", seasonStats: { ppg: 22.8, rpg: 5.0, apg: 5.5 } },
       { id: "1631102", name: "Jaime Jaquez Jr.", position: "F", number: "11", seasonStats: { ppg: 12.5, rpg: 4.5, apg: 2.8 } },
       { id: "1629639", name: "Terry Rozier", position: "G", number: "2", seasonStats: { ppg: 14.8, rpg: 3.8, apg: 4.2 } },
       { id: "1629634", name: "Nikola Jovic", position: "F", number: "5", seasonStats: { ppg: 9.5, rpg: 4.5, apg: 2.0 } },
       { id: "203482", name: "Kevin Love", position: "F-C", number: "42", seasonStats: { ppg: 7.2, rpg: 5.5, apg: 1.8 } },
       { id: "1627780", name: "Duncan Robinson", position: "F", number: "55", seasonStats: { ppg: 8.8, rpg: 2.5, apg: 1.5 } }
    ],
    tendencies: ["Heat Culture Defense", "Zone Defense", "Butler Takeover"],
    playbook: [
      { id: "p1", name: "Jimmy Buckets", type: "offense", description: "Butler isolation.", diagramType: "iso", execution: ["Post up or wing ISO", "Draw fouls", "Kick to shooters"], raptorsCounter: "No reach-ins, make him shoot." }
    ]
  },
  "Magic": {
    id: "1610612753",
    roster: [
       { id: "1630559", name: "Paolo Banchero", position: "F", number: "5", seasonStats: { ppg: 28.5, rpg: 8.8, apg: 5.5 } },
       { id: "1630536", name: "Franz Wagner", position: "F", number: "22", seasonStats: { ppg: 24.2, rpg: 5.8, apg: 6.0 } },
       { id: "1631094", name: "Jalen Suggs", position: "G", number: "4", seasonStats: { ppg: 15.8, rpg: 4.2, apg: 4.8 } },
       { id: "1630544", name: "Wendell Carter Jr.", position: "C", number: "34", seasonStats: { ppg: 8.5, rpg: 7.5, apg: 2.5 } },
       { id: "1629649", name: "Kentavious Caldwell-Pope", position: "G", number: "3", seasonStats: { ppg: 10.2, rpg: 2.5, apg: 1.8 } },
       { id: "1631099", name: "Anthony Black", position: "G", number: "0", seasonStats: { ppg: 7.5, rpg: 3.2, apg: 3.5 } },
       { id: "1629633", name: "Cole Anthony", position: "G", number: "50", seasonStats: { ppg: 11.2, rpg: 4.0, apg: 4.2 } },
       { id: "1630579", name: "Jonathan Isaac", position: "F", number: "1", seasonStats: { ppg: 6.5, rpg: 4.5, apg: 0.8, bpg: 1.5 } }
    ],
    tendencies: ["Elite Length", "Transition Offense", "Switchable Defense"],
    playbook: [
      { id: "p1", name: "Paolo Post", type: "offense", description: "Banchero post-up.", diagramType: "iso", execution: ["Entry to block", "Paolo faces up", "Triple threat attack"], raptorsCounter: "Front the post, help weak side." }
    ]
  }
};

// ===== DYNAMIC ROSTER FETCHING (ESPN API) =====
const ESPN_TEAM_IDS = {
  "Hawks":1,"Celtics":2,"Nets":17,"Hornets":30,"Bulls":4,"Cavaliers":5,"Mavericks":6,
  "Nuggets":7,"Pistons":8,"Warriors":9,"Rockets":10,"Pacers":11,"Clippers":12,"Lakers":13,
  "Grizzlies":29,"Heat":14,"Bucks":15,"Timberwolves":16,"Pelicans":3,"Knicks":18,
  "Thunder":25,"Magic":19,"76ers":20,"Suns":21,"Trail Blazers":22,"Kings":23,"Spurs":24,
  "Raptors":28,"Jazz":26,"Wizards":27
};

const _rosterCache = {};

const fetchLiveRoster = async (teamName) => {
  if (_rosterCache[teamName]) return _rosterCache[teamName];
  const espnId = ESPN_TEAM_IDS[teamName];
  if (!espnId) return null;
  try {
    const controller = new AbortController();
    const timeoutId = setTimeout(() => controller.abort(), 5000);
    const res = await fetch(`https://site.api.espn.com/apis/site/v2/sports/basketball/nba/teams/${espnId}/roster`, { signal: controller.signal });
    clearTimeout(timeoutId);
    if (!res.ok) return null;
    const data = await res.json();
    const roster = data.athletes.map(a => ({
      id: a.id,
      name: a.fullName,
      position: a.position?.abbreviation || '',
      number: a.jersey || '',
      headshot: a.headshot?.href || '',
      height: a.displayHeight || '',
      weight: a.displayWeight || '',
      age: a.age || 0,
      _espnId: a.id
    }));
    _rosterCache[teamName] = roster;
    // Also update OPPONENT_DATA if it exists
    if (OPPONENT_DATA[teamName]) {
      OPPONENT_DATA[teamName].roster = roster;
    }
    return roster;
  } catch (e) {
    console.warn('Roster fetch failed for', teamName, e);
    window._raptorsApiFailure = true;
    return null;
  }
};

// Hook to fetch roster dynamically
const useLiveRoster = (teamName) => {
  const [roster, setRoster] = React.useState(null);
  const [loading, setLoading] = React.useState(false);
  React.useEffect(() => {
    if (!teamName) return;
    setLoading(true);
    fetchLiveRoster(teamName).then(r => {
      if (r) setRoster(r);
      setLoading(false);
    });
  }, [teamName]);
  return { roster, loading };
};

// ESPN headshot URL helper
const getHeadshot = (player) => {
  if (player?.headshot) return player.headshot;
  if (player?._espnId) return `https://a.espncdn.com/i/headshots/nba/players/full/${player._espnId}.png`;
  // Fallback to NBA CDN with nba.com ID
  if (player?.id && !String(player.id).startsWith('player')) return `https://cdn.nba.com/headshots/nba/latest/1040x760/${player.id}.png`;
  return '';
};

const GENERIC_ROSTER = [
    { id: "player1", name: "Star Point Guard", position: "G", number: "1" },
    { id: "player2", name: "Shooting Guard", position: "G", number: "2" },
    { id: "player3", name: "Small Forward", position: "F", number: "3" },
    { id: "player4", name: "Power Forward", position: "F", number: "4" },
    { id: "player5", name: "Center", position: "C", number: "5" },
    { id: "player6", name: "Sixth Man", position: "G", number: "6" },
    { id: "player7", name: "Wing Defender", position: "F", number: "7" },
    { id: "player8", name: "Backup Big", position: "C", number: "8" },
];

const generateStats = (seed, multiplier = 1) => {
    return {
        ppg: fmt((10 + Math.random() * 15) * multiplier),
        rpg: fmt((2 + Math.random() * 8) * multiplier),
        apg: fmt((1 + Math.random() * 7) * multiplier),
        spg: fmt(Math.random() * 2),
        bpg: fmt(Math.random() * 1.5),
        oreb: 1.2, dreb: 4.5,
        fgPct: fmt(45 + Math.random() * 10),
        threePtPct: fmt(32 + Math.random() * 10),
        ftPct: fmt(70 + Math.random() * 20),
        plusMinus: fmt((Math.random() * 10) - 5),
        turnovers: fmt(2.1)
    };
};

const enrichRoster = (simpleRoster) => {
    return simpleRoster.map(p => {
        const baseStats = p.seasonStats ? {
            ...generateStats(1),
            ...p.seasonStats,
            ppg: fmt(p.seasonStats.ppg || 10),
            rpg: fmt(p.seasonStats.rpg || 3),
            apg: fmt(p.seasonStats.apg || 2)
        } : generateStats(1);
        return {
            ...p,
            seasonStats: baseStats,
            vsOpponentStats: generateStats(1.1),
            advanced: {
                per: fmt(15 + Math.random() * 10),
                ts: fmt(55 + Math.random() * 10),
                usg: fmt(20 + Math.random() * 10),
                ortg: fmt(110 + Math.random() * 10),
                drtg: fmt(110 + Math.random() * 10),
            },
            analysis: "Key rotation player. Watch for aggressive drives."
        };
    });
};

const fetchRaptorsSchedule = async () => {
  const games = [
    { id: "g43", date: "Jan 16", opponent: "Clippers", opponentId: "1610612746", isHome: true, time: "7:30 PM", venue: "Scotiabank Arena", status: "completed", result: "L 117-121 OT" },
    { id: "g44", date: "Jan 18", opponent: "Lakers", opponentId: "1610612747", isHome: false, time: "10:30 PM", venue: "Crypto.com Arena", status: "completed", result: "L 93-110" },
    { id: "g45", date: "Jan 20", opponent: "Warriors", opponentId: "1610612744", isHome: false, time: "10:00 PM", venue: "Chase Center", status: "completed", result: "W 145-127" },
    { id: "g46", date: "Jan 21", opponent: "Kings", opponentId: "1610612758", isHome: false, time: "10:00 PM", venue: "Golden 1 Center", status: "completed", result: "W 122-109" },
    { id: "g47", date: "Jan 23", opponent: "Trail Blazers", opponentId: "1610612757", isHome: false, time: "10:00 PM", venue: "Moda Center", status: "completed", result: "W 110-98" },
    { id: "g48", date: "Jan 25", opponent: "Thunder", opponentId: "1610612760", isHome: false, time: "8:00 PM", venue: "Paycom Center", status: "completed", result: "W 103-101" },
    { id: "g49", date: "Jan 28", opponent: "Knicks", opponentId: "1610612752", isHome: true, time: "7:30 PM", venue: "Scotiabank Arena", status: "completed", result: "L 92-119" },
    { id: "g50", date: "Jan 30", opponent: "Magic", opponentId: "1610612753", isHome: false, time: "7:00 PM", venue: "Kia Center", status: "completed", result: "L 120-130" },
    { id: "g51", date: "Feb 1", opponent: "Jazz", opponentId: "1610612762", isHome: true, time: "7:30 PM", venue: "Scotiabank Arena", status: "completed", result: "W 107-100" },
    { id: "g52", date: "Feb 4", opponent: "Timberwolves", opponentId: "1610612750", isHome: true, time: "7:30 PM", venue: "Scotiabank Arena", status: "completed", result: "W 131-128 OT" },
    { id: "g53", date: "Feb 5", opponent: "Bulls", opponentId: "1610612741", isHome: true, time: "7:30 PM", venue: "Scotiabank Arena", status: "completed", result: "W 130-113" },
    { id: "g54", date: "Feb 8", opponent: "Pacers", opponentId: "1610612754", isHome: true, time: "3:00 PM", venue: "Scotiabank Arena", status: "completed", result: "W 130-123" },
    { id: "g55", date: "Feb 11", opponent: "Pistons", opponentId: "1610612765", isHome: true, time: "7:30 PM", venue: "Scotiabank Arena", status: "upcoming" },
    { id: "g56", date: "Feb 19", opponent: "Bulls", opponentId: "1610612741", isHome: false, time: "8:00 PM", venue: "United Center", status: "upcoming" },
    { id: "g57", date: "Feb 22", opponent: "Bucks", opponentId: "1610612749", isHome: false, time: "3:30 PM", venue: "Fiserv Forum", status: "upcoming" },
    { id: "g58", date: "Feb 24", opponent: "Thunder", opponentId: "1610612760", isHome: true, time: "7:30 PM", venue: "Scotiabank Arena", status: "upcoming" },
    { id: "g59", date: "Feb 25", opponent: "Spurs", opponentId: "1610612759", isHome: true, time: "7:30 PM", venue: "Scotiabank Arena", status: "upcoming" },
    { id: "g60", date: "Feb 28", opponent: "Wizards", opponentId: "1610612764", isHome: false, time: "7:00 PM", venue: "Capital One Arena", status: "upcoming" },
  ];
  return { games, sources: [] };
};

const analyzeGameMatchup = async (opponent) => {
  await new Promise(resolve => setTimeout(resolve, 300));
  // Try to fetch live roster from ESPN
  const liveRoster = await fetchLiveRoster(opponent);
  let opponentData = OPPONENT_DATA[opponent];
  if (!opponentData) {
      const key = Object.keys(OPPONENT_DATA).find(k => k.includes(opponent) || opponent.includes(k));
      if (key) { opponentData = OPPONENT_DATA[key]; }
      else {
          opponentData = { id: "0", roster: GENERIC_ROSTER, tendencies: ["Balanced Attack", "Man-to-Man", "Pace and Space"],
              playbook: [
                   { id: "gen1", name: "High PnR", type: "offense", description: "Standard pick and roll action.", diagramType: "pnr", execution: ["Guard calls for screen", "Big sets solid pick", "Read the defense"], raptorsCounter: "Standard drop coverage." },
                   { id: "gen2", name: "Horns", type: "offense", description: "Two bigs at the elbows.", diagramType: "horns", execution: ["Entry pass to elbow", "Corner cut", "High low action"], raptorsCounter: "Crowd the elbows." },
                   { id: "gen3", name: "Iso", type: "offense", description: "Clear out for best player.", diagramType: "iso", execution: ["1-4 flat", "Isolation at top", "Drive and kick"], raptorsCounter: "Help early." },
                   { id: "gen4", name: "Spain PnR", type: "offense", description: "Stack pick and roll.", diagramType: "pnr", execution: ["High ball screen", "Back screen for roller", "Pop"], raptorsCounter: "Switch everything." },
              ]
          };
      }
  }
  // Prefer live ESPN roster over hardcoded data
  const baseRoster = liveRoster || opponentData.roster;
  const opponentRoster = enrichRoster(baseRoster);
  const raptorsRoster = RAPTORS_ROSTER;
  const starPlayer = opponentRoster[0].name;
  const keyDefender = opponentRoster.length > 7 ? opponentRoster[7].name : "the bench";
  const analysis = {
    summary: `The Raptors face the ${opponent} in a crucial February matchup. With the trade deadline looming, Toronto must focus on containing ${starPlayer}. The ${opponent} have been relying on their ${opponentData.tendencies[0].toLowerCase()}, requiring disciplined rotation.`,
    winProbability: Math.floor(40 + Math.random() * 20),
    raptorsRoster, opponentRoster,
    lineupPresets: [
        { name: "Starters", description: "Main rotation", playerIds: opponentRoster.slice(0,5).map(p => p.id), netRating: 4.5, ortg: 115.2, drtg: 110.7 },
        { name: "Second Unit", description: "Bench mob", playerIds: opponentRoster.slice(5,10).map(p => p.id), netRating: -1.2, ortg: 105.0, drtg: 106.2 },
        { name: "Speed Unit", description: "Small ball lineup", playerIds: [opponentRoster[0].id, opponentRoster[4].id, opponentRoster[6]?.id, opponentRoster[7]?.id, opponentRoster[8]?.id].filter(Boolean), netRating: 2.1, ortg: 118.0, drtg: 115.9 }
    ],
    playbook: opponentData.playbook || [],
    scoutingReport: {
        offensiveTendencies: opponentData.tendencies,
        defensiveSchemes: ["Drop Coverage", "Switch 1-4", "Zone on BLOBs"],
        xFactor: opponentRoster[2].name,
        keysToVictory: [`Limit ${opponentRoster[0].name} in transition`, "Win the rebounding battle", "Generate 15+ deflections", `Force ${opponentRoster[1].name} to drive left`]
    },
    intel: {
        injuries: [
            { player: "Jakob Poeltl", status: "Out", details: "Back â€” ruled out Feb 8 vs Pacers", team: "raptors" },
            { player: "Collin Murray-Boyles", status: "Questionable", details: "Left thumb â€” aggravated vs Pacers, day-to-day", team: "raptors" },
            { player: "Scottie Barnes", status: "Active", details: "Available", team: "raptors" },
            { player: "Chris Paul", status: "Active", details: "Acquired via trade â€” available", team: "raptors" },
            { player: "Trayce Jackson-Davis", status: "Active", details: "Acquired via trade â€” available", team: "raptors" },
            { player: opponentRoster[0]?.name || "Star Player", status: "Active", details: "Full go", team: "opponent" },
            { player: opponentRoster[3]?.name || "Key Forward", status: "Questionable", details: "Knee soreness â€” GTD", team: "opponent" }
        ],
        restDays: { raptors: 2, opponent: 1 },
        backToBack: { raptors: false, opponent: true },
        referees: [
            { name: "Scott Foster", role: "Crew Chief", foulCallRate: 45.2, tendency: "Lets them play" },
            { name: "Marc Davis", role: "Referee", foulCallRate: 42.8, tendency: "Whistle-happy in paint" },
            { name: "Courtney Kirkland", role: "Umpire", foulCallRate: 41.5, tendency: "Consistent" }
        ],
        pace: { raptors: 101.2, opponent: 98.5, leagueAvg: 99.8 },
        homeSplits: { raptors: { home: "14-12", away: "9-20" }, opponent: { home: "18-8", away: "14-14" } },
        rebounding: {
            raptors: { oreb: 10.2, dreb: 33.5, total: 43.7, orebPct: 26.8 },
            opponent: { oreb: 11.5, dreb: 34.2, total: 45.7, orebPct: 28.1 }
        },
        freeThrows: {
            raptors: { ftPct: 78.5, ftaPerGame: 21.3, ftRate: 0.268 },
            opponent: { ftPct: 76.2, ftaPerGame: 23.8, ftRate: 0.285 }
        },
        quarterScoring: {
            raptors: { q1: 27.5, q2: 28.2, q3: 26.8, q4: 29.3 },
            opponent: { q1: 28.1, q2: 27.5, q3: 28.9, q4: 27.2 }
        },
        seasonSeries: {
            raptorsWins: 1, opponentWins: 1,
            games: [
                { date: "Nov 15", result: "W 112-105", topScorer: "Scottie Barnes - 28 pts" },
                { date: "Jan 8", result: "L 98-115", topScorer: "RJ Barrett - 22 pts" }
            ]
        },
        streaks: {
            raptors: { current: "W4", home: "W2", away: "L1" },
            opponent: { current: "W2", home: "W5", away: "L2" }
        },
        assistDistribution: {
            raptors: [
                { from: "Quickley", to: "Barnes", pct: 18 },
                { from: "Quickley", to: "Ingram", pct: 15 },
                { from: "Barnes", to: "Poeltl", pct: 12 },
                { from: "Barrett", to: "Barnes", pct: 10 }
            ],
            opponent: [
                { from: "Edwards", to: "Randle", pct: 16 },
                { from: "Conley", to: "Edwards", pct: 14 },
                { from: "Conley", to: "Gobert", pct: 11 }
            ]
        },
        defenseByPosition: {
            raptors: { pg: 112.5, sg: 108.2, sf: 105.8, pf: 110.3, c: 102.4 },
            opponent: { pg: 108.1, sg: 110.5, sf: 107.2, pf: 106.8, c: 99.5 }
        },
        clutchStats: {
            raptors: { record: "8-5", ppg: 4.8, fgPct: 45.2, plusMinus: 2.1 },
            opponent: { record: "6-7", ppg: 4.2, fgPct: 41.8, plusMinus: -1.5 }
        },
        lastTenTrend: {
            raptors: [105, 112, 98, 118, 108, 115, 122, 110, 119, 114],
            opponent: [110, 102, 115, 108, 99, 112, 105, 118, 108, 111]
        },
        socialChatter: [
            { headline: "Raptors acquire Chris Paul in blockbuster 3-team deadline deal", source: "Shams Charania (ESPN)", sentiment: "positive" },
            { headline: "Trayce Jackson-Davis traded from Warriors to Raptors for 2nd-round pick", source: "Chris Haynes (TNT)", sentiment: "neutral" },
            { headline: "Ochai Agbaji headed to Nets as part of CP3 deal", source: "Marc Stein (Substack)", sentiment: "neutral" },
            { headline: "Jakob Poeltl's back injury lingers â€” Raptors add depth at center", source: "Raptors Republic", sentiment: "neutral" },
            { headline: `${opponent} heading to Scotiabank Arena as Raptors adjust post-deadline roster`, source: "ESPN", sentiment: "positive" }
        ]
    }
  };
  return { analysis, sources: [] };
};

// ============================================================
// LUCIDE ICONS - extract from global
// ============================================================
const {
  Brain, Trophy, Activity, Shield, Zap, RotateCcw, ChevronRight, LayoutTemplate,
  MessageSquare, AlertTriangle, TrendingUp, Radio, Users, Heart, Share,
  MessageCircle, MoveVertical, RefreshCcw, BarChart3, ArrowUpDown, Swords, Info,
  Calendar, LayoutDashboard, X, Target, Award, Bandage, Clock, Gavel, Home, Plane,
  ArrowRightLeft, Gauge, Timer, Sun, Moon, Bell, Download, ExternalLink, Flame,
  Snowflake, TrendingDown, Volume2, Printer, Copy, Twitter, Facebook, Send,
  ChevronUp, ChevronDown, Search, Filter, Star, Sparkles, Eye, EyeOff, History,
  Battery, BatteryMedium, Cpu, BarChart2, DollarSign, Sliders, Compass, Settings,
  MoreHorizontal
} = LucideReact;

// ============================================================
// RECHARTS - extract from global
// ============================================================
const {
  BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer,
  RadarChart, PolarGrid, PolarAngleAxis, PolarRadiusAxis, Radar,
  LineChart, Line, AreaChart, Area, ReferenceLine, Cell
} = Recharts;

const { useState, useEffect, useRef, useCallback, useMemo, Component } = React;

// ============================================================
// ERROR BOUNDARY - Catches rendering errors
// ============================================================
class ErrorBoundary extends Component {
  constructor(props) {
    super(props);
    this.state = { hasError: false, error: null };
  }
  
  static getDerivedStateFromError(error) {
    return { hasError: true, error };
  }
  
  componentDidCatch(error, errorInfo) {
    console.error('Raptors Intel Error:', error, errorInfo);
  }
  
  render() {
    if (this.state.hasError) {
      return (
        <div className="min-h-screen bg-cmd-bg flex items-center justify-center p-4">
          <div className="glass-card p-8 max-w-md text-center">
            <div className="text-6xl mb-4">ðŸ¦–</div>
            <h2 className="text-xl font-bold text-white mb-2">Something went wrong</h2>
            <p className="text-slate-400 text-sm mb-4">The app encountered an error. Please refresh the page.</p>
            <button 
              onClick={() => window.location.reload()}
              className="px-4 py-2 bg-raptors-red text-white rounded-lg font-bold hover:bg-raptors-red/80 transition-colors"
            >
              Refresh Page
            </button>
          </div>
        </div>
      );
    }
    
    return this.props.children;
  }
}

// ============================================================
// LOADING SKELETON
// ============================================================
const LoadingSkeleton = ({ lines = 3, className = '' }) => (
  <div className={`animate-pulse space-y-3 p-4 ${className}`}>
    {Array.from({ length: lines }).map((_, i) => (
      <div key={i} className="flex gap-3">
        {i === 0 && <div className="w-10 h-10 bg-slate-700/50 rounded-lg flex-shrink-0" />}
        <div className="flex-1 space-y-2">
          <div className={`h-3 bg-slate-700/50 rounded-full ${i % 2 === 0 ? 'w-3/4' : 'w-1/2'}`} />
          {i === 0 && <div className="h-3 bg-slate-700/40 rounded-full w-1/3" />}
        </div>
      </div>
    ))}
  </div>
);

// ============================================================
// WIDGET ERROR BOUNDARY - Wraps individual sections
// ============================================================
class WidgetErrorBoundary extends Component {
  constructor(props) {
    super(props);
    this.state = { hasError: false, retryCount: 0 };
  }
  static getDerivedStateFromError() { return { hasError: true }; }
  componentDidCatch(error, info) { console.error(`Widget error [${this.props.name || 'unknown'}]:`, error, info); }
  handleRetry = () => {
    this.setState(prev => ({ hasError: false, retryCount: prev.retryCount + 1 }));
  };
  render() {
    if (this.state.hasError) {
      return (
        <div className="glass-card p-4 text-center text-slate-500 text-sm" role="alert">
          <span className="text-lg">âš ï¸</span>
          <p className="mt-1 font-semibold">{this.props.name || 'Widget'} failed to load</p>
          {this.state.retryCount > 0 && <p className="text-xs mt-1 text-yellow-500">Live data unavailable â€” showing cached data</p>}
          <button onClick={this.handleRetry} className="mt-2 px-3 py-1 text-xs bg-raptors-red/20 text-raptors-red rounded-full hover:bg-raptors-red/30 transition-colors font-bold" aria-label={`Retry loading ${this.props.name || 'widget'}`}>ðŸ”„ Retry</button>
        </div>
      );
    }
    return this.props.children;
  }
}

// API Failure Banner Component
const ApiFailureBanner = ({ message = "Live data unavailable â€” showing cached data", onRetry }) => (
  <div className="bg-yellow-500/10 border border-yellow-500/30 rounded-lg px-4 py-2 flex items-center justify-between gap-3 mb-3" role="alert">
    <span className="text-yellow-400 text-xs font-medium flex items-center gap-2">âš ï¸ {message}</span>
    {onRetry && <button onClick={onRetry} className="text-xs bg-yellow-500/20 text-yellow-400 px-2 py-1 rounded font-bold hover:bg-yellow-500/30 transition-colors" aria-label="Retry loading data">Retry</button>}
  </div>
);

// ============================================================
// PREMIUM DESIGN COMPONENTS
// ============================================================

// Cursor Glow Follower
const CursorGlow = ({ isDark = true }) => {
  const [position, setPosition] = useState({ x: -500, y: -500 });
  
  useEffect(() => {
    const handleMouseMove = (e) => {
      setPosition({ x: e.clientX, y: e.clientY });
    };
    window.addEventListener('mousemove', handleMouseMove);
    return () => window.removeEventListener('mousemove', handleMouseMove);
  }, []);
  
  if (!isDark) return null;
  
  return (
    <div 
      className="cursor-glow"
      style={{ left: position.x, top: position.y }}
    />
  );
};

// CSS-only Star Particles for Hero
const HeroStarField = () => {
  const stars = useMemo(() => Array.from({ length: 40 }, (_, i) => ({
    id: i,
    left: `${Math.random() * 100}%`,
    top: `${Math.random() * 100}%`,
    size: Math.random() * 2 + 1,
    delay: `${Math.random() * 5}s`,
    duration: `${2 + Math.random() * 3}s`,
    opacity: 0.2 + Math.random() * 0.5,
  })), []);

  return (
    <div className="hero-star-field absolute inset-0 overflow-hidden pointer-events-none">
      {stars.map(s => (
        <div key={s.id} className="absolute rounded-full bg-white" style={{
          left: s.left, top: s.top, width: s.size, height: s.size,
          opacity: s.opacity,
          animation: `star-twinkle ${s.duration} ease-in-out ${s.delay} infinite`,
        }} />
      ))}
    </div>
  );
};

// Countdown Timer Hook
const useCountdown = (targetDate) => {
  const [timeLeft, setTimeLeft] = useState({ days: 0, hours: 0, minutes: 0, seconds: 0 });
  useEffect(() => {
    const update = () => {
      const now = new Date();
      const diff = targetDate - now;
      if (diff <= 0) { setTimeLeft({ days: 0, hours: 0, minutes: 0, seconds: 0 }); return; }
      setTimeLeft({
        days: Math.floor(diff / 86400000),
        hours: Math.floor((diff % 86400000) / 3600000),
        minutes: Math.floor((diff % 3600000) / 60000),
        seconds: Math.floor((diff % 60000) / 1000),
      });
    };
    update();
    const interval = setInterval(update, 1000);
    return () => clearInterval(interval);
  }, [targetDate]);
  return timeLeft;
};

// Animated Win Counter
const AnimatedWinCounter = ({ target, duration = 1500 }) => {
  const [count, setCount] = useState(0);
  const ref = useRef(null);
  useEffect(() => {
    const observer = new IntersectionObserver((entries) => {
      if (entries[0].isIntersecting) {
        let start = 0;
        const step = target / (duration / 16);
        const timer = setInterval(() => {
          start += step;
          if (start >= target) { setCount(target); clearInterval(timer); }
          else setCount(Math.floor(start));
        }, 16);
        observer.disconnect();
      }
    });
    if (ref.current) observer.observe(ref.current);
    return () => observer.disconnect();
  }, [target, duration]);
  return <span ref={ref}>{count}</span>;
};

// Premium Hero Section
const HeroStatsBar = ({ isDark = true }) => {
  // Next game: Feb 11 vs Pistons at 7:30 PM ET
  const nextGameDate = useMemo(() => new Date('2026-02-12T00:30:00Z'), []); // 7:30 PM ET = 00:30 UTC next day
  const countdown = useCountdown(nextGameDate);
  const winPct = (RAPTORS_STATS.wins / (RAPTORS_STATS.wins + RAPTORS_STATS.losses)).toFixed(3);

  return (
    <div className={`relative overflow-hidden ${isDark ? 'bg-gradient-to-br from-black via-[#0a0e17] to-[#1a0010]' : 'bg-gradient-to-br from-white via-slate-50 to-red-50'}`}>
      {isDark && <HeroStarField />}
      {/* Subtle radial glow */}
      {isDark && <div className="absolute inset-0 pointer-events-none" style={{background: 'radial-gradient(ellipse at 50% 80%, rgba(206,17,65,0.08) 0%, transparent 60%)'}} />}

      <div className="relative z-10 max-w-5xl mx-auto px-4 py-6 md:py-8">
        {/* Main Record Display */}
        <div className="flex flex-col md:flex-row items-center justify-between gap-3 md:gap-8">
          {/* Left: Record */}
          <div className="flex items-center gap-3 md:gap-6">
            <div className="text-center">
              <div className={`text-[2rem] md:text-[4rem] font-black leading-none tracking-tight ${isDark ? 'text-white' : 'text-slate-900'}`}>
                <AnimatedWinCounter target={RAPTORS_STATS.wins} />
                <span className={`${isDark ? 'text-raptors-silver' : 'text-slate-400'} mx-1`}>-</span>
                <span className={isDark ? 'text-slate-500' : 'text-slate-400'}>{RAPTORS_STATS.losses}</span>
              </div>
              <div className={`text-[0.75rem] uppercase tracking-[0.2em] font-bold mt-1 ${isDark ? 'text-raptors-silver' : 'text-slate-500'}`}>
                2025-26 Season
              </div>
            </div>
            {/* Conference Ranking Badge */}
            <div className={`flex flex-col items-center px-4 py-3 rounded-xl border ${isDark ? 'border-raptors-purple/40 bg-raptors-purple/10' : 'border-purple-200 bg-purple-50'}`}>
              <span className={`text-[0.75rem] uppercase tracking-wider font-bold ${isDark ? 'text-raptors-purple' : 'text-purple-600'}`} style={{color: isDark ? '#7c5cbf' : undefined}}>East</span>
              <span className={`text-2xl font-black ${isDark ? 'text-white' : 'text-slate-800'}`}>#5</span>
              <span className={`text-[0.75rem] font-semibold ${isDark ? 'text-raptors-silver' : 'text-slate-500'}`}>{winPct} W%</span>
            </div>
          </div>

          {/* Center: Next Game Countdown */}
          <div className="flex flex-col items-center">
            <div className={`text-[0.75rem] uppercase tracking-[0.15em] font-bold mb-2 ${isDark ? 'text-raptors-silver' : 'text-slate-500'}`}>
              Next Game â€” <span className="text-raptors-red">vs Pistons</span>
            </div>
            <div className="flex items-center gap-1.5 md:gap-2">
              {[
                { val: countdown.days, label: 'D' },
                { val: countdown.hours, label: 'H' },
                { val: countdown.minutes, label: 'M' },
                { val: countdown.seconds, label: 'S' },
              ].map((t, i) => (
                <div key={i} className="flex flex-col items-center">
                  <div className={`w-10 h-10 md:w-14 md:h-14 rounded-lg flex items-center justify-center text-base md:text-2xl font-black ${isDark ? 'bg-white/5 border border-white/10 text-white' : 'bg-slate-100 border border-slate-200 text-slate-800'}`}
                    style={{ fontVariantNumeric: 'tabular-nums' }}>
                    {String(t.val).padStart(2, '0')}
                  </div>
                  <span className={`text-[0.625rem] mt-1 font-bold ${isDark ? 'text-slate-600' : 'text-slate-400'}`}>{t.label}</span>
                </div>
              ))}
            </div>
            <div className={`text-[0.75rem] mt-2 ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>
              Feb 11 Â· 7:30 PM ET Â· Scotiabank Arena
            </div>
          </div>

          {/* Right: Quick metrics */}
          <div className="flex flex-row md:flex-row gap-2 md:gap-3">
            {[
              { icon: 'ðŸ”¥', value: RAPTORS_STATS.streak, label: 'Streak', color: RAPTORS_STATS.streak.startsWith('W') ? 'text-green-400' : 'text-red-400' },
              { icon: 'ðŸ€', value: RAPTORS_STATS.ppg, label: 'PPG', color: isDark ? 'text-white' : 'text-slate-800' },
            ].map((s, i) => (
              <div key={i} className={`flex flex-col items-center px-3 py-2 rounded-xl ${isDark ? 'bg-white/5 border border-white/8' : 'bg-slate-50 border border-slate-200'}`}>
                <span className="text-base">{s.icon}</span>
                <span className={`text-lg font-black ${s.color}`}>{s.value}</span>
                <span className={`text-[0.625rem] uppercase tracking-wider font-bold ${isDark ? 'text-slate-600' : 'text-slate-400'}`}>{s.label}</span>
              </div>
            ))}
          </div>
        </div>
      </div>

      {/* Bottom gradient fade */}
      <div className={`absolute bottom-0 left-0 right-0 h-8 ${isDark ? 'bg-gradient-to-t from-[#0a0e17] to-transparent' : 'bg-gradient-to-t from-light-bg to-transparent'}`} />
    </div>
  );
};

// Quick Stats Dashboard (4 metric cards below hero)
const QuickStatsDashboard = ({ isDark = true }) => {
  const winPct = (RAPTORS_STATS.wins / (RAPTORS_STATS.wins + RAPTORS_STATS.losses)).toFixed(3);
  const cards = [
    { label: 'Win %', value: winPct, sub: `${RAPTORS_STATS.wins}W ${RAPTORS_STATS.losses}L`, gradient: 'from-[#CE1141] to-[#3E2680]' },
    { label: 'PPG', value: RAPTORS_STATS.ppg.toFixed(1), sub: `Opp: ${RAPTORS_STATS.oppPpg}`, gradient: 'from-[#CE1141] to-[#ff6b35]' },
    { label: 'Streak', value: RAPTORS_STATS.streak, sub: RAPTORS_STATS.streak.startsWith('W') ? 'ðŸ”¥ On Fire' : 'Bounce Back', gradient: 'from-[#3E2680] to-[#CE1141]' },
    { label: 'Games Back', value: '3.5', sub: 'From 1st (CLE)', gradient: 'from-[#3E2680] to-[#6b46c1]' },
  ];

  return (
    <div className="max-w-5xl mx-auto px-4 py-3">
      <div className="grid grid-cols-2 md:grid-cols-4 gap-3">
        {cards.map((c, i) => (
          <div key={i} className={`relative rounded-xl p-[1.5px] overflow-hidden group`} style={{background: `linear-gradient(135deg, ${c.gradient.includes('CE1141') ? '#CE1141' : '#3E2680'}, ${c.gradient.includes('3E2680') ? '#3E2680' : '#CE1141'})`}}>
            <div className={`rounded-[10px] px-4 py-3 h-full ${isDark ? 'bg-[#0a0e17]' : 'bg-white'} transition-all duration-300 group-hover:bg-opacity-90`}
              style={{ boxShadow: isDark ? '0 0 20px rgba(206,17,65,0.05)' : 'none' }}>
              <div className={`text-[0.75rem] uppercase tracking-wider font-bold ${isDark ? 'text-raptors-silver' : 'text-slate-500'}`}>{c.label}</div>
              <div className={`text-[1.5rem] font-black mt-0.5 ${isDark ? 'text-white' : 'text-slate-800'}`}>{c.value}</div>
              <div className={`text-[0.75rem] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{c.sub}</div>
            </div>
            {/* Hover glow */}
            <div className="absolute inset-0 rounded-xl opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none" style={{boxShadow: '0 0 25px rgba(206,17,65,0.15), inset 0 0 25px rgba(206,17,65,0.05)'}} />
          </div>
        ))}
      </div>
    </div>
  );
};

// Animated Number Counter
const AnimatedNumber = ({ value, duration = 2000, prefix = '', suffix = '', className = '' }) => {
  const [display, setDisplay] = useState(0);
  const ref = useRef(null);
  
  useEffect(() => {
    const observer = new IntersectionObserver((entries) => {
      if (entries[0].isIntersecting) {
        let start = 0;
        const end = parseFloat(value);
        const increment = end / (duration / 16);
        const timer = setInterval(() => {
          start += increment;
          if (start >= end) {
            setDisplay(end);
            clearInterval(timer);
          } else {
            setDisplay(start);
          }
        }, 16);
        observer.disconnect();
      }
    });
    if (ref.current) observer.observe(ref.current);
    return () => observer.disconnect();
  }, [value, duration]);
  
  return (
    <span ref={ref} className={className}>
      {prefix}{typeof value === 'number' ? display.toFixed(1) : value}{suffix}
    </span>
  );
};

// 3D Tilt Card Wrapper
const TiltCard = ({ children, className = '', isDark = true }) => {
  const cardRef = useRef(null);
  
  const handleMouseMove = (e) => {
    if (!cardRef.current) return;
    const rect = cardRef.current.getBoundingClientRect();
    const x = e.clientX - rect.left;
    const y = e.clientY - rect.top;
    const centerX = rect.width / 2;
    const centerY = rect.height / 2;
    const rotateX = (y - centerY) / 20;
    const rotateY = (centerX - x) / 20;
    cardRef.current.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg) scale(1.02)`;
  };
  
  const handleMouseLeave = () => {
    if (cardRef.current) {
      cardRef.current.style.transform = 'perspective(1000px) rotateX(0) rotateY(0) scale(1)';
    }
  };
  
  return (
    <div 
      ref={cardRef}
      className={`transition-transform duration-300 ${className}`}
      onMouseMove={handleMouseMove}
      onMouseLeave={handleMouseLeave}
    >
      {children}
    </div>
  );
};

// Animated Progress Ring
const ProgressRing = ({ progress, size = 80, strokeWidth = 8, color = '#CE1141', isDark = true }) => {
  const radius = (size - strokeWidth) / 2;
  const circumference = radius * 2 * Math.PI;
  const offset = circumference - (progress / 100) * circumference;
  
  return (
    <div className="relative inline-flex items-center justify-center">
      <svg width={size} height={size} className="transform -rotate-90">
        <circle
          cx={size / 2}
          cy={size / 2}
          r={radius}
          stroke={isDark ? '#1e293b' : '#e2e8f0'}
          strokeWidth={strokeWidth}
          fill="none"
        />
        <circle
          cx={size / 2}
          cy={size / 2}
          r={radius}
          stroke={color}
          strokeWidth={strokeWidth}
          fill="none"
          strokeLinecap="round"
          strokeDasharray={circumference}
          strokeDashoffset={offset}
          className="transition-all duration-1000 ease-out"
          style={{ filter: `drop-shadow(0 0 6px ${color})` }}
        />
      </svg>
      <div className="absolute inset-0 flex items-center justify-center">
        <span className={`text-lg font-black ${isDark ? 'text-white' : 'text-slate-800'}`}>{progress}%</span>
      </div>
    </div>
  );
};

// Glowing Badge
const GlowBadge = ({ children, color = 'red', pulse = false }) => {
  const colors = {
    red: 'bg-raptors-red text-white shadow-[0_0_15px_rgba(206,17,65,0.5)]',
    green: 'bg-green-500 text-white shadow-[0_0_15px_rgba(34,197,94,0.5)]',
    purple: 'bg-purple-500 text-white shadow-[0_0_15px_rgba(168,85,247,0.5)]',
    gold: 'bg-amber-500 text-black shadow-[0_0_15px_rgba(245,158,11,0.5)]'
  };
  
  return (
    <span className={`inline-flex items-center px-2 py-0.5 rounded-full text-[10px] font-bold ${colors[color]} ${pulse ? 'animate-pulse' : ''}`}>
      {children}
    </span>
  );
};

// Animated Blob Background
const AnimatedBlobs = ({ isDark = true }) => {
  if (!isDark) return null;
  
  return (
    <div className="fixed inset-0 overflow-hidden pointer-events-none z-0">
      <div className="blob-bg" style={{ top: '10%', left: '10%' }} />
      <div className="blob-bg" style={{ top: '60%', right: '10%', animationDelay: '-5s', background: 'radial-gradient(circle, rgba(62,38,128,0.12) 0%, transparent 70%)' }} />
      <div className="blob-bg" style={{ bottom: '10%', left: '30%', animationDelay: '-10s', width: '300px', height: '300px' }} />
    </div>
  );
};

// Scroll Reveal Wrapper
const ScrollReveal = ({ children, className = '' }) => {
  const ref = useRef(null);
  const [revealed, setRevealed] = useState(false);
  
  useEffect(() => {
    const observer = new IntersectionObserver(
      (entries) => {
        if (entries[0].isIntersecting) {
          setRevealed(true);
          observer.disconnect();
        }
      },
      { threshold: 0.1 }
    );
    if (ref.current) observer.observe(ref.current);
    return () => observer.disconnect();
  }, []);
  
  return (
    <div ref={ref} className={`scroll-reveal ${revealed ? 'revealed' : ''} ${className}`}>
      {children}
    </div>
  );
};

// Skeleton Loader
const SkeletonLoader = ({ width = '100%', height = '20px', rounded = 'md' }) => (
  <div 
    className={`skeleton rounded-${rounded}`} 
    style={{ width, height }}
  />
);

// Magnetic Button
const MagneticButton = ({ children, onClick, className = '', isDark = true }) => {
  const buttonRef = useRef(null);
  
  const handleMouseMove = (e) => {
    if (!buttonRef.current) return;
    const rect = buttonRef.current.getBoundingClientRect();
    const x = e.clientX - rect.left - rect.width / 2;
    const y = e.clientY - rect.top - rect.height / 2;
    buttonRef.current.style.transform = `translate(${x * 0.3}px, ${y * 0.3}px)`;
  };
  
  const handleMouseLeave = () => {
    if (buttonRef.current) {
      buttonRef.current.style.transform = 'translate(0, 0)';
    }
  };
  
  return (
    <button
      ref={buttonRef}
      onClick={onClick}
      onMouseMove={handleMouseMove}
      onMouseLeave={handleMouseLeave}
      className={`btn-magnetic transition-transform ${className}`}
    >
      {children}
    </button>
  );
};

// Spotlight Card
const SpotlightCard = ({ children, className = '', isDark = true }) => {
  const cardRef = useRef(null);
  
  const handleMouseMove = (e) => {
    if (!cardRef.current) return;
    const rect = cardRef.current.getBoundingClientRect();
    const x = ((e.clientX - rect.left) / rect.width) * 100;
    const y = ((e.clientY - rect.top) / rect.height) * 100;
    cardRef.current.style.setProperty('--mouse-x', `${x}%`);
    cardRef.current.style.setProperty('--mouse-y', `${y}%`);
  };
  
  return (
    <div 
      ref={cardRef}
      className={`spotlight ${className}`}
      onMouseMove={handleMouseMove}
    >
      {children}
    </div>
  );
};

// Animated List Item
const AnimatedListItem = ({ children, index = 0, className = '' }) => (
  <div 
    className={`stagger-item ${className}`}
    style={{ animationDelay: `${index * 0.08}s` }}
  >
    {children}
  </div>
);

// Glowing Number
const GlowingNumber = ({ value, size = 'lg', color = 'red', animate = false }) => {
  const sizeClasses = {
    sm: 'text-lg',
    md: 'text-2xl',
    lg: 'text-4xl',
    xl: 'text-6xl'
  };
  const colorClasses = {
    red: 'text-raptors-red text-glow',
    green: 'text-green-400',
    gold: 'text-amber-400',
    purple: 'text-purple-400'
  };
  
  return (
    <span className={`font-black ${sizeClasses[size]} ${colorClasses[color]} ${animate ? 'number-pop' : ''}`}>
      {value}
    </span>
  );
};

// Animated Stat Bar
const AnimatedStatBar = ({ value, max = 100, color = '#CE1141', label, showValue = true, delay = 0, isDark = true }) => {
  const pct = (value / max) * 100;
  
  return (
    <div className="space-y-1">
      {label && (
        <div className="flex justify-between text-[10px]">
          <span className={isDark ? 'text-slate-400' : 'text-slate-500'}>{label}</span>
          {showValue && <span className="font-bold" style={{ color }}>{value}</span>}
        </div>
      )}
      <div className={`h-2 rounded-full overflow-hidden ${isDark ? 'bg-cmd-border' : 'bg-light-border'}`}>
        <div 
          className="h-full rounded-full progress-fill"
          style={{ 
            width: `${pct}%`, 
            background: `linear-gradient(90deg, ${color}, ${color}88)`,
            animationDelay: `${delay}s`,
            boxShadow: `0 0 10px ${color}40`
          }}
        />
      </div>
    </div>
  );
};

// Flip Stat Card
const FlipStatCard = ({ front, back, isDark = true }) => (
  <div className="flip-card h-20">
    <div className="flip-card-inner relative w-full h-full">
      <div className={`flip-card-front absolute inset-0 ${isDark ? 'glass-card' : 'bg-white border border-light-border rounded-2xl'} p-3 flex items-center justify-center`}>
        {front}
      </div>
      <div className={`flip-card-back absolute inset-0 ${isDark ? 'glass-card' : 'bg-white border border-light-border rounded-2xl'} p-3 flex items-center justify-center`}>
        {back}
      </div>
    </div>
  </div>
);

// Premium Loading State
const PremiumLoader = ({ text = 'Loading...', isDark = true }) => (
  <div className="flex flex-col items-center justify-center gap-4 p-8">
    <div className="spinner-premium" />
    <div className={`text-sm ${isDark ? 'text-slate-400' : 'text-slate-500'} text-shimmer`}>{text}</div>
  </div>
);

// Animated Badge
const AnimatedBadge = ({ children, variant = 'default', pulse = false }) => {
  const variants = {
    default: 'bg-slate-500/20 text-slate-400',
    success: 'bg-green-500/20 text-green-400',
    warning: 'bg-amber-500/20 text-amber-400',
    danger: 'bg-red-500/20 text-red-400',
    info: 'bg-blue-500/20 text-blue-400',
    raptors: 'gradient-raptors text-white'
  };
  
  return (
    <span className={`inline-flex items-center px-2 py-0.5 rounded-full text-[10px] font-bold scale-in ${variants[variant]} ${pulse ? 'breathe' : ''}`}>
      {children}
    </span>
  );
};

// Circular Stat Gauge
const CircularGauge = ({ value, max = 100, size = 100, strokeWidth = 10, color = '#CE1141', label, isDark = true }) => {
  const radius = (size - strokeWidth) / 2;
  const circumference = radius * 2 * Math.PI;
  const pct = (value / max) * 100;
  const offset = circumference - (pct / 100) * circumference;
  
  return (
    <div className="relative inline-flex flex-col items-center">
      <svg width={size} height={size} className="transform -rotate-90">
        <circle
          cx={size / 2}
          cy={size / 2}
          r={radius}
          stroke={isDark ? '#1e293b' : '#e2e8f0'}
          strokeWidth={strokeWidth}
          fill="none"
        />
        <circle
          cx={size / 2}
          cy={size / 2}
          r={radius}
          stroke={`url(#gradient-${label})`}
          strokeWidth={strokeWidth}
          fill="none"
          strokeLinecap="round"
          strokeDasharray={circumference}
          strokeDashoffset={offset}
          className="transition-all duration-1000 ease-out"
          style={{ filter: `drop-shadow(0 0 8px ${color}60)` }}
        />
        <defs>
          <linearGradient id={`gradient-${label}`} x1="0%" y1="0%" x2="100%" y2="0%">
            <stop offset="0%" stopColor={color} />
            <stop offset="100%" stopColor={color + '99'} />
          </linearGradient>
        </defs>
      </svg>
      <div className="absolute inset-0 flex flex-col items-center justify-center">
        <span className={`text-xl font-black ${isDark ? 'text-white' : 'text-slate-800'}`}>{value}</span>
        {label && <span className={`text-[8px] ${isDark ? 'text-slate-500' : 'text-slate-400'} uppercase`}>{label}</span>}
      </div>
    </div>
  );
};

// Animated Comparison Bar
const ComparisonBar = ({ left, right, leftLabel, rightLabel, leftColor = '#CE1141', rightColor = '#3B82F6', isDark = true }) => {
  const total = left + right;
  const leftPct = (left / total) * 100;
  
  return (
    <div className="space-y-1">
      <div className="flex justify-between text-[10px]">
        <span style={{ color: leftColor }} className="font-bold">{leftLabel}: {left}</span>
        <span style={{ color: rightColor }} className="font-bold">{rightLabel}: {right}</span>
      </div>
      <div className={`h-3 rounded-full overflow-hidden flex ${isDark ? 'bg-cmd-border' : 'bg-light-border'}`}>
        <div 
          className="h-full progress-fill"
          style={{ 
            width: `${leftPct}%`, 
            background: `linear-gradient(90deg, ${leftColor}, ${leftColor}aa)`,
            boxShadow: `0 0 10px ${leftColor}40`
          }}
        />
        <div 
          className="h-full flex-1 progress-fill"
          style={{ 
            background: `linear-gradient(90deg, ${rightColor}aa, ${rightColor})`,
            boxShadow: `0 0 10px ${rightColor}40`,
            animationDelay: '0.2s'
          }}
        />
      </div>
    </div>
  );
};

// Stat Trend Indicator
const TrendIndicator = ({ value, previousValue, suffix = '' }) => {
  const diff = value - previousValue;
  const pctChange = ((diff / previousValue) * 100).toFixed(1);
  const isPositive = diff > 0;
  const isNeutral = diff === 0;
  
  return (
    <div className={`flex items-center gap-1 text-[10px] ${isNeutral ? 'text-slate-400' : isPositive ? 'text-green-400' : 'text-red-400'}`}>
      {!isNeutral && (
        <span className={isPositive ? 'rotate-0' : 'rotate-180'}>â–²</span>
      )}
      <span className="font-bold">
        {isPositive ? '+' : ''}{pctChange}%{suffix}
      </span>
    </div>
  );
};

// Animated Win/Loss Block
const WinLossBlock = ({ result, margin, opponent, date }) => {
  const isWin = result === 'W';
  
  return (
    <div className={`p-2 rounded-lg text-center transition-all hover:scale-105 cursor-pointer ${
      isWin ? 'bg-green-500/20 hover:bg-green-500/30' : 'bg-red-500/20 hover:bg-red-500/30'
    }`}>
      <div className={`text-lg font-black ${isWin ? 'text-green-400' : 'text-red-400'}`}>{result}</div>
      <div className={`text-[9px] ${isWin ? 'text-green-400/70' : 'text-red-400/70'}`}>
        {isWin ? '+' : ''}{margin}
      </div>
    </div>
  );
};

// Animated Pie Segment
const PieChart = ({ segments, size = 100, isDark = true }) => {
  let cumulativePercent = 0;
  
  const getCoordinatesForPercent = (percent) => {
    const x = Math.cos(2 * Math.PI * percent);
    const y = Math.sin(2 * Math.PI * percent);
    return [x, y];
  };
  
  return (
    <svg width={size} height={size} viewBox="-1 -1 2 2" style={{ transform: 'rotate(-90deg)' }}>
      {segments.map((segment, i) => {
        const [startX, startY] = getCoordinatesForPercent(cumulativePercent);
        cumulativePercent += segment.percent / 100;
        const [endX, endY] = getCoordinatesForPercent(cumulativePercent);
        const largeArcFlag = segment.percent > 50 ? 1 : 0;
        const pathData = `M ${startX} ${startY} A 1 1 0 ${largeArcFlag} 1 ${endX} ${endY} L 0 0`;
        
        return (
          <path 
            key={i} 
            d={pathData} 
            fill={segment.color}
            className="transition-all hover:opacity-80"
            style={{ filter: `drop-shadow(0 0 4px ${segment.color}40)` }}
          />
        );
      })}
    </svg>
  );
};

// Hover Card with Preview
const HoverPreviewCard = ({ trigger, children, isDark = true }) => {
  const [isHovered, setIsHovered] = useState(false);
  
  return (
    <div 
      className="relative"
      onMouseEnter={() => setIsHovered(true)}
      onMouseLeave={() => setIsHovered(false)}
    >
      {trigger}
      {isHovered && (
        <div className={`absolute z-50 top-full left-1/2 transform -translate-x-1/2 mt-2 p-3 rounded-xl scale-in ${isDark ? 'glass-premium' : 'bg-white shadow-xl border border-light-border'}`}>
          {children}
        </div>
      )}
    </div>
  );
};

// Animated Rank Position
const RankPosition = ({ rank, total = 30, label = 'Rank', isDark = true }) => {
  const pct = ((total - rank + 1) / total) * 100;
  const color = rank <= 10 ? '#22c55e' : rank <= 20 ? '#eab308' : '#ef4444';
  
  return (
    <div className={`p-3 rounded-xl ${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg'}`}>
      <div className="flex items-center justify-between mb-2">
        <span className={`text-[10px] ${isDark ? 'text-slate-400' : 'text-slate-500'} uppercase`}>{label}</span>
        <span className="text-2xl font-black" style={{ color }}>#{rank}</span>
      </div>
      <div className={`h-1.5 rounded-full overflow-hidden ${isDark ? 'bg-cmd-border' : 'bg-light-border'}`}>
        <div 
          className="h-full rounded-full progress-fill"
          style={{ width: `${pct}%`, background: color }}
        />
      </div>
    </div>
  );
};

// Countdown Timer with Style
const StyledCountdown = ({ targetDate, label, isDark = true }) => {
  const [time, setTime] = useState({ d: 0, h: 0, m: 0, s: 0 });
  
  useEffect(() => {
    const calc = () => {
      const diff = new Date(targetDate) - new Date();
      if (diff <= 0) return;
      setTime({
        d: Math.floor(diff / (1000 * 60 * 60 * 24)),
        h: Math.floor((diff / (1000 * 60 * 60)) % 24),
        m: Math.floor((diff / (1000 * 60)) % 60),
        s: Math.floor((diff / 1000) % 60)
      });
    };
    calc();
    const interval = setInterval(calc, 1000);
    return () => clearInterval(interval);
  }, [targetDate]);
  
  const TimeBlock = ({ value, unit }) => (
    <div className={`flex flex-col items-center p-2 rounded-lg ${isDark ? 'glass-premium' : 'bg-light-card'}`}>
      <span className="text-xl font-black gradient-text">{String(value).padStart(2, '0')}</span>
      <span className={`text-[8px] uppercase ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{unit}</span>
    </div>
  );
  
  return (
    <div className="space-y-2">
      {label && <div className={`text-center text-xs ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>{label}</div>}
      <div className="flex justify-center gap-2">
        <TimeBlock value={time.d} unit="days" />
        <TimeBlock value={time.h} unit="hrs" />
        <TimeBlock value={time.m} unit="min" />
        <TimeBlock value={time.s} unit="sec" />
      </div>
    </div>
  );
};

// Interactive Toggle Switch
const ToggleSwitch = ({ checked, onChange, label, isDark = true }) => (
  <label className="flex items-center gap-2 cursor-pointer">
    <div className="relative">
      <input type="checkbox" className="sr-only" checked={checked} onChange={onChange} />
      <div className={`w-10 h-5 rounded-full transition-colors ${checked ? 'gradient-raptors' : isDark ? 'bg-cmd-border' : 'bg-light-border'}`}>
        <div className={`absolute w-4 h-4 bg-white rounded-full top-0.5 transition-transform ${checked ? 'translate-x-5' : 'translate-x-0.5'}`} 
          style={{ boxShadow: checked ? '0 0 8px rgba(206,17,65,0.5)' : 'none' }}
        />
      </div>
    </div>
    {label && <span className={`text-xs ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>{label}</span>}
  </label>
);

// Floating Action Button
const FloatingButton = ({ icon, onClick, isDark = true }) => (
  <button
    onClick={onClick}
    className={`fixed bottom-20 right-4 lg:bottom-8 lg:right-8 w-14 h-14 rounded-full flex items-center justify-center z-40 transition-all hover:scale-110 elastic ${
      isDark 
        ? 'gradient-raptors shadow-lg shadow-raptors-red/30' 
        : 'bg-raptors-red shadow-lg shadow-raptors-red/30'
    }`}
  >
    <span className="text-white text-2xl">{icon}</span>
  </button>
);

// Stat Comparison Card
const StatComparisonCard = ({ stat1, stat2, label, isDark = true }) => (
  <div className={`p-3 rounded-xl ${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg'}`}>
    <div className={`text-center text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'} uppercase mb-2`}>{label}</div>
    <div className="flex items-center justify-center gap-4">
      <div className="text-center">
        <div className="text-xl font-black text-raptors-red">{stat1.value}</div>
        <div className={`text-[8px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{stat1.label}</div>
      </div>
      <div className={`text-xs ${isDark ? 'text-slate-600' : 'text-slate-300'}`}>vs</div>
      <div className="text-center">
        <div className={`text-xl font-black ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>{stat2.value}</div>
        <div className={`text-[8px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{stat2.label}</div>
      </div>
    </div>
  </div>
);

// Animated Icon
const AnimatedIcon = ({ icon: Icon, className = '', animate = 'none' }) => {
  const animations = {
    none: '',
    bounce: 'icon-bounce',
    pulse: 'animate-pulse',
    spin: 'animate-spin',
    float: 'float-subtle'
  };
  
  return <Icon className={`${className} ${animations[animate]}`} />;
};

// Quick Action Button
const QuickActionButton = ({ icon, label, onClick, isDark = true, active = false }) => (
  <button
    onClick={onClick}
    className={`flex flex-col items-center gap-1 p-3 rounded-xl transition-all hover:scale-105 ${
      active 
        ? 'gradient-raptors text-white' 
        : isDark 
          ? 'glass-card hover:bg-cmd-card text-slate-400 hover:text-white' 
          : 'bg-light-card hover:bg-slate-200 text-slate-500 hover:text-slate-800'
    }`}
  >
    <span className="text-xl">{icon}</span>
    <span className="text-[9px] font-medium">{label}</span>
  </button>
);

// Section Divider
const SectionDivider = ({ label, isDark = true }) => (
  <div className="flex items-center gap-3 my-4">
    <div className={`flex-1 h-px ${isDark ? 'bg-gradient-to-r from-transparent via-cmd-border to-transparent' : 'bg-gradient-to-r from-transparent via-light-border to-transparent'}`} />
    {label && (
      <span className={`text-[10px] font-bold uppercase tracking-widest ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{label}</span>
    )}
    <div className={`flex-1 h-px ${isDark ? 'bg-gradient-to-r from-transparent via-cmd-border to-transparent' : 'bg-gradient-to-r from-transparent via-light-border to-transparent'}`} />
  </div>
);

// ============================================================
// v9.0 MILESTONE - PREMIUM FEATURES
// ============================================================

// Animated Header with Typing Effect
const TypewriterTitle = ({ text, isDark = true }) => {
  const [displayText, setDisplayText] = useState('');
  const [index, setIndex] = useState(0);
  
  useEffect(() => {
    if (index < text.length) {
      const timeout = setTimeout(() => {
        setDisplayText(prev => prev + text[index]);
        setIndex(prev => prev + 1);
      }, 80);
      return () => clearTimeout(timeout);
    }
  }, [index, text]);
  
  return (
    <span className={`font-black ${isDark ? 'text-white' : 'text-slate-800'}`}>
      {displayText}
      <span className="animate-pulse text-raptors-red">|</span>
    </span>
  );
};

// Score Prediction Slider
const ScoreSlider = ({ min = 90, max = 130, value, onChange, team, isDark = true }) => (
  <div className="space-y-2">
    <div className="flex justify-between text-[10px]">
      <span className={isDark ? 'text-slate-400' : 'text-slate-500'}>{team}</span>
      <span className="font-bold text-raptors-red">{value}</span>
    </div>
    <input
      type="range"
      min={min}
      max={max}
      value={value}
      onChange={(e) => onChange(Number(e.target.value))}
      className="w-full h-2 rounded-full appearance-none cursor-pointer"
      style={{
        background: `linear-gradient(to right, #CE1141 0%, #CE1141 ${((value - min) / (max - min)) * 100}%, ${isDark ? '#1e293b' : '#e2e8f0'} ${((value - min) / (max - min)) * 100}%, ${isDark ? '#1e293b' : '#e2e8f0'} 100%)`
      }}
    />
  </div>
);

// Interactive Score Predictor Widget
const ScorePredictorWidget = ({ isDark = true, opponent }) => {
  const [raptorsScore, setRaptorsScore] = useState(112);
  const [oppScore, setOppScore] = useState(108);
  const [submitted, setSubmitted] = useState(false);
  
  if (!opponent) return null;
  
  return (
    <div className={`${isDark ? 'glass-card border-gradient-animated' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-4">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Brain className="w-3 h-3 text-purple-400" /> Make Your Prediction
        </h3>
        {submitted && <span className="text-[9px] text-green-400">âœ“ Saved</span>}
      </div>
      
      <div className="space-y-4">
        <ScoreSlider team="Raptors" value={raptorsScore} onChange={setRaptorsScore} isDark={isDark} />
        <ScoreSlider team={opponent} value={oppScore} onChange={setOppScore} isDark={isDark} />
      </div>
      
      <div className="mt-4 text-center">
        <div className={`text-lg font-black ${raptorsScore > oppScore ? 'text-green-400' : 'text-red-400'}`}>
          {raptorsScore} - {oppScore}
        </div>
        <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>
          {raptorsScore > oppScore ? 'Raptors Win! ðŸ¦–' : 'Raptors Lose ðŸ˜¢'}
        </div>
      </div>
      
      <button
        onClick={() => setSubmitted(true)}
        className={`w-full mt-3 py-2 rounded-lg text-xs font-bold transition-all btn-ripple ${
          submitted 
            ? 'bg-green-500/20 text-green-400 border border-green-500/30' 
            : 'gradient-raptors text-white hover:opacity-90'
        }`}
      >
        {submitted ? 'âœ“ Prediction Saved' : 'Lock It In'}
      </button>
    </div>
  );
};

// Animated Trophy Room
const TrophyRoom = ({ isDark = true }) => {
  const trophies = [
    { year: '2019', icon: 'ðŸ†', label: 'NBA Champions' },
    { year: '2016', icon: 'ðŸ¥ˆ', label: 'Conference Finals' },
    { year: '2024', icon: 'â­', label: 'Scottie All-Star' }
  ];
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Trophy className="w-3 h-3 text-amber-400" /> Trophy Room
        </h3>
      </div>
      
      <div className="flex justify-center gap-3">
        {trophies.map((t, i) => (
          <div 
            key={i} 
            className={`p-3 rounded-xl text-center transition-all hover:scale-110 cursor-pointer stagger-item ${
              isDark ? 'bg-amber-500/10 hover:bg-amber-500/20' : 'bg-amber-500/5 hover:bg-amber-500/10'
            }`}
            style={{ animationDelay: `${i * 0.1}s` }}
          >
            <div className="text-2xl mb-1 float-subtle">{t.icon}</div>
            <div className={`text-[9px] font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{t.year}</div>
            <div className={`text-[8px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{t.label}</div>
          </div>
        ))}
      </div>
    </div>
  );
};

// Animated Heat Map (simulated)
const MiniHeatMap = ({ isDark = true }) => {
  const zones = [
    { area: 'Paint', pct: 58.2, makes: 24, attempts: 41 },
    { area: 'Mid-Range', pct: 42.5, makes: 8, attempts: 19 },
    { area: 'Corner 3', pct: 38.2, makes: 5, attempts: 13 },
    { area: 'Above Break', pct: 33.8, makes: 9, attempts: 27 }
  ];
  
  const getColor = (pct) => {
    if (pct >= 50) return 'bg-green-500';
    if (pct >= 40) return 'bg-yellow-500';
    return 'bg-red-500';
  };
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Target className="w-3 h-3 text-orange-400" /> Shot Zones
        </h3>
      </div>
      
      <div className="grid grid-cols-2 gap-2">
        {zones.map((z, i) => (
          <div 
            key={i} 
            className={`p-2 rounded-lg text-center ${isDark ? 'bg-cmd-bg' : 'bg-light-card'} stagger-item`}
            style={{ animationDelay: `${i * 0.1}s` }}
          >
            <div className="flex items-center justify-center gap-1 mb-1">
              <div className={`w-2 h-2 rounded-full ${getColor(z.pct)}`} />
              <span className={`text-[10px] font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{z.pct}%</span>
            </div>
            <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{z.area}</div>
            <div className={`text-[8px] ${isDark ? 'text-slate-600' : 'text-slate-400'}`}>{z.makes}/{z.attempts}</div>
          </div>
        ))}
      </div>
    </div>
  );
};

// ============================================================
// SHOT CHART VISUALIZATION - Half-court SVG with zone shooting %
// ============================================================
const ShotChartWidget = ({ isDark = true }) => {
  const [hoveredZone, setHoveredZone] = useState(null);
  const shotZones = [
    { id: 'paint', label: 'Paint', pct: 62.4, makes: 412, attempts: 660, x: 150, y: 155, leagueAvg: 58.0 },
    { id: 'midLeft', label: 'Mid-Range Left', pct: 41.8, makes: 89, attempts: 213, x: 60, y: 110, leagueAvg: 40.5 },
    { id: 'midRight', label: 'Mid-Range Right', pct: 43.1, makes: 93, attempts: 216, x: 240, y: 110, leagueAvg: 40.5 },
    { id: 'midTop', label: 'Mid-Range Top', pct: 42.0, makes: 76, attempts: 181, x: 150, y: 60, leagueAvg: 40.5 },
    { id: 'corner3L', label: 'Corner 3 Left', pct: 38.7, makes: 65, attempts: 168, x: 18, y: 170, leagueAvg: 37.0 },
    { id: 'corner3R', label: 'Corner 3 Right', pct: 37.9, makes: 61, attempts: 161, x: 282, y: 170, leagueAvg: 37.0 },
    { id: 'three3L', label: '3PT Wing Left', pct: 35.8, makes: 98, attempts: 274, x: 35, y: 55, leagueAvg: 35.5 },
    { id: 'three3R', label: '3PT Wing Right', pct: 36.4, makes: 102, attempts: 280, x: 265, y: 55, leagueAvg: 35.5 },
    { id: 'threeTop', label: '3PT Top of Key', pct: 36.1, makes: 115, attempts: 318, x: 150, y: 15, leagueAvg: 35.5 }
  ];

  const getZoneColor = (pct, leagueAvg) => {
    const diff = pct - leagueAvg;
    if (diff >= 4) return { fill: 'rgba(239,68,68,0.85)', stroke: '#ef4444', label: 'ðŸ”¥' };
    if (diff >= 1.5) return { fill: 'rgba(251,146,60,0.75)', stroke: '#fb923c', label: 'ðŸŸ ' };
    if (diff >= -1.5) return { fill: 'rgba(250,204,21,0.65)', stroke: '#facc15', label: 'ðŸŸ¡' };
    if (diff >= -4) return { fill: 'rgba(96,165,250,0.7)', stroke: '#60a5fa', label: 'ðŸ”µ' };
    return { fill: 'rgba(59,130,246,0.85)', stroke: '#3b82f6', label: 'â„ï¸' };
  };

  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Target className="w-3.5 h-3.5 text-orange-400" /> Shot Chart
        </h3>
        <span className={`text-[8px] px-1.5 py-0.5 rounded ${isDark ? 'bg-cmd-bg text-slate-400' : 'bg-light-card text-slate-500'}`}>vs League Avg</span>
      </div>

      <div className="relative flex justify-center">
        <svg viewBox="0 0 300 200" className="w-full max-w-[300px]" style={{ filter: isDark ? 'drop-shadow(0 0 8px rgba(206,17,65,0.1))' : 'none' }}>
          {/* Half Court */}
          <rect x="5" y="5" width="290" height="190" rx="2" fill={isDark ? '#111827' : '#f8fafc'} stroke={isDark ? '#334155' : '#cbd5e1'} strokeWidth="1.5"/>
          {/* 3-point arc */}
          <path d="M 30 195 L 30 135 Q 30 20 150 15 Q 270 20 270 135 L 270 195" fill="none" stroke={isDark ? '#334155' : '#cbd5e1'} strokeWidth="1" strokeDasharray="4,3"/>
          {/* Paint / Key */}
          <rect x="100" y="120" width="100" height="75" rx="1" fill="none" stroke={isDark ? '#475569' : '#94a3b8'} strokeWidth="1"/>
          {/* Free throw circle */}
          <circle cx="150" cy="120" r="30" fill="none" stroke={isDark ? '#475569' : '#94a3b8'} strokeWidth="0.8" strokeDasharray="3,3"/>
          {/* Basket */}
          <circle cx="150" cy="185" r="4" fill="none" stroke={isDark ? '#f97316' : '#ea580c'} strokeWidth="1.5"/>
          <line x1="140" y1="192" x2="160" y2="192" stroke={isDark ? '#f97316' : '#ea580c'} strokeWidth="1.5"/>
          {/* Restricted area */}
          <path d="M 135 195 Q 135 170 150 168 Q 165 170 165 195" fill="none" stroke={isDark ? '#475569' : '#94a3b8'} strokeWidth="0.8"/>

          {/* Shot zone circles */}
          {shotZones.map((zone) => {
            const colors = getZoneColor(zone.pct, zone.leagueAvg);
            const isHovered = hoveredZone === zone.id;
            const r = isHovered ? 18 : 14;
            return (
              <g key={zone.id} 
                 onMouseEnter={() => setHoveredZone(zone.id)} 
                 onMouseLeave={() => setHoveredZone(null)}
                 style={{ cursor: 'pointer' }}>
                <circle cx={zone.x} cy={zone.y} r={r} fill={colors.fill} stroke={colors.stroke} strokeWidth={isHovered ? 2 : 1} style={{ transition: 'r 0.2s, stroke-width 0.2s' }}/>
                <text x={zone.x} y={zone.y + 1} textAnchor="middle" dominantBaseline="middle" fill="white" fontSize={isHovered ? "9" : "8"} fontWeight="800" style={{ textShadow: '0 1px 2px rgba(0,0,0,0.8)' }}>
                  {zone.pct}%
                </text>
              </g>
            );
          })}
        </svg>
      </div>

      {/* Hover tooltip */}
      {hoveredZone && (() => {
        const zone = shotZones.find(z => z.id === hoveredZone);
        const diff = (zone.pct - zone.leagueAvg).toFixed(1);
        return (
          <div className={`mt-2 p-2 rounded-lg text-center ${isDark ? 'bg-cmd-bg' : 'bg-light-card'} animate-fade-in`}>
            <div className={`text-[10px] font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{zone.label}</div>
            <div className={`text-[9px] ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>
              {zone.makes}/{zone.attempts} â€¢ 
              <span className={parseFloat(diff) > 0 ? 'text-green-400' : 'text-red-400'}> {diff > 0 ? '+' : ''}{diff}% vs avg</span>
            </div>
          </div>
        );
      })()}

      {/* Legend */}
      <div className="flex items-center justify-center gap-3 mt-2">
        {[{l:'Hot', c:'bg-red-500'},{l:'Warm', c:'bg-orange-400'},{l:'Avg', c:'bg-yellow-400'},{l:'Cool', c:'bg-blue-400'},{l:'Cold', c:'bg-blue-600'}].map((item,i) => (
          <div key={i} className="flex items-center gap-1">
            <div className={`w-2 h-2 rounded-full ${item.c}`}/>
            <span className={`text-[7px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{item.l}</span>
          </div>
        ))}
      </div>
    </div>
  );
};

// ============================================================
// PACE & EFFICIENCY SCATTER CHART - ORtg vs DRtg all teams
// ============================================================
const PaceEfficiencyWidget = ({ isDark = true }) => {
  const [hoveredTeam, setHoveredTeam] = useState(null);
  const teams = [
    { abbr: 'BOS', ortg: 120.1, drtg: 110.2, color: '#007A33' },
    { abbr: 'OKC', ortg: 118.5, drtg: 108.8, color: '#007AC1' },
    { abbr: 'CLE', ortg: 116.8, drtg: 107.5, color: '#860038' },
    { abbr: 'DEN', ortg: 117.2, drtg: 112.5, color: '#0E2240' },
    { abbr: 'NYK', ortg: 115.8, drtg: 111.0, color: '#006BB6' },
    { abbr: 'MIL', ortg: 116.0, drtg: 112.8, color: '#00471B' },
    { abbr: 'TOR', ortg: 114.2, drtg: 111.8, color: '#CE1141' },
    { abbr: 'MIA', ortg: 112.5, drtg: 110.5, color: '#98002E' },
    { abbr: 'LAL', ortg: 113.8, drtg: 113.2, color: '#552583' },
    { abbr: 'PHX', ortg: 115.0, drtg: 114.0, color: '#1D1160' },
    { abbr: 'MIN', ortg: 112.0, drtg: 108.5, color: '#0C2340' },
    { abbr: 'DAL', ortg: 116.5, drtg: 113.8, color: '#00538C' },
    { abbr: 'PHI', ortg: 113.0, drtg: 112.0, color: '#006BB6' },
    { abbr: 'IND', ortg: 117.5, drtg: 115.5, color: '#002D62' },
    { abbr: 'SAC', ortg: 114.5, drtg: 114.8, color: '#5A2D81' },
    { abbr: 'GSW', ortg: 113.2, drtg: 113.0, color: '#1D428A' },
    { abbr: 'HOU', ortg: 112.8, drtg: 111.5, color: '#CE1141' },
    { abbr: 'MEM', ortg: 111.5, drtg: 112.8, color: '#5D76A9' },
    { abbr: 'ATL', ortg: 114.8, drtg: 116.0, color: '#E03A3E' },
    { abbr: 'CHI', ortg: 110.5, drtg: 113.5, color: '#CE1141' },
    { abbr: 'ORL', ortg: 110.8, drtg: 109.8, color: '#0077C0' },
    { abbr: 'NOP', ortg: 111.0, drtg: 114.5, color: '#0C2340' },
    { abbr: 'SAS', ortg: 109.5, drtg: 115.8, color: '#C4CED4' },
    { abbr: 'POR', ortg: 108.8, drtg: 116.5, color: '#E03A3E' },
    { abbr: 'CHA', ortg: 108.0, drtg: 117.0, color: '#1D1160' },
    { abbr: 'DET', ortg: 107.5, drtg: 116.0, color: '#C8102E' },
    { abbr: 'WAS', ortg: 107.0, drtg: 118.5, color: '#002B5C' },
    { abbr: 'UTA', ortg: 109.0, drtg: 115.0, color: '#002B5C' },
    { abbr: 'BKN', ortg: 108.5, drtg: 116.8, color: '#000000' },
    { abbr: 'LAC', ortg: 112.2, drtg: 112.5, color: '#C8102E' }
  ];

  // Chart dimensions
  const W = 280, H = 200, pad = 28;
  const ortgMin = 105, ortgMax = 122, drtgMin = 106, drtgMax = 120;
  const midOrtg = (ortgMin + ortgMax) / 2, midDrtg = (drtgMin + drtgMax) / 2;
  const scaleX = (ortg) => pad + ((ortg - ortgMin) / (ortgMax - ortgMin)) * (W - pad * 2);
  const scaleY = (drtg) => pad + ((drtg - drtgMin) / (drtgMax - drtgMin)) * (H - pad * 2);

  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-2">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <BarChart3 className="w-3.5 h-3.5 text-cyan-400" /> Pace & Efficiency
        </h3>
        <span className={`text-[8px] px-1.5 py-0.5 rounded ${isDark ? 'bg-cmd-bg text-slate-400' : 'bg-light-card text-slate-500'}`}>ORtg vs DRtg</span>
      </div>

      <div className="relative flex justify-center">
        <svg viewBox={`0 0 ${W} ${H}`} className="w-full">
          {/* Quadrant backgrounds */}
          <rect x={scaleX(midOrtg)} y={pad} width={scaleX(ortgMax)-scaleX(midOrtg)} height={scaleY(midDrtg)-pad} fill={isDark ? 'rgba(34,197,94,0.06)' : 'rgba(34,197,94,0.08)'} />
          <rect x={pad} y={pad} width={scaleX(midOrtg)-pad} height={scaleY(midDrtg)-pad} fill={isDark ? 'rgba(96,165,250,0.05)' : 'rgba(96,165,250,0.06)'} />
          <rect x={scaleX(midOrtg)} y={scaleY(midDrtg)} width={scaleX(ortgMax)-scaleX(midOrtg)} height={scaleY(drtgMax)-scaleY(midDrtg)} fill={isDark ? 'rgba(251,146,60,0.05)' : 'rgba(251,146,60,0.06)'} />
          <rect x={pad} y={scaleY(midDrtg)} width={scaleX(midOrtg)-pad} height={scaleY(drtgMax)-scaleY(midDrtg)} fill={isDark ? 'rgba(239,68,68,0.05)' : 'rgba(239,68,68,0.06)'} />

          {/* Quadrant labels */}
          <text x={scaleX(ortgMax)-4} y={pad+10} textAnchor="end" fontSize="6" fill={isDark ? '#4ade80' : '#16a34a'} fontWeight="700">ELITE</text>
          <text x={pad+4} y={pad+10} textAnchor="start" fontSize="6" fill={isDark ? '#60a5fa' : '#2563eb'} fontWeight="700">DEF-FIRST</text>
          <text x={scaleX(ortgMax)-4} y={scaleY(drtgMax)-4} textAnchor="end" fontSize="6" fill={isDark ? '#fb923c' : '#ea580c'} fontWeight="700">OFF-FIRST</text>
          <text x={pad+4} y={scaleY(drtgMax)-4} textAnchor="start" fontSize="6" fill={isDark ? '#f87171' : '#dc2626'} fontWeight="700">BELOW AVG</text>

          {/* Midlines */}
          <line x1={scaleX(midOrtg)} y1={pad} x2={scaleX(midOrtg)} y2={scaleY(drtgMax)} stroke={isDark ? '#334155' : '#cbd5e1'} strokeWidth="0.5" strokeDasharray="3,3"/>
          <line x1={pad} y1={scaleY(midDrtg)} x2={scaleX(ortgMax)} y2={scaleY(midDrtg)} stroke={isDark ? '#334155' : '#cbd5e1'} strokeWidth="0.5" strokeDasharray="3,3"/>

          {/* Axes labels */}
          <text x={W/2} y={H-2} textAnchor="middle" fontSize="6" fill={isDark ? '#64748b' : '#94a3b8'}>Offensive Rating â†’</text>
          <text x={6} y={H/2} textAnchor="middle" fontSize="6" fill={isDark ? '#64748b' : '#94a3b8'} transform={`rotate(-90, 6, ${H/2})`}>â† Better Defense</text>

          {/* Team dots */}
          {teams.map((t) => {
            const isTor = t.abbr === 'TOR';
            const isHov = hoveredTeam === t.abbr;
            return (
              <g key={t.abbr} onMouseEnter={() => setHoveredTeam(t.abbr)} onMouseLeave={() => setHoveredTeam(null)} style={{ cursor: 'pointer' }}>
                {isTor && <circle cx={scaleX(t.ortg)} cy={scaleY(t.drtg)} r="10" fill="none" stroke="#CE1141" strokeWidth="1" strokeDasharray="2,2" opacity="0.5" style={{ animation: 'pulse-ring-expand 2s ease-out infinite' }}/>}
                <circle cx={scaleX(t.ortg)} cy={scaleY(t.drtg)} r={isTor ? 5 : isHov ? 4.5 : 3} fill={isTor ? '#CE1141' : (t.color || (isDark ? '#64748b' : '#94a3b8'))} stroke={isTor ? '#fff' : 'none'} strokeWidth={isTor ? 1 : 0} opacity={isTor ? 1 : isHov ? 1 : 0.6}/>
                {(isTor || isHov) && <text x={scaleX(t.ortg)} y={scaleY(t.drtg) - (isTor ? 8 : 7)} textAnchor="middle" fontSize={isTor ? "7" : "6"} fill={isTor ? '#CE1141' : (isDark ? '#e2e8f0' : '#334155')} fontWeight="800">{t.abbr}</text>}
              </g>
            );
          })}
        </svg>
      </div>

      {hoveredTeam && (() => {
        const t = teams.find(x => x.abbr === hoveredTeam);
        return (
          <div className={`mt-1 p-1.5 rounded text-center ${isDark ? 'bg-cmd-bg' : 'bg-light-card'} animate-fade-in`}>
            <span className={`text-[10px] font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{t.abbr}</span>
            <span className={`text-[9px] ${isDark ? 'text-slate-400' : 'text-slate-500'} ml-2`}>ORtg: {t.ortg} | DRtg: {t.drtg} | Net: {(t.ortg - t.drtg).toFixed(1)}</span>
          </div>
        );
      })()}
    </div>
  );
};

// ============================================================
// INTERACTIVE ROSTER GRID - Formation-style layout with depth chart
// ============================================================
const InteractiveRosterGrid = ({ isDark = true }) => {
  const [selectedPos, setSelectedPos] = useState(null);
  const depthChart = {
    PG: { starters: ['Immanuel Quickley'], bench: ['Davion Mitchell', 'Jamal Shead'] },
    SG: { starters: ['Gradey Dick'], bench: ['Bruce Brown', 'Ochai Agbaji'] },
    SF: { starters: ['RJ Barrett'], bench: ['Kelly Olynyk', 'Garrett Temple'] },
    PF: { starters: ['Scottie Barnes'], bench: ['Chris Boucher', 'Collin Murray-Boyles'] },
    C:  { starters: ['Jakob Poeltl'], bench: ['Kelly Olynyk', 'Bruno Fernando'] }
  };
  const posStats = {
    PG: { ppg: 15.2, apg: 6.8 }, SG: { ppg: 14.8, apg: 2.5 },
    SF: { ppg: 21.3, apg: 4.2 }, PF: { ppg: 22.8, apg: 6.1 },
    C:  { ppg: 14.5, rpg: 10.8 }
  };
  // Formation positions (basketball court style - PG at top, C near basket)
  const positions = [
    { pos: 'PG', x: '50%', y: '12%' },
    { pos: 'SG', x: '80%', y: '30%' },
    { pos: 'SF', x: '20%', y: '30%' },
    { pos: 'PF', x: '30%', y: '58%' },
    { pos: 'C',  x: '70%', y: '58%' }
  ];
  const posColors = { PG: '#60a5fa', SG: '#f472b6', SF: '#4ade80', PF: '#fb923c', C: '#a78bfa' };

  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Users className="w-3.5 h-3.5 text-raptors-red" /> Roster Formation
        </h3>
        {selectedPos && <button onClick={() => setSelectedPos(null)} className="text-[8px] text-raptors-red font-bold">âœ• CLOSE</button>}
      </div>

      {!selectedPos ? (
        <div className="relative" style={{ height: '180px' }}>
          {/* Mini court background */}
          <div className={`absolute inset-0 rounded-lg ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`} style={{ opacity: 0.5 }}>
            <svg viewBox="0 0 200 150" className="w-full h-full" preserveAspectRatio="xMidYMid meet">
              <ellipse cx="100" cy="130" rx="40" ry="20" fill="none" stroke={isDark ? '#1e293b' : '#e2e8f0'} strokeWidth="1"/>
              <rect x="60" y="100" width="80" height="50" fill="none" stroke={isDark ? '#1e293b' : '#e2e8f0'} strokeWidth="0.8"/>
              <path d="M 20 150 Q 20 10 100 5 Q 180 10 180 150" fill="none" stroke={isDark ? '#1e293b' : '#e2e8f0'} strokeWidth="0.6" strokeDasharray="4,4"/>
            </svg>
          </div>

          {positions.map(({ pos, x, y }) => (
            <button key={pos} onClick={() => setSelectedPos(pos)} className="absolute transform -translate-x-1/2 -translate-y-1/2 group" style={{ left: x, top: y }}>
              <div className={`w-11 h-11 rounded-full flex flex-col items-center justify-center border-2 transition-all group-hover:scale-110 ${isDark ? 'bg-cmd-surface' : 'bg-white'}`}
                   style={{ borderColor: posColors[pos], boxShadow: `0 0 12px ${posColors[pos]}33` }}>
                <span className="text-[9px] font-black" style={{ color: posColors[pos] }}>{pos}</span>
                <span className={`text-[7px] font-medium ${isDark ? 'text-slate-400' : 'text-slate-500'} truncate max-w-[36px]`}>{depthChart[pos].starters[0].split(' ').pop()}</span>
              </div>
            </button>
          ))}
        </div>
      ) : (
        <div className="animate-fade-in">
          <div className="flex items-center gap-2 mb-2">
            <div className="w-6 h-6 rounded-full flex items-center justify-center text-[9px] font-black text-white" style={{ background: posColors[selectedPos] }}>{selectedPos}</div>
            <span className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>Depth Chart</span>
          </div>
          {/* Starter */}
          <div className={`p-2.5 rounded-lg mb-1.5 border ${isDark ? 'bg-cmd-bg border-cmd-border' : 'bg-light-card border-light-border'}`}>
            <div className="flex items-center justify-between">
              <div>
                <span className={`text-[8px] font-bold uppercase px-1 py-0.5 rounded ${isDark ? 'bg-green-500/20 text-green-400' : 'bg-green-100 text-green-700'}`}>STARTER</span>
                <div className={`text-xs font-bold mt-1 ${isDark ? 'text-white' : 'text-slate-800'}`}>{depthChart[selectedPos].starters[0]}</div>
              </div>
              <div className="text-right">
                <div className={`text-sm font-black ${isDark ? 'text-white' : 'text-slate-800'}`}>{posStats[selectedPos].ppg} <span className="text-[8px] font-normal text-slate-500">PPG</span></div>
                <div className={`text-[9px] ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>{posStats[selectedPos].apg ? posStats[selectedPos].apg + ' APG' : posStats[selectedPos].rpg + ' RPG'}</div>
              </div>
            </div>
          </div>
          {/* Bench */}
          {depthChart[selectedPos].bench.map((player, i) => (
            <div key={i} className={`p-2 rounded-lg mb-1 ${isDark ? 'bg-cmd-bg/50' : 'bg-light-card/50'}`}>
              <div className="flex items-center justify-between">
                <div className="flex items-center gap-2">
                  <span className={`text-[8px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>#{i + 2}</span>
                  <span className={`text-[10px] font-medium ${isDark ? 'text-slate-300' : 'text-slate-600'}`}>{player}</span>
                </div>
                <span className={`text-[8px] px-1 py-0.5 rounded ${isDark ? 'bg-slate-800 text-slate-400' : 'bg-slate-100 text-slate-500'}`}>BENCH</span>
              </div>
            </div>
          ))}
        </div>
      )}
    </div>
  );
};

// Live Pulse Animation
const LivePulse = ({ label = 'LIVE', isDark = true }) => (
  <div className="flex items-center gap-2">
    <div className="relative">
      <div className="w-2 h-2 bg-red-500 rounded-full" />
      <div className="absolute inset-0 w-2 h-2 bg-red-500 rounded-full animate-ping" />
    </div>
    <span className={`text-[10px] font-bold ${isDark ? 'text-red-400' : 'text-red-500'}`}>{label}</span>
  </div>
);

// Mini Bar Chart
const MiniBarChart = ({ data, height = 40, isDark = true }) => {
  const max = Math.max(...data.map(d => d.value));
  
  return (
    <div className="flex items-end gap-1" style={{ height }}>
      {data.map((d, i) => (
        <div 
          key={i}
          className="flex-1 rounded-t progress-fill"
          style={{
            height: `${(d.value / max) * 100}%`,
            background: d.color || '#CE1141',
            animationDelay: `${i * 0.1}s`
          }}
          title={`${d.label}: ${d.value}`}
        />
      ))}
    </div>
  );
};

// Community Buzz Widget
const CommunityBuzzWidget = ({ isDark = true }) => {
  const reactions = [
    { emoji: 'ðŸ”¥', count: 234, label: 'Fire' },
    { emoji: 'ðŸ˜¤', count: 156, label: 'Hype' },
    { emoji: 'ðŸ¦–', count: 189, label: 'Raptors' },
    { emoji: 'ðŸ’œ', count: 98, label: 'Love' }
  ];
  
  const [selected, setSelected] = useState(null);
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Heart className="w-3 h-3 text-pink-400" /> React
        </h3>
      </div>
      
      <div className="flex justify-center gap-2">
        {reactions.map((r, i) => (
          <button
            key={i}
            onClick={() => setSelected(i)}
            className={`flex flex-col items-center p-2 rounded-lg transition-all hover:scale-110 ${
              selected === i 
                ? 'gradient-raptors' 
                : isDark ? 'bg-cmd-bg hover:bg-cmd-card' : 'bg-light-card hover:bg-slate-200'
            }`}
          >
            <span className="text-xl">{r.emoji}</span>
            <span className={`text-[9px] font-bold ${selected === i ? 'text-white' : isDark ? 'text-slate-400' : 'text-slate-500'}`}>
              {r.count + (selected === i ? 1 : 0)}
            </span>
          </button>
        ))}
      </div>
    </div>
  );
};

// MVP Race Widget
const MVPRaceWidget = ({ isDark = true }) => {
  const candidates = [
    { name: 'Scottie Barnes', odds: '+2500', trend: 'up' },
    { name: 'Shai GA', odds: '+150', trend: 'same' },
    { name: 'Jokic', odds: '+200', trend: 'down' }
  ];
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Award className="w-3 h-3 text-yellow-400" /> MVP Watch
        </h3>
      </div>
      
      <div className="space-y-2">
        {candidates.map((c, i) => (
          <div key={i} className="flex items-center justify-between text-[10px]">
            <div className="flex items-center gap-2">
              <span className={`font-bold ${i === 0 ? 'text-raptors-red' : isDark ? 'text-slate-300' : 'text-slate-600'}`}>
                {i + 1}. {c.name}
              </span>
              {c.trend === 'up' && <span className="text-green-400">â†‘</span>}
              {c.trend === 'down' && <span className="text-red-400">â†“</span>}
            </div>
            <span className={`font-bold ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>{c.odds}</span>
          </div>
        ))}
      </div>
    </div>
  );
};

// Season Highlight Widget
const SeasonHighlightWidget = ({ isDark = true }) => {
  const [currentSlide, setCurrentSlide] = useState(0);
  const highlights = [
    { title: "Scottie's 38-Point Explosion", date: "Jan 15", emoji: "ðŸ”¥" },
    { title: "6-Game Win Streak Begins", date: "Feb 1", emoji: "ðŸ†" },
    { title: "RJ Barrett's Return Game", date: "Dec 20", emoji: "ðŸ’ª" }
  ];
  
  useEffect(() => {
    const interval = setInterval(() => {
      setCurrentSlide(prev => (prev + 1) % highlights.length);
    }, 5000);
    return () => clearInterval(interval);
  }, []);
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4 overflow-hidden`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Star className="w-3 h-3 text-yellow-400" /> Highlights
        </h3>
        <div className="flex gap-1">
          {highlights.map((_, i) => (
            <div key={i} className={`w-1.5 h-1.5 rounded-full ${i === currentSlide ? 'bg-raptors-red' : isDark ? 'bg-slate-600' : 'bg-slate-300'}`} />
          ))}
        </div>
      </div>
      
      <div className="relative h-16">
        {highlights.map((h, i) => (
          <div
            key={i}
            className={`absolute inset-0 transition-all duration-500 ${
              i === currentSlide ? 'opacity-100 translate-x-0' : 'opacity-0 translate-x-full'
            }`}
          >
            <div className="flex items-center gap-3">
              <span className="text-3xl">{h.emoji}</span>
              <div>
                <div className={`text-sm font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{h.title}</div>
                <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{h.date}</div>
              </div>
            </div>
          </div>
        ))}
      </div>
    </div>
  );
};

// Quick Stats Grid
const QuickStatsGrid = ({ isDark = true }) => {
  const stats = [
    { label: 'FG%', value: '46.8', rank: 18 },
    { label: '3P%', value: '34.3', rank: 22 },
    { label: 'REB', value: '45.0', rank: 12 },
    { label: 'AST', value: '26.2', rank: 14 },
    { label: 'STL', value: '8.2', rank: 8 },
    { label: 'BLK', value: '5.8', rank: 10 }
  ];
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <BarChart3 className="w-3 h-3 text-cyan-400" /> Quick Stats
        </h3>
      </div>
      
      <div className="grid grid-cols-3 gap-2">
        {stats.map((s, i) => (
          <div 
            key={i} 
            className={`p-2 rounded-lg text-center stagger-item ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`}
            style={{ animationDelay: `${i * 0.05}s` }}
          >
            <div className={`text-lg font-black ${s.rank <= 10 ? 'text-green-400' : s.rank <= 20 ? 'text-yellow-400' : 'text-red-400'}`}>
              {s.value}
            </div>
            <div className={`text-[8px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{s.label}</div>
            <div className={`text-[7px] ${isDark ? 'text-slate-600' : 'text-slate-400'}`}>#{s.rank}</div>
          </div>
        ))}
      </div>
    </div>
  );
};

// Mood Meter Widget
const MoodMeterWidget = ({ isDark = true }) => {
  const [mood, setMood] = useState(70); // 0-100 scale
  
  const getMoodEmoji = () => {
    if (mood >= 80) return 'ðŸ”¥';
    if (mood >= 60) return 'ðŸ˜Š';
    if (mood >= 40) return 'ðŸ˜';
    return 'ðŸ˜¢';
  };
  
  const getMoodLabel = () => {
    if (mood >= 80) return 'HYPED';
    if (mood >= 60) return 'Optimistic';
    if (mood >= 40) return 'Neutral';
    return 'Worried';
  };
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Heart className="w-3 h-3 text-pink-400" /> Fan Mood
        </h3>
        <span className="text-2xl">{getMoodEmoji()}</span>
      </div>
      
      <div className="text-center mb-3">
        <div className={`text-lg font-black ${mood >= 60 ? 'text-green-400' : mood >= 40 ? 'text-yellow-400' : 'text-red-400'}`}>
          {getMoodLabel()}
        </div>
      </div>
      
      <div className={`h-3 rounded-full overflow-hidden ${isDark ? 'bg-cmd-border' : 'bg-light-border'}`}>
        <div 
          className="h-full rounded-full progress-fill"
          style={{
            width: `${mood}%`,
            background: mood >= 60 ? 'linear-gradient(90deg, #22c55e, #4ade80)' : mood >= 40 ? 'linear-gradient(90deg, #eab308, #facc15)' : 'linear-gradient(90deg, #ef4444, #f87171)'
          }}
        />
      </div>
    </div>
  );
};

// Trivia Widget
const TriviaWidget = ({ isDark = true }) => {
  const [revealed, setRevealed] = useState(false);
  const trivia = {
    question: "Who scored the most points in Raptors franchise history?",
    answer: "DeMar DeRozan (13,296 pts)"
  };
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Brain className="w-3 h-3 text-purple-400" /> Trivia
          <span style={{fontSize:'0.5rem',background:'linear-gradient(135deg,#CE1141,#3E2680)',color:'#fff',padding:'1px 6px',borderRadius:'9999px',fontWeight:800,letterSpacing:'0.5px',marginLeft:'4px'}}>NEW</span>
        </h3>
        <span className="text-lg">ðŸ§ </span>
      </div>
      
      <div className={`text-[11px] ${isDark ? 'text-slate-300' : 'text-slate-600'} mb-3`}>
        {trivia.question}
      </div>
      
      {revealed ? (
        <div className={`p-2 rounded-lg text-center ${isDark ? 'bg-green-500/10' : 'bg-green-500/5'}`}>
          <span className="text-[10px] font-bold text-green-400">{trivia.answer}</span>
        </div>
      ) : (
        <button
          onClick={() => setRevealed(true)}
          className={`w-full py-2 rounded-lg text-xs font-bold transition-all ${
            isDark ? 'bg-cmd-bg hover:bg-cmd-card text-white' : 'bg-light-card hover:bg-slate-200 text-slate-800'
          }`}
        >
          Reveal Answer
        </button>
      )}
    </div>
  );
};

// Sound Toggle Widget
const SoundWidget = ({ isDark = true }) => {
  const [enabled, setEnabled] = useState(false);
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-3`}>
      <div className="flex items-center justify-between">
        <div className="flex items-center gap-2">
          <Volume2 className={`w-4 h-4 ${enabled ? 'text-raptors-red' : isDark ? 'text-slate-500' : 'text-slate-400'}`} />
          <span className={`text-[10px] ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>Game Sounds</span>
        </div>
        <button
          onClick={() => setEnabled(!enabled)}
          className={`w-8 h-4 rounded-full transition-colors ${enabled ? 'bg-raptors-red' : isDark ? 'bg-cmd-border' : 'bg-light-border'}`}
        >
          <div className={`w-3 h-3 bg-white rounded-full transition-transform ${enabled ? 'translate-x-4' : 'translate-x-0.5'}`} />
        </button>
      </div>
    </div>
  );
};

// Weather Game Impact Widget
const WeatherImpactWidget = ({ isDark = true }) => {
  const weather = ARENA_DATA.weather;
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          {weather.icon} Game Day Weather
        </h3>
      </div>
      
      <div className="flex items-center justify-between">
        <div>
          <div className={`text-2xl font-black ${isDark ? 'text-white' : 'text-slate-800'}`}>{weather.temp}Â°C</div>
          <div className={`text-[10px] ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>{weather.condition}</div>
        </div>
        <div className={`text-[10px] p-2 rounded-lg ${isDark ? 'bg-blue-500/10' : 'bg-blue-500/5'}`}>
          <div className="text-blue-400 font-bold">Impact: Low</div>
          <div className={isDark ? 'text-slate-500' : 'text-slate-400'}>Indoor game</div>
        </div>
      </div>
    </div>
  );
};

// Power Rankings Widget
// ============================================================
// LIVE GAME BANNER
// ============================================================
const LiveGameBanner = ({ isDark = true }) => {
  const [liveData, setLiveData] = useState({ live: false });
  
  useEffect(() => {
    let mounted = true;
    const poll = async () => {
      const data = await fetchEnhancedScoreboard();
      if (mounted) setLiveData(data);
    };
    poll();
    const interval = setInterval(poll, 30000); // 30s during live games
    return () => { mounted = false; clearInterval(interval); };
  }, []);

  if (!liveData.live) return null;

  const quarters = ['Q1', 'Q2', 'Q3', 'Q4'];
  const homeWinning = liveData.homeScore > liveData.awayScore;
  const awayWinning = liveData.awayScore > liveData.homeScore;

  return (
    <div className="live-game-banner text-white py-3 px-4 relative overflow-hidden z-20">
      <div className="max-w-4xl mx-auto flex flex-col sm:flex-row items-center justify-between gap-2">
        <div className="flex items-center gap-3">
          <span className="live-pulse-dot w-3 h-3 bg-red-500 rounded-full inline-block"></span>
          <span className="text-xs font-bold uppercase tracking-wider">LIVE NOW</span>
        </div>
        <div className="flex items-center gap-4">
          <div className={`flex items-center gap-2 ${awayWinning ? 'font-black' : ''}`}>
            <img src={'https://cdn.nba.com/logos/nba/' + (liveData.awayId || '') + '/primary/L/logo.svg'} className="w-6 h-6" alt="" />
            <span className="text-sm font-bold">{liveData.away}</span>
            <span className="text-xl font-black">{liveData.awayScore}</span>
          </div>
          <div className="flex flex-col items-center">
            <span className="text-[10px] uppercase tracking-wider opacity-75">Q{liveData.period} {liveData.clock}</span>
          </div>
          <div className={`flex items-center gap-2 ${homeWinning ? 'font-black' : ''}`}>
            <span className="text-xl font-black">{liveData.homeScore}</span>
            <span className="text-sm font-bold">{liveData.home}</span>
            <img src={'https://cdn.nba.com/logos/nba/' + (liveData.homeId || '') + '/primary/L/logo.svg'} className="w-6 h-6" alt="" />
          </div>
        </div>
        {/* Quarter breakdown */}
        <div className="flex gap-2">
          {quarters.slice(0, Math.max(liveData.period || 1, (liveData.homeQuarters || []).length)).map((q, i) => (
            <div key={q} className="text-center">
              <div className="text-[9px] opacity-60">{q}</div>
              <div className="text-[10px] font-mono">
                {(liveData.awayQuarters || [])[i] ?? '-'}-{(liveData.homeQuarters || [])[i] ?? '-'}
              </div>
            </div>
          ))}
        </div>
      </div>
    </div>
  );
};

// ============================================================
// AWARDS WATCH WIDGET
// ============================================================
const AwardsWatchWidget = ({ isDark = true }) => {
  const [expanded, setExpanded] = useState(false);
  const displayAwards = expanded ? AWARDS_WATCH : AWARDS_WATCH.slice(0, 3);
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          ðŸ… Awards Watch
        </h3>
        <span className={`text-[9px] px-2 py-0.5 rounded-full ${isDark ? 'bg-yellow-500/10 text-yellow-400' : 'bg-yellow-50 text-yellow-600'}`}>2025-26</span>
      </div>
      <div className="space-y-2.5">
        {displayAwards.map((award, i) => (
          <div key={i} className={`${isDark ? 'bg-cmd-bg/50' : 'bg-light-card'} rounded-lg p-2.5`}>
            <div className="flex items-center gap-2 mb-1.5">
              <span className="text-sm">{award.emoji}</span>
              <span className={`text-[11px] font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{award.category}</span>
            </div>
            {award.players.map((p, j) => (
              <div key={j} className={`flex items-start gap-2 ${j > 0 ? 'mt-1.5 pt-1.5 border-t ' + (isDark ? 'border-cmd-border/30' : 'border-light-border') : ''}`}>
                {p.highlight && <span className="text-raptors-red text-[10px] mt-0.5">ðŸ¦–</span>}
                <div className="flex-1">
                  <span className={`text-[11px] font-semibold ${p.highlight ? 'text-raptors-red' : isDark ? 'text-slate-300' : 'text-slate-700'}`}>{p.name}</span>
                  {p.note && <p className={`text-[9px] mt-0.5 ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{p.note}</p>}
                </div>
              </div>
            ))}
          </div>
        ))}
      </div>
      {AWARDS_WATCH.length > 3 && (
        <button onClick={() => setExpanded(e => !e)} className={`mt-2 w-full text-center text-[10px] ${isDark ? 'text-slate-500 hover:text-slate-300' : 'text-slate-400 hover:text-slate-600'} transition-colors`}>
          {expanded ? 'â–² Show less' : 'â–¼ Show all categories'}
        </button>
      )}
    </div>
  );
};

// ============================================================
// POWER RANKINGS WIDGET (Enhanced â€” Around the League)
// ============================================================
const PowerRankingsWidget = ({ isDark = true }) => {
  const { standings: eastStandings } = useLiveStandings();
  const [westStandings, setWestStandings] = useState(FALLBACK_STANDINGS_WEST);
  const [tab, setTab] = useState('east');

  useEffect(() => {
    fetchWestStandings().then(setWestStandings);
  }, []);

  const eastTop5 = eastStandings.slice(0, 5);
  const westTop5 = westStandings.slice(0, 5);
  const raptors = eastStandings.find(t => t.abbr === 'TOR');
  const current = tab === 'east' ? eastTop5 : westTop5;

  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <TrendingUp className="w-3 h-3 text-green-400" /> Around the League
        </h3>
      </div>

      {/* Raptors position callout */}
      {raptors && (
        <div className={`mb-3 p-2 rounded-lg ${isDark ? 'bg-raptors-red/10 border border-raptors-red/20' : 'bg-raptors-red/5 border border-raptors-red/15'}`}>
          <div className="flex items-center justify-between">
            <span className="text-raptors-red text-[11px] font-bold">ðŸ¦– Raptors: #{raptors.rank} East</span>
            <span className={`text-[10px] font-mono ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>{raptors.wins}-{raptors.losses}</span>
          </div>
        </div>
      )}

      {/* Tab switcher */}
      <div className="flex gap-1 mb-3">
        {['east', 'west'].map(t => (
          <button key={t} onClick={() => setTab(t)} className={`flex-1 text-[10px] font-bold py-1.5 rounded-lg transition-all uppercase ${tab === t ? 'bg-raptors-red text-white' : isDark ? 'bg-cmd-bg text-slate-500 hover:text-slate-300' : 'bg-light-card text-slate-400 hover:text-slate-600'}`}>
            {t === 'east' ? 'East Top 5' : 'West Top 5'}
          </button>
        ))}
      </div>

      <div className="space-y-1.5">
        {current.map((team, i) => (
          <div key={team.abbr} className={`flex items-center justify-between py-1.5 px-2 rounded-lg text-xs ${team.abbr === 'TOR' ? (isDark ? 'bg-raptors-red/10' : 'bg-raptors-red/5') : ''}`}>
            <div className="flex items-center gap-2">
              <span className={`w-4 text-center font-bold ${i === 0 ? 'text-yellow-400' : i === 1 ? 'text-slate-300' : i === 2 ? 'text-amber-600' : isDark ? 'text-slate-500' : 'text-slate-400'}`}>{i + 1}</span>
              <img loading="lazy" src={`https://cdn.nba.com/logos/nba/${team.id}/primary/L/logo.svg`} className="w-4 h-4" alt="" />
              <span className={`font-semibold ${team.abbr === 'TOR' ? 'text-raptors-red' : isDark ? 'text-slate-300' : 'text-slate-700'}`}>{team.abbr}</span>
            </div>
            <span className={`font-mono ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>{team.wins}-{team.losses}</span>
          </div>
        ))}
      </div>
    </div>
  );
};

// ============================================================
// STANDINGS VISUALIZATION (Bar Chart)
// ============================================================
const StandingsVisualizationWidget = ({ isDark = true }) => {
  const { standings } = useLiveStandings();
  const [visible, setVisible] = useState(false);
  const ref = useRef(null);

  useEffect(() => {
    const obs = new IntersectionObserver(([e]) => { if (e.isIntersecting) setVisible(true); }, { threshold: 0.2 });
    if (ref.current) obs.observe(ref.current);
    return () => obs.disconnect();
  }, []);

  if (!standings.length) return null;
  const maxWins = Math.max(...standings.map(t => t.wins));
  const playoffLine = 6;
  const playInLine = 10;

  return (
    <div ref={ref} className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          ðŸ“Š East Standings Chart
        </h3>
      </div>
      <div className="space-y-1">
        {standings.map((team, i) => {
          const barWidth = visible ? `${(team.wins / maxWins) * 100}%` : '0%';
          const isPlayoff = i < playoffLine;
          const isPlayIn = i >= playoffLine && i < playInLine;
          const isTOR = team.abbr === 'TOR';

          return (
            <React.Fragment key={team.abbr}>
              {i === playoffLine && (
                <div className="flex items-center gap-2 py-1">
                  <div className={`flex-1 border-t border-dashed ${isDark ? 'border-green-500/40' : 'border-green-400/40'}`}></div>
                  <span className="text-[8px] text-green-500 font-bold uppercase">Playoff â–²</span>
                  <div className={`flex-1 border-t border-dashed ${isDark ? 'border-green-500/40' : 'border-green-400/40'}`}></div>
                </div>
              )}
              {i === playInLine && (
                <div className="flex items-center gap-2 py-1">
                  <div className={`flex-1 border-t border-dashed ${isDark ? 'border-yellow-500/40' : 'border-yellow-400/40'}`}></div>
                  <span className="text-[8px] text-yellow-500 font-bold uppercase">Play-In â–²</span>
                  <div className={`flex-1 border-t border-dashed ${isDark ? 'border-yellow-500/40' : 'border-yellow-400/40'}`}></div>
                </div>
              )}
              <div className="flex items-center gap-1.5">
                <span className={`w-4 text-[9px] text-right ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{team.rank}</span>
                <span className={`w-8 text-[9px] font-semibold ${isTOR ? 'text-raptors-red' : isDark ? 'text-slate-400' : 'text-slate-500'}`}>{team.abbr}</span>
                <div className={`flex-1 h-3.5 rounded-sm overflow-hidden ${isDark ? 'bg-cmd-border/30' : 'bg-slate-100'}`}>
                  <div
                    className="standings-bar h-full rounded-sm"
                    style={{
                      width: barWidth,
                      background: isTOR ? '#CE1141' : isPlayoff ? (isDark ? '#22c55e40' : '#22c55e30') : isPlayIn ? (isDark ? '#eab30840' : '#eab30830') : (isDark ? '#64748b30' : '#94a3b830'),
                      transitionDelay: `${i * 50}ms`,
                    }}
                  />
                </div>
                <span className={`w-7 text-[9px] font-mono text-right ${isTOR ? 'text-raptors-red font-bold' : isDark ? 'text-slate-500' : 'text-slate-400'}`}>{team.wins}</span>
              </div>
            </React.Fragment>
          );
        })}
      </div>
      <div className={`flex justify-center gap-4 mt-3 text-[8px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>
        <span><span className="inline-block w-2 h-2 rounded-sm bg-green-500/40 mr-1"></span>Playoff (1-6)</span>
        <span><span className="inline-block w-2 h-2 rounded-sm bg-yellow-500/40 mr-1"></span>Play-In (7-10)</span>
      </div>
    </div>
  );
};

// All-Star Tracker Widget
const AllStarTrackerWidget = ({ isDark = true }) => {
  const candidates = [
    { name: 'Scottie Barnes', votes: 3241242, trend: 'up', pct: 85, note: '2026 All-Star Starter â­' },
    { name: 'RJ Barrett', votes: 487000, trend: 'same', pct: 22, note: 'Strong season, missed cut' }
  ];
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Star className="w-3 h-3 text-yellow-400 fill-yellow-400" /> All-Star Watch
        </h3>
      </div>
      
      <div className="space-y-3">
        {candidates.map((c, i) => (
          <div key={i}>
            <div className="flex justify-between text-[10px] mb-1">
              <span className={`font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{c.name}</span>
              <span className={isDark ? 'text-slate-400' : 'text-slate-500'}>{c.votes >= 1000000 ? (c.votes / 1000000).toFixed(1) + 'M' : (c.votes / 1000).toFixed(0) + 'K'} votes</span>
            </div>
            {c.note && <div className={`text-[9px] mb-1 ${isDark ? 'text-yellow-400/80' : 'text-yellow-600'}`}>{c.note}</div>}
            <div className={`h-2 rounded-full overflow-hidden ${isDark ? 'bg-cmd-border' : 'bg-light-border'}`}>
              <div 
                className="h-full rounded-full progress-fill"
                style={{ width: `${c.pct}%`, background: 'linear-gradient(90deg, #f59e0b, #fcd34d)' }}
              />
            </div>
          </div>
        ))}
      </div>
    </div>
  );
};

// Social Links Widget
const SocialLinksWidget = ({ isDark = true }) => {
  const links = [
    { icon: 'ðŸ¦', label: 'Twitter', url: '#' },
    { icon: 'ðŸ“¸', label: 'Instagram', url: '#' },
    { icon: 'ðŸ“º', label: 'YouTube', url: '#' }
  ];
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Share className="w-3 h-3 text-blue-400" /> Follow
        </h3>
      </div>
      
      <div className="flex justify-center gap-3">
        {links.map((l, i) => (
          <a
            key={i}
            href={l.url}
            className={`p-3 rounded-xl transition-all hover:scale-110 ${
              isDark ? 'bg-cmd-bg hover:bg-cmd-card' : 'bg-light-card hover:bg-slate-200'
            }`}
          >
            <span className="text-xl">{l.icon}</span>
          </a>
        ))}
      </div>
    </div>
  );
};

// League Pass Promo Widget
const LeaguePassWidget = ({ isDark = true }) => (
  <div className={`${isDark ? 'glass-card gradient-border' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4 relative overflow-hidden`}>
    <div className="absolute top-0 right-0 w-20 h-20 bg-gradient-to-bl from-raptors-red/20 to-transparent rounded-bl-full" />
    
    <div className="flex items-center gap-3">
      <div className="text-3xl">ðŸ€</div>
      <div>
        <div className={`text-[11px] font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>NBA League Pass</div>
        <div className={`text-[9px] ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>Watch every Raptors game</div>
      </div>
    </div>
    
    <button className="w-full mt-3 py-2 gradient-raptors rounded-lg text-xs font-bold text-white hover:opacity-90 transition-opacity">
      Get League Pass
    </button>
  </div>
);

// Credits/About Widget
const AboutWidget = ({ isDark = true }) => (
  <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
    <div className="text-center">
      <div className="text-2xl mb-2">ðŸ¦–</div>
      <div className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>Raptors Intel</div>
      <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'} mt-1`}>
        Built with â¤ï¸ for Raptors fans
      </div>
      <div className={`text-[8px] ${isDark ? 'text-slate-600' : 'text-slate-400'} mt-2`}>
        Not affiliated with the NBA or Toronto Raptors
      </div>
    </div>
  </div>
);

// ============================================================
// PARTICLE SYSTEM - Floating basketballs and geometric shapes
// ============================================================
const ParticleSystem = ({ isDark = true }) => {
  const [particles, setParticles] = useState([]);
  
  useEffect(() => {
    const generateParticles = () => {
      const newParticles = [];
      // Basketball particles
      for (let i = 0; i < 5; i++) {
        newParticles.push({
          id: `ball-${i}`,
          type: 'basketball',
          x: Math.random() * 100,
          y: Math.random() * 100,
          size: 15 + Math.random() * 10,
          duration: 15 + Math.random() * 10,
          delay: Math.random() * 5,
        });
      }
      // Geometric particles (diamonds, circles)
      for (let i = 0; i < 15; i++) {
        newParticles.push({
          id: `geo-${i}`,
          type: Math.random() > 0.5 ? 'diamond' : 'circle',
          x: Math.random() * 100,
          y: Math.random() * 100,
          size: 4 + Math.random() * 8,
          duration: 10 + Math.random() * 15,
          delay: Math.random() * 8,
          color: Math.random() > 0.5 ? 'rgba(206,17,65,0.3)' : 'rgba(62,38,128,0.3)',
        });
      }
      setParticles(newParticles);
    };
    generateParticles();
  }, []);

  return (
    <div className="particles-container">
      {particles.map(p => (
        <div
          key={p.id}
          className="particle"
          style={{
            left: `${p.x}%`,
            top: `${p.y}%`,
            width: p.size,
            height: p.size,
            animationDuration: `${p.duration}s`,
            animationDelay: `${p.delay}s`,
            background: p.type === 'basketball' 
              ? 'radial-gradient(circle at 30% 30%, #ff6b35, #CE1141)' 
              : p.color,
            borderRadius: p.type === 'diamond' ? '2px' : '50%',
            transform: p.type === 'diamond' ? 'rotate(45deg)' : 'none',
            boxShadow: p.type === 'basketball' 
              ? 'inset -2px -2px 4px rgba(0,0,0,0.3), 0 0 10px rgba(206,17,65,0.2)' 
              : `0 0 ${p.size}px ${p.color}`,
          }}
        />
      ))}
    </div>
  );
};

// ============================================================
// CONFETTI SYSTEM - Celebration effect
// ============================================================
const ConfettiSystem = ({ active, duration = 3000 }) => {
  const [pieces, setPieces] = useState([]);
  
  useEffect(() => {
    if (active) {
      const colors = ['#CE1141', '#3E2680', '#FFD700', '#FFFFFF', '#00FF00'];
      const newPieces = [];
      for (let i = 0; i < 50; i++) {
        newPieces.push({
          id: i,
          x: Math.random() * 100,
          color: colors[Math.floor(Math.random() * colors.length)],
          delay: Math.random() * 0.5,
          rotation: Math.random() * 360,
          size: 8 + Math.random() * 8,
        });
      }
      setPieces(newPieces);
      setTimeout(() => setPieces([]), duration);
    }
  }, [active, duration]);

  if (pieces.length === 0) return null;

  return (
    <div className="fixed inset-0 pointer-events-none z-50 overflow-hidden">
      {pieces.map(p => (
        <div
          key={p.id}
          className="confetti-piece"
          style={{
            left: `${p.x}%`,
            backgroundColor: p.color,
            width: p.size,
            height: p.size * 0.6,
            animationDelay: `${p.delay}s`,
            transform: `rotate(${p.rotation}deg)`,
          }}
        />
      ))}
    </div>
  );
};

// ============================================================
// ANIMATED GRADIENT ORB BACKGROUND
// ============================================================
const GradientOrbs = ({ isDark = true }) => {
  if (!isDark) return null;
  
  return (
    <div className="fixed inset-0 pointer-events-none overflow-hidden z-0">
      <div 
        className="glow-orb"
        style={{
          width: '600px',
          height: '600px',
          background: 'radial-gradient(circle, rgba(206,17,65,0.15) 0%, transparent 70%)',
          top: '-200px',
          right: '-200px',
        }}
      />
      <div 
        className="glow-orb"
        style={{
          width: '500px',
          height: '500px',
          background: 'radial-gradient(circle, rgba(62,38,128,0.15) 0%, transparent 70%)',
          bottom: '-150px',
          left: '-150px',
          animationDelay: '2s',
        }}
      />
      <div 
        className="glow-orb"
        style={{
          width: '300px',
          height: '300px',
          background: 'radial-gradient(circle, rgba(206,17,65,0.1) 0%, transparent 70%)',
          top: '40%',
          left: '30%',
          animationDelay: '4s',
        }}
      />
    </div>
  );
};

// ============================================================
// ANIMATED STAT NUMBER - Spring physics counter
// ============================================================
const AnimatedStatNumber = ({ value, decimals = 1, prefix = '', suffix = '', className = '' }) => {
  const [display, setDisplay] = useState(0);
  const [hasAnimated, setHasAnimated] = useState(false);
  const ref = useRef(null);
  const animRef = useRef(null);

  useEffect(() => {
    const observer = new IntersectionObserver(
      ([entry]) => {
        if (entry.isIntersecting && !hasAnimated) {
          setHasAnimated(true);
          const target = Number(value) || 0;
          let start = null;
          const duration = 1500;
          
          const step = (ts) => {
            if (!start) start = ts;
            const progress = Math.min((ts - start) / duration, 1);
            // Elastic easing for spring effect
            const eased = progress === 1 
              ? 1 
              : 1 - Math.pow(2, -10 * progress) * Math.cos((progress * 10 - 0.75) * ((2 * Math.PI) / 3));
            setDisplay(eased * target);
            if (progress < 1) animRef.current = requestAnimationFrame(step);
          };
          animRef.current = requestAnimationFrame(step);
        }
      },
      { threshold: 0.5 }
    );
    
    if (ref.current) observer.observe(ref.current);
    return () => {
      observer.disconnect();
      if (animRef.current) cancelAnimationFrame(animRef.current);
    };
  }, [value, hasAnimated]);

  return (
    <span ref={ref} className={className}>
      {prefix}{display.toFixed(decimals)}{suffix}
    </span>
  );
};

// ============================================================
// RIPPLE BUTTON - Click effect
// ============================================================
const RippleButton = ({ children, onClick, className = '', ...props }) => {
  const buttonRef = useRef(null);
  
  const createRipple = (e) => {
    const button = buttonRef.current;
    const rect = button.getBoundingClientRect();
    const size = Math.max(rect.width, rect.height);
    const x = e.clientX - rect.left - size / 2;
    const y = e.clientY - rect.top - size / 2;
    
    const ripple = document.createElement('span');
    ripple.className = 'ripple-effect';
    ripple.style.width = ripple.style.height = `${size}px`;
    ripple.style.left = `${x}px`;
    ripple.style.top = `${y}px`;
    
    button.appendChild(ripple);
    setTimeout(() => ripple.remove(), 600);
    
    if (onClick) onClick(e);
  };

  return (
    <button 
      ref={buttonRef} 
      className={`btn-ripple-v2 ${className}`} 
      onClick={createRipple}
      {...props}
    >
      {children}
    </button>
  );
};

// ============================================================
// BASKETBALL LOADING SPINNER
// ============================================================
const BasketballLoader = ({ size = 60 }) => (
  <div className="flex flex-col items-center justify-center gap-4">
    <div 
      className="relative"
      style={{ width: size, height: size }}
    >
      <div 
        className="absolute inset-0 rounded-full"
        style={{
          background: 'radial-gradient(circle at 30% 30%, #ff6b35, #CE1141)',
          boxShadow: 'inset -4px -4px 8px rgba(0,0,0,0.4), 0 0 20px rgba(206,17,65,0.4)',
          animation: 'basketball-bounce 1s ease-in-out infinite',
        }}
      />
      {/* Basketball lines */}
      <svg viewBox="0 0 100 100" className="absolute inset-0 w-full h-full" style={{ animation: 'spin-glow 4s linear infinite' }}>
        <path d="M50 5 Q70 50 50 95" fill="none" stroke="rgba(0,0,0,0.3)" strokeWidth="2" />
        <path d="M5 50 Q50 30 95 50" fill="none" stroke="rgba(0,0,0,0.3)" strokeWidth="2" />
      </svg>
    </div>
    <div className="text-xs font-bold text-raptors-red uppercase tracking-widest animate-pulse">Loading...</div>
  </div>
);

// ============================================================
// COURT BACKGROUND SVG - Animated court lines
// ============================================================
const CourtBackground = ({ isDark = true }) => {
  if (!isDark) return null;
  
  return (
    <div className="fixed inset-0 pointer-events-none z-0 opacity-[0.03]">
      <svg viewBox="0 0 940 500" className="w-full h-full" preserveAspectRatio="xMidYMid slice">
        {/* Half court */}
        <rect x="0" y="0" width="940" height="500" fill="none" stroke="#CE1141" strokeWidth="2" className="court-line-animated" />
        <line x1="470" y1="0" x2="470" y2="500" stroke="#CE1141" strokeWidth="2" className="court-line-animated" style={{ animationDelay: '0.2s' }} />
        <circle cx="470" cy="250" r="60" fill="none" stroke="#CE1141" strokeWidth="2" className="court-line-animated" style={{ animationDelay: '0.4s' }} />
        {/* Three point lines */}
        <path d="M0 50 L140 50 A110 110 0 0 1 140 450 L0 450" fill="none" stroke="#CE1141" strokeWidth="2" className="court-line-animated" style={{ animationDelay: '0.6s' }} />
        <path d="M940 50 L800 50 A110 110 0 0 0 800 450 L940 450" fill="none" stroke="#CE1141" strokeWidth="2" className="court-line-animated" style={{ animationDelay: '0.8s' }} />
        {/* Keys */}
        <rect x="0" y="170" width="190" height="160" fill="none" stroke="#CE1141" strokeWidth="2" className="court-line-animated" style={{ animationDelay: '1s' }} />
        <rect x="750" y="170" width="190" height="160" fill="none" stroke="#CE1141" strokeWidth="2" className="court-line-animated" style={{ animationDelay: '1.2s' }} />
      </svg>
    </div>
  );
};

// ============================================================
// LIVE INDICATOR - Pulsing dot with rings
// ============================================================
const LiveIndicator = ({ className = '' }) => (
  <span className={`relative inline-flex ${className}`}>
    <span className="absolute inline-flex h-full w-full rounded-full bg-red-500 opacity-75 animate-ping" />
    <span className="relative inline-flex rounded-full h-2 w-2 bg-red-500 shadow-lg shadow-red-500/50" />
  </span>
);

// ============================================================
// GLOWING CARD WRAPPER - Premium card effect
// ============================================================
const GlowingCard = ({ children, className = '', glowColor = 'raptors-red', isDark = true }) => {
  const [mousePos, setMousePos] = useState({ x: 50, y: 50 });
  const cardRef = useRef(null);

  const handleMouseMove = (e) => {
    if (!cardRef.current) return;
    const rect = cardRef.current.getBoundingClientRect();
    const x = ((e.clientX - rect.left) / rect.width) * 100;
    const y = ((e.clientY - rect.top) / rect.height) * 100;
    setMousePos({ x, y });
  };

  return (
    <div
      ref={cardRef}
      className={`relative overflow-hidden ${isDark ? 'premium-glass' : 'bg-white border border-light-border shadow-xl'} rounded-2xl transition-all duration-300 hover:shadow-2xl ${className}`}
      onMouseMove={handleMouseMove}
      style={{
        '--glow-x': `${mousePos.x}%`,
        '--glow-y': `${mousePos.y}%`,
      }}
    >
      {isDark && (
        <div 
          className="absolute inset-0 opacity-0 hover:opacity-100 transition-opacity duration-500 pointer-events-none"
          style={{
            background: `radial-gradient(circle at var(--glow-x) var(--glow-y), rgba(206,17,65,0.15) 0%, transparent 50%)`,
          }}
        />
      )}
      {children}
    </div>
  );
};

// ============================================================
// ANIMATED PROGRESS BAR - Stat comparison
// ============================================================
const AnimatedProgressBar = ({ value, max = 100, color = 'raptors-red', label, showValue = true, isDark = true }) => {
  const [width, setWidth] = useState(0);
  const ref = useRef(null);

  useEffect(() => {
    const observer = new IntersectionObserver(
      ([entry]) => {
        if (entry.isIntersecting) {
          setTimeout(() => setWidth((value / max) * 100), 100);
        }
      },
      { threshold: 0.3 }
    );
    if (ref.current) observer.observe(ref.current);
    return () => observer.disconnect();
  }, [value, max]);

  return (
    <div ref={ref} className="w-full">
      {label && <div className={`text-[10px] mb-1 ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>{label}</div>}
      <div className={`h-2 rounded-full overflow-hidden ${isDark ? 'bg-cmd-border' : 'bg-light-border'}`}>
        <div 
          className={`h-full rounded-full bg-${color} transition-all duration-1000 ease-out stat-bar-glow`}
          style={{ 
            width: `${width}%`,
            backgroundColor: color === 'raptors-red' ? '#CE1141' : color,
            boxShadow: `0 0 10px ${color === 'raptors-red' ? 'rgba(206,17,65,0.5)' : color}`,
          }}
        />
      </div>
      {showValue && <div className={`text-[9px] mt-0.5 text-right font-mono ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{value}</div>}
    </div>
  );
};

// ============================================================
// STAT CARD WITH ANIMATION
// ============================================================
const AnimatedStatCard = ({ icon: Icon, label, value, trend, trendValue, delay = 0, isDark = true }) => (
  <div 
    className={`card-enter ${isDark ? 'premium-glass' : 'bg-white border border-light-border shadow-lg'} rounded-xl p-4 relative overflow-hidden group`}
    style={{ animationDelay: `${delay}s` }}
  >
    <div className="absolute inset-0 bg-gradient-to-br from-raptors-red/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500" />
    <div className="relative z-10">
      <div className="flex items-center justify-between mb-2">
        <Icon className={`w-4 h-4 ${isDark ? 'text-raptors-red' : 'text-raptors-red'}`} />
        {trend && (
          <span className={`text-[10px] font-bold flex items-center gap-0.5 ${trend === 'up' ? 'text-green-400' : 'text-red-400'}`}>
            {trend === 'up' ? <TrendingUp className="w-3 h-3" /> : <TrendingDown className="w-3 h-3" />}
            {trendValue}
          </span>
        )}
      </div>
      <div className={`text-2xl font-black ${isDark ? 'text-white' : 'text-slate-800'}`}>
        <AnimatedStatNumber value={value} decimals={1} />
      </div>
      <div className={`text-[10px] uppercase font-bold ${isDark ? 'text-slate-500' : 'text-slate-400'} tracking-wider`}>{label}</div>
    </div>
  </div>
);

// ============================================================
// LIVE SCORE TICKER
// ============================================================
const LiveScoreTicker = ({ isDark = true }) => {
  const [scores, setScores] = useState(LIVE_NBA_SCORES);
  const [offset, setOffset] = useState(0);
  const [liveCount, setLiveCount] = useState(0);
  
  useEffect(() => {
    let mounted = true;
    const load = async () => {
      const data = await fetchLiveScoreboard();
      if (data && mounted) {
        setScores(data.length > 0 ? data : []);
        setLiveCount(data.filter(g => g.isLive).length);
      }
    };
    load();
    const interval = setInterval(load, 60000);
    return () => { mounted = false; clearInterval(interval); };
  }, []);

  useEffect(() => {
    const interval = setInterval(() => {
      setOffset(prev => (prev - 1) % -3000);
    }, 30);
    return () => clearInterval(interval);
  }, []);

  if (scores.length === 0) {
    return (
      <div className={`w-full overflow-hidden ${isDark ? 'bg-cmd-bg border-cmd-border' : 'bg-light-card border-light-border'} border-b py-1.5`}>
        <div className="flex items-center justify-center">
          <span className={`text-[10px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>ðŸ€ No games scheduled right now â€” check back on game day</span>
        </div>
      </div>
    );
  }

  return (
    <div className={`w-full overflow-hidden ${isDark ? 'bg-cmd-bg border-cmd-border' : 'bg-light-card border-light-border'} border-b py-1.5`}>
      <div className="flex items-center">
        <div className={`shrink-0 px-2 py-0.5 text-[10px] font-bold uppercase flex items-center gap-1 ${liveCount > 0 ? 'text-raptors-red' : isDark ? 'text-slate-500' : 'text-slate-400'}`}>
          ðŸ€ {liveCount > 0 ? `${liveCount} Live` : 'Scores'}
        </div>
        <div className="overflow-hidden flex-1">
          <div className="flex items-center gap-8 whitespace-nowrap" style={{ transform: `translateX(${offset}px)` }}>
            {[...scores, ...scores].map((game, i) => {
              const isLive = game.isLive || game.status?.includes('Q');
              const isFinal = game.isFinal || game.status === 'Final';
              return (
                <div key={i} className={`flex items-center gap-3 px-4 py-0.5 rounded ${game.isRaptors ? (isDark ? 'bg-raptors-red/15 border border-raptors-red/30' : 'bg-raptors-red/10 border border-raptors-red/20') : ''}`}>
                  <div className="flex items-center gap-2">
                    <img loading="lazy" src={`https://cdn.nba.com/logos/nba/${game.awayId}/primary/L/logo.svg`} className="w-4 h-4" alt="" />
                    <span className={`text-xs font-bold ${game.isRaptors && game.away === 'TOR' ? 'text-raptors-red' : isDark ? 'text-slate-300' : 'text-slate-700'}`}>{game.away}</span>
                    <span className={`text-xs font-mono font-bold ${game.awayScore > game.homeScore ? 'text-green-500' : isDark ? 'text-white' : 'text-slate-800'}`}>{game.awayScore || '-'}</span>
                  </div>
                  <span className={`text-xs ${isLive ? 'text-raptors-red font-bold animate-pulse' : isFinal ? 'text-slate-500' : isDark ? 'text-slate-400' : 'text-slate-500'}`}>
                    {isLive && 'ðŸ”´ '}{game.status}
                  </span>
                  <div className="flex items-center gap-2">
                    <span className={`text-xs font-mono font-bold ${game.homeScore > game.awayScore ? 'text-green-500' : isDark ? 'text-white' : 'text-slate-800'}`}>{game.homeScore || '-'}</span>
                    <span className={`text-xs font-bold ${game.isRaptors && game.home === 'TOR' ? 'text-raptors-red' : isDark ? 'text-slate-300' : 'text-slate-700'}`}>{game.home}</span>
                    <img loading="lazy" src={`https://cdn.nba.com/logos/nba/${game.homeId}/primary/L/logo.svg`} className="w-4 h-4" alt="" />
                  </div>
                </div>
              );
            })}
          </div>
        </div>
      </div>
    </div>
  );
};

// Form Indicator Component
const FormIndicator = ({ form }) => {
  if (form === 'hot') return <span className="flex items-center gap-0.5 text-[8px] font-bold text-orange-400 bg-orange-400/10 px-1 py-0.5 rounded" title="Hot - Last 5 games above average"><Flame className="w-2.5 h-2.5" /> HOT</span>;
  if (form === 'cold') return <span className="flex items-center gap-0.5 text-[8px] font-bold text-blue-400 bg-blue-400/10 px-1 py-0.5 rounded" title="Cold - Last 5 games below average"><Snowflake className="w-2.5 h-2.5" /> COLD</span>;
  return null;
};

// === BETTING INTELLIGENCE COMPONENTS ===

// Collapsible Section helper
const BettingSection = ({ title, icon, isDark, defaultOpen = false, children }) => {
  const [open, setOpen] = React.useState(defaultOpen);
  return (
    <div className={`${isDark ? 'bg-black/20 border border-white/5' : 'bg-slate-50 border border-slate-200'} rounded-xl overflow-hidden`}>
      <button onClick={() => setOpen(!open)} className={`w-full flex items-center justify-between p-3 ${isDark ? 'hover:bg-white/5' : 'hover:bg-slate-100'} transition-colors`}>
        <span className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>{icon} {title}</span>
        <ChevronDown className={`w-3.5 h-3.5 ${isDark ? 'text-slate-400' : 'text-slate-500'} transition-transform ${open ? 'rotate-180' : ''}`} />
      </button>
      {open && <div className="p-3 pt-0">{children}</div>}
    </div>
  );
};

// Live Odds Ticker
const LiveOddsTickerWidget = ({ isDark = true }) => {
  const d = BETTING_INTEL.odds;
  const items = Object.entries(d.books).map(([name, b]) => (
    `${name}: TOR ${b.spread.line} (${b.spread.vig}) | ML ${b.ml.raptors} | O/U ${b.ou.line}`
  ));
  return (
    <div className={`${isDark ? 'bg-black/30 border border-white/10' : 'bg-slate-100 border border-slate-200'} rounded-lg overflow-hidden mb-3`}>
      <div className="flex items-center">
        <div className={`px-2 py-1.5 ${BETTING_INTEL.odds._live ? (isDark ? 'bg-emerald-600' : 'bg-emerald-500') : (isDark ? 'bg-raptors-red/80' : 'bg-raptors-red')} text-white text-[9px] font-bold uppercase shrink-0`}>{BETTING_INTEL.odds._live ? 'ðŸ”´ LIVE' : 'ODDS'}</div>
        <div className="overflow-hidden flex-1">
          <div className="animate-marquee whitespace-nowrap py-1.5">
            {items.map((item, i) => (
              <span key={i} className={`text-[10px] font-mono ${isDark ? 'text-slate-300' : 'text-slate-600'} mx-4`}>
                {item} {i < items.length - 1 ? 'â€¢' : ''}
              </span>
            ))}
            {items.map((item, i) => (
              <span key={`dup-${i}`} className={`text-[10px] font-mono ${isDark ? 'text-slate-300' : 'text-slate-600'} mx-4`}>
                {item} {i < items.length - 1 ? 'â€¢' : ''}
              </span>
            ))}
          </div>
        </div>
      </div>
    </div>
  );
};

// Odds Comparison Widget
const OddsComparisonWidget = ({ isDark = true }) => {
  const d = BETTING_INTEL.odds;
  const books = Object.entries(d.books);
  const bestSpread = Math.max(...books.map(([,b]) => b.spread.line));
  const bestML = Math.max(...books.map(([,b]) => b.ml.raptors));
  const bestOU = Math.max(...books.map(([,b]) => b.ou.line));
  const openLine = d.opening;

  return (
    <div className="space-y-3">
      <div className="overflow-x-auto">
        <table className="w-full text-[10px]">
          <thead>
            <tr className={isDark ? 'text-slate-400' : 'text-slate-500'}>
              <th className="text-left py-1 font-medium">Book</th>
              <th className="text-center py-1 font-medium">Spread</th>
              <th className="text-center py-1 font-medium">ML TOR</th>
              <th className="text-center py-1 font-medium">ML OPP</th>
              <th className="text-center py-1 font-medium">O/U</th>
              <th className="text-right py-1 font-medium">Updated</th>
            </tr>
          </thead>
          <tbody>
            {books.map(([name, b]) => (
              <tr key={name} className={`${isDark ? 'border-t border-white/5' : 'border-t border-slate-100'}`}>
                <td className={`py-1.5 font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{name}</td>
                <td className={`py-1.5 text-center font-mono font-bold ${b.spread.line === bestSpread ? 'text-green-400' : isDark ? 'text-slate-300' : 'text-slate-600'}`}>{b.spread.line} ({b.spread.vig})</td>
                <td className={`py-1.5 text-center font-mono font-bold ${b.ml.raptors === bestML ? 'text-green-400' : isDark ? 'text-slate-300' : 'text-slate-600'}`}>{b.ml.raptors}</td>
                <td className={`py-1.5 text-center font-mono ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>+{b.ml.opp}</td>
                <td className={`py-1.5 text-center font-mono font-bold ${b.ou.line === bestOU ? 'text-green-400' : isDark ? 'text-slate-300' : 'text-slate-600'}`}>{b.ou.line}</td>
                <td className={`py-1.5 text-right ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{b.updated}</td>
              </tr>
            ))}
          </tbody>
        </table>
      </div>
      <div className={`flex gap-3 text-[9px] ${isDark ? 'text-slate-400' : 'text-slate-500'} pt-1`}>
        <span>Open: TOR {openLine.spread} | ML {openLine.ml} | O/U {openLine.ou}</span>
        <span className="text-raptors-red font-bold">â†’ Moved {Math.abs(d.books.DraftKings.spread.line - openLine.spread)} pts</span>
      </div>
    </div>
  );
};

// ATS Trends Widget
const ATSTrendsWidget = ({ isDark = true }) => {
  const d = BETTING_INTEL.ats;
  const { BarChart, Bar, XAxis, YAxis, Tooltip, ResponsiveContainer, Cell } = window.Recharts;
  const records = [
    { label: "Overall", ...d.overall }, { label: "Home", ...d.home }, { label: "Away", ...d.away },
    { label: "L10", ...d.last10 }, { label: "L20", ...d.last20 }, { label: "Fav", ...d.asFavorite },
    { label: "Dog", ...d.asUnderdog }
  ];
  const marginData = Object.entries(d.margins).map(([k, v]) => ({ name: k, w: v.w, l: v.l }));

  return (
    <div className="space-y-3">
      <div className="grid grid-cols-4 gap-1.5">
        {records.slice(0, 4).map(r => (
          <div key={r.label} className={`p-2 rounded-lg text-center ${isDark ? 'bg-cmd-bg' : 'bg-white border border-slate-100'}`}>
            <div className={`text-sm font-black ${(r.pct||r.w/(r.w+r.l)*100) > 50 ? 'text-green-400' : 'text-red-400'}`}>{r.w}-{r.l}</div>
            <div className={`text-[8px] ${isDark ? 'text-slate-500' : 'text-slate-400'} uppercase`}>{r.label}</div>
          </div>
        ))}
      </div>
      <div className="grid grid-cols-3 gap-1.5">
        {records.slice(4).map(r => (
          <div key={r.label} className={`p-2 rounded-lg text-center ${isDark ? 'bg-cmd-bg' : 'bg-white border border-slate-100'}`}>
            <div className={`text-sm font-black ${(r.pct||r.w/(r.w+r.l)*100) > 50 ? 'text-green-400' : 'text-red-400'}`}>{r.w}-{r.l}</div>
            <div className={`text-[8px] ${isDark ? 'text-slate-500' : 'text-slate-400'} uppercase`}>{r.label}</div>
          </div>
        ))}
      </div>
      <div className="h-28">
        <ResponsiveContainer width="100%" height="100%">
          <BarChart data={marginData} barSize={16}>
            <XAxis dataKey="name" tick={{ fill: isDark ? '#94a3b8' : '#64748b', fontSize: 9 }} axisLine={false} tickLine={false} />
            <YAxis hide />
            <Bar dataKey="w" fill="#22c55e" radius={[3,3,0,0]} name="Wins" />
            <Bar dataKey="l" fill="#ef4444" radius={[3,3,0,0]} name="Losses" />
          </BarChart>
        </ResponsiveContainer>
      </div>
      <div className={`grid grid-cols-2 gap-2 text-[10px] ${isDark ? 'text-slate-300' : 'text-slate-600'}`}>
        <div className="flex justify-between"><span>Conference</span><span className="font-bold">{d.conference.w}-{d.conference.l - d.conference.w + d.conference.w} ({d.conference.pct}%)</span></div>
        <div className="flex justify-between"><span>Division</span><span className="font-bold">{d.division.w}-{d.division.l} ({d.division.pct}%)</span></div>
        <div className="flex justify-between"><span>After Win</span><span className="font-bold">{d.afterWin.w}-{d.afterWin.l}</span></div>
        <div className="flex justify-between"><span>After Loss</span><span className="font-bold">{d.afterLoss.w}-{d.afterLoss.l}</span></div>
      </div>
    </div>
  );
};

// Over/Under Trends Widget
const OverUnderTrendsWidget = ({ isDark = true }) => {
  const d = BETTING_INTEL.ouTrends;
  const records = [
    { label: "Overall", ...d.overall }, { label: "Home", ...d.home }, { label: "Away", ...d.away }, { label: "L10", ...d.last10 }
  ];
  const quarterData = Object.entries(d.byQuarter).map(([q, v]) => ({ name: q, over: v.over, under: v.under }));
  const { BarChart, Bar, XAxis, ResponsiveContainer } = window.Recharts;

  return (
    <div className="space-y-3">
      <div className="grid grid-cols-4 gap-1.5">
        {records.map(r => (
          <div key={r.label} className={`p-2 rounded-lg text-center ${isDark ? 'bg-cmd-bg' : 'bg-white border border-slate-100'}`}>
            <div className={`text-sm font-black ${(r.pct||(r.over/(r.over+r.under)*100)) > 50 ? 'text-green-400' : 'text-red-400'}`}>{r.over}-{r.under}</div>
            <div className={`text-[8px] ${isDark ? 'text-slate-500' : 'text-slate-400'} uppercase`}>{r.label}</div>
          </div>
        ))}
      </div>
      <div className="grid grid-cols-3 gap-2">
        <div className={`p-2 rounded-lg text-center ${isDark ? 'bg-cmd-bg' : 'bg-white border border-slate-100'}`}>
          <div className={`text-lg font-black ${isDark ? 'text-white' : 'text-slate-800'}`}>{d.avgTotal}</div>
          <div className={`text-[8px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>AVG TOTAL</div>
        </div>
        <div className={`p-2 rounded-lg text-center ${isDark ? 'bg-cmd-bg' : 'bg-white border border-slate-100'}`}>
          <div className="text-lg font-black text-raptors-red">{d.avgTeamPts}</div>
          <div className={`text-[8px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>TOR PPG</div>
        </div>
        <div className={`p-2 rounded-lg text-center ${isDark ? 'bg-cmd-bg' : 'bg-white border border-slate-100'}`}>
          <div className={`text-lg font-black ${isDark ? 'text-blue-400' : 'text-blue-500'}`}>{d.avgOppPts}</div>
          <div className={`text-[8px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>OPP PPG</div>
        </div>
      </div>
      <div className="h-24">
        <ResponsiveContainer width="100%" height="100%">
          <BarChart data={quarterData} barSize={14}>
            <XAxis dataKey="name" tick={{ fill: isDark ? '#94a3b8' : '#64748b', fontSize: 9 }} axisLine={false} tickLine={false} />
            <Bar dataKey="over" fill="#22c55e" radius={[3,3,0,0]} />
            <Bar dataKey="under" fill="#ef4444" radius={[3,3,0,0]} />
          </BarChart>
        </ResponsiveContainer>
      </div>
      <div className="space-y-1">
        {d.streaks.map((s, i) => (
          <div key={i} className={`text-[10px] ${isDark ? 'text-amber-400' : 'text-amber-600'} flex items-center gap-1`}>
            <span>ðŸ”¥</span> {s}
          </div>
        ))}
      </div>
    </div>
  );
};

// Player Props Insight Widget
const PlayerPropsInsightWidget = ({ isDark = true }) => {
  const players = BETTING_INTEL.playerProps;
  return (
    <div className="space-y-2">
      <div className="overflow-x-auto">
        <table className="w-full text-[9px]">
          <thead>
            <tr className={isDark ? 'text-slate-400' : 'text-slate-500'}>
              <th className="text-left py-1">Player</th>
              <th className="text-center py-1">PTS</th>
              <th className="text-center py-1">REB</th>
              <th className="text-center py-1">AST</th>
              <th className="text-center py-1">3PM</th>
              <th className="text-center py-1">ADJ</th>
            </tr>
          </thead>
          <tbody>
            {players.map(p => (
              <tr key={p.name} className={`${isDark ? 'border-t border-white/5' : 'border-t border-slate-100'}`}>
                <td className={`py-1.5 font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-1`}>
                  {p.name.split(' ')[1]}
                  {p.hot && <span className="text-[7px] bg-orange-500/20 text-orange-400 px-1 rounded font-bold">ðŸ”¥</span>}
                </td>
                <td className="py-1.5 text-center">
                  <span className="font-mono font-bold">{p.pts.line}</span>
                  <span className={`block text-[8px] ${p.pts.overRate > 55 ? 'text-green-400' : p.pts.overRate < 45 ? 'text-red-400' : isDark ? 'text-slate-500' : 'text-slate-400'}`}>{p.pts.overRate}%O</span>
                </td>
                <td className="py-1.5 text-center">
                  <span className="font-mono font-bold">{p.reb.line}</span>
                  <span className={`block text-[8px] ${p.reb.overRate > 55 ? 'text-green-400' : p.reb.overRate < 45 ? 'text-red-400' : isDark ? 'text-slate-500' : 'text-slate-400'}`}>{p.reb.overRate}%O</span>
                </td>
                <td className="py-1.5 text-center">
                  <span className="font-mono font-bold">{p.ast.line}</span>
                  <span className={`block text-[8px] ${p.ast.overRate > 55 ? 'text-green-400' : p.ast.overRate < 45 ? 'text-red-400' : isDark ? 'text-slate-500' : 'text-slate-400'}`}>{p.ast.overRate}%O</span>
                </td>
                <td className="py-1.5 text-center">
                  <span className="font-mono font-bold">{p.threes.line}</span>
                  <span className={`block text-[8px] ${p.threes.overRate > 55 ? 'text-green-400' : p.threes.overRate < 45 ? 'text-red-400' : isDark ? 'text-slate-500' : 'text-slate-400'}`}>{p.threes.overRate}%O</span>
                </td>
                <td className={`py-1.5 text-center font-mono text-[9px] ${p.matchupAdj > 0 ? 'text-green-400' : 'text-red-400'}`}>
                  {p.matchupAdj > 0 ? '+' : ''}{p.matchupAdj}
                </td>
              </tr>
            ))}
          </tbody>
        </table>
      </div>
      <div className={`text-[8px] ${isDark ? 'text-slate-500' : 'text-slate-400'} text-center`}>ADJ = Matchup adjustment vs opponent DRTG â€¢ %O = Over hit rate L10</div>
    </div>
  );
};

// Sharp Money Widget
const SharpMoneyWidget = ({ isDark = true }) => {
  const d = BETTING_INTEL.sharp;
  const SplitBar = ({ label, pub, sharp, pubLabel, sharpLabel }) => (
    <div className="space-y-1">
      <div className={`text-[9px] font-bold ${isDark ? 'text-slate-400' : 'text-slate-500'} uppercase`}>{label}</div>
      <div>
        <div className={`flex justify-between text-[8px] mb-0.5 ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>
          <span>Public: {pubLabel} {pub}%</span><span>Money: {sharpLabel} {sharp}%</span>
        </div>
        <div className="flex gap-0.5">
          <div className="flex h-2.5 rounded-l-full overflow-hidden flex-1">
            <div className="bg-raptors-red/60" style={{width: `${pub}%`}} />
            <div className={`${isDark ? 'bg-slate-700' : 'bg-slate-300'}`} style={{width: `${100-pub}%`}} />
          </div>
          <div className="flex h-2.5 rounded-r-full overflow-hidden flex-1">
            <div className="bg-emerald-500/70" style={{width: `${sharp}%`}} />
            <div className={`${isDark ? 'bg-slate-700' : 'bg-slate-300'}`} style={{width: `${100-sharp}%`}} />
          </div>
        </div>
      </div>
    </div>
  );

  return (
    <div className="space-y-3">
      <SplitBar label="Spread" pub={d.spreadPublic.raptors} sharp={d.spreadMoney.raptors} pubLabel="TOR" sharpLabel="TOR" />
      <SplitBar label="Over/Under" pub={d.ouPublic.over} sharp={d.ouMoney.over} pubLabel="Over" sharpLabel="Over" />
      <SplitBar label="Moneyline" pub={d.mlPublic.raptors} sharp={d.mlMoney.raptors} pubLabel="TOR" sharpLabel="TOR" />
      {d.steamMoves.length > 0 && (
        <div className="space-y-1">
          <div className={`text-[9px] font-bold ${isDark ? 'text-slate-400' : 'text-slate-500'} uppercase`}>Steam Moves</div>
          {d.steamMoves.map((m, i) => (
            <div key={i} className={`flex items-center gap-2 text-[10px] p-1.5 rounded ${m.alert ? (isDark ? 'bg-amber-500/10 border border-amber-500/20' : 'bg-amber-50 border border-amber-200') : (isDark ? 'bg-cmd-bg' : 'bg-slate-50')}`}>
              {m.alert && <span className="text-amber-400 text-[8px] font-bold">âš¡ STEAM</span>}
              <span className={isDark ? 'text-slate-400' : 'text-slate-500'}>{m.time}</span>
              <span className={`font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{m.direction}</span>
              <span className={isDark ? 'text-slate-500' : 'text-slate-400'}>@ {m.book}</span>
            </div>
          ))}
        </div>
      )}
      {d.reverseLineMovement.detected && (
        <div className={`p-2 rounded-lg text-[10px] ${isDark ? 'bg-purple-500/10 border border-purple-500/20 text-purple-300' : 'bg-purple-50 border border-purple-200 text-purple-700'}`}>
          <span className="font-bold">âš ï¸ Reverse Line Movement: </span>{d.reverseLineMovement.detail}
        </div>
      )}
    </div>
  );
};

// Situational Angles Widget
const SituationalAnglesWidget = ({ isDark = true }) => {
  const d = BETTING_INTEL.situations;
  const angles = [
    { label: "Back-to-Back", ...d.b2b },
    { label: "Rest Advantage", ...d.restAdvantage },
    { label: "After 3+ Days Rest", ...d.afterBreak },
    { label: "Division Rivals", ...d.divisionRivals },
    { label: "National TV", ...d.nationalTV }
  ];
  const monthly = Object.entries(d.monthly);

  return (
    <div className="space-y-3">
      <div className="space-y-1.5">
        {angles.map(a => (
          <div key={a.label} className={`flex items-center justify-between p-2 rounded-lg ${isDark ? 'bg-cmd-bg' : 'bg-white border border-slate-100'}`}>
            <span className={`text-[10px] ${isDark ? 'text-slate-300' : 'text-slate-600'}`}>{a.label}</span>
            <div className="flex items-center gap-2">
              <span className={`text-xs font-mono font-bold ${a.pct > 55 ? 'text-green-400' : a.pct < 45 ? 'text-red-400' : isDark ? 'text-white' : 'text-slate-800'}`}>{a.w}-{a.l}</span>
              <span className={`text-[9px] font-mono ${a.pct > 55 ? 'text-green-400' : a.pct < 45 ? 'text-red-400' : isDark ? 'text-slate-400' : 'text-slate-500'}`}>{a.pct}%</span>
            </div>
          </div>
        ))}
      </div>
      <div>
        <div className={`text-[9px] font-bold ${isDark ? 'text-slate-400' : 'text-slate-500'} uppercase mb-1.5`}>Monthly ATS</div>
        <div className="flex gap-1.5">
          {monthly.map(([month, r]) => (
            <div key={month} className={`flex-1 p-1.5 rounded text-center ${isDark ? 'bg-cmd-bg' : 'bg-white border border-slate-100'}`}>
              <div className={`text-[8px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{month}</div>
              <div className={`text-[10px] font-bold ${r.w > r.l ? 'text-green-400' : 'text-red-400'}`}>{r.w}-{r.l}</div>
            </div>
          ))}
        </div>
      </div>
    </div>
  );
};

// Betting Model Widget
const BettingModelWidget = ({ isDark = true }) => {
  const d = BETTING_INTEL.model;
  const scoreColor = d.compositeScore >= 70 ? 'text-green-400' : d.compositeScore >= 50 ? 'text-amber-400' : 'text-red-400';
  const scoreBg = d.compositeScore >= 70 ? 'from-green-500/20' : d.compositeScore >= 50 ? 'from-amber-500/20' : 'from-red-500/20';

  return (
    <div className="space-y-3">
      <div className="flex items-center gap-3">
        <div className={`w-16 h-16 rounded-xl bg-gradient-to-br ${scoreBg} to-transparent flex flex-col items-center justify-center`}>
          <div className={`text-2xl font-black ${scoreColor}`}>{d.compositeScore}</div>
          <div className={`text-[7px] ${isDark ? 'text-slate-500' : 'text-slate-400'} uppercase`}>Score</div>
        </div>
        <div className="flex-1 space-y-1">
          <div className="flex justify-between">
            <span className={`text-[10px] ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>Predicted</span>
            <span className={`text-sm font-mono font-black ${isDark ? 'text-white' : 'text-slate-800'}`}>TOR {d.predictedScore.raptors} - {d.predictedScore.opp} OPP</span>
          </div>
          <div className="flex justify-between">
            <span className={`text-[10px] ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>Power</span>
            <span className={`text-xs font-mono ${isDark ? 'text-slate-300' : 'text-slate-600'}`}>TOR {d.raptorsPower} vs {d.oppPower} OPP</span>
          </div>
        </div>
      </div>
      <div className="grid grid-cols-3 gap-1.5">
        {[d.spreadPick, d.mlPick, d.ouPick].map((pick, i) => (
          <div key={i} className={`p-2 rounded-lg text-center ${isDark ? 'bg-cmd-bg' : 'bg-white border border-slate-100'}`}>
            <div className={`text-[10px] font-bold ${pick.confidence >= 65 ? 'text-green-400' : 'text-amber-400'}`}>{pick.pick}</div>
            <div className={`text-[8px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{pick.confidence}% conf</div>
            <div className="text-[8px] text-emerald-400">+{pick.edge}% edge</div>
          </div>
        ))}
      </div>
      <div className="space-y-1">
        {d.factors.map((f, i) => (
          <div key={i} className={`text-[10px] ${isDark ? 'text-slate-300' : 'text-slate-600'} flex items-start gap-1.5`}>
            <span className="text-raptors-red mt-0.5">â€¢</span> {f}
          </div>
        ))}
      </div>
    </div>
  );
};

// Prop Builder Widget
const PropBuilderWidget = ({ isDark = true }) => {
  const players = BETTING_INTEL.playerProps;
  const correlations = BETTING_INTEL.correlations;
  const [selectedPlayer, setSelectedPlayer] = React.useState(0);
  const [selectedStat, setSelectedStat] = React.useState('pts');
  const { BarChart, Bar, XAxis, YAxis, ReferenceLine, ResponsiveContainer, Cell } = window.Recharts;
  
  const player = players[selectedPlayer];
  const statData = player[selectedStat];
  const last10 = statData.last10 || [];
  const chartData = last10.map((v, i) => ({ game: `G${i+1}`, value: v }));
  const avg = last10.length > 0 ? (last10.reduce((a,b) => a+b, 0) / last10.length).toFixed(1) : 0;
  const overCount = last10.filter(v => v > statData.line).length;

  return (
    <div className="space-y-3">
      <div className="flex gap-2 flex-wrap">
        {players.map((p, i) => (
          <button key={i} onClick={() => setSelectedPlayer(i)}
            className={`text-[9px] px-2 py-1 rounded-full font-bold transition-colors ${i === selectedPlayer ? 'bg-raptors-red text-white' : isDark ? 'bg-cmd-bg text-slate-400 hover:text-white' : 'bg-slate-100 text-slate-500 hover:text-slate-800'}`}>
            {p.name.split(' ')[1]}
          </button>
        ))}
      </div>
      <div className="flex gap-1.5">
        {['pts','reb','ast'].map(stat => (
          <button key={stat} onClick={() => setSelectedStat(stat)}
            className={`text-[9px] px-2 py-1 rounded font-bold uppercase transition-colors ${stat === selectedStat ? 'bg-white/10 text-white border border-white/20' : isDark ? 'text-slate-500 hover:text-slate-300' : 'text-slate-400 hover:text-slate-600'}`}>
            {stat}
          </button>
        ))}
      </div>
      <div className="h-32">
        <ResponsiveContainer width="100%" height="100%">
          <BarChart data={chartData} barSize={18}>
            <XAxis dataKey="game" tick={{ fill: isDark ? '#64748b' : '#94a3b8', fontSize: 8 }} axisLine={false} tickLine={false} />
            <YAxis hide />
            <ReferenceLine y={statData.line} stroke="#CE1141" strokeDasharray="3 3" label={{ value: statData.line, fill: '#CE1141', fontSize: 9, position: 'right' }} />
            <Bar dataKey="value" radius={[3,3,0,0]}>
              {chartData.map((entry, i) => (
                <Cell key={i} fill={entry.value > statData.line ? '#22c55e' : '#ef4444'} />
              ))}
            </Bar>
          </BarChart>
        </ResponsiveContainer>
      </div>
      <div className="flex justify-between items-center">
        <div className={`text-[10px] ${isDark ? 'text-slate-300' : 'text-slate-600'}`}>
          Avg: <span className="font-bold">{avg}</span> | Line: <span className="font-bold">{statData.line}</span> | Over: <span className={`font-bold ${overCount >= 6 ? 'text-green-400' : 'text-red-400'}`}>{overCount}/10</span>
        </div>
        <div className={`text-[10px] font-bold ${overCount >= 6 ? 'text-green-400' : 'text-red-400'}`}>
          {overCount >= 6 ? 'âœ… LEAN OVER' : 'âŒ LEAN UNDER'}
        </div>
      </div>
      <div className="space-y-1 pt-1">
        <div className={`text-[9px] font-bold ${isDark ? 'text-slate-400' : 'text-slate-500'} uppercase`}>Correlations</div>
        {correlations.map((c, i) => (
          <div key={i} className={`flex items-center justify-between text-[10px] p-1.5 rounded ${isDark ? 'bg-cmd-bg' : 'bg-slate-50'}`}>
            <span className={isDark ? 'text-slate-300' : 'text-slate-600'}>{c.trigger} â†’ {c.result}</span>
            <span className={`font-bold ${c.strength >= 70 ? 'text-green-400' : 'text-amber-400'}`}>{c.strength}%</span>
          </div>
        ))}
      </div>
    </div>
  );
};

// Print/Export Report
const ExportButton = ({ game, isDark = true }) => {
  const handleExport = () => {
    // Create a print-friendly view
    const printContent = `
      RAPTORS INTEL - SCOUTING REPORT
      ================================
      
      Matchup: Toronto Raptors vs ${game?.opponent || 'TBD'}
      Date: ${game?.date || 'TBD'} | Venue: ${game?.venue || 'TBD'}
      
      Record: ${RAPTORS_STATS.wins}-${RAPTORS_STATS.losses} | Streak: ${RAPTORS_STATS.streak}
      
      Generated by Raptors Intel - https://rajkcho.github.io/raptorsintel/
    `;
    
    // Open print dialog
    const printWindow = window.open('', '_blank');
    printWindow.document.write(`
      <html>
        <head>
          <title>Raptors Intel - ${game?.opponent || 'Scouting'} Report</title>
          <style>
            body { font-family: system-ui, sans-serif; padding: 40px; max-width: 800px; margin: 0 auto; }
            h1 { color: #CE1141; }
            .stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin: 20px 0; }
            .stat-box { background: #f5f5f5; padding: 15px; border-radius: 8px; text-align: center; }
            .stat-value { font-size: 24px; font-weight: bold; }
            .stat-label { font-size: 12px; color: #666; }
          </style>
        </head>
        <body>
          <h1>ðŸ¦– RAPTORS INTEL</h1>
          <h2>Scouting Report: vs ${game?.opponent || 'TBD'}</h2>
          <p><strong>Date:</strong> ${game?.date || 'TBD'} | <strong>Venue:</strong> ${game?.venue || 'TBD'}</p>
          <div class="stats">
            <div class="stat-box"><div class="stat-value">${RAPTORS_STATS.wins}-${RAPTORS_STATS.losses}</div><div class="stat-label">Record</div></div>
            <div class="stat-box"><div class="stat-value">${RAPTORS_STATS.streak}</div><div class="stat-label">Streak</div></div>
            <div class="stat-box"><div class="stat-value">${RAPTORS_STATS.ppg}</div><div class="stat-label">PPG</div></div>
          </div>
          <hr>
          <p style="color: #666; font-size: 12px;">Generated by Raptors Intel â€¢ Not affiliated with NBA or Toronto Raptors</p>
        </body>
      </html>
    `);
    printWindow.document.close();
    printWindow.print();
  };

  return (
    <button onClick={handleExport} className={`p-2 rounded-lg transition-all ${isDark ? 'hover:bg-cmd-card text-slate-400 hover:text-white' : 'hover:bg-light-card text-slate-500 hover:text-slate-800'}`} title="Export Report">
      <Printer className="w-4 h-4" />
    </button>
  );
};

// Win Streak Celebration - ENHANCED
const StreakCelebration = ({ streak, isDark = true }) => {
  if (!streak || !streak.startsWith('W')) return null;
  const wins = parseInt(streak.slice(1)) || 0;
  if (wins < 3) return null;
  
  return (
    <div className={`${isDark ? 'animated-border' : 'bg-white border-2 border-green-500 shadow-lg'} rounded-2xl relative overflow-hidden`}>
      {/* Animated background */}
      <div className="absolute inset-0 bg-gradient-to-br from-green-500/20 via-raptors-red/10 to-green-500/20" style={{animation: 'gradient-shift 3s ease infinite', backgroundSize: '200% 200%'}}></div>
      
      {/* Sparkle particles */}
      <div className="absolute inset-0 overflow-hidden">
        {[...Array(8)].map((_, i) => (
          <div key={i} className="absolute w-1 h-1 bg-yellow-400 rounded-full" style={{
            left: `${10 + (i * 12)}%`,
            top: `${20 + Math.sin(i) * 30}%`,
            animation: `star-twinkle ${1 + Math.random()}s ease-in-out ${i * 0.2}s infinite`,
            boxShadow: '0 0 6px rgba(250, 204, 21, 0.8)'
          }} />
        ))}
      </div>
      
      <div className="relative z-10 p-5 text-center">
        {/* Animated fire icons */}
        <div className="flex justify-center gap-2 mb-2">
          {[...Array(Math.min(wins, 5))].map((_, i) => (
            <span key={i} className="text-2xl" style={{
              animation: 'float 2s ease-in-out infinite',
              animationDelay: `${i * 0.15}s`
            }}>ðŸ”¥</span>
          ))}
        </div>
        
        {/* Main text with neon effect */}
        <div className={`text-3xl font-black ${isDark ? 'text-white neon-text' : 'text-slate-800'} tracking-tight`}>
          {wins} GAME STREAK!
        </div>
        
        {/* Subtitle */}
        <div className={`text-sm font-bold uppercase mt-1 tracking-widest ${isDark ? 'text-green-400' : 'text-green-600'}`} style={{textShadow: isDark ? '0 0 10px rgba(74, 222, 128, 0.5)' : 'none'}}>
          ðŸ¦– RAPTORS ARE ON FIRE ðŸ¦–
        </div>
        
        {/* Win indicators */}
        <div className="flex justify-center gap-2 mt-3">
          {[...Array(Math.min(wins, 10))].map((_, i) => (
            <div key={i} 
              className="w-6 h-6 rounded-full bg-gradient-to-br from-green-400 to-green-600 flex items-center justify-center shadow-lg"
              style={{
                animation: 'card-entrance 0.5s ease-out forwards',
                animationDelay: `${i * 0.08}s`,
                opacity: 0,
                boxShadow: '0 0 10px rgba(74, 222, 128, 0.5)'
              }}
            >
              <span className="text-white text-xs font-black">W</span>
            </div>
          ))}
        </div>
        
        {/* Progress bar to next milestone */}
        <div className="mt-4 px-4">
          <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'} mb-1`}>
            {wins < 10 ? `${10 - wins} wins to double digits!` : 'Double digit streak! ðŸŽ‰'}
          </div>
          <div className={`h-1.5 rounded-full ${isDark ? 'bg-cmd-border' : 'bg-light-border'} overflow-hidden`}>
            <div 
              className="h-full rounded-full bg-gradient-to-r from-green-400 to-green-500"
              style={{
                width: `${Math.min((wins / 10) * 100, 100)}%`,
                animation: 'bar-grow 1.5s ease-out',
                boxShadow: '0 0 10px rgba(74, 222, 128, 0.5)'
              }}
            />
          </div>
        </div>
      </div>
    </div>
  );
};

// Recent Results Widget - Last 5 games
const RecentResultsWidget = ({ games, isDark = true }) => {
  // Get last 5 completed games
  const recentGames = games
    .filter(g => g.status === 'completed' && g.result)
    .slice(-5)
    .reverse();
  
  if (recentGames.length === 0) return null;
  
  return (
    <div className={`${isDark ? 'premium-glass' : 'bg-white border border-light-border shadow-lg'} rounded-2xl p-4`}>
      <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase mb-3`}>
        <History className="w-3 h-3 text-raptors-red" /> Last 5 Games
      </h3>
      <div className="space-y-2">
        {recentGames.map((game, i) => {
          const isWin = game.result?.startsWith('W');
          return (
            <div key={i} className={`flex items-center justify-between p-2 rounded-lg ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`}>
              <div className="flex items-center gap-2">
                <span className={`w-6 h-6 rounded-full flex items-center justify-center text-[10px] font-black ${
                  isWin ? 'bg-green-500/20 text-green-400' : 'bg-red-500/20 text-red-400'
                }`}>
                  {isWin ? 'W' : 'L'}
                </span>
                <div className="flex items-center gap-1.5">
                  <img loading="lazy" src={`https://cdn.nba.com/logos/nba/${game.opponentId}/primary/L/logo.svg`} className="w-4 h-4" alt="" />
                  <span className={`text-[11px] font-medium ${isDark ? 'text-slate-300' : 'text-slate-600'}`}>{game.opponent}</span>
                </div>
              </div>
              <span className={`text-[10px] font-mono font-bold ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>
                {game.result?.split(' ')[1] || game.result}
              </span>
            </div>
          );
        })}
      </div>
      {/* Streak indicator */}
      <div className={`mt-3 pt-3 border-t ${isDark ? 'border-cmd-border' : 'border-light-border'} flex items-center justify-center gap-1`}>
        {recentGames.slice(0, 5).map((game, i) => {
          const isWin = game.result?.startsWith('W');
          return (
            <span key={i} className={`w-5 h-5 rounded-full flex items-center justify-center text-[8px] font-black ${
              isWin ? 'bg-green-500 text-white' : 'bg-red-500 text-white'
            }`}>
              {isWin ? 'W' : 'L'}
            </span>
          );
        })}
      </div>
    </div>
  );
};

// Key Matchups Widget - Shows star player matchups
const KeyMatchupsWidget = ({ opponent, isDark = true }) => {
  if (!opponent) return null;
  
  // Get opponent data
  const opponentData = OPPONENT_DATA[opponent];
  if (!opponentData?.roster) return null;
  
  // Get top player from each team by PPG
  const raptorsStar = RAPTORS_ROSTER.slice().sort((a, b) => (b.seasonStats?.ppg || 0) - (a.seasonStats?.ppg || 0))[0];
  const opponentStar = opponentData.roster.slice().sort((a, b) => (b.seasonStats?.ppg || 0) - (a.seasonStats?.ppg || 0))[0];
  
  if (!raptorsStar || !opponentStar) return null;
  
  return (
    <div className={`${isDark ? 'premium-glass' : 'bg-white border border-light-border shadow-lg'} rounded-2xl p-4`}>
      <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase mb-3`}>
        <Swords className="w-3 h-3 text-orange-400" /> Key Matchup
      </h3>
      
      <div className="flex items-center justify-between">
        {/* Raptors Star */}
        <div className="text-center flex-1">
          <div className="w-12 h-12 mx-auto rounded-full overflow-hidden bg-raptors-red/20 mb-2">
            <img 
              src={getHeadshot(raptorsStar)} 
              className="w-full h-full object-cover object-top"
              loading="lazy"
              onError={(e) => { e.target.style.display = 'none'; e.target.nextSibling.style.display = 'flex'; }}
              alt={raptorsStar.name}
            />
            <div className="hidden w-full h-full items-center justify-center text-raptors-red font-black text-lg">
              {raptorsStar.name.split(' ').map(n => n[0]).join('')}
            </div>
          </div>
          <div className={`text-[11px] font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{raptorsStar.name.split(' ').pop()}</div>
          <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{raptorsStar.seasonStats?.ppg?.toFixed(1) || 0} PPG</div>
        </div>
        
        {/* VS Badge */}
        <div className={`px-3 py-1 rounded-full ${isDark ? 'bg-cmd-bg' : 'bg-light-card'} text-xs font-bold ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>
          VS
        </div>
        
        {/* Opponent Star */}
        <div className="text-center flex-1">
          <div className="w-12 h-12 mx-auto rounded-full overflow-hidden bg-blue-500/20 mb-2">
            <img 
              src={getHeadshot(opponentStar)} 
              className="w-full h-full object-cover object-top"
              loading="lazy"
              onError={(e) => { e.target.style.display = 'none'; e.target.nextSibling.style.display = 'flex'; }}
              alt={opponentStar.name}
            />
            <div className="hidden w-full h-full items-center justify-center text-blue-400 font-black text-lg">
              {opponentStar.name.split(' ').map(n => n[0]).join('')}
            </div>
          </div>
          <div className={`text-[11px] font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{opponentStar.name.split(' ').pop()}</div>
          <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{opponentStar.seasonStats?.ppg?.toFixed(1) || 0} PPG</div>
        </div>
      </div>
      
      {/* Comparison bars */}
      <div className="mt-3 pt-3 border-t ${isDark ? 'border-cmd-border' : 'border-light-border'} space-y-2">
        {['ppg', 'rpg', 'apg'].map(stat => {
          const r = raptorsStar.seasonStats?.[stat] || 0;
          const o = opponentStar.seasonStats?.[stat] || 0;
          const rPct = (r / (r + o || 1)) * 100;
          const labels = { ppg: 'PPG', rpg: 'RPG', apg: 'APG' };
          return (
            <div key={stat} className="flex items-center gap-2 text-[10px]">
              <span className={`w-8 font-mono font-bold text-right ${r > o ? 'text-green-400' : isDark ? 'text-slate-400' : 'text-slate-500'}`}>{r.toFixed(1)}</span>
              <div className="flex-1 h-1.5 rounded-full overflow-hidden flex bg-cmd-border">
                <div className="bg-raptors-red h-full" style={{width: `${rPct}%`}}></div>
                <div className="bg-blue-500 h-full flex-1"></div>
              </div>
              <span className={`w-8 font-mono font-bold ${o > r ? 'text-green-400' : isDark ? 'text-slate-400' : 'text-slate-500'}`}>{o.toFixed(1)}</span>
              <span className={`w-8 ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{labels[stat]}</span>
            </div>
          );
        })}
      </div>
    </div>
  );
};

// Season Progress Widget
const SeasonProgress = ({ isDark = true }) => {
  const totalGames = 82;
  const gamesPlayed = RAPTORS_STATS.wins + RAPTORS_STATS.losses;
  const gamesRemaining = totalGames - gamesPlayed;
  const winPct = gamesPlayed > 0 ? ((RAPTORS_STATS.wins / gamesPlayed) * 100).toFixed(1) : 0;
  const projectedWins = gamesPlayed > 0 ? Math.round((RAPTORS_STATS.wins / gamesPlayed) * totalGames) : 0;
  const progressPct = (gamesPlayed / totalGames) * 100;
  
  return (
    <div className={`${isDark ? 'premium-glass' : 'bg-white border border-light-border shadow-lg'} rounded-2xl p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <TrendingUp className="w-3 h-3 text-raptors-red" /> Season Progress
        </h3>
        <span className={`text-[10px] font-mono ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{gamesPlayed}/82</span>
      </div>
      
      {/* Progress bar */}
      <div className={`h-3 rounded-full overflow-hidden ${isDark ? 'bg-cmd-border' : 'bg-light-border'} mb-3`}>
        <div 
          className="h-full bg-gradient-to-r from-raptors-red to-raptors-purple rounded-full relative"
          style={{width: `${progressPct}%`, transition: 'width 1s ease-out'}}
        >
          <div className="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent animate-shimmer"></div>
        </div>
      </div>
      
      {/* Stats grid */}
      <div className="grid grid-cols-3 gap-2 text-center">
        <div className={`p-2 rounded-lg ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`}>
          <div className={`text-lg font-black ${isDark ? 'text-green-400' : 'text-green-600'}`}>{RAPTORS_STATS.wins}</div>
          <div className={`text-[8px] uppercase font-bold ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>Wins</div>
        </div>
        <div className={`p-2 rounded-lg ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`}>
          <div className={`text-lg font-black ${isDark ? 'text-red-400' : 'text-red-600'}`}>{RAPTORS_STATS.losses}</div>
          <div className={`text-[8px] uppercase font-bold ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>Losses</div>
        </div>
        <div className={`p-2 rounded-lg ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`}>
          <div className={`text-lg font-black ${isDark ? 'text-white' : 'text-slate-800'}`}>{winPct}%</div>
          <div className={`text-[8px] uppercase font-bold ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>Win %</div>
        </div>
      </div>
      
      {/* Projected finish */}
      <div className={`mt-3 pt-3 border-t ${isDark ? 'border-cmd-border' : 'border-light-border'} flex justify-between items-center`}>
        <span className={`text-[10px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>Projected Final</span>
        <span className={`text-sm font-bold ${projectedWins >= 41 ? 'text-green-400' : 'text-amber-400'}`}>{projectedWins}-{totalGames - projectedWins}</span>
      </div>
    </div>
  );
};

// Game Countdown Timer
const GameCountdown = ({ game, isDark = true, gameDayMode = false }) => {
  const [timeLeft, setTimeLeft] = useState({ days: 0, hours: 0, minutes: 0, seconds: 0 });
  const [isGameDay, setIsGameDay] = useState(false);
  
  useEffect(() => {
    if (!game || game.status !== 'upcoming') return;
    
    const calculateTime = () => {
      // Parse game date and time (assuming EST timezone)
      const gameYear = new Date().getFullYear();
      const dateParts = game.date.split(' '); // e.g., "Feb 11"
      const month = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'].indexOf(dateParts[0]);
      const day = parseInt(dateParts[1]);
      const timeParts = game.time.replace(' PM', '').replace(' AM', '').split(':');
      let hour = parseInt(timeParts[0]);
      if (game.time.includes('PM') && hour !== 12) hour += 12;
      if (game.time.includes('AM') && hour === 12) hour = 0;
      
      const gameDate = new Date(gameYear, month, day, hour, parseInt(timeParts[1]) || 0);
      const now = new Date();
      const diff = gameDate - now;
      
      if (diff <= 0) {
        setTimeLeft({ days: 0, hours: 0, minutes: 0, seconds: 0 });
        return;
      }
      
      const days = Math.floor(diff / (1000 * 60 * 60 * 24));
      const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
      const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
      const seconds = Math.floor((diff % (1000 * 60)) / 1000);
      
      setTimeLeft({ days, hours, minutes, seconds });
      setIsGameDay(days === 0);
    };
    
    calculateTime();
    const timer = setInterval(calculateTime, 1000);
    return () => clearInterval(timer);
  }, [game]);
  
  if (!game || game.status !== 'upcoming') return null;
  
  return (
    <div className={`${isDark ? 'premium-glass' : 'bg-white border border-light-border shadow-lg'} rounded-2xl p-4 relative overflow-hidden`}>
      {isGameDay && (
        <div className="absolute inset-0 bg-gradient-to-r from-raptors-red/10 via-transparent to-raptors-red/10" style={{animation: 'pulse 2s ease-in-out infinite'}}></div>
      )}
      <div className="relative z-10">
        <div className="flex items-center justify-between mb-3">
          <div className="flex items-center gap-2">
            <div className="w-8 h-8 rounded-full bg-raptors-red/20 flex items-center justify-center">
              <Timer className={`w-4 h-4 ${isGameDay ? 'text-raptors-red animate-pulse' : 'text-raptors-red'}`} />
            </div>
            <div>
              <div className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>
                {isGameDay ? 'ðŸ”¥ GAME DAY!' : 'Next Game'}
              </div>
              <div className={`text-[10px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>
                vs {game.opponent} â€¢ {game.time}
              </div>
            </div>
          </div>
          {game.isHome ? (
            <span className="text-[9px] font-bold uppercase bg-raptors-red/20 text-raptors-red px-2 py-1 rounded">HOME</span>
          ) : (
            <span className={`text-[9px] font-bold uppercase ${isDark ? 'bg-cmd-bg text-slate-400' : 'bg-light-card text-slate-500'} px-2 py-1 rounded`}>AWAY</span>
          )}
        </div>
        <div className="grid grid-cols-4 gap-2 text-center">
          {[
            { label: 'Days', value: timeLeft.days },
            { label: 'Hrs', value: timeLeft.hours },
            { label: 'Min', value: timeLeft.minutes },
            { label: 'Sec', value: timeLeft.seconds },
          ].map((unit, i) => (
            <div key={i} className={`p-2 rounded-lg ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`}>
              <div className={`${gameDayMode ? 'text-2xl' : 'text-xl'} font-mono font-black ${isGameDay && i < 2 ? 'text-raptors-red' : isDark ? 'text-white' : 'text-slate-800'} transition-all duration-300`}>
                {String(unit.value).padStart(2, '0')}
              </div>
              <div className={`text-[8px] uppercase font-bold ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{unit.label}</div>
            </div>
          ))}
        </div>
      </div>
    </div>
  );
};

// Quick Stats Bar - ENHANCED
const QuickStatsBar = ({ isDark = true }) => {
  const diff = RAPTORS_STATS.ppg - RAPTORS_STATS.oppPpg;
  const diffRounded = parseFloat(diff.toFixed(1));
  
  return (
    <div className={`${isDark ? 'premium-glass holo-card' : 'bg-white border border-light-border shadow-lg'} rounded-2xl p-4 relative overflow-hidden`}>
      {/* Decorative top bar */}
      <div className="absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-raptors-red via-raptors-purple to-raptors-red"></div>
      
      <div className="flex items-center justify-between gap-2">
        {/* PPG */}
        <div className={`text-center flex-1 py-2 rounded-lg transition-all hover:scale-105 ${isDark ? 'hover:bg-white/5' : 'hover:bg-slate-100'}`}>
          <div className="text-sm mb-1">âš”ï¸</div>
          <div className={`text-xl font-mono font-black ${isDark ? 'text-white' : 'text-slate-800'}`}>
            {RAPTORS_STATS.ppg.toFixed(1)}
          </div>
          <div className={`text-[9px] uppercase font-bold ${isDark ? 'text-slate-500' : 'text-slate-400'} tracking-wider`}>PPG</div>
        </div>
        
        {/* OPP PPG */}
        <div className={`text-center flex-1 py-2 rounded-lg transition-all hover:scale-105 ${isDark ? 'hover:bg-white/5' : 'hover:bg-slate-100'}`}>
          <div className="text-sm mb-1">ðŸ›¡ï¸</div>
          <div className={`text-xl font-mono font-black ${isDark ? 'text-white' : 'text-slate-800'}`}>
            {RAPTORS_STATS.oppPpg.toFixed(1)}
          </div>
          <div className={`text-[9px] uppercase font-bold ${isDark ? 'text-slate-500' : 'text-slate-400'} tracking-wider`}>OPP PPG</div>
        </div>
        
        {/* DIFF */}
        <div className={`text-center flex-1 py-2 rounded-lg transition-all hover:scale-105 ${isDark ? 'hover:bg-white/5' : 'hover:bg-slate-100'}`}>
          <div className="text-sm mb-1">{diffRounded >= 0 ? 'ðŸ“ˆ' : 'ðŸ“‰'}</div>
          <div className={`text-xl font-mono font-black ${
            diffRounded > 0 ? 'text-green-400' : diffRounded < 0 ? 'text-red-400' : (isDark ? 'text-slate-400' : 'text-slate-500')
          }`} style={diffRounded > 0 ? {textShadow: '0 0 10px rgba(74, 222, 128, 0.3)'} : diffRounded < 0 ? {textShadow: '0 0 10px rgba(248, 113, 113, 0.3)'} : {}}>
            {diffRounded > 0 ? '+' : ''}{diffRounded.toFixed(1)}
          </div>
          <div className={`text-[9px] uppercase font-bold ${isDark ? 'text-slate-500' : 'text-slate-400'} tracking-wider`}>DIFF</div>
        </div>
      </div>
    </div>
  );
};

// ============================================================
// MICRO-COMPONENTS
// ============================================================
const AnimatedCounter = ({ value, decimals = 1, duration = 1200, prefix = '', suffix = '' }) => {
  const [display, setDisplay] = useState(0);
  const ref = useRef(null);
  useEffect(() => {
    const target = Number(value) || 0;
    let start = null;
    const step = (ts) => {
      if (!start) start = ts;
      const progress = Math.min((ts - start) / duration, 1);
      const eased = 1 - Math.pow(1 - progress, 3);
      setDisplay(eased * target);
      if (progress < 1) ref.current = requestAnimationFrame(step);
    };
    ref.current = requestAnimationFrame(step);
    return () => cancelAnimationFrame(ref.current);
  }, [value, duration]);
  return React.createElement('span', null, prefix + display.toFixed(decimals) + suffix);
};

const WinProbRing = ({ value, size = 100 }) => {
  const r = 40;
  const circ = 2 * Math.PI * r;
  const offset = circ - (circ * (value || 0)) / 100;
  return (
    <div className="relative win-ring-glow" style={{ width: size, height: size }}>
      <svg viewBox="0 0 100 100" className="w-full h-full -rotate-90">
        <circle cx="50" cy="50" r={r} fill="none" stroke="rgba(206,17,65,0.15)" strokeWidth="6" />
        <circle cx="50" cy="50" r={r} fill="none" stroke="url(#ringGrad)" strokeWidth="6" strokeLinecap="round" strokeDasharray={circ} strokeDashoffset={offset} className="animate-ring-fill" style={{ animation: 'ring-fill 1.5s ease-out both' }} />
        <defs>
          <linearGradient id="ringGrad" x1="0%" y1="0%" x2="100%" y2="0%">
            <stop offset="0%" stopColor="#CE1141" />
            <stop offset="100%" stopColor="#3E2680" />
          </linearGradient>
        </defs>
      </svg>
      <div className="absolute inset-0 flex flex-col items-center justify-center">
        <div className="text-2xl font-black text-white neon-text"><AnimatedCounter value={value} decimals={0} suffix="%" /></div>
        <div className="text-[8px] uppercase font-bold text-slate-400 tracking-wider">Win Prob</div>
      </div>
    </div>
  );
};

const GlowDivider = () => (
  <div className="h-px w-full bg-gradient-to-r from-transparent via-raptors-red/40 to-transparent my-2"></div>
);

// ============================================================
// COURT DIAGRAM
// ============================================================
const getDiagram = (type) => {
    switch(type) {
        case 'pnr':
            return (
                <g>
                   <circle cx="50" cy="50" r="1.5" fill="#CE1141" style={{animation: 'drive 3s infinite'}} />
                   <path d="M50 50 Q 60 40 70 30" fill="none" stroke="#CE1141" strokeWidth="0.5" markerEnd="url(#arrowhead)" strokeDasharray="2,1" opacity="0.5" />
                   <circle cx="55" cy="45" r="1.5" fill="#94a3b8" style={{animation: 'screen-anim 3s infinite 1s'}} />
                   <line x1="55" y1="45" x2="60" y2="40" stroke="#94a3b8" strokeWidth="1" strokeLinecap="round" opacity="0.5" />
                   <text x="45" y="55" fontSize="2" fill="#94a3b8">PG</text>
                   <text x="52" y="44" fontSize="2" fill="#94a3b8">C</text>
                </g>
            );
        case 'horns':
             return (
                <g>
                    <circle cx="70" cy="20" r="1.5" fill="#94a3b8" />
                    <circle cx="70" cy="40" r="1.5" fill="#94a3b8" />
                    <circle cx="60" cy="30" r="1.5" fill="#CE1141" />
                    <path d="M60 30 L 70 20" fill="none" stroke="#CE1141" strokeWidth="0.5" strokeDasharray="1,1" style={{animation: 'pass 2s infinite'}} />
                    <path d="M60 30 L 70 40" fill="none" stroke="#CE1141" strokeWidth="0.5" strokeDasharray="1,1" style={{animation: 'pass 2s infinite 1s'}} />
                </g>
             );
        case 'zone':
             return (
                <g>
                    <circle cx="75" cy="20" r="1.5" fill="#6366f1" opacity="0.7" style={{animation: 'pulse-svg 2s infinite'}} />
                    <circle cx="75" cy="40" r="1.5" fill="#6366f1" opacity="0.7" style={{animation: 'pulse-svg 2s infinite 0.5s'}} />
                    <circle cx="85" cy="15" r="1.5" fill="#6366f1" opacity="0.7" style={{animation: 'pulse-svg 2s infinite 1s'}} />
                    <circle cx="85" cy="30" r="1.5" fill="#6366f1" opacity="0.7" style={{animation: 'pulse-svg 2s infinite 1.5s'}} />
                    <circle cx="85" cy="45" r="1.5" fill="#6366f1" opacity="0.7" style={{animation: 'pulse-svg 2s infinite 2s'}} />
                </g>
             );
        default:
            return (
                <g>
                    <path d="M60 10 Q 75 30 85 30" fill="none" stroke="#CE1141" strokeWidth="0.8" markerEnd="url(#arrowhead)" strokeDasharray="2,1" style={{animation: 'pass 3s infinite'}} />
                    <circle cx="60" cy="10" r="1.5" fill="#CE1141" style={{animation: 'pulse-svg 1s infinite'}} />
                    <text x="55" y="10" fontSize="3" fill="#94a3b8">ISO</text>
                </g>
            );
    }
};

const PlayOverlay = ({ play }) => (
    <g key={play.id}>
        <defs>
            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
              <polygon points="0 0, 10 3.5, 0 7" fill="#CE1141" />
            </marker>
        </defs>
        {getDiagram(play.diagramType)}
    </g>
);

const CourtDiagram = ({ play }) => (
    <div className="relative w-full pt-[60%] bg-[#0f1520] rounded-xl overflow-hidden border border-cmd-border shadow-lg">
      <div className="absolute inset-0">
          <svg viewBox="0 0 100 60" className="w-full h-full" preserveAspectRatio="none">
             <rect x="0" y="0" width="100" height="60" fill="#0f1520" />
             <rect x="0" y="22" width="12" height="16" fill="#CE1141" fillOpacity="0.08" />
             <rect x="88" y="22" width="12" height="16" fill="#3E2680" fillOpacity="0.08" />
             <circle cx="50" cy="30" r="8" fill="none" stroke="rgba(206,17,65,0.25)" strokeWidth="0.5" />
             <path d="M50 0 V60" stroke="rgba(206,17,65,0.15)" strokeWidth="0.2" />
             <rect x="0" y="22" width="12" height="16" fill="none" stroke="rgba(206,17,65,0.4)" strokeWidth="0.5" />
             <circle cx="12" cy="30" r="4" fill="none" stroke="rgba(206,17,65,0.4)" strokeWidth="0.5" />
             <path d="M0 10 A 15 15 0 0 1 15 50" fill="none" stroke="rgba(206,17,65,0.2)" strokeWidth="0.5" strokeDasharray="1,1" />
             <rect x="88" y="22" width="12" height="16" fill="none" stroke="rgba(62,38,128,0.4)" strokeWidth="0.5" />
             <circle cx="88" cy="30" r="4" fill="none" stroke="rgba(62,38,128,0.4)" strokeWidth="0.5" />
             {play && <PlayOverlay play={play} />}
          </svg>
      </div>
      <div className="absolute top-2 left-2 bg-cmd-surface/90 backdrop-blur text-slate-300 border border-cmd-border px-3 py-1 rounded text-[10px] font-mono font-bold uppercase z-10">
         {play ? play.name : 'Tactical Board'}
      </div>
    </div>
);

// ============================================================
// PLAYER DEEP DIVE
// ============================================================
const StatBox = ({ label, value, sub, color }) => (
    <div className="bg-cmd-bg/50 p-3 rounded-lg border border-cmd-border hover:border-raptors-red/30 hover:shadow-lg hover:shadow-raptors-red/5 transition-all">
        <div className="text-[10px] text-slate-500 uppercase font-bold">{label}</div>
        <div className={`text-xl font-mono font-bold ${color || 'text-white'}`}>{value !== undefined ? <AnimatedCounter value={Number(String(value).replace('%','')) || 0} decimals={1} suffix={String(value).includes('%') ? '%' : ''} /> : '-'}</div>
        {sub && <div className="text-[10px] text-slate-500 mt-1">{sub}</div>}
    </div>
);

const PlayerDeepDive = ({ player, opponentName, onClose, teamName = 'Raptors' }) => {
  const [imgError, setImgError] = useState(false);
  const s = player.seasonStats || {};
  const v = player.vsOpponentStats || {};
  const a = player.advanced || {};
  
  // Get salary info for this player
  const teamSalaryData = TEAM_SALARIES[teamName] || TEAM_SALARIES['Raptors'];
  const playerSalary = teamSalaryData?.roster?.[player.id] || null;
  
  // Get player initials for fallback
  const getInitials = (name) => {
    const parts = name.split(' ');
    if (parts.length >= 2) return parts[0][0] + parts[parts.length - 1][0];
    return name.slice(0, 2).toUpperCase();
  };
  
  const radarData = [
    { subject: 'PTS', A: s.ppg || 0, fullMark: 30 },
    { subject: 'REB', A: s.rpg || 0, fullMark: 15 },
    { subject: 'AST', A: s.apg || 0, fullMark: 12 },
    { subject: 'PER', A: a.per || 0, fullMark: 30 },
    { subject: 'USG', A: a.usg || 0, fullMark: 40 },
    { subject: 'TS%', A: (a.ts || 0), fullMark: 100 },
  ];
  return (
    <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-md animate-fade-in">
      <div className="bg-cmd-surface w-full max-w-5xl rounded-3xl overflow-hidden border border-raptors-red/20 shadow-2xl shadow-raptors-red/10 flex flex-col max-h-[90vh]">
        <div className="relative h-48 bg-cmd-bg overflow-hidden flex-shrink-0">
             <div className="absolute inset-0 bg-gradient-to-r from-cmd-bg via-cmd-surface to-raptors-red/20"></div>
             {!imgError ? (
               <img loading="lazy" src={getHeadshot(player)} onError={() => setImgError(true)} className="absolute bottom-0 right-10 h-[120%] object-contain" style={{filter: 'drop-shadow(0 0 20px rgba(206,17,65,0.4))'}} alt={player.name} />
             ) : (
               <div className="absolute bottom-0 right-10 h-[120%] w-48 flex flex-col items-center justify-center bg-gradient-to-br from-raptors-red/20 to-raptors-purple/30 rounded-full" style={{filter: 'drop-shadow(0 0 20px rgba(206,17,65,0.4))'}}>
                 <div className="text-6xl font-black text-raptors-red/80">{getInitials(player.name)}</div>
                 <div className="text-2xl font-mono font-bold text-raptors-red/50">#{player.number}</div>
               </div>
             )}
             <div className="absolute top-0 left-0 p-8">
                 <button onClick={onClose} className="mb-4 text-slate-500 hover:text-raptors-red flex items-center gap-2 transition-colors"><X className="w-5 h-5" /> Close Scouting Report</button>
                 <h2 className="text-5xl font-black text-white uppercase italic tracking-tighter neon-text">{player.name}</h2>
                 <div className="flex gap-4 mt-2 text-xl font-mono text-slate-400"><span>#{player.number}</span><span>|</span><span>{player.position}</span></div>
                 {/* Salary Badge */}
                 {playerSalary && (
                   <div className="mt-3 inline-flex items-center gap-2 bg-green-500/10 border border-green-500/30 px-3 py-1.5 rounded-full">
                     <span className="text-green-400 text-lg">ðŸ’°</span>
                     <span className="text-green-400 font-black text-lg">{formatSalary(playerSalary.salary)}</span>
                     <span className="text-green-400/60 text-xs">/ year</span>
                   </div>
                 )}
             </div>
        </div>
        <div className="p-8 overflow-y-auto custom-scrollbar">
           <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
               <div className="space-y-6">
                   <h3 className="flex items-center gap-2 text-raptors-red font-bold uppercase tracking-widest border-b border-cmd-border pb-2"><Activity className="w-4 h-4" /> Season Averages</h3>
                   <div className="grid grid-cols-2 gap-4">
                       <StatBox label="PPG" value={s.ppg} />
                       <StatBox label="RPG" value={s.rpg} sub={`${s.oreb || 0} Off / ${s.dreb || 0} Def`} />
                       <StatBox label="APG" value={s.apg} />
                       <StatBox label="+/-" value={s.plusMinus} color={s.plusMinus > 0 ? 'text-green-400' : 'text-red-400'} />
                       <StatBox label="FG%" value={`${s.fgPct}%`} />
                       <StatBox label="3P%" value={`${s.threePtPct}%`} />
                   </div>
                   <div className="bg-cmd-bg/50 p-4 rounded-xl border border-cmd-border">
                       <div className="text-xs text-slate-500 uppercase mb-2 font-bold">Efficiency Metrics</div>
                       <div className="flex justify-between items-center text-sm mb-1"><span className="text-slate-400">PER</span><span className="font-bold text-white">{a.per}</span></div>
                       <div className="w-full bg-cmd-border h-1.5 rounded-full overflow-hidden"><div className="bg-raptors-red h-full rounded-full shadow-lg shadow-raptors-red/30" style={{width: `${(a.per/35)*100}%`, animation: 'bar-grow 1s ease-out both', transformOrigin: 'left'}}></div></div>
                       <div className="flex justify-between items-center text-sm mt-3 mb-1"><span className="text-slate-400">True Shooting</span><span className="font-bold text-white">{a.ts}%</span></div>
                       <div className="w-full bg-cmd-border h-1.5 rounded-full overflow-hidden"><div className="bg-blue-500 h-full rounded-full shadow-lg shadow-blue-500/30" style={{width: `${a.ts}%`, animation: 'bar-grow 1s ease-out 0.2s both', transformOrigin: 'left'}}></div></div>
                   </div>
               </div>
               <div className="space-y-6">
                   <h3 className="flex items-center gap-2 text-blue-400 font-bold uppercase tracking-widest border-b border-cmd-border pb-2"><Target className="w-4 h-4" /> VS {opponentName}</h3>
                   <div className="bg-blue-500/5 border border-blue-500/20 p-6 rounded-2xl">
                       <div className="text-center mb-6"><div className="text-4xl font-black text-white mb-1 neon-text-subtle">{v.ppg || '-'}</div><div className="text-xs text-blue-400 uppercase font-bold">Points vs {opponentName}</div></div>
                       <div className="space-y-4">
                           <div className="flex justify-between items-center p-3 bg-cmd-bg/50 rounded-lg border border-cmd-border"><span className="text-slate-400 text-sm font-medium">Rebounds</span><span className="font-mono font-bold text-white">{v.rpg || '-'}</span></div>
                           <div className="flex justify-between items-center p-3 bg-cmd-bg/50 rounded-lg border border-cmd-border"><span className="text-slate-400 text-sm font-medium">Assists</span><span className="font-mono font-bold text-white">{v.apg || '-'}</span></div>
                           <div className="flex justify-between items-center p-3 bg-cmd-bg/50 rounded-lg border border-cmd-border"><span className="text-slate-400 text-sm font-medium">Turnovers</span><span className="font-mono font-bold text-white">{v.turnovers || '-'}</span></div>
                       </div>
                   </div>
                   <div className="bg-cmd-bg/50 p-4 rounded-xl border border-cmd-border"><p className="text-sm text-slate-400 italic leading-relaxed">"{player.analysis || `Key player for the rotation against ${opponentName}.`}"</p></div>
                   
                   {/* Contract Information */}
                   {playerSalary && (
                     <div className="bg-gradient-to-br from-green-500/10 to-emerald-500/5 border border-green-500/20 p-4 rounded-xl">
                       <div className="flex items-center gap-2 mb-3">
                         <span className="text-lg">ðŸ“‹</span>
                         <h4 className="text-xs font-bold text-green-400 uppercase tracking-widest">Contract Details</h4>
                       </div>
                       <div className="space-y-2">
                         <div className="flex justify-between items-center p-2 bg-cmd-bg/50 rounded-lg">
                           <span className="text-slate-400 text-sm">Annual Salary</span>
                           <span className="font-mono font-black text-green-400 text-lg">{formatSalary(playerSalary.salary)}</span>
                         </div>
                         <div className="flex justify-between items-center p-2 bg-cmd-bg/50 rounded-lg">
                           <span className="text-slate-400 text-sm">Contract Type</span>
                           <span className="font-bold text-white text-sm">{playerSalary.type}</span>
                         </div>
                         <div className="flex justify-between items-center p-2 bg-cmd-bg/50 rounded-lg">
                           <span className="text-slate-400 text-sm">Years Remaining</span>
                           <span className="font-mono font-bold text-white">{playerSalary.years} yrs</span>
                         </div>
                         <div className="flex justify-between items-center p-2 bg-cmd-bg/50 rounded-lg">
                           <span className="text-slate-400 text-sm">Expires</span>
                           <span className="font-mono font-bold text-amber-400">{playerSalary.expiry}</span>
                         </div>
                         {/* Cost per stat */}
                         <div className="mt-3 pt-3 border-t border-green-500/20">
                           <div className="text-[10px] text-slate-500 uppercase mb-2">Cost Per Stat Point</div>
                           <div className="grid grid-cols-3 gap-2 text-center">
                             <div className="bg-cmd-bg/50 rounded-lg p-2">
                               <div className="text-[9px] text-slate-500">$/PPG</div>
                               <div className="text-xs font-mono font-bold text-white">{s.ppg ? formatSalary(Math.round(playerSalary.salary / s.ppg)) : 'N/A'}</div>
                             </div>
                             <div className="bg-cmd-bg/50 rounded-lg p-2">
                               <div className="text-[9px] text-slate-500">$/RPG</div>
                               <div className="text-xs font-mono font-bold text-white">{s.rpg ? formatSalary(Math.round(playerSalary.salary / s.rpg)) : 'N/A'}</div>
                             </div>
                             <div className="bg-cmd-bg/50 rounded-lg p-2">
                               <div className="text-[9px] text-slate-500">$/APG</div>
                               <div className="text-xs font-mono font-bold text-white">{s.apg ? formatSalary(Math.round(playerSalary.salary / s.apg)) : 'N/A'}</div>
                             </div>
                           </div>
                         </div>
                       </div>
                     </div>
                   )}
               </div>
               <div className="space-y-6">
                   <h3 className="flex items-center gap-2 text-white font-bold uppercase tracking-widest border-b border-cmd-border pb-2"><TrendingUp className="w-4 h-4" /> Impact Profile</h3>
                   <div className="h-64 w-full">
                       <ResponsiveContainer width="100%" height="100%">
                           <RadarChart cx="50%" cy="50%" outerRadius="80%" data={radarData}>
                               <PolarGrid stroke="#1e293b" />
                               <PolarAngleAxis dataKey="subject" tick={{ fill: '#94a3b8', fontSize: 10, fontWeight: 'bold' }} />
                               <PolarRadiusAxis angle={30} domain={[0, 'auto']} tick={false} axisLine={false} />
                               <Radar name={player.name} dataKey="A" stroke="#3E2680" fill="#CE1141" fillOpacity={0.5} />
                               <Tooltip contentStyle={{ backgroundColor: '#111827', borderColor: '#1e293b', borderRadius: '8px', boxShadow: '0 4px 20px rgba(206,17,65,0.2)', color: '#e2e8f0' }} itemStyle={{ color: '#e2e8f0', fontWeight: 'bold' }} />
                           </RadarChart>
                       </ResponsiveContainer>
                   </div>
               </div>
           </div>
        </div>
      </div>
    </div>
  );
};

// ============================================================
// SCHEDULE LIST
// ============================================================
const ScheduleList = ({ games, onSelectGame, selectedGameId, isDark = true }) => {
  const [filter, setFilter] = useState('all'); // 'all', 'home', 'away', 'upcoming'
  
  const formatDate = (dateStr) => {
    try { const d = new Date(dateStr); if (!isNaN(d.getTime())) return { month: d.toLocaleString('en-US', { month: 'short' }).toUpperCase(), day: d.getDate().toString() }; } catch(e) {}
    const parts = dateStr.trim().split(' ');
    if (parts.length >= 2) return { month: parts[0].slice(0, 3).toUpperCase(), day: parts[1].replace(/[^0-9]/g, '') || '?' };
    return { month: 'GAME', day: '' };
  };

  const filteredGames = games.filter(g => {
    if (filter === 'home') return g.isHome;
    if (filter === 'away') return !g.isHome;
    if (filter === 'upcoming') return g.status === 'upcoming';
    return true;
  });

  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} overflow-hidden flex flex-col`} style={{maxHeight: '400px'}}>
      <div className={`p-3 border-b ${isDark ? 'border-cmd-border' : 'border-light-border'} bg-gradient-to-r from-raptors-red/10 to-transparent sticky top-0 z-10`}>
        <h2 className={`text-sm font-bold ${isDark ? 'text-slate-200' : 'text-slate-800'} flex items-center gap-2 uppercase tracking-tight mb-2`}><Calendar className="text-raptors-red w-4 h-4" /> 25-26 Schedule</h2>
        <div className="flex gap-1">
          {[
            { key: 'all', label: 'All' },
            { key: 'upcoming', label: 'Next' },
            { key: 'home', label: 'Home' },
            { key: 'away', label: 'Away' },
          ].map(f => (
            <button
              key={f.key}
              onClick={() => setFilter(f.key)}
              className={`flex-1 text-[9px] py-1 rounded font-bold transition-all ${filter === f.key 
                ? 'bg-raptors-red text-white' 
                : isDark ? 'bg-cmd-bg text-slate-400 hover:text-white' : 'bg-light-card text-slate-500 hover:text-slate-800'}`}
            >
              {f.label}
            </button>
          ))}
        </div>
      </div>
      <div className={`overflow-y-auto flex-1 divide-y ${isDark ? 'divide-cmd-border' : 'divide-light-border'}`}>
        {filteredGames.length === 0 ? (<div className="p-4 text-center text-slate-500 text-xs">No games found</div>) : (
          filteredGames.map((game) => {
            const { month, day } = formatDate(game.date);
            const isSelected = selectedGameId === game.id;
            return (
            <div key={game.id} onClick={() => onSelectGame(game)} className={`px-3 py-2 cursor-pointer transition-all ${isDark ? 'hover:bg-cmd-card/50' : 'hover:bg-slate-50'} group relative ${isSelected ? 'bg-raptors-red/5' : ''}`}>
              {isSelected && <div className="absolute left-0 top-0 bottom-0 w-1 bg-raptors-red shadow-lg shadow-raptors-red/50"></div>}
              <div className="flex items-center gap-2">
                 <div className="flex-shrink-0 w-8 text-center"><div className="text-[9px] uppercase font-bold text-slate-500 leading-none">{month}</div><div className={`text-sm font-black ${isDark ? 'text-slate-200' : 'text-slate-800'} leading-none mt-0.5`}>{day}</div></div>
                 <div className="flex-1 min-w-0">
                    <div className="flex items-center gap-1.5 mb-0.5">
                        <span className={`text-[10px] font-bold uppercase ${game.isHome ? 'text-slate-500' : 'text-slate-400'}`}>{game.isHome ? 'VS' : '@'}</span>
                        <div className="flex items-center gap-1.5 min-w-0">
                             {game.opponentId ? (<img loading="lazy" src={`https://cdn.nba.com/logos/nba/${game.opponentId}/primary/L/logo.svg`} className="w-4 h-4 object-contain" alt={game.opponent} />) : (<div className={`w-4 h-4 rounded-full ${isDark ? 'bg-cmd-border' : 'bg-light-border'}`}></div>)}
                             <span className={`font-bold ${isDark ? 'text-slate-200' : 'text-slate-700'} text-xs truncate leading-none`}>{game.opponent}</span>
                        </div>
                    </div>
                 </div>
                 <div className="text-right">
                    {game.status === 'completed' && game.result ? (<div className={`text-[10px] font-bold ${game.result.startsWith('W') ? 'text-green-500' : 'text-red-500'}`} style={game.result.startsWith('W') ? {textShadow: isDark ? '0 0 6px rgba(74,222,128,0.3)' : 'none'} : {textShadow: isDark ? '0 0 6px rgba(248,113,113,0.3)' : 'none'}}>{game.result}</div>
                    ) : game.status === 'live' ? (<div className="text-[9px] bg-raptors-red text-white px-1.5 py-0.5 rounded shadow-lg shadow-raptors-red/40" style={{animation: 'glow-pulse 2s ease-in-out infinite'}}>LIVE</div>
                    ) : (<div className="text-[9px] text-raptors-red/80 bg-raptors-red/10 border border-raptors-red/20 px-1.5 py-0.5 rounded">UP</div>)}
                 </div>
              </div>
            </div>
            );
          })
        )}
      </div>
    </div>
  );
};

// ============================================================
// SUB-COMPONENTS FOR MATCHUP ANALYZER
// ============================================================
const PlayerCard = ({ player, onClick, onDeepDive, isOpponent, isSelected }) => {
    const [imgError, setImgError] = useState(false);
    // Get player initials for fallback
    const getInitials = (name) => {
      const parts = name.split(' ');
      if (parts.length >= 2) return parts[0][0] + parts[parts.length - 1][0];
      return name.slice(0, 2).toUpperCase();
    };
    return (
        <div className={`card-3d group relative rounded-xl overflow-hidden transition-all duration-300 cursor-pointer ${isSelected ? 'ring-2 ring-raptors-red scale-105 z-20 shadow-xl shadow-raptors-red/20' : 'hover-lift'} bg-cmd-card border border-cmd-border h-40 flex flex-col justify-end`} onClick={onClick}>
            <div className="absolute inset-0 bg-gradient-to-t from-cmd-bg via-transparent to-transparent opacity-95"></div>
            {!imgError ? (<img loading="lazy" src={getHeadshot(player)} onError={() => setImgError(true)} className={`absolute top-0 left-1/2 -translate-x-1/2 w-[140%] max-w-none object-cover object-top h-full ${isOpponent ? 'grayscale-[0.3]' : ''}`} alt={player.name} />
            ) : (
              <div className={`absolute inset-0 flex flex-col items-center justify-center ${isOpponent ? 'bg-gradient-to-br from-blue-900/50 to-blue-950/80' : 'bg-gradient-to-br from-raptors-red/20 to-raptors-purple/30'}`}>
                <div className={`text-3xl font-black ${isOpponent ? 'text-blue-400' : 'text-raptors-red'} opacity-80`}>{getInitials(player.name)}</div>
                <div className={`text-lg font-mono font-bold ${isOpponent ? 'text-blue-500/60' : 'text-raptors-red/60'}`}>#{player.number}</div>
              </div>
            )}
            <button onClick={(e) => { e.stopPropagation(); onDeepDive(); }} className="absolute top-1 right-1 z-30 p-1.5 rounded-full bg-cmd-surface/50 hover:bg-raptors-red text-white opacity-0 group-hover:opacity-100 transition-all backdrop-blur-sm" title="View Analytics"><ChevronRight className="w-3 h-3" /></button>
            {/* Form Indicator */}
            {player.form && <div className="absolute top-1 left-1 z-30"><FormIndicator form={player.form} /></div>}
            <div className="relative z-20 p-2 pointer-events-none">
                <div className={`text-[9px] font-black uppercase tracking-wider mb-0.5 ${isOpponent ? 'text-blue-400' : 'text-raptors-red'}`}>{player.position} â€¢ #{player.number}</div>
                <div className="text-white font-bold leading-tight text-xs mb-1 truncate">{player.name.split(' ').slice(1).join(' ')}</div>
                <div className="flex justify-between items-end border-t border-white/10 pt-1">
                    <div className="text-[9px] text-slate-400">PER {Number(player.advanced?.per || 0).toFixed(1)}</div>
                    <div className="text-[9px] font-mono font-bold text-white neon-text-subtle">{Number(player.seasonStats?.ppg || 0).toFixed(1)} PPG</div>
                </div>
            </div>
            {isSelected && (<div className="absolute inset-0 bg-raptors-red/20 z-10 flex items-center justify-center backdrop-blur-[2px]"><div className="bg-cmd-surface text-raptors-red px-2 py-1 rounded text-[10px] font-bold shadow-lg shadow-raptors-red/30 uppercase border border-raptors-red/30">Select Swap</div></div>)}
        </div>
    );
};

const BenchCard = ({ player, onClick, isOpponent, isHighlighted }) => {
    const [imgError, setImgError] = useState(false);
    const getInitials = (name) => {
      const parts = name.split(' ');
      if (parts.length >= 2) return parts[0][0] + parts[parts.length - 1][0];
      return name.slice(0, 2).toUpperCase();
    };
    return (
        <div onClick={onClick} className={`flex-shrink-0 w-16 h-20 rounded-lg overflow-hidden relative cursor-pointer group transition-all bg-cmd-card border ${isHighlighted ? 'ring-2 ring-raptors-red/50 border-raptors-red/30 shadow-lg shadow-raptors-red/10' : 'border-cmd-border hover:ring-2 hover:ring-raptors-red/30 hover:border-raptors-red/20'}`} style={isHighlighted ? {animation: 'border-glow 2s ease-in-out infinite'} : {}}>
             {!imgError ? (<img loading="lazy" src={getHeadshot(player)} onError={() => setImgError(true)} className={`w-full h-full object-cover object-top ${isOpponent ? 'grayscale-[0.3]' : ''}`} alt={player.name} />) : (
               <div className={`w-full h-full flex flex-col items-center justify-center ${isOpponent ? 'bg-gradient-to-br from-blue-900/30 to-blue-950/50' : 'bg-gradient-to-br from-raptors-red/10 to-raptors-purple/20'}`}>
                 <div className={`text-sm font-black ${isOpponent ? 'text-blue-400/70' : 'text-raptors-red/70'}`}>{getInitials(player.name)}</div>
                 <div className={`text-[9px] font-mono ${isOpponent ? 'text-blue-500/50' : 'text-raptors-red/50'}`}>#{player.number}</div>
               </div>
             )}
            <div className="absolute bottom-0 inset-x-0 bg-cmd-bg/90 backdrop-blur-sm p-0.5 text-center">
                <div className="text-[8px] text-white font-bold truncate">{player.name.split(' ').pop()}</div>
                <div className="text-[7px] text-slate-400 font-mono">{Number(player.seasonStats?.ppg || 0).toFixed(1)}</div>
            </div>
        </div>
    );
};

const ComparisonRow = ({ label, raptorsVal, opponentVal, higherIsBetter }) => {
    const raptorsWins = higherIsBetter ? raptorsVal > opponentVal : raptorsVal < opponentVal;
    const opponentWins = higherIsBetter ? opponentVal > raptorsVal : opponentVal < raptorsVal;
    const tied = Math.abs(raptorsVal - opponentVal) < 0.05;
    const pct = Math.min(100, Math.max(5, (raptorsVal / (raptorsVal + opponentVal || 1)) * 100));
    return (
        <div className="flex items-center gap-3">
            <div className={`flex-1 text-right font-mono text-sm font-bold transition-colors ${tied ? 'text-slate-400' : raptorsWins ? 'text-green-400' : 'text-slate-500'}`} style={raptorsWins && !tied ? {textShadow: '0 0 8px rgba(74,222,128,0.3)'} : {}}>{raptorsVal.toFixed(1)}</div>
            <div className="flex-shrink-0 w-24">
                <div className="relative h-2 bg-cmd-border rounded-full overflow-hidden"><div className="absolute left-0 top-0 h-full bg-gradient-to-r from-raptors-red to-raptors-purple rounded-full" style={{ width: `${pct}%`, animation: 'bar-grow 1s ease-out both', transformOrigin: 'left' }} /></div>
                <div className="text-[9px] text-slate-500 text-center mt-1 font-medium">{label}</div>
            </div>
            <div className={`flex-1 text-left font-mono text-sm font-bold transition-colors ${tied ? 'text-slate-400' : opponentWins ? 'text-green-400' : 'text-slate-500'}`} style={opponentWins && !tied ? {textShadow: '0 0 8px rgba(74,222,128,0.3)'} : {}}>{opponentVal.toFixed(1)}</div>
        </div>
    );
};

// ============================================================
// MATCHUP ANALYZER (MAIN COMPONENT)
// ============================================================
const MatchupAnalyzer = ({ game }) => {
  const [analysis, setAnalysis] = useState(null);
  const [loading, setLoading] = useState(false);
  const [activeRaptorsLineup, setActiveRaptorsLineup] = useState([]);
  const [activeOpponentLineup, setActiveOpponentLineup] = useState([]);
  const [raptorsBench, setRaptorsBench] = useState([]);
  const [opponentBench, setOpponentBench] = useState([]);
  const [selectedSlot, setSelectedSlot] = useState(null);
  const [selectedPlay, setSelectedPlay] = useState(null);
  const [selectedPlayerForDeepDive, setSelectedPlayerForDeepDive] = useState(null);

  useEffect(() => {
    let mounted = true;
    const fetchAnalysis = async () => {
      setLoading(true); setAnalysis(null);
      const result = await analyzeGameMatchup(game.opponent);
      if (mounted && result.analysis) {
        setAnalysis(result.analysis);
        const raptors = result.analysis.raptorsRoster || [];
        const opponents = result.analysis.opponentRoster || [];
        const rapStarters = raptors.slice(0, 5);
        const oppStarters = opponents.slice(0, 5);
        setActiveRaptorsLineup(rapStarters);
        setActiveOpponentLineup(oppStarters);
        setRaptorsBench(raptors.filter(p => !rapStarters.find(s => s.id === p.id)));
        setOpponentBench(opponents.filter(p => !oppStarters.find(s => s.id === p.id)));
        if (result.analysis.playbook?.length > 0) setSelectedPlay(result.analysis.playbook[0]);
        setLoading(false);
      }
    };
    fetchAnalysis();
    return () => { mounted = false; };
  }, [game]);

  const handleBenchClick = (player, team) => {
      if (selectedSlot && selectedSlot.team === team) {
          if (team === 'raptors') {
              const currentActive = activeRaptorsLineup[selectedSlot.index];
              const newActive = [...activeRaptorsLineup];
              newActive[selectedSlot.index] = player;
              setActiveRaptorsLineup(newActive);
              setRaptorsBench(prev => [...prev.filter(p => p.id !== player.id), currentActive]);
          } else {
              const currentActive = activeOpponentLineup[selectedSlot.index];
              const newActive = [...activeOpponentLineup];
              newActive[selectedSlot.index] = player;
              setActiveOpponentLineup(newActive);
              setOpponentBench(prev => [...prev.filter(p => p.id !== player.id), currentActive]);
          }
          setSelectedSlot(null);
      }
  };

  const applyRaptorsPreset = (presetName) => {
      if (!analysis) return;
      const allRaptors = analysis.raptorsRoster || [];
      let newActive = [];
      if (presetName === 'starters') { newActive = allRaptors.slice(0, 5); }
      else if (presetName === 'second') { newActive = allRaptors.slice(5, 10); if (newActive.length < 5) { newActive = [...newActive, ...allRaptors.filter(p => !newActive.includes(p)).slice(0, 5 - newActive.length)]; } }
      else if (presetName === 'speed') { newActive = [...allRaptors].filter(p => p.position.includes('G') || p.position.includes('SF')).slice(0, 5); if (newActive.length < 5) { newActive = [...newActive, ...allRaptors.filter(p => !newActive.includes(p)).slice(0, 5 - newActive.length)]; } }
      else if (presetName === 'big') { newActive = [...allRaptors].filter(p => p.position.includes('C') || p.position.includes('PF') || p.position.includes('F')).slice(0, 5); if (newActive.length < 5) { newActive = [...newActive, ...allRaptors.filter(p => !newActive.includes(p)).slice(0, 5 - newActive.length)]; } }
      if (newActive.length < 5) newActive = allRaptors.slice(0, 5);
      setActiveRaptorsLineup(newActive.slice(0, 5));
      setRaptorsBench(allRaptors.filter(p => !newActive.find(a => a.id === p.id)));
      setSelectedSlot(null);
  };

  const applyPreset = (presetName) => {
      if (!analysis || !analysis.lineupPresets) return;
      const allOpponents = analysis.opponentRoster || [];
      let newActive = [];
      const preset = analysis.lineupPresets.find(p => p.name.toLowerCase().includes(presetName.toLowerCase()));
      if (preset && preset.playerIds && preset.playerIds.length > 0) newActive = allOpponents.filter(p => preset.playerIds.includes(p.id));
      if (newActive.length < 5) {
          if (presetName === 'bench' || presetName === 'second') newActive = allOpponents.slice(5, 10);
          else if (presetName === 'speed') newActive = [...allOpponents].filter(p => p.position.includes('G') || p.position.includes('F')).slice(0,5);
          else newActive = allOpponents.slice(0, 5);
      }
      if (newActive.length < 5) { newActive = [...newActive, ...allOpponents.filter(p => !newActive.includes(p)).slice(0, 5 - newActive.length)]; }
      setActiveOpponentLineup(newActive.slice(0, 5));
      setOpponentBench(allOpponents.filter(p => !newActive.find(a => a.id === p.id)));
  };

  const calculateAggregates = (players) => {
    if (!players.length) return { ortg: 0, drtg: 0, per: 0, net: 0 };
    const avg = (key, subKey) => players.reduce((sum, p) => sum + (p[key]?.[subKey] || 0), 0) / players.length;
    const ortg = avg('advanced', 'ortg');
    const drtg = avg('advanced', 'drtg');
    return { ortg, drtg, per: avg('advanced', 'per'), net: ortg - drtg };
  };

  const raptorsAgg = calculateAggregates(activeRaptorsLineup);
  const opponentAgg = calculateAggregates(activeOpponentLineup);

  if (loading) return (
    <div className="h-full flex flex-col items-center justify-center space-y-6 p-12">
       <div className="relative w-24 h-24">
         <div className="absolute inset-0 rounded-full border-4 border-raptors-red/20"></div>
         <div className="absolute inset-0 rounded-full border-4 border-raptors-red border-t-transparent animate-spin"></div>
         <div className="absolute inset-2 rounded-full" style={{background: 'radial-gradient(circle, rgba(206,17,65,0.15) 0%, transparent 70%)'}}></div>
       </div>
       <div className="text-center">
         <h2 className="text-xl font-bold text-white uppercase tracking-wider neon-text">Scouting {game.opponent}...</h2>
         <p className="text-slate-500 mt-2">Gathering injury reports, film study, and social sentiment.</p>
         <div className="mt-4 w-48 h-1 mx-auto rounded-full overflow-hidden bg-cmd-border"><div className="h-full shimmer-bg bg-raptors-red/20 w-full"></div></div>
       </div>
    </div>
  );

  if (!analysis) return <div className="p-8 text-center text-slate-500">Select a game to begin scouting.</div>;

  return (
    <div className="space-y-6 pb-20 animate-fade-in relative">
      {/* 1. MATCHUP HEADER */}
      <div className="glass-card gradient-border p-8 relative overflow-hidden animate-slide-up">
         <div className="absolute inset-0 bg-grid opacity-30"></div>
         <div className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[500px] h-[500px] rounded-full" style={{background: 'radial-gradient(circle, rgba(206,17,65,0.08) 0%, transparent 70%)'}}></div>
         <div className="absolute top-0 right-0 p-4 opacity-[0.04] animate-float"><img loading="lazy" src={`https://cdn.nba.com/logos/nba/${game.opponentId}/primary/L/logo.svg`} className="w-64 h-64" alt="logo" /></div>
         <div className="relative z-10 flex flex-col md:flex-row gap-8">
             <div className="flex-1">
                <div className="flex items-center gap-3 mb-2"><span className="bg-raptors-red/20 text-raptors-red border border-raptors-red/30 px-2 py-0.5 rounded text-xs font-bold uppercase">Game Prep</span><span className="text-slate-500 text-sm font-mono">{game.date} &bull; {game.venue}</span></div>
                <h1 className="text-4xl md:text-6xl font-black text-white italic uppercase tracking-tighter mb-4 neon-text" style={{animation: 'text-reveal 0.8s ease-out both'}}>Raptors vs {game.opponent}</h1>
                <p className="text-lg text-slate-400 max-w-2xl leading-relaxed border-l-4 border-raptors-red/50 pl-4">{analysis.summary}</p>
             </div>
             <div className="flex gap-4 items-end">
                <WinProbRing value={analysis.winProbability} size={100} />
                <div className="h-12 w-px bg-cmd-border"></div>
                <div className="text-center"><div className="text-4xl font-black text-white neon-text-subtle"><AnimatedCounter value={raptorsAgg.per} /></div><div className="text-xs text-slate-500 uppercase font-bold">TOR PER</div></div>
                <div className="h-12 w-px bg-cmd-border"></div>
                <div className="text-center"><div className="text-4xl font-black text-white"><AnimatedCounter value={opponentAgg.per} /></div><div className="text-xs text-slate-500 uppercase font-bold">OPP PER</div></div>
             </div>
         </div>
      </div>

      {/* 2. STRATEGIC GAME PLAN */}
      <div className="glass-card p-6 animate-slide-up" style={{animationDelay: '0.15s'}}>
          <div className="flex items-center gap-3 mb-6 pb-4 border-b border-cmd-border"><Brain className="w-6 h-6 text-raptors-red" /><h2 className="text-2xl font-bold text-white">Strategic Game Plan</h2></div>
          <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
              <div className="space-y-6">
                 <div><div className="text-xs font-bold text-slate-500 uppercase tracking-widest mb-3">Offensive Profile</div><div className="flex flex-wrap gap-2">{analysis.scoutingReport.offensiveTendencies.map((t, i) => (<span key={i} className="bg-raptors-red/10 text-raptors-red/90 text-sm px-3 py-1.5 rounded-full font-medium border border-raptors-red/20 hover:bg-raptors-red/20 hover:shadow-lg hover:shadow-raptors-red/10 transition-all cursor-default">{t}</span>))}</div></div>
                 <div><div className="text-xs font-bold text-slate-500 uppercase tracking-widest mb-3">Defensive Schemes</div><div className="flex flex-wrap gap-2">{analysis.scoutingReport.defensiveSchemes.map((t, i) => (<span key={i} className="bg-blue-500/10 text-blue-400 text-sm px-3 py-1.5 rounded-full font-medium border border-blue-500/20 hover:bg-blue-500/20 transition-all cursor-default">{t}</span>))}</div></div>
              </div>
              <div className="bg-cmd-bg/50 rounded-xl p-5 border border-cmd-border">
                  <h3 className="text-sm font-bold text-white uppercase tracking-wider mb-4 flex items-center gap-2"><Zap className="w-4 h-4 text-yellow-500 fill-yellow-500" /> Keys to Victory</h3>
                  <ul className="space-y-4">{analysis.scoutingReport.keysToVictory.map((key, i) => (<li key={i} className="flex gap-3 text-sm text-slate-300" style={{animation: `slide-up 0.4s ease-out ${0.1 * i}s both`}}><span className="flex-shrink-0 w-6 h-6 rounded-full bg-raptors-red/20 text-raptors-red border border-raptors-red/30 flex items-center justify-center font-bold text-xs shadow-lg shadow-raptors-red/10">{i+1}</span><span className="pt-0.5 font-medium leading-snug">{key}</span></li>))}</ul>
              </div>
              <div className="relative overflow-hidden rounded-xl bg-gradient-to-br from-cmd-surface to-cmd-bg p-6 text-white flex flex-col justify-center animate-glow-pulse border border-raptors-red/10">
                  <div className="absolute top-0 right-0 p-4 opacity-10 animate-float"><Activity className="w-32 h-32" /></div>
                  <div className="relative z-10"><div className="text-xs font-bold text-raptors-red uppercase tracking-widest mb-2">X-Factor Matchup</div><div className="text-3xl font-black italic mb-2 neon-text">{analysis.scoutingReport.xFactor}</div><p className="text-slate-400 text-sm leading-relaxed">"Controlling this player's impact is crucial for the defensive rotation scheme."</p></div>
              </div>
          </div>
      </div>

      <div className="grid grid-cols-1 lg:grid-cols-2 gap-6 animate-slide-up" style={{animationDelay: '0.3s'}}>
          {/* 3. MEDIA & INTEL */}
          <div className="glass-card overflow-hidden flex flex-col">
              <div className="bg-cmd-bg/50 px-6 py-4 border-b border-cmd-border flex items-center justify-between"><h2 className="text-lg font-bold text-white flex items-center gap-2"><Radio className="text-raptors-red w-5 h-5" /> Media Row & Medical</h2></div>
              <div className="p-6 grid grid-cols-1 md:grid-cols-2 gap-6 flex-1">
                  <div>
                      <div className="flex items-center gap-2 mb-4"><AlertTriangle className="text-orange-500 w-4 h-4" /><span className="text-xs font-bold text-slate-500 uppercase tracking-wider">Injury Report</span></div>
                      <div className="space-y-3">
                          {analysis.intel?.injuries?.length > 0 ? analysis.intel.injuries.map((inj, i) => (
                              <div key={i} className={`flex items-start gap-3 bg-cmd-bg/50 p-3 rounded-lg border transition-all ${inj.status === 'Out' ? 'border-l-2 border-l-red-500 border-red-500/20' : inj.status === 'Active' ? 'border-l-2 border-l-green-500 border-green-500/20' : 'border-l-2 border-l-yellow-500 border-yellow-500/20'}`}>
                                  {inj.status === 'Out' && <div className="absolute -top-1 -right-1 z-10"></div>}
                                  <div className={`mt-1 w-1.5 h-1.5 rounded-full flex-shrink-0 ${inj.status === 'Out' ? 'bg-red-500' : inj.status === 'Active' ? 'bg-green-500' : 'bg-yellow-500'}`} style={inj.status === 'Out' ? {animation: 'pulse-dot 1.5s ease-in-out infinite'} : {}}></div>
                                  <div><div className="flex items-center gap-2 flex-wrap"><span className="text-sm font-bold text-white">{inj.player}</span>{inj.status === 'Out' && <span className="text-[8px] px-1.5 py-0.5 rounded bg-red-500/20 text-red-400 border border-red-500/30 font-black uppercase tracking-wider">BREAKING</span>}<span className={`text-[10px] px-1.5 rounded uppercase font-bold ${inj.status === 'Out' ? 'bg-red-500/20 text-red-400' : inj.status === 'Active' ? 'bg-green-500/20 text-green-400' : 'bg-yellow-500/20 text-yellow-400'}`}>{inj.status}</span></div><div className="text-xs text-slate-500 mt-1">{inj.details}</div></div>
                              </div>
                          )) : (<div className="text-slate-500 text-sm italic">No significant injuries reported.</div>)}
                      </div>
                  </div>
                  <div>
                      <div className="flex items-center gap-2 mb-4"><MessageSquare className="text-blue-400 w-4 h-4" /><span className="text-xs font-bold text-slate-500 uppercase tracking-wider">Social Feed</span></div>
                      <div className="space-y-4">
                          {analysis.intel?.socialChatter?.map((item, i) => {
                              const isRaptors = item.source.toLowerCase().includes('raptors') || item.source.toLowerCase().includes('republic');
                              const isOpponentSrc = item.source.toLowerCase().includes(game.opponent.toLowerCase());
                              let avatar = 'https://cdn-icons-png.flaticon.com/512/3135/3135715.png';
                              if (item.source.toLowerCase().includes('espn')) avatar = 'https://upload.wikimedia.org/wikipedia/commons/thumb/a/a2/ESPN_logo.svg/1200px-ESPN_logo.svg.png';
                              if (isRaptors) avatar = 'https://cdn.nba.com/logos/nba/1610612761/primary/L/logo.svg';
                              if (isOpponentSrc && game.opponentId) avatar = `https://cdn.nba.com/logos/nba/${game.opponentId}/primary/L/logo.svg`;
                              const sentimentColor = item.sentiment === 'positive' ? 'border-l-green-500' : item.sentiment === 'negative' ? 'border-l-red-500' : 'border-l-blue-500';
                              return (
                                <div key={i} className={`bg-cmd-bg/50 border border-cmd-border border-l-2 ${sentimentColor} rounded-xl p-4 hover-lift`}>
                                    <div className="flex gap-3">
                                        <div className="flex-shrink-0"><img src={avatar} loading="lazy" onError={(e) => e.currentTarget.src = 'https://cdn-icons-png.flaticon.com/512/3135/3135715.png'} alt="avatar" className="w-10 h-10 rounded-full object-contain border border-cmd-border bg-cmd-surface p-1" /></div>
                                        <div className="flex-1 min-w-0"><div className="flex items-center justify-between"><span className="text-sm font-bold text-white truncate">{item.source}</span><span className="text-xs text-slate-500">2h</span></div><p className="text-sm text-slate-300 mt-1 leading-snug">{item.headline}</p></div>
                                    </div>
                                </div>
                              );
                          })}
                      </div>
                  </div>
              </div>
          </div>

          {/* 4. TACTICAL PLAYBOOK */}
          <div className="glass-card flex flex-col overflow-hidden">
             <div className="bg-cmd-bg/50 px-6 py-4 border-b border-cmd-border flex items-center justify-between"><h3 className="text-lg font-bold text-white flex items-center gap-2"><LayoutTemplate className="text-orange-500 w-5 h-5" /> Interactive Playbook</h3></div>
             <div className="flex flex-col md:flex-row h-auto md:h-[450px]">
                 <div className="w-full md:w-3/5 bg-cmd-bg/30 p-4 md:p-8 flex flex-col justify-center items-center">
                     <div className="rounded-lg overflow-hidden border-2 border-cmd-border shadow-xl shadow-raptors-red/5 w-full max-w-lg aspect-[1.6]"><CourtDiagram play={selectedPlay} /></div>
                 </div>
                 <div className="w-full md:w-2/5 flex flex-col border-l border-cmd-border bg-cmd-surface/50 overflow-hidden">
                     <div className="p-4 border-b border-cmd-border bg-cmd-bg/30 flex-shrink-0">
                        <div className="flex gap-2 overflow-x-auto pb-1 scrollbar-hide">
                            {analysis.playbook?.map((play) => (<button key={play.id} onClick={() => setSelectedPlay(play)} className={`flex-shrink-0 px-3 py-1.5 rounded-full text-xs font-bold transition-all border ${selectedPlay?.id === play.id ? 'bg-raptors-red text-white border-raptors-red shadow-lg shadow-raptors-red/30' : 'bg-cmd-surface text-slate-400 border-cmd-border hover:border-raptors-red/30 hover:text-white'}`}>{play.name}</button>))}
                        </div>
                     </div>
                     <div className="flex-1 p-6 overflow-y-auto custom-scrollbar">
                         {selectedPlay ? (
                             <div className="space-y-6">
                                <div><div className="flex items-center justify-between mb-3"><h4 className="font-black text-xl text-white uppercase italic tracking-tighter">{selectedPlay.name}</h4><span className="text-[10px] font-bold bg-cmd-bg text-slate-400 border border-cmd-border px-2 py-1 rounded uppercase">{selectedPlay.diagramType}</span></div><p className="text-sm text-slate-400 leading-snug">{selectedPlay.description}</p></div>
                                <div><div className="text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-2">Execution Steps</div><div className="space-y-3 relative pl-2"><div className="absolute left-[11px] top-2 bottom-2 w-px bg-raptors-red/20"></div>{selectedPlay.execution?.map((step, i) => (<div key={i} className="flex gap-3 relative" style={{animation: `slide-up 0.4s ease-out ${0.1 * i}s both`}}><div className="w-6 h-6 rounded-full bg-cmd-surface border-2 border-raptors-red/30 flex items-center justify-center text-[10px] font-bold text-raptors-red flex-shrink-0 z-10">{i+1}</div><p className="text-sm text-slate-300 pt-0.5">{step}</p></div>))}</div></div>
                                <div className="bg-raptors-red/5 border border-raptors-red/20 p-4 rounded-xl mt-4" style={{animation: 'border-glow 3s ease-in-out infinite'}}><div className="flex items-center gap-1.5 mb-2"><Shield className="w-4 h-4 text-raptors-red" /><span className="text-xs font-bold text-raptors-red uppercase tracking-widest">Defensive Key</span></div><p className="text-sm text-white font-bold leading-relaxed">{selectedPlay.raptorsCounter}</p></div>
                             </div>
                         ) : (<div className="flex flex-col items-center justify-center h-full text-slate-500 space-y-2"><Activity className="w-8 h-8 opacity-20" /><span className="text-sm font-medium">Select a play to view details</span></div>)}
                     </div>
                 </div>
             </div>
          </div>
      </div>

      {/* 5. GAME CONTEXT - REST, REFS, PACE */}
      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 animate-slide-up" style={{animationDelay: '0.4s'}}>
          {/* Rest Days */}
          <div className="glass-card p-4">
              <div className="flex items-center gap-2 mb-3"><Clock className="w-4 h-4 text-blue-400" /><span className="text-xs font-bold text-slate-500 uppercase tracking-wider">Rest Advantage</span></div>
              <div className="flex justify-between items-center">
                  <div className="text-center">
                      <div className="text-3xl font-black text-white">{analysis.intel?.restDays?.raptors || 2}</div>
                      <div className="text-[10px] text-slate-500 uppercase">TOR Days</div>
                  </div>
                  <div className="text-slate-600">vs</div>
                  <div className="text-center">
                      <div className="text-3xl font-black text-slate-400">{analysis.intel?.restDays?.opponent || 1}</div>
                      <div className="text-[10px] text-slate-500 uppercase">OPP Days</div>
                  </div>
              </div>
              {analysis.intel?.backToBack?.opponent && (
                  <div className="mt-3 px-2 py-1.5 bg-yellow-500/10 border border-yellow-500/20 rounded-lg text-center">
                      <span className="text-[10px] font-bold text-yellow-400 uppercase">âš ï¸ {game.opponent} on B2B</span>
                  </div>
              )}
              {analysis.intel?.backToBack?.raptors && (
                  <div className="mt-3 px-2 py-1.5 bg-red-500/10 border border-red-500/20 rounded-lg text-center">
                      <span className="text-[10px] font-bold text-red-400 uppercase">âš ï¸ Raptors on B2B</span>
                  </div>
              )}
          </div>

          {/* Referee Crew */}
          <div className="glass-card p-4">
              <div className="flex items-center gap-2 mb-3"><Gavel className="w-4 h-4 text-purple-400" /><span className="text-xs font-bold text-slate-500 uppercase tracking-wider">Officials</span></div>
              <div className="space-y-2">
                  {analysis.intel?.referees?.map((ref, i) => (
                      <div key={i} className="flex items-center justify-between p-2 bg-cmd-bg/50 rounded-lg border border-cmd-border">
                          <div>
                              <div className="text-sm font-bold text-white">{ref.name}</div>
                              <div className="text-[10px] text-slate-500">{ref.role}</div>
                          </div>
                          <div className="text-right">
                              <div className="text-xs font-mono text-slate-300">{ref.foulCallRate} F/G</div>
                              <div className="text-[9px] text-slate-500 italic">{ref.tendency}</div>
                          </div>
                      </div>
                  ))}
              </div>
          </div>

          {/* Pace Comparison */}
          <div className="glass-card p-4">
              <div className="flex items-center gap-2 mb-3"><Gauge className="w-4 h-4 text-green-400" /><span className="text-xs font-bold text-slate-500 uppercase tracking-wider">Pace Factor</span></div>
              <div className="space-y-3">
                  <div>
                      <div className="flex justify-between items-center mb-1">
                          <span className="text-xs text-raptors-red font-bold">TOR</span>
                          <span className="text-sm font-mono text-white">{analysis.intel?.pace?.raptors || 101.2}</span>
                      </div>
                      <div className="w-full bg-cmd-border h-2 rounded-full overflow-hidden">
                          <div className="bg-raptors-red h-full rounded-full" style={{width: `${((analysis.intel?.pace?.raptors || 101.2) / 110) * 100}%`}}></div>
                      </div>
                  </div>
                  <div>
                      <div className="flex justify-between items-center mb-1">
                          <span className="text-xs text-blue-400 font-bold">{game.opponent?.slice(0,3).toUpperCase()}</span>
                          <span className="text-sm font-mono text-white">{analysis.intel?.pace?.opponent || 98.5}</span>
                      </div>
                      <div className="w-full bg-cmd-border h-2 rounded-full overflow-hidden">
                          <div className="bg-blue-500 h-full rounded-full" style={{width: `${((analysis.intel?.pace?.opponent || 98.5) / 110) * 100}%`}}></div>
                      </div>
                  </div>
                  <div className="text-center pt-2 border-t border-cmd-border">
                      <span className="text-[10px] text-slate-500">League Avg: {analysis.intel?.pace?.leagueAvg || 99.8}</span>
                  </div>
              </div>
          </div>

          {/* Home/Away Splits */}
          <div className="glass-card p-4">
              <div className="flex items-center gap-2 mb-3"><Home className="w-4 h-4 text-orange-400" /><span className="text-xs font-bold text-slate-500 uppercase tracking-wider">Venue Splits</span></div>
              <div className="space-y-3">
                  <div className="flex items-center justify-between p-2 bg-cmd-bg/50 rounded-lg border border-cmd-border">
                      <div className="flex items-center gap-2">
                          <img src="https://cdn.nba.com/logos/nba/1610612761/primary/L/logo.svg" className="w-5 h-5" loading="lazy" alt="TOR" />
                          <span className="text-xs font-bold text-white">TOR</span>
                      </div>
                      <div className="flex gap-3 text-xs">
                          <span className="text-green-400"><Home className="w-3 h-3 inline mr-1" />{analysis.intel?.homeSplits?.raptors?.home || "14-12"}</span>
                          <span className="text-slate-400"><Plane className="w-3 h-3 inline mr-1" />{analysis.intel?.homeSplits?.raptors?.away || "9-20"}</span>
                      </div>
                  </div>
                  <div className="flex items-center justify-between p-2 bg-cmd-bg/50 rounded-lg border border-cmd-border">
                      <div className="flex items-center gap-2">
                          {game.opponentId && <img loading="lazy" src={`https://cdn.nba.com/logos/nba/${game.opponentId}/primary/L/logo.svg`} className="w-5 h-5" alt="" />}
                          <span className="text-xs font-bold text-white">{game.opponent?.slice(0,3).toUpperCase()}</span>
                      </div>
                      <div className="flex gap-3 text-xs">
                          <span className="text-green-400"><Home className="w-3 h-3 inline mr-1" />{analysis.intel?.homeSplits?.opponent?.home || "18-8"}</span>
                          <span className="text-slate-400"><Plane className="w-3 h-3 inline mr-1" />{analysis.intel?.homeSplits?.opponent?.away || "14-14"}</span>
                      </div>
                  </div>
              </div>
          </div>
      </div>

      {/* 5.5 ADVANCED BATTLE METRICS */}
      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 animate-slide-up" style={{animationDelay: '0.45s'}}>
          {/* Rebounding Battle */}
          <div className="glass-card p-4">
              <div className="flex items-center gap-2 mb-3"><ArrowRightLeft className="w-4 h-4 text-cyan-400" /><span className="text-xs font-bold text-slate-500 uppercase tracking-wider">Rebounding</span></div>
              <div className="grid grid-cols-2 gap-3">
                  <div className="text-center p-2 bg-raptors-red/10 rounded-lg border border-raptors-red/20">
                      <div className="text-xl font-black text-white">{analysis.intel?.rebounding?.raptors?.total || 43.7}</div>
                      <div className="text-[9px] text-slate-500 uppercase">TOR RPG</div>
                      <div className="text-[10px] text-raptors-red mt-1">{analysis.intel?.rebounding?.raptors?.oreb || 10.2} OFF</div>
                  </div>
                  <div className="text-center p-2 bg-blue-500/10 rounded-lg border border-blue-500/20">
                      <div className="text-xl font-black text-white">{analysis.intel?.rebounding?.opponent?.total || 45.7}</div>
                      <div className="text-[9px] text-slate-500 uppercase">OPP RPG</div>
                      <div className="text-[10px] text-blue-400 mt-1">{analysis.intel?.rebounding?.opponent?.oreb || 11.5} OFF</div>
                  </div>
              </div>
              <div className="mt-3 pt-2 border-t border-cmd-border">
                  <div className="flex justify-between text-[10px]">
                      <span className="text-slate-500">OREB%</span>
                      <span className="text-raptors-red font-bold">{analysis.intel?.rebounding?.raptors?.orebPct || 26.8}%</span>
                      <span className="text-blue-400 font-bold">{analysis.intel?.rebounding?.opponent?.orebPct || 28.1}%</span>
                  </div>
              </div>
          </div>

          {/* Free Throw Battle */}
          <div className="glass-card p-4">
              <div className="flex items-center gap-2 mb-3"><Target className="w-4 h-4 text-yellow-400" /><span className="text-xs font-bold text-slate-500 uppercase tracking-wider">Free Throws</span></div>
              <div className="space-y-2">
                  <div className="flex justify-between items-center p-2 bg-cmd-bg/50 rounded-lg">
                      <span className="text-xs text-raptors-red font-bold">TOR</span>
                      <div className="flex gap-3 text-xs">
                          <span className="text-white font-mono">{analysis.intel?.freeThrows?.raptors?.ftPct || 78.5}%</span>
                          <span className="text-slate-400">{analysis.intel?.freeThrows?.raptors?.ftaPerGame || 21.3} FTA</span>
                      </div>
                  </div>
                  <div className="flex justify-between items-center p-2 bg-cmd-bg/50 rounded-lg">
                      <span className="text-xs text-blue-400 font-bold">OPP</span>
                      <div className="flex gap-3 text-xs">
                          <span className="text-white font-mono">{analysis.intel?.freeThrows?.opponent?.ftPct || 76.2}%</span>
                          <span className="text-slate-400">{analysis.intel?.freeThrows?.opponent?.ftaPerGame || 23.8} FTA</span>
                      </div>
                  </div>
              </div>
              <div className="mt-2 text-center">
                  <span className="text-[9px] text-slate-500">FT Rate: TOR {((analysis.intel?.freeThrows?.raptors?.ftRate || 0.268) * 100).toFixed(1)}% | OPP {((analysis.intel?.freeThrows?.opponent?.ftRate || 0.285) * 100).toFixed(1)}%</span>
              </div>
          </div>

          {/* Quarter Scoring */}
          <div className="glass-card p-4">
              <div className="flex items-center gap-2 mb-3"><Timer className="w-4 h-4 text-pink-400" /><span className="text-xs font-bold text-slate-500 uppercase tracking-wider">By Quarter</span></div>
              <div className="space-y-1.5">
                  {['Q1', 'Q2', 'Q3', 'Q4'].map((q, i) => {
                      const qKey = q.toLowerCase();
                      const torVal = analysis.intel?.quarterScoring?.raptors?.[qKey] || [27.5, 28.2, 26.8, 29.3][i];
                      const oppVal = analysis.intel?.quarterScoring?.opponent?.[qKey] || [28.1, 27.5, 28.9, 27.2][i];
                      const torWins = torVal > oppVal;
                      return (
                          <div key={q} className="flex items-center gap-2 text-xs">
                              <span className="w-6 text-slate-500 font-bold">{q}</span>
                              <div className="flex-1 flex items-center gap-1">
                                  <span className={`font-mono ${torWins ? 'text-green-400' : 'text-slate-400'}`}>{torVal}</span>
                                  <div className="flex-1 h-1.5 bg-cmd-border rounded-full overflow-hidden flex">
                                      <div className="bg-raptors-red h-full" style={{width: `${(torVal / (torVal + oppVal)) * 100}%`}}></div>
                                      <div className="bg-blue-500 h-full flex-1"></div>
                                  </div>
                                  <span className={`font-mono ${!torWins ? 'text-green-400' : 'text-slate-400'}`}>{oppVal}</span>
                              </div>
                          </div>
                      );
                  })}
              </div>
          </div>

          {/* Season Series */}
          <div className="glass-card p-4">
              <div className="flex items-center gap-2 mb-3"><Trophy className="w-4 h-4 text-amber-400" /><span className="text-xs font-bold text-slate-500 uppercase tracking-wider">Season Series</span></div>
              <div className="text-center mb-3">
                  <div className="flex justify-center items-center gap-4">
                      <div>
                          <div className="text-2xl font-black text-raptors-red">{analysis.intel?.seasonSeries?.raptorsWins || 1}</div>
                          <div className="text-[9px] text-slate-500">TOR</div>
                      </div>
                      <span className="text-slate-600 text-xl">-</span>
                      <div>
                          <div className="text-2xl font-black text-blue-400">{analysis.intel?.seasonSeries?.opponentWins || 1}</div>
                          <div className="text-[9px] text-slate-500">OPP</div>
                      </div>
                  </div>
              </div>
              <div className="space-y-1.5">
                  {(analysis.intel?.seasonSeries?.games || [
                      { date: "Nov 15", result: "W 112-105", topScorer: "Barnes - 28" },
                      { date: "Jan 8", result: "L 98-115", topScorer: "Barrett - 22" }
                  ]).map((g, i) => (
                      <div key={i} className={`text-[10px] p-1.5 rounded ${g.result.startsWith('W') ? 'bg-green-500/10 text-green-400' : 'bg-red-500/10 text-red-400'}`}>
                          <span className="font-bold">{g.date}:</span> {g.result}
                      </div>
                  ))}
              </div>
          </div>
      </div>

      {/* 5.75 TREND ANALYSIS */}
      <div className="grid grid-cols-1 lg:grid-cols-2 gap-4 animate-slide-up" style={{animationDelay: '0.5s'}}>
          {/* Last 10 Games Trend */}
          <div className="glass-card p-4">
              <div className="flex items-center gap-2 mb-3"><TrendingUp className="w-4 h-4 text-emerald-400" /><span className="text-xs font-bold text-slate-500 uppercase tracking-wider">Last 10 Games Scoring</span></div>
              <div className="h-40">
                  <ResponsiveContainer width="100%" height="100%">
                      <AreaChart data={(analysis.intel?.lastTenTrend?.raptors || [105, 112, 98, 118, 108, 115, 122, 110, 119, 114]).map((pts, i) => ({
                          game: `G${i+1}`,
                          TOR: pts,
                          OPP: (analysis.intel?.lastTenTrend?.opponent || [110, 102, 115, 108, 99, 112, 105, 118, 108, 111])[i]
                      }))}>
                          <defs>
                              <linearGradient id="torGrad" x1="0" y1="0" x2="0" y2="1">
                                  <stop offset="5%" stopColor="#CE1141" stopOpacity={0.3}/>
                                  <stop offset="95%" stopColor="#CE1141" stopOpacity={0}/>
                              </linearGradient>
                              <linearGradient id="oppGrad" x1="0" y1="0" x2="0" y2="1">
                                  <stop offset="5%" stopColor="#6366f1" stopOpacity={0.3}/>
                                  <stop offset="95%" stopColor="#6366f1" stopOpacity={0}/>
                              </linearGradient>
                          </defs>
                          <CartesianGrid strokeDasharray="3 3" stroke="#1e293b" />
                          <XAxis dataKey="game" tick={{ fontSize: 10, fill: '#64748b' }} />
                          <YAxis domain={[90, 130]} tick={{ fontSize: 10, fill: '#64748b' }} />
                          <Tooltip contentStyle={{ backgroundColor: '#111827', borderColor: '#1e293b', borderRadius: '8px', fontSize: '11px' }} />
                          <Area type="monotone" dataKey="TOR" stroke="#CE1141" fill="url(#torGrad)" strokeWidth={2} />
                          <Area type="monotone" dataKey="OPP" stroke="#6366f1" fill="url(#oppGrad)" strokeWidth={2} />
                      </AreaChart>
                  </ResponsiveContainer>
              </div>
          </div>

          {/* Clutch Performance */}
          <div className="glass-card p-4">
              <div className="flex items-center gap-2 mb-3"><Zap className="w-4 h-4 text-yellow-400 fill-yellow-400" /><span className="text-xs font-bold text-slate-500 uppercase tracking-wider">Clutch Time (Â±5 pts, &lt;5 min)</span></div>
              <div className="grid grid-cols-2 gap-4">
                  <div className="bg-raptors-red/10 border border-raptors-red/20 rounded-xl p-4 text-center">
                      <div className="text-2xl font-black text-white mb-1">{analysis.intel?.clutchStats?.raptors?.record || "8-5"}</div>
                      <div className="text-[10px] text-slate-500 uppercase mb-3">TOR Clutch Record</div>
                      <div className="grid grid-cols-2 gap-2 text-xs">
                          <div><span className="text-slate-400">PPG:</span> <span className="text-white font-bold">{analysis.intel?.clutchStats?.raptors?.ppg || 4.8}</span></div>
                          <div><span className="text-slate-400">FG%:</span> <span className="text-white font-bold">{analysis.intel?.clutchStats?.raptors?.fgPct || 45.2}%</span></div>
                      </div>
                      <div className={`mt-2 text-sm font-mono font-bold ${(analysis.intel?.clutchStats?.raptors?.plusMinus || 2.1) >= 0 ? 'text-green-400' : 'text-red-400'}`}>
                          {(analysis.intel?.clutchStats?.raptors?.plusMinus || 2.1) > 0 ? '+' : ''}{analysis.intel?.clutchStats?.raptors?.plusMinus || 2.1}
                      </div>
                  </div>
                  <div className="bg-blue-500/10 border border-blue-500/20 rounded-xl p-4 text-center">
                      <div className="text-2xl font-black text-white mb-1">{analysis.intel?.clutchStats?.opponent?.record || "6-7"}</div>
                      <div className="text-[10px] text-slate-500 uppercase mb-3">OPP Clutch Record</div>
                      <div className="grid grid-cols-2 gap-2 text-xs">
                          <div><span className="text-slate-400">PPG:</span> <span className="text-white font-bold">{analysis.intel?.clutchStats?.opponent?.ppg || 4.2}</span></div>
                          <div><span className="text-slate-400">FG%:</span> <span className="text-white font-bold">{analysis.intel?.clutchStats?.opponent?.fgPct || 41.8}%</span></div>
                      </div>
                      <div className={`mt-2 text-sm font-mono font-bold ${(analysis.intel?.clutchStats?.opponent?.plusMinus || -1.5) >= 0 ? 'text-green-400' : 'text-red-400'}`}>
                          {(analysis.intel?.clutchStats?.opponent?.plusMinus || -1.5) > 0 ? '+' : ''}{analysis.intel?.clutchStats?.opponent?.plusMinus || -1.5}
                      </div>
                  </div>
              </div>
          </div>
      </div>

      {/* 5.9 ASSIST NETWORK & DEFENSE */}
      <div className="grid grid-cols-1 lg:grid-cols-2 gap-4 animate-slide-up" style={{animationDelay: '0.55s'}}>
          {/* Assist Distribution */}
          <div className="glass-card p-4">
              <div className="flex items-center gap-2 mb-3"><Share className="w-4 h-4 text-teal-400" /><span className="text-xs font-bold text-slate-500 uppercase tracking-wider">Top Assist Connections</span></div>
              <div className="grid grid-cols-2 gap-4">
                  <div>
                      <div className="text-[10px] text-raptors-red font-bold mb-2 uppercase">Toronto</div>
                      <div className="space-y-2">
                          {(analysis.intel?.assistDistribution?.raptors || [
                              { from: "Quickley", to: "Barnes", pct: 18 },
                              { from: "Quickley", to: "Ingram", pct: 15 },
                              { from: "Barnes", to: "Poeltl", pct: 12 }
                          ]).slice(0, 3).map((conn, i) => (
                              <div key={i} className="flex items-center gap-2 text-xs">
                                  <div className="flex-1 flex items-center gap-1">
                                      <span className="text-white font-medium truncate">{conn.from}</span>
                                      <span className="text-raptors-red">â†’</span>
                                      <span className="text-slate-400 truncate">{conn.to}</span>
                                  </div>
                                  <div className="w-12 h-1.5 bg-cmd-border rounded-full overflow-hidden">
                                      <div className="h-full bg-raptors-red rounded-full" style={{width: `${conn.pct * 3}%`}}></div>
                                  </div>
                                  <span className="text-slate-500 font-mono w-8 text-right">{conn.pct}%</span>
                              </div>
                          ))}
                      </div>
                  </div>
                  <div>
                      <div className="text-[10px] text-blue-400 font-bold mb-2 uppercase">{game.opponent?.slice(0,3)}</div>
                      <div className="space-y-2">
                          {(analysis.intel?.assistDistribution?.opponent || [
                              { from: "Edwards", to: "Randle", pct: 16 },
                              { from: "Conley", to: "Edwards", pct: 14 },
                              { from: "Conley", to: "Gobert", pct: 11 }
                          ]).slice(0, 3).map((conn, i) => (
                              <div key={i} className="flex items-center gap-2 text-xs">
                                  <div className="flex-1 flex items-center gap-1">
                                      <span className="text-white font-medium truncate">{conn.from}</span>
                                      <span className="text-blue-400">â†’</span>
                                      <span className="text-slate-400 truncate">{conn.to}</span>
                                  </div>
                                  <div className="w-12 h-1.5 bg-cmd-border rounded-full overflow-hidden">
                                      <div className="h-full bg-blue-500 rounded-full" style={{width: `${conn.pct * 3}%`}}></div>
                                  </div>
                                  <span className="text-slate-500 font-mono w-8 text-right">{conn.pct}%</span>
                              </div>
                          ))}
                      </div>
                  </div>
              </div>
          </div>

          {/* Defense by Position */}
          <div className="glass-card p-4">
              <div className="flex items-center gap-2 mb-3"><Shield className="w-4 h-4 text-violet-400" /><span className="text-xs font-bold text-slate-500 uppercase tracking-wider">Defense by Position (DRTG)</span></div>
              <div className="h-44">
                  <ResponsiveContainer width="100%" height="100%">
                      <RadarChart cx="50%" cy="50%" outerRadius="70%" data={[
                          { pos: 'PG', TOR: analysis.intel?.defenseByPosition?.raptors?.pg || 112.5, OPP: analysis.intel?.defenseByPosition?.opponent?.pg || 108.1 },
                          { pos: 'SG', TOR: analysis.intel?.defenseByPosition?.raptors?.sg || 108.2, OPP: analysis.intel?.defenseByPosition?.opponent?.sg || 110.5 },
                          { pos: 'SF', TOR: analysis.intel?.defenseByPosition?.raptors?.sf || 105.8, OPP: analysis.intel?.defenseByPosition?.opponent?.sf || 107.2 },
                          { pos: 'PF', TOR: analysis.intel?.defenseByPosition?.raptors?.pf || 110.3, OPP: analysis.intel?.defenseByPosition?.opponent?.pf || 106.8 },
                          { pos: 'C', TOR: analysis.intel?.defenseByPosition?.raptors?.c || 102.4, OPP: analysis.intel?.defenseByPosition?.opponent?.c || 99.5 }
                      ]}>
                          <PolarGrid stroke="#1e293b" />
                          <PolarAngleAxis dataKey="pos" tick={{ fill: '#94a3b8', fontSize: 10, fontWeight: 'bold' }} />
                          <PolarRadiusAxis angle={90} domain={[95, 120]} tick={false} axisLine={false} />
                          <Radar name="TOR" dataKey="TOR" stroke="#CE1141" fill="#CE1141" fillOpacity={0.3} strokeWidth={2} />
                          <Radar name="OPP" dataKey="OPP" stroke="#6366f1" fill="#6366f1" fillOpacity={0.2} strokeWidth={2} />
                          <Tooltip contentStyle={{ backgroundColor: '#111827', borderColor: '#1e293b', borderRadius: '8px', fontSize: '11px' }} />
                      </RadarChart>
                  </ResponsiveContainer>
              </div>
              <div className="flex justify-center gap-4 text-[10px] mt-1">
                  <span className="flex items-center gap-1"><span className="w-2 h-2 rounded-full bg-raptors-red"></span> TOR (lower is better)</span>
                  <span className="flex items-center gap-1"><span className="w-2 h-2 rounded-full bg-blue-500"></span> OPP</span>
              </div>
          </div>
      </div>

      {/* 6. ROTATION SIMULATOR */}
      <div className="glass-card overflow-hidden animate-slide-up" style={{animationDelay: '0.65s'}}>
          <div className="relative bg-gradient-to-r from-cmd-bg via-cmd-surface to-cmd-bg px-6 py-5 overflow-hidden">
              <div className="absolute inset-0 bg-grid opacity-20"></div>
              <div className="relative z-10 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
                  <div>
                      <h2 className="text-2xl font-black text-white flex items-center gap-3 uppercase tracking-tight"><div className="bg-raptors-red p-2 rounded-lg shadow-lg shadow-raptors-red/30"><Activity className="w-5 h-5 text-white" /></div>Rotation Simulator</h2>
                      <p className="text-slate-500 text-xs mt-1 ml-12">Click a player on court, then click a bench player to swap</p>
                  </div>
                  <div className="flex items-center gap-3 ml-12 sm:ml-0">
                      <div className={`px-4 py-2 rounded-lg text-center ${(raptorsAgg.net - opponentAgg.net) >= 0 ? 'bg-green-500/10 border border-green-500/30' : 'bg-red-500/10 border border-red-500/30'}`}>
                          <div className={`text-xl font-black font-mono ${(raptorsAgg.net - opponentAgg.net) >= 0 ? 'text-green-400' : 'text-red-400'}`} style={(raptorsAgg.net - opponentAgg.net) >= 0 ? {textShadow: '0 0 10px rgba(74,222,128,0.3)'} : {textShadow: '0 0 10px rgba(248,113,113,0.3)'}}>{(raptorsAgg.net - opponentAgg.net) > 0 ? '+' : ''}{(raptorsAgg.net - opponentAgg.net).toFixed(1)}</div>
                          <div className="text-[9px] text-slate-500 uppercase font-bold tracking-wider">Edge</div>
                      </div>
                  </div>
              </div>
          </div>
          <div className="p-6 space-y-6">
          <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                  <div className="text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-2">Raptors Presets</div>
                  <div className="flex gap-1.5 bg-cmd-bg p-1 rounded-lg border border-cmd-border">
                       <button onClick={() => applyRaptorsPreset('starters')} className="btn-ripple flex-1 px-3 py-2 text-xs font-bold text-slate-300 hover:bg-cmd-card hover:text-white rounded transition-all flex items-center justify-center gap-1.5"><Users className="w-3 h-3" /> Starters</button>
                       <button onClick={() => applyRaptorsPreset('second')} className="btn-ripple flex-1 px-3 py-2 text-xs font-bold text-slate-300 hover:bg-cmd-card hover:text-white rounded transition-all flex items-center justify-center gap-1.5"><RefreshCcw className="w-3 h-3" /> 2nd Unit</button>
                       <button onClick={() => applyRaptorsPreset('speed')} className="btn-ripple flex-1 px-3 py-2 text-xs font-bold text-slate-300 hover:bg-cmd-card hover:text-white rounded transition-all flex items-center justify-center gap-1.5"><Zap className="w-3 h-3" /> Speed</button>
                       <button onClick={() => applyRaptorsPreset('big')} className="btn-ripple flex-1 px-3 py-2 text-xs font-bold text-slate-300 hover:bg-cmd-card hover:text-white rounded transition-all flex items-center justify-center gap-1.5"><Shield className="w-3 h-3" /> Big</button>
                  </div>
              </div>
              <div>
                  <div className="text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-2">{game.opponent} Presets</div>
                  <div className="flex gap-1.5 bg-cmd-bg p-1 rounded-lg border border-cmd-border">
                       <button onClick={() => applyPreset('starters')} className="btn-ripple flex-1 px-3 py-2 text-xs font-bold text-slate-300 hover:bg-cmd-card hover:text-white rounded transition-all flex items-center justify-center gap-1.5"><Users className="w-3 h-3" /> Starters</button>
                       <button onClick={() => applyPreset('second')} className="btn-ripple flex-1 px-3 py-2 text-xs font-bold text-slate-300 hover:bg-cmd-card hover:text-white rounded transition-all flex items-center justify-center gap-1.5"><RefreshCcw className="w-3 h-3" /> 2nd Unit</button>
                       <button onClick={() => applyPreset('speed')} className="btn-ripple flex-1 px-3 py-2 text-xs font-bold text-slate-300 hover:bg-cmd-card hover:text-white rounded transition-all flex items-center justify-center gap-1.5"><Zap className="w-3 h-3" /> Speed</button>
                  </div>
              </div>
          </div>
          <div className="grid grid-cols-1 md:grid-cols-2 gap-6 relative">
                <div className="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 z-10 hidden md:block"><div className="bg-raptors-red p-2.5 rounded-full border-2 border-raptors-red/50 shadow-xl shadow-raptors-red/20 animate-glow-pulse"><Swords className="w-4 h-4 text-white" /></div></div>
                <div className="bg-gradient-to-br from-raptors-red/5 to-cmd-surface/50 rounded-xl p-4 border border-raptors-red/10">
                    <div className="flex justify-between items-end mb-4 pb-2 border-b-2 border-raptors-red/50">
                        <div className="flex items-center gap-2"><img src="https://cdn.nba.com/logos/nba/1610612761/primary/L/logo.svg" className="w-6 h-6" loading="lazy" alt="TOR" /><h3 className="text-raptors-red font-black uppercase text-sm tracking-wider neon-text-subtle">TORONTO</h3></div>
                        <div className="flex items-center gap-3">
                            <div className="text-[10px] font-mono text-slate-500">ORTG <span className="font-bold text-white">{raptorsAgg.ortg.toFixed(1)}</span></div>
                            <div className="text-[10px] font-mono text-slate-500">DRTG <span className="font-bold text-white">{raptorsAgg.drtg.toFixed(1)}</span></div>
                            <div className={`text-xs font-mono font-bold px-2 py-0.5 rounded ${raptorsAgg.net >= 0 ? 'bg-green-500/10 text-green-400 border border-green-500/20' : 'bg-red-500/10 text-red-400 border border-red-500/20'}`}>NET {raptorsAgg.net > 0 ? '+' : ''}{raptorsAgg.net.toFixed(1)}</div>
                        </div>
                    </div>
                    <div className="grid grid-cols-5 gap-2">{activeRaptorsLineup.map((player, idx) => (<PlayerCard key={player.id} player={player} onClick={() => setSelectedSlot(selectedSlot?.team === 'raptors' && selectedSlot?.index === idx ? null : { team: 'raptors', index: idx })} onDeepDive={() => setSelectedPlayerForDeepDive({ player, team: 'Raptors' })} isSelected={selectedSlot?.team === 'raptors' && selectedSlot?.index === idx} />))}</div>
                    <div className="mt-4 pt-3 border-t border-raptors-red/10">
                         <div className="flex items-center justify-between mb-2"><div className="text-[10px] font-bold text-slate-500 uppercase tracking-wider">Bench ({raptorsBench.length})</div>{selectedSlot?.team === 'raptors' && <div className="text-[10px] font-bold text-raptors-red animate-pulse uppercase neon-text-subtle">Click to swap in</div>}</div>
                         <div className="flex gap-2 overflow-x-auto pb-2 scrollbar-hide">{raptorsBench.map(player => (<BenchCard key={player.id} player={player} onClick={() => handleBenchClick(player, 'raptors')} isHighlighted={selectedSlot?.team === 'raptors'} />))}</div>
                    </div>
                </div>
                <div className="bg-gradient-to-br from-blue-500/5 to-cmd-surface/50 rounded-xl p-4 border border-blue-500/10">
                    <div className="flex justify-between items-end mb-4 pb-2 border-b-2 border-blue-500/50">
                        <div className="flex items-center gap-2">{game.opponentId && <img loading="lazy" src={`https://cdn.nba.com/logos/nba/${game.opponentId}/primary/L/logo.svg`} className="w-6 h-6" alt={game.opponent} />}<h3 className="text-blue-400 font-black uppercase text-sm tracking-wider">{game.opponent}</h3></div>
                        <div className="flex items-center gap-3">
                            <div className="text-[10px] font-mono text-slate-500">ORTG <span className="font-bold text-white">{opponentAgg.ortg.toFixed(1)}</span></div>
                            <div className="text-[10px] font-mono text-slate-500">DRTG <span className="font-bold text-white">{opponentAgg.drtg.toFixed(1)}</span></div>
                            <div className={`text-xs font-mono font-bold px-2 py-0.5 rounded ${opponentAgg.net >= 0 ? 'bg-green-500/10 text-green-400 border border-green-500/20' : 'bg-red-500/10 text-red-400 border border-red-500/20'}`}>NET {opponentAgg.net > 0 ? '+' : ''}{opponentAgg.net.toFixed(1)}</div>
                        </div>
                    </div>
                    <div className="grid grid-cols-5 gap-2">{activeOpponentLineup.map((player, idx) => (<PlayerCard key={player.id} player={player} onClick={() => setSelectedSlot(selectedSlot?.team === 'opponent' && selectedSlot?.index === idx ? null : { team: 'opponent', index: idx })} onDeepDive={() => setSelectedPlayerForDeepDive({ player, team: game.opponent })} isOpponent isSelected={selectedSlot?.team === 'opponent' && selectedSlot?.index === idx} />))}</div>
                    <div className="mt-4 pt-3 border-t border-blue-500/10">
                         <div className="flex items-center justify-between mb-2"><div className="text-[10px] font-bold text-slate-500 uppercase tracking-wider">Bench ({opponentBench.length})</div>{selectedSlot?.team === 'opponent' && <div className="text-[10px] font-bold text-blue-400 animate-pulse uppercase">Click to swap in</div>}</div>
                         <div className="flex gap-2 overflow-x-auto pb-2 scrollbar-hide">{opponentBench.map(player => (<BenchCard key={player.id} player={player} onClick={() => handleBenchClick(player, 'opponent')} isOpponent isHighlighted={selectedSlot?.team === 'opponent'} />))}</div>
                    </div>
                </div>
          </div>
          <div className="bg-cmd-bg/50 rounded-xl border border-cmd-border overflow-hidden">
              <div className="bg-cmd-surface/50 px-5 py-3 border-b border-cmd-border flex items-center gap-2"><BarChart3 className="w-4 h-4 text-slate-400" /><h3 className="text-sm font-bold text-slate-200 uppercase tracking-wider">Lineup Analytics Comparison</h3></div>
              <div className="p-5">
                  <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                      <div className="bg-cmd-surface/50 rounded-lg border border-cmd-border p-4">
                          <div className="text-xs font-bold text-slate-500 uppercase tracking-wider mb-3">Rating Comparison</div>
                          <div className="h-52">
                              <ResponsiveContainer width="100%" height="100%">
                                  <BarChart data={[
                                      { name: 'ORTG', Raptors: Number(raptorsAgg.ortg.toFixed(1)), Opponent: Number(opponentAgg.ortg.toFixed(1)) },
                                      { name: 'DRTG', Raptors: Number(raptorsAgg.drtg.toFixed(1)), Opponent: Number(opponentAgg.drtg.toFixed(1)) },
                                      { name: 'PER', Raptors: Number(raptorsAgg.per.toFixed(1)), Opponent: Number(opponentAgg.per.toFixed(1)) },
                                      { name: 'NET', Raptors: Number(raptorsAgg.net.toFixed(1)), Opponent: Number(opponentAgg.net.toFixed(1)) },
                                  ]} barGap={2} barCategoryGap="20%">
                                      <CartesianGrid strokeDasharray="3 3" stroke="#1e293b" />
                                      <XAxis dataKey="name" tick={{ fontSize: 11, fontWeight: 600, fill: '#94a3b8' }} />
                                      <YAxis tick={{ fontSize: 10, fill: '#64748b' }} domain={['auto', 'auto']} />
                                      <Tooltip contentStyle={{ backgroundColor: '#111827', borderColor: '#1e293b', borderRadius: '8px', boxShadow: '0 4px 20px rgba(206,17,65,0.15)', fontSize: '12px', color: '#e2e8f0' }} itemStyle={{ color: '#e2e8f0' }} />
                                      <Legend wrapperStyle={{ fontSize: '11px', fontWeight: 600, color: '#94a3b8' }} />
                                      <Bar dataKey="Raptors" fill="#CE1141" radius={[4, 4, 0, 0]} />
                                      <Bar dataKey="Opponent" fill="#6366f1" radius={[4, 4, 0, 0]} />
                                  </BarChart>
                              </ResponsiveContainer>
                          </div>
                      </div>
                      <div className="bg-cmd-surface/50 rounded-lg border border-cmd-border p-4">
                          <div className="text-xs font-bold text-slate-500 uppercase tracking-wider mb-3">Head-to-Head Breakdown</div>
                          <div className="space-y-3">
                              <ComparisonRow label="Offensive Rating" raptorsVal={raptorsAgg.ortg} opponentVal={opponentAgg.ortg} higherIsBetter={true} />
                              <ComparisonRow label="Defensive Rating" raptorsVal={raptorsAgg.drtg} opponentVal={opponentAgg.drtg} higherIsBetter={false} />
                              <ComparisonRow label="Net Rating" raptorsVal={raptorsAgg.net} opponentVal={opponentAgg.net} higherIsBetter={true} />
                              <ComparisonRow label="Avg PER" raptorsVal={raptorsAgg.per} opponentVal={opponentAgg.per} higherIsBetter={true} />
                              <ComparisonRow label="Combined PPG" raptorsVal={activeRaptorsLineup.reduce((s, p) => s + (p.seasonStats?.ppg || 0), 0)} opponentVal={activeOpponentLineup.reduce((s, p) => s + (p.seasonStats?.ppg || 0), 0)} higherIsBetter={true} />
                              <ComparisonRow label="Combined RPG" raptorsVal={activeRaptorsLineup.reduce((s, p) => s + (p.seasonStats?.rpg || 0), 0)} opponentVal={activeOpponentLineup.reduce((s, p) => s + (p.seasonStats?.rpg || 0), 0)} higherIsBetter={true} />
                              <ComparisonRow label="Combined APG" raptorsVal={activeRaptorsLineup.reduce((s, p) => s + (p.seasonStats?.apg || 0), 0)} opponentVal={activeOpponentLineup.reduce((s, p) => s + (p.seasonStats?.apg || 0), 0)} higherIsBetter={true} />
                          </div>
                      </div>
                  </div>
              </div>
          </div>
          </div>
      </div>

      {selectedPlayerForDeepDive && (<PlayerDeepDive player={selectedPlayerForDeepDive.player} opponentName={game.opponent} teamName={selectedPlayerForDeepDive.team} onClose={() => setSelectedPlayerForDeepDive(null)} />)}
    </div>
  );
};

// ============================================================
// Standings Widget (with live ESPN data)
const StandingsWidget = ({ isDark = true }) => {
  const { standings, loading, lastUpdated } = useLiveStandings();

  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} overflow-hidden`}>
      <div className={`px-3 py-2 border-b ${isDark ? 'border-cmd-border' : 'border-light-border'} bg-gradient-to-r from-raptors-red/10 to-transparent`}>
        <div className="flex items-center justify-between">
          <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2`}>
            <Trophy className="w-3 h-3 text-yellow-500" /> East Standings
          </h3>
          {loading ? (
            <span className="w-2 h-2 bg-yellow-500 rounded-full animate-pulse" title="Updating..."></span>
          ) : (
            <span className="w-2 h-2 bg-green-500 rounded-full" title={`Updated ${lastUpdated?.toLocaleTimeString() || ''}`}></span>
          )}
        </div>
      </div>
      <div className={`divide-y ${isDark ? 'divide-cmd-border/50' : 'divide-light-border'} max-h-64 overflow-y-auto`}>
        {loading && standings.length === 0 ? <SkeletonBlock rows={8} /> : standings.map((team) => (
          <div key={team.abbr} className={`flex items-center justify-between px-3 py-1.5 text-xs ${team.highlight ? 'bg-raptors-red/10' : ''}`}>
            <div className="flex items-center gap-2">
              <span className="text-slate-500 w-4">{team.rank}</span>
              <img loading="lazy" src={`https://cdn.nba.com/logos/nba/${team.id}/primary/L/logo.svg`} className="w-4 h-4" alt="" />
              <span className={team.highlight ? 'text-raptors-red font-bold' : isDark ? 'text-slate-300' : 'text-slate-700'}>{team.abbr}</span>
            </div>
            <span className={`font-mono ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>{team.wins}-{team.losses}</span>
          </div>
        ))}
      </div>
      <div className={`px-3 py-1.5 text-[9px] ${isDark ? 'text-slate-600 border-t border-cmd-border' : 'text-slate-400 border-t border-light-border'} text-center`}>
        {loading ? 'Updating...' : 'Live data â€¢ Auto-refreshes'}
      </div>
    </div>
  );
};

// Theme Context
const ThemeContext = React.createContext({ isDark: true, toggle: () => {} });

// Mobile Bottom Nav
const MobileBottomNav = ({ isDark = true, onThemeToggle, onShare, onReminder, onNavigate }) => {
  const scrollTo = (id) => { const el = document.getElementById(id); if (el) el.scrollIntoView({ behavior: 'smooth', block: 'start' }); };
  return (
    <div className={`mobile-bottom-nav lg:hidden fixed bottom-0 left-0 right-0 z-40 ${isDark ? 'bg-cmd-surface/95 border-cmd-border' : 'bg-white/95 border-light-border'} border-t backdrop-blur-lg py-2 px-4`} style={{ paddingBottom: 'calc(0.5rem + env(safe-area-inset-bottom, 0px))' }}>
      <div className="flex justify-around items-center">
        <button onClick={() => window.scrollTo({ top: 0, behavior: 'smooth' })} className={`flex flex-col items-center justify-center gap-1 p-2 min-w-[44px] min-h-[44px] ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>
          <Home className="w-5 h-5" />
          <span className="text-[9px]">Home</span>
        </button>
        <button onClick={() => scrollTo('standings-section')} className={`flex flex-col items-center justify-center gap-1 p-2 min-w-[44px] min-h-[44px] ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>
          <Trophy className="w-5 h-5" />
          <span className="text-[9px]">Standings</span>
        </button>
        <button onClick={() => scrollTo('schedule-section')} className={`flex flex-col items-center justify-center gap-1 p-2 min-w-[44px] min-h-[44px] ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>
          <Calendar className="w-5 h-5" />
          <span className="text-[9px]">Schedule</span>
        </button>
        <button onClick={onShare} className={`flex flex-col items-center justify-center gap-1 p-2 min-w-[44px] min-h-[44px] ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>
          <MoreHorizontal className="w-5 h-5" />
          <span className="text-[9px]">More</span>
        </button>
      </div>
    </div>
  );
};

// Arena Info Widget
const ArenaWidget = ({ isDark = true }) => (
  <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
    <div className="flex items-center justify-between mb-3">
      <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
        <Home className="w-3 h-3 text-raptors-red" /> Arena Info
      </h3>
      <span className="text-lg">{ARENA_DATA.weather.icon}</span>
    </div>
    <div className={`text-lg font-bold ${isDark ? 'text-white' : 'text-slate-800'} mb-1`}>{ARENA_DATA.name}</div>
    <div className={`text-xs ${isDark ? 'text-slate-400' : 'text-slate-500'} space-y-1`}>
      <div className="flex justify-between"><span>ðŸ“ Location</span><span>{ARENA_DATA.location}</span></div>
      <div className="flex justify-between"><span>ðŸª‘ Capacity</span><span>{ARENA_DATA.capacity.toLocaleString()}</span></div>
      <div className="flex justify-between"><span>ðŸŒ¡ï¸ Weather</span><span>{ARENA_DATA.weather.temp}Â°C {ARENA_DATA.weather.condition}</span></div>
    </div>
  </div>
);

// Fan Poll Widget
const FanPollWidget = ({ isDark = true }) => {
  const [voted, setVoted] = useState(false);
  const [selectedOption, setSelectedOption] = useState(null);
  
  const handleVote = (idx) => {
    if (voted) return;
    setSelectedOption(idx);
    setVoted(true);
  };

  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Users className="w-3 h-3 text-purple-400" /> Fan Poll
        </h3>
        <span className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{FAN_POLL.totalVotes.toLocaleString()} votes</span>
      </div>
      <div className={`text-sm font-medium ${isDark ? 'text-white' : 'text-slate-800'} mb-3`}>{FAN_POLL.question}</div>
      <div className="space-y-2">
        {FAN_POLL.options.map((opt, i) => (
          <button
            key={i}
            onClick={() => handleVote(i)}
            disabled={voted}
            className={`w-full relative overflow-hidden rounded-lg p-2 text-left transition-all ${voted ? '' : 'hover:scale-[1.02]'} ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`}
          >
            {voted && (
              <div 
                className={`absolute inset-0 ${i === 0 ? 'bg-green-500/20' : 'bg-red-500/20'}`} 
                style={{width: `${opt.pct}%`}}
              />
            )}
            <div className="relative flex justify-between items-center">
              <span className={`text-sm ${selectedOption === i ? 'font-bold' : ''} ${isDark ? 'text-white' : 'text-slate-800'}`}>
                {opt.text} {selectedOption === i && 'âœ“'}
              </span>
              {voted && <span className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{opt.pct}%</span>}
            </div>
          </button>
        ))}
      </div>
    </div>
  );
};

// Historical H2H Widget
const HistoricalH2HWidget = ({ isDark = true, opponent }) => (
  <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
    <div className="flex items-center justify-between mb-3">
      <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
        <Trophy className="w-3 h-3 text-amber-400" /> All-Time vs {opponent?.slice(0,3) || 'OPP'}
      </h3>
    </div>
    <div className="grid grid-cols-2 gap-2 text-center">
      <div className={`p-2 rounded-lg ${isDark ? 'bg-raptors-red/10' : 'bg-raptors-red/5'}`}>
        <div className="text-xl font-black text-raptors-red">{HISTORICAL_H2H.allTime.raptors}</div>
        <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'} uppercase`}>TOR Wins</div>
      </div>
      <div className={`p-2 rounded-lg ${isDark ? 'bg-blue-500/10' : 'bg-blue-500/5'}`}>
        <div className="text-xl font-black text-blue-400">{HISTORICAL_H2H.allTime.opponent}</div>
        <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'} uppercase`}>OPP Wins</div>
      </div>
    </div>
    <div className={`mt-3 pt-2 border-t ${isDark ? 'border-cmd-border' : 'border-light-border'} grid grid-cols-3 gap-1 text-center text-[10px]`}>
      <div><span className={isDark ? 'text-slate-500' : 'text-slate-400'}>L10:</span> <span className={`font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{HISTORICAL_H2H.lastTen.raptors}-{HISTORICAL_H2H.lastTen.opponent}</span></div>
      <div><span className={isDark ? 'text-slate-500' : 'text-slate-400'}>Home:</span> <span className={`font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{HISTORICAL_H2H.atHome.raptors}-{HISTORICAL_H2H.atHome.opponent}</span></div>
      <div><span className={isDark ? 'text-slate-500' : 'text-slate-400'}>PO:</span> <span className={`font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{HISTORICAL_H2H.playoffs.raptors}-{HISTORICAL_H2H.playoffs.opponent}</span></div>
    </div>
  </div>
);

// Injury Report Widget
const InjuryReportWidget = ({ isDark = true, opponent }) => {
  const opponentInjuries = OPPONENT_DATA[opponent]?.injuries || [];
  
  const statusColor = (status) => {
    switch(status) {
      case 'OUT': return 'text-red-500';
      case 'GTD': return 'text-yellow-500';
      case 'QUES': return 'text-orange-400';
      default: return 'text-slate-400';
    }
  };
  
  const statusIcon = (status) => {
    switch(status) {
      case 'OUT': return 'ðŸš«';
      case 'GTD': return 'âš ï¸';
      case 'QUES': return 'â“';
      default: return 'âœ“';
    }
  };

  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Activity className="w-3 h-3 text-red-400" /> Injury Report
        </h3>
        <span className="text-lg">ðŸ¥</span>
      </div>
      
      {/* Raptors Injuries */}
      <div className="mb-3">
        <div className={`text-[10px] font-bold ${isDark ? 'text-raptors-red' : 'text-raptors-red'} mb-1 uppercase`}>Toronto</div>
        {INJURY_REPORT.raptors.length === 0 ? (
          <div className={`text-[10px] ${isDark ? 'text-green-400' : 'text-green-600'}`}>âœ“ Fully healthy</div>
        ) : (
          <div className="space-y-1">
            {INJURY_REPORT.raptors.map((player, i) => (
              <div key={i} className="flex items-center justify-between text-[10px]">
                <span className={isDark ? 'text-slate-300' : 'text-slate-600'}>{player.name}</span>
                <span className="flex items-center gap-1">
                  <span className={statusColor(player.status)}>{player.status}</span>
                  <span className={isDark ? 'text-slate-500' : 'text-slate-400'}>({player.reason})</span>
                </span>
              </div>
            ))}
          </div>
        )}
      </div>
      
      {/* Opponent Injuries */}
      <div className={`pt-2 border-t ${isDark ? 'border-cmd-border' : 'border-light-border'}`}>
        <div className={`text-[10px] font-bold ${isDark ? 'text-blue-400' : 'text-blue-600'} mb-1 uppercase`}>{opponent || 'Opponent'}</div>
        {opponentInjuries.length === 0 ? (
          <div className={`text-[10px] ${isDark ? 'text-green-400' : 'text-green-600'}`}>âœ“ Fully healthy</div>
        ) : (
          <div className="space-y-1">
            {opponentInjuries.map((player, i) => (
              <div key={i} className="flex items-center justify-between text-[10px]">
                <span className={isDark ? 'text-slate-300' : 'text-slate-600'}>{player.name}</span>
                <span className="flex items-center gap-1">
                  <span className={statusColor(player.status)}>{player.status}</span>
                  <span className={isDark ? 'text-slate-500' : 'text-slate-400'}>({player.reason})</span>
                </span>
              </div>
            ))}
          </div>
        )}
      </div>
    </div>
  );
};

// Rest & Fatigue Widget
const RestFatigueWidget = ({ isDark = true }) => {
  const daysBetween = REST_DATA.daysBetween;
  const fatigueLevel = daysBetween <= 1 ? 'High' : daysBetween === 2 ? 'Medium' : 'Low';
  const fatigueColor = daysBetween <= 1 ? 'text-red-500' : daysBetween === 2 ? 'text-yellow-500' : 'text-green-500';
  const fatigueBg = daysBetween <= 1 ? 'bg-red-500/10' : daysBetween === 2 ? 'bg-yellow-500/10' : 'bg-green-500/10';

  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Battery className="w-3 h-3 text-green-400" /> Rest & Fatigue
        </h3>
        <span className={`text-[10px] px-2 py-0.5 rounded-full ${fatigueBg} ${fatigueColor} font-bold`}>{fatigueLevel}</span>
      </div>
      
      <div className={`grid grid-cols-2 gap-2 text-[10px] ${isDark ? 'text-slate-300' : 'text-slate-600'}`}>
        <div className="flex justify-between">
          <span>Days Rest</span>
          <span className={`font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{daysBetween}</span>
        </div>
        <div className="flex justify-between">
          <span>B2B</span>
          <span className={`font-bold ${REST_DATA.isBackToBack ? 'text-red-400' : 'text-green-400'}`}>
            {REST_DATA.isBackToBack ? 'Yes âš ï¸' : 'No âœ“'}
          </span>
        </div>
        <div className="flex justify-between">
          <span>Games (7d)</span>
          <span className={`font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{REST_DATA.gamesLast7Days}</span>
        </div>
        <div className="flex justify-between">
          <span>Avg MPG (L5)</span>
          <span className={`font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{REST_DATA.avgMinutesLast5}</span>
        </div>
      </div>
      
      <div className={`mt-3 pt-2 border-t ${isDark ? 'border-cmd-border' : 'border-light-border'}`}>
        <div className="flex justify-between items-center text-[10px]">
          <span className={isDark ? 'text-slate-500' : 'text-slate-400'}>Miles traveled (7d)</span>
          <span className={`font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{REST_DATA.milesLastWeek.toLocaleString()} mi</span>
        </div>
      </div>
    </div>
  );
};

// Trade Deadline Countdown Widget
const TradeDeadlineWidget = ({ isDark = true }) => {
  return null; // Deadline passed, replaced by TradeAnalysisWidget
};

const TradeAnalysisWidget = ({ isDark = true }) => {
  const [tab, setTab] = useState('completed');
  const completed = TRADE_RUMORS.filter(t => t.status === 'Completed');
  const rumored = TRADE_RUMORS.filter(t => t.status === 'Rumored');
  const unlikely = TRADE_RUMORS.filter(t => t.status === 'Unlikely');
  const filtered = tab === 'completed' ? completed : tab === 'rumored' ? rumored : unlikely;
  
  const capSpace = { before: 8.2, after: 28.5, max: 140.6 };
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <ArrowRightLeft className="w-3 h-3 text-orange-400" /> Trade Deadline Recap
        </h3>
        <span className="text-[9px] px-1.5 py-0.5 rounded bg-green-500/20 text-green-400 font-bold">CLOSED</span>
      </div>
      
      {/* Tabs */}
      <div className="flex gap-1 mb-3">
        {[{k:'completed',l:'Done',c:'green'},{k:'rumored',l:'What If',c:'yellow'},{k:'unlikely',l:'LOL',c:'red'}].map(t => (
          <button key={t.k} onClick={() => setTab(t.k)}
            className={`flex-1 text-[9px] py-1 rounded font-bold transition-all ${tab === t.k 
              ? `bg-${t.c}-500/20 text-${t.c}-400 border border-${t.c}-500/30` 
              : `${isDark ? 'bg-cmd-bg text-slate-500' : 'bg-light-card text-slate-400'}`}`}>
            {t.l} ({t.k === 'completed' ? completed.length : t.k === 'rumored' ? rumored.length : unlikely.length})
          </button>
        ))}
      </div>
      
      {/* Trades List */}
      <div className="space-y-2 max-h-[250px] overflow-y-auto custom-scrollbar">
        {filtered.map(trade => (
          <div key={trade.id} className={`p-2 rounded-lg ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`}>
            <div className="flex items-center justify-between mb-1">
              <span className={`text-[10px] font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>
                {trade.teams.join(' â†” ')}
              </span>
              <div className="flex items-center gap-1">
                {trade.date && <span className={`text-[8px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{trade.date}</span>}
                <span className={`text-[8px] px-1 py-0.5 rounded font-bold ${
                  trade.status === 'Completed' ? 'bg-green-500/20 text-green-400' :
                  trade.status === 'Rumored' ? 'bg-yellow-500/20 text-yellow-400' :
                  'bg-red-500/20 text-red-400'}`}>{trade.status}</span>
              </div>
            </div>
            <div className={`text-[9px] ${isDark ? 'text-slate-400' : 'text-slate-500'} mb-1`}>
              <span className="text-red-400">OUT:</span> {trade.players.sent.join(', ')} â†’ <span className="text-green-400">IN:</span> {trade.players.received.join(', ')}
            </div>
            <div className={`text-[8px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{trade.summary}</div>
            <div className="flex items-center justify-between mt-1">
              <span className={`text-[8px] ${isDark ? 'text-slate-600' : 'text-slate-400'}`}>via {trade.source}</span>
              <div className="flex items-center gap-0.5">
                {Array.from({length: 5}, (_, i) => (
                  <div key={i} className={`w-1.5 h-1.5 rounded-full ${i < Math.ceil(trade.impact / 2) ? 'bg-orange-400' : isDark ? 'bg-slate-700' : 'bg-slate-300'}`} />
                ))}
              </div>
            </div>
          </div>
        ))}
      </div>
      
      {/* Cap Space */}
      <div className={`mt-3 pt-2 border-t ${isDark ? 'border-cmd-border' : 'border-light-border'}`}>
        <div className={`text-[9px] font-bold ${isDark ? 'text-slate-400' : 'text-slate-500'} mb-1 uppercase`}>Cap Space Impact</div>
        <div className="flex items-center gap-2 mb-1">
          <span className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>Before</span>
          <div className="flex-1 h-2 rounded-full bg-slate-700/50 overflow-hidden">
            <div className="h-full rounded-full bg-red-400/60" style={{width: `${(capSpace.before / capSpace.max) * 100}%`}} />
          </div>
          <span className={`text-[9px] font-bold ${isDark ? 'text-red-400' : 'text-red-500'}`}>${capSpace.before}M</span>
        </div>
        <div className="flex items-center gap-2">
          <span className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>After</span>
          <div className="flex-1 h-2 rounded-full bg-slate-700/50 overflow-hidden">
            <div className="h-full rounded-full bg-green-400" style={{width: `${(capSpace.after / capSpace.max) * 100}%`}} />
          </div>
          <span className={`text-[9px] font-bold text-green-400`}>${capSpace.after}M</span>
        </div>
      </div>
    </div>
  );
};

// Notification Request Widget
const NotificationWidget = ({ isDark = true, game }) => {
  const [permission, setPermission] = useState('default');
  const [scheduled, setScheduled] = useState(false);
  
  useEffect(() => {
    if ('Notification' in window) {
      setPermission(Notification.permission);
    }
  }, []);
  
  const requestPermission = async () => {
    if (!('Notification' in window)) {
      alert('Notifications not supported in this browser');
      return;
    }
    const result = await Notification.requestPermission();
    setPermission(result);
    if (result === 'granted' && game?.status === 'upcoming') {
      setScheduled(true);
      // In a real app, you'd register with a service worker here
    }
  };

  if (!game || game.status !== 'upcoming') return null;

  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Bell className="w-3 h-3 text-purple-400" /> Game Alerts
        </h3>
        <span className="text-lg">ðŸ””</span>
      </div>
      
      {permission === 'granted' ? (
        <div className="text-center">
          <div className={`text-sm ${isDark ? 'text-green-400' : 'text-green-600'} mb-2`}>âœ“ Notifications Enabled</div>
          <button
            onClick={() => setScheduled(!scheduled)}
            className={`w-full py-2 rounded-lg text-xs font-bold transition-all ${
              scheduled 
                ? 'bg-green-500/20 text-green-400 border border-green-500/30' 
                : `${isDark ? 'bg-cmd-bg hover:bg-cmd-card' : 'bg-light-card hover:bg-slate-200'} ${isDark ? 'text-white' : 'text-slate-800'}`
            }`}
          >
            {scheduled ? 'ðŸ”” Reminder Set' : 'Set Game Reminder'}
          </button>
        </div>
      ) : permission === 'denied' ? (
        <div className={`text-center text-xs ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>
          Notifications blocked. Enable in browser settings.
        </div>
      ) : (
        <button
          onClick={requestPermission}
          className="w-full py-2 bg-raptors-red text-white rounded-lg text-xs font-bold hover:bg-raptors-red/90 transition-all"
        >
          Enable Game Alerts
        </button>
      )}
    </div>
  );
};

// Pace Predictor Widget
const PacePredictorWidget = ({ isDark = true, opponent }) => {
  const raptorsPace = 100.8; // Raptors pace
  const opponentPace = opponent === 'Pacers' ? 103.2 : opponent === 'Bulls' ? 97.5 : opponent === 'Pistons' ? 99.1 : 100.0;
  const avgPace = (raptorsPace + opponentPace) / 2;
  const gameType = avgPace > 101 ? 'Fast' : avgPace < 98 ? 'Slow' : 'Medium';
  const predictedPossessions = Math.round(avgPace * 0.48 * 2);
  
  const paceColor = avgPace > 101 ? 'text-orange-400' : avgPace < 98 ? 'text-blue-400' : 'text-green-400';
  const paceBg = avgPace > 101 ? 'bg-orange-500/10' : avgPace < 98 ? 'bg-blue-500/10' : 'bg-green-500/10';

  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Gauge className="w-3 h-3 text-cyan-400" /> Pace Predictor
        </h3>
        <span className={`text-[10px] px-2 py-0.5 rounded-full ${paceBg} ${paceColor} font-bold`}>{gameType}</span>
      </div>
      
      <div className="grid grid-cols-3 gap-2 text-center mb-3">
        <div className={`p-2 rounded-lg ${isDark ? 'bg-raptors-red/10' : 'bg-raptors-red/5'}`}>
          <div className="text-lg font-black text-raptors-red">{raptorsPace.toFixed(1)}</div>
          <div className={`text-[8px] ${isDark ? 'text-slate-500' : 'text-slate-400'} uppercase`}>TOR</div>
        </div>
        <div className={`p-2 rounded-lg ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`}>
          <div className={`text-lg font-black ${paceColor}`}>{avgPace.toFixed(1)}</div>
          <div className={`text-[8px] ${isDark ? 'text-slate-500' : 'text-slate-400'} uppercase`}>Pred</div>
        </div>
        <div className={`p-2 rounded-lg ${isDark ? 'bg-blue-500/10' : 'bg-blue-500/5'}`}>
          <div className="text-lg font-black text-blue-400">{opponentPace.toFixed(1)}</div>
          <div className={`text-[8px] ${isDark ? 'text-slate-500' : 'text-slate-400'} uppercase`}>{opponent?.slice(0,3) || 'OPP'}</div>
        </div>
      </div>
      
      <div className={`pt-2 border-t ${isDark ? 'border-cmd-border' : 'border-light-border'} text-[10px]`}>
        <div className="flex justify-between">
          <span className={isDark ? 'text-slate-400' : 'text-slate-500'}>Est. Possessions</span>
          <span className={`font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>~{predictedPossessions}</span>
        </div>
      </div>
    </div>
  );
};

// Net Rating Widget
const NetRatingWidget = ({ isDark = true }) => {
  const ortg = 114.2;
  const drtg = 111.8;
  const netRtg = ortg - drtg;
  const netColor = netRtg > 0 ? 'text-green-400' : 'text-red-400';
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <TrendingUp className="w-3 h-3 text-emerald-400" /> Net Rating
        </h3>
        <span className={`text-sm font-black ${netColor}`}>{netRtg > 0 ? '+' : ''}{netRtg.toFixed(1)}</span>
      </div>
      
      <div className="grid grid-cols-2 gap-2 text-center">
        <div className={`p-2 rounded-lg ${isDark ? 'bg-green-500/10' : 'bg-green-500/5'}`}>
          <div className="text-xl font-black text-green-400">{ortg.toFixed(1)}</div>
          <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'} uppercase`}>Offense</div>
        </div>
        <div className={`p-2 rounded-lg ${isDark ? 'bg-red-500/10' : 'bg-red-500/5'}`}>
          <div className="text-xl font-black text-red-400">{drtg.toFixed(1)}</div>
          <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'} uppercase`}>Defense</div>
        </div>
      </div>
      
      <div className={`mt-2 text-[10px] ${isDark ? 'text-slate-400' : 'text-slate-500'} text-center`}>
        Points per 100 possessions
      </div>
    </div>
  );
};

// Player Props Predictions Widget
const PlayerPropsWidget = ({ isDark = true, opponent }) => {
  const predictions = [
    { player: 'Scottie Barnes', prop: 'PTS', line: 19.5, over: 58, confidence: 'High' },
    { player: 'RJ Barrett', prop: 'PTS', line: 17.5, over: 52, confidence: 'Med' },
    { player: 'Scottie Barnes', prop: 'REB', line: 8.5, over: 55, confidence: 'Med' },
    { player: 'Immanuel Quickley', prop: 'AST', line: 6.5, over: 48, confidence: 'Low' }
  ];
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Target className="w-3 h-3 text-purple-400" /> Player Props
        </h3>
        <span className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>AI Picks</span>
      </div>
      
      <div className="space-y-2">
        {predictions.map((p, i) => (
          <div key={i} className={`flex items-center justify-between text-[10px] p-2 rounded-lg ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`}>
            <div className="flex-1">
              <span className={`font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{p.player.split(' ')[1]}</span>
              <span className={`ml-1 ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>{p.prop} O{p.line}</span>
            </div>
            <div className="flex items-center gap-2">
              <span className={`${p.over > 55 ? 'text-green-400' : p.over < 50 ? 'text-red-400' : 'text-yellow-400'}`}>
                {p.over}%
              </span>
              <span className={`px-1.5 py-0.5 rounded text-[8px] ${
                p.confidence === 'High' ? 'bg-green-500/20 text-green-400' :
                p.confidence === 'Med' ? 'bg-yellow-500/20 text-yellow-400' :
                'bg-slate-500/20 text-slate-400'
              }`}>
                {p.confidence}
              </span>
            </div>
          </div>
        ))}
      </div>
    </div>
  );
};

// Four Factors Widget
const FourFactorsWidget = ({ isDark = true, opponent }) => {
  const raptors = { efg: 53.2, tov: 13.1, orb: 27.5, ftr: 24.8 };
  const opp = { efg: 51.8, tov: 14.2, orb: 25.2, ftr: 22.1 };
  
  const Factor = ({ label, value, oppValue, higher = true }) => {
    const better = higher ? value > oppValue : value < oppValue;
    return (
      <div className={`p-2 rounded-lg ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`}>
        <div className={`text-xs font-bold mb-1 ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>{label}</div>
        <div className="flex justify-between items-center">
          <span className={`text-sm font-black ${better ? 'text-green-400' : 'text-slate-400'}`}>{value}%</span>
          <span className={`text-[10px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>vs</span>
          <span className={`text-sm font-bold ${!better ? 'text-green-400' : 'text-slate-400'}`}>{oppValue}%</span>
        </div>
      </div>
    );
  };

  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <BarChart3 className="w-3 h-3 text-indigo-400" /> Four Factors
        </h3>
        <span className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>TOR vs {opponent?.slice(0,3) || 'OPP'}</span>
      </div>
      
      <div className="grid grid-cols-2 gap-2">
        <Factor label="eFG%" value={raptors.efg} oppValue={opp.efg} />
        <Factor label="TOV%" value={raptors.tov} oppValue={opp.tov} higher={false} />
        <Factor label="ORB%" value={raptors.orb} oppValue={opp.orb} />
        <Factor label="FTR" value={raptors.ftr} oppValue={opp.ftr} />
      </div>
    </div>
  );
};

// Clutch Time Stats Widget
const ClutchStatsWidget = ({ isDark = true }) => {
  const clutchStats = {
    record: { w: 8, l: 5 },
    ppg: 4.2,
    fgPct: 45.8,
    ftPct: 82.1,
    threePct: 36.2,
    netRtg: 3.8
  };
  const clutchPerformers = [
    { name: 'Scottie Barnes', pts: 42, fg: '48.2%', badge: 'ðŸ”¥' },
    { name: 'Immanuel Quickley', pts: 35, fg: '44.5%', badge: 'ðŸŽ¯' },
    { name: 'RJ Barrett', pts: 28, fg: '41.8%', badge: 'ðŸ’ª' },
    { name: 'Gradey Dick', pts: 22, fg: '52.1%', badge: 'ðŸ§Š' },
    { name: 'Jakob Poeltl', pts: 18, fg: '62.5%', badge: 'ðŸ›¡ï¸' }
  ];
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Timer className="w-3 h-3 text-amber-400" /> Clutch Time
        </h3>
        <span className={`text-[9px] px-1.5 py-0.5 rounded font-bold ${clutchStats.record.w > clutchStats.record.l ? 'bg-green-500/20 text-green-400' : 'bg-red-500/20 text-red-400'}`}>
          {clutchStats.record.w > clutchStats.record.l ? 'CLOSERS' : 'CHOKERS'}
        </span>
      </div>
      
      <div className="text-center mb-3">
        <div className={`text-2xl font-black ${clutchStats.record.w > clutchStats.record.l ? 'text-green-400' : 'text-red-400'}`}>
          {clutchStats.record.w}-{clutchStats.record.l}
        </div>
        <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'} uppercase`}>Within 5 pts, Last 5 Min</div>
      </div>
      
      <div className="grid grid-cols-3 gap-1 mb-3">
        {[
          { label: 'PPG', val: clutchStats.ppg },
          { label: 'FG%', val: clutchStats.fgPct + '%' },
          { label: 'Net Rtg', val: '+' + clutchStats.netRtg }
        ].map((s, i) => (
          <div key={i} className={`text-center p-1.5 rounded ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`}>
            <div className={`text-xs font-black ${isDark ? 'text-white' : 'text-slate-800'}`}>{s.val}</div>
            <div className={`text-[8px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{s.label}</div>
          </div>
        ))}
      </div>
      
      <div className={`pt-2 border-t ${isDark ? 'border-cmd-border' : 'border-light-border'}`}>
        <div className={`text-[9px] font-bold ${isDark ? 'text-slate-400' : 'text-slate-500'} mb-1.5 uppercase`}>Top Clutch Performers</div>
        {clutchPerformers.map((p, i) => (
          <div key={i} className={`flex items-center justify-between py-1 ${i > 0 ? `border-t ${isDark ? 'border-slate-800' : 'border-slate-100'}` : ''}`}>
            <div className="flex items-center gap-1.5">
              <span className="text-[10px]">{p.badge}</span>
              <span className={`text-[10px] font-medium ${isDark ? 'text-slate-300' : 'text-slate-600'}`}>{p.name}</span>
            </div>
            <div className="flex items-center gap-2">
              <span className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{p.fg}</span>
              <span className={`text-[10px] font-bold ${isDark ? 'text-amber-400' : 'text-amber-500'}`}>{p.pts} pts</span>
            </div>
          </div>
        ))}
      </div>
    </div>
  );
};

// Advanced Stats Widget
const AdvancedStatsWidget = ({ isDark = true }) => {
  const stats = [
    { label: 'Off Rtg', key: 'offRtg', higher: true },
    { label: 'Def Rtg', key: 'defRtg', higher: false },
    { label: 'Net Rtg', key: 'netRtg', higher: true },
    { label: 'Pace', key: 'pace', higher: true },
    { label: 'eFG%', key: 'efgPct', higher: true },
    { label: 'TS%', key: 'tsPct', higher: true }
  ];
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <BarChart3 className="w-3 h-3 text-cyan-400" /> Advanced Analytics
        </h3>
        <span className="text-lg">ðŸ“Š</span>
      </div>
      
      <div className="space-y-2">
        {stats.map((s, i) => {
          const tor = ADVANCED_STATS.raptors[s.key];
          const avg = ADVANCED_STATS.leagueAvg[s.key];
          const better = s.higher ? tor >= avg : tor <= avg;
          const maxVal = Math.max(Math.abs(tor), Math.abs(avg)) * 1.2 || 1;
          const torWidth = s.key === 'netRtg' ? 50 + (tor / maxVal) * 40 : (tor / (avg * 1.3)) * 100;
          const avgWidth = s.key === 'netRtg' ? 50 + (avg / maxVal) * 40 : (avg / (avg * 1.3)) * 100;
          const rank = ADVANCED_STATS.rank[s.key];
          
          return (
            <div key={i}>
              <div className="flex justify-between items-center mb-0.5">
                <span className={`text-[9px] ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>{s.label}</span>
                <div className="flex items-center gap-2">
                  {rank && <span className={`text-[8px] ${isDark ? 'text-slate-600' : 'text-slate-400'}`}>#{rank}</span>}
                  <span className={`text-[10px] font-bold ${better ? 'text-green-400' : 'text-red-400'}`}>{tor}</span>
                </div>
              </div>
              <div className="relative h-2 rounded-full overflow-hidden" style={{background: isDark ? 'rgba(255,255,255,0.05)' : 'rgba(0,0,0,0.05)'}}>
                <div className={`absolute h-full rounded-full ${better ? 'bg-green-400/60' : 'bg-red-400/60'}`} style={{width: `${Math.min(Math.max(torWidth, 5), 100)}%`}} />
                <div className="absolute h-full w-0.5 bg-yellow-400/80" style={{left: `${Math.min(Math.max(avgWidth, 5), 100)}%`}} title={`League Avg: ${avg}`} />
              </div>
            </div>
          );
        })}
      </div>
      
      <div className={`mt-2 flex items-center gap-3 text-[8px] ${isDark ? 'text-slate-600' : 'text-slate-400'}`}>
        <span className="flex items-center gap-1"><span className="w-2 h-1 bg-green-400/60 rounded" /> TOR</span>
        <span className="flex items-center gap-1"><span className="w-0.5 h-2 bg-yellow-400/80" /> League Avg</span>
      </div>
    </div>
  );
};

// Schedule & Results Widget
const ScheduleResultsWidget = ({ isDark = true }) => {
  const [view, setView] = useState('upcoming');
  const diffColors = ['text-green-400', 'text-green-400', 'text-yellow-400', 'text-orange-400', 'text-red-400', 'text-red-400'];
  const diffLabels = ['', 'Easy', 'Easy', 'Medium', 'Hard', 'Elite'];
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Calendar className="w-3 h-3 text-blue-400" /> Schedule
        </h3>
        <div className="flex gap-1">
          {['upcoming', 'recent'].map(v => (
            <button key={v} onClick={() => setView(v)}
              className={`text-[9px] px-2 py-0.5 rounded font-bold ${view === v 
                ? 'bg-blue-500/20 text-blue-400' 
                : `${isDark ? 'text-slate-500' : 'text-slate-400'}`}`}>
              {v === 'upcoming' ? 'Next' : 'Last 5'}
            </button>
          ))}
        </div>
      </div>
      
      {view === 'upcoming' ? (
        <div className="space-y-1.5 max-h-[300px] overflow-y-auto custom-scrollbar">
          {SCHEDULE_DATA.upcoming.map((g, i) => (
            <div key={i} className={`flex items-center gap-2 p-1.5 rounded-lg ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`}>
              <div className="flex-1 min-w-0">
                <div className="flex items-center gap-1.5">
                  <span className={`text-[10px] font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{g.opponent}</span>
                  <span className={`text-[8px] px-1 py-0.5 rounded font-bold ${g.home ? 'bg-green-500/20 text-green-400' : 'bg-purple-500/20 text-purple-400'}`}>
                    {g.home ? 'HOME' : 'AWAY'}
                  </span>
                </div>
                <div className={`text-[8px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{g.date} Â· {g.time} Â· {g.tv}</div>
              </div>
              <div className="text-right">
                <div className={`text-[8px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{g.oppRecord}</div>
                <div className={`text-[8px] font-bold ${diffColors[g.difficulty]}`}>{diffLabels[g.difficulty]}</div>
              </div>
            </div>
          ))}
        </div>
      ) : (
        <div className="space-y-1.5">
          {SCHEDULE_DATA.recent.map((g, i) => (
            <div key={i} className={`flex items-center gap-2 p-1.5 rounded-lg ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`}>
              <span className={`text-xs font-black w-5 text-center ${g.result === 'W' ? 'text-green-400' : 'text-red-400'}`}>{g.result}</span>
              <div className="flex-1">
                <span className={`text-[10px] font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{g.opponent}</span>
                <span className={`text-[8px] ml-1.5 ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{g.home ? 'ðŸ ' : 'âœˆï¸'}</span>
              </div>
              <span className={`text-[10px] font-bold ${isDark ? 'text-slate-300' : 'text-slate-600'}`}>{g.score}</span>
              <span className={`text-[8px] ${isDark ? 'text-slate-600' : 'text-slate-400'}`}>{g.date}</span>
            </div>
          ))}
        </div>
      )}
    </div>
  );
};

// Draft Pick Tracker Widget
const DraftPickWidget = ({ isDark = true }) => {
  const pick = {
    currentPosition: 21,
    worstCase: 25,
    bestCase: 18,
    lottery: false,
    ownsPick: true,
    note: "2026 1st â€” projected late 1st round"
  };
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Award className="w-3 h-3 text-yellow-400" /> Draft Watch
        </h3>
        {pick.lottery && <span className="text-[9px] px-1.5 py-0.5 rounded bg-purple-500/20 text-purple-400">Lottery</span>}
      </div>
      
      <div className="text-center mb-3">
        <div className={`text-3xl font-black ${isDark ? 'text-white' : 'text-slate-800'}`}>#{pick.currentPosition}</div>
        <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'} uppercase`}>Current Position</div>
      </div>
      
      <div className={`flex justify-between text-[10px] ${isDark ? 'text-slate-300' : 'text-slate-600'}`}>
        <div className="text-center">
          <div className="text-green-400 font-bold">#{pick.bestCase}</div>
          <div className={isDark ? 'text-slate-500' : 'text-slate-400'}>Best</div>
        </div>
        <div className="text-center">
          <div className={`font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>#{pick.currentPosition}</div>
          <div className={isDark ? 'text-slate-500' : 'text-slate-400'}>Proj</div>
        </div>
        <div className="text-center">
          <div className="text-red-400 font-bold">#{pick.worstCase}</div>
          <div className={isDark ? 'text-slate-500' : 'text-slate-400'}>Worst</div>
        </div>
      </div>
    </div>
  );
};

// Quarter-by-Quarter Breakdown Widget
const QuarterBreakdownWidget = ({ isDark = true }) => {
  const quarters = {
    q1: { scored: 28.2, allowed: 27.5, diff: 0.7 },
    q2: { scored: 26.8, allowed: 28.1, diff: -1.3 },
    q3: { scored: 29.1, allowed: 27.9, diff: 1.2 },
    q4: { scored: 27.4, allowed: 28.0, diff: -0.6 }
  };
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <LayoutTemplate className="w-3 h-3 text-cyan-400" /> By Quarter
        </h3>
      </div>
      
      <div className="space-y-2">
        {Object.entries(quarters).map(([q, data]) => (
          <div key={q} className="flex items-center gap-2">
            <span className={`w-6 text-[10px] font-bold ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>{q.toUpperCase()}</span>
            <div className="flex-1 flex items-center gap-1">
              <div className={`flex-1 h-4 rounded-l ${isDark ? 'bg-cmd-bg' : 'bg-light-card'} flex items-center justify-end px-1`}>
                <span className="text-[9px] text-raptors-red font-bold">{data.scored.toFixed(1)}</span>
              </div>
              <div className={`flex-1 h-4 rounded-r ${isDark ? 'bg-cmd-bg' : 'bg-light-card'} flex items-center px-1`}>
                <span className="text-[9px] text-blue-400 font-bold">{data.allowed.toFixed(1)}</span>
              </div>
            </div>
            <span className={`w-8 text-right text-[9px] font-bold ${data.diff > 0 ? 'text-green-400' : 'text-red-400'}`}>
              {data.diff > 0 ? '+' : ''}{data.diff.toFixed(1)}
            </span>
          </div>
        ))}
      </div>
    </div>
  );
};

// Season Storylines Widget
const StorylinesWidget = ({ isDark = true }) => {
  const stories = [
    { icon: 'ðŸŒŸ', text: "Scottie Barnes All-Star snub controversy" },
    { icon: 'ðŸ“ˆ', text: "6-game win streak, longest since 2022" },
    { icon: 'ðŸ’”', text: "Pascal Siakam return game looming" },
    { icon: 'ðŸ”„', text: "Trade deadline buzz around Boucher" }
  ];
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <MessageSquare className="w-3 h-3 text-pink-400" /> Storylines
        </h3>
      </div>
      
      <div className="space-y-2">
        {stories.map((s, i) => (
          <div key={i} className={`flex items-start gap-2 text-[10px] ${isDark ? 'text-slate-300' : 'text-slate-600'}`}>
            <span>{s.icon}</span>
            <span>{s.text}</span>
          </div>
        ))}
      </div>
    </div>
  );
};

// Home/Away Splits Widget
const HomeAwaySplitsWidget = ({ isDark = true, nextGameHome }) => {
  const splits = {
    home: { w: 16, l: 12, ppg: 116.2, opp: 113.8 },
    away: { w: 9, l: 20, ppg: 108.4, opp: 115.2 }
  };
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Home className="w-3 h-3 text-teal-400" /> Home/Away
        </h3>
        <span className={`text-[9px] px-1.5 py-0.5 rounded ${nextGameHome ? 'bg-green-500/20 text-green-400' : 'bg-orange-500/20 text-orange-400'}`}>
          {nextGameHome ? 'HOME' : 'AWAY'}
        </span>
      </div>
      
      <div className="grid grid-cols-2 gap-2">
        <div className={`p-2 rounded-lg text-center ${nextGameHome ? 'ring-2 ring-green-500/50' : ''} ${isDark ? 'bg-green-500/10' : 'bg-green-500/5'}`}>
          <div className="text-xs font-bold text-green-400 mb-1">ðŸ  Home</div>
          <div className={`text-lg font-black ${isDark ? 'text-white' : 'text-slate-800'}`}>{splits.home.w}-{splits.home.l}</div>
          <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{splits.home.ppg} PPG</div>
        </div>
        <div className={`p-2 rounded-lg text-center ${!nextGameHome ? 'ring-2 ring-orange-500/50' : ''} ${isDark ? 'bg-orange-500/10' : 'bg-orange-500/5'}`}>
          <div className="text-xs font-bold text-orange-400 mb-1">âœˆï¸ Away</div>
          <div className={`text-lg font-black ${isDark ? 'text-white' : 'text-slate-800'}`}>{splits.away.w}-{splits.away.l}</div>
          <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{splits.away.ppg} PPG</div>
        </div>
      </div>
    </div>
  );
};

// Win Streak Probability Widget  
const StreakProbabilityWidget = ({ isDark = true, streak }) => {
  const extendProb = 62; // Based on opponent strength
  const breakProb = 100 - extendProb;
  
  if (streak <= 0) return null;
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Flame className="w-3 h-3 text-orange-400" /> Streak Odds
        </h3>
        <span className="text-lg">ðŸ”¥</span>
      </div>
      
      <div className="text-center mb-3">
        <div className={`text-sm ${isDark ? 'text-slate-300' : 'text-slate-600'}`}>Can they extend the</div>
        <div className={`text-2xl font-black text-orange-400`}>{streak}-Game Win Streak?</div>
      </div>
      
      <div className="flex gap-2 mb-2">
        <div className="flex-1 text-center">
          <div className={`text-2xl font-black ${extendProb > 50 ? 'text-green-400' : 'text-slate-400'}`}>{extendProb}%</div>
          <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'} uppercase`}>Extend</div>
        </div>
        <div className="flex-1 text-center">
          <div className={`text-2xl font-black ${breakProb > 50 ? 'text-red-400' : 'text-slate-400'}`}>{breakProb}%</div>
          <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'} uppercase`}>End</div>
        </div>
      </div>
      
      <div className={`h-2 rounded-full overflow-hidden ${isDark ? 'bg-cmd-border' : 'bg-light-border'}`}>
        <div className="h-full bg-gradient-to-r from-green-500 to-green-400" style={{width: `${extendProb}%`}} />
      </div>
    </div>
  );
};

// Coach Insights Widget
const CoachInsightsWidget = ({ isDark = true }) => {
  const insights = [
    { label: 'Timeout Usage', value: 'Conservative', icon: 'â¸ï¸' },
    { label: 'Challenge Rate', value: '72% success', icon: 'ðŸŽ¯' },
    { label: 'Late Game Plays', value: 'Barnes Iso', icon: 'ðŸ€' },
    { label: 'Zone Defense', value: 'Rare (8%)', icon: 'ðŸ›¡ï¸' }
  ];
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Brain className="w-3 h-3 text-violet-400" /> Coach Tendencies
        </h3>
      </div>
      
      <div className={`text-center mb-3 p-2 rounded-lg ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`}>
        <div className={`text-sm font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>Darko RajakoviÄ‡</div>
        <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>2nd Season â€¢ Development Focus</div>
      </div>
      
      <div className="space-y-2">
        {insights.map((i, idx) => (
          <div key={idx} className="flex items-center justify-between text-[10px]">
            <span className="flex items-center gap-1">
              <span>{i.icon}</span>
              <span className={isDark ? 'text-slate-400' : 'text-slate-500'}>{i.label}</span>
            </span>
            <span className={`font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{i.value}</span>
          </div>
        ))}
      </div>
    </div>
  );
};

// Live Viewers Widget
const LiveViewersWidget = ({ isDark = true }) => {
  const [viewers, setViewers] = useState(LIVE_VIEWERS);
  
  useEffect(() => {
    const interval = setInterval(() => {
      setViewers(prev => prev + Math.floor(Math.random() * 10) - 3);
    }, 5000);
    return () => clearInterval(interval);
  }, []);

  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-3`}>
      <div className="flex items-center justify-center gap-2">
        <div className="w-2 h-2 rounded-full bg-red-500 animate-pulse" />
        <span className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{viewers}</span>
        <span className={`text-[10px] ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>fans viewing</span>
      </div>
    </div>
  );
};

// Betting Hub Widget - Main Container
// ===== LIVE ODDS API INTEGRATION =====
const ODDS_API_BASE = 'https://api.the-odds-api.com/v4';
const ODDS_API_SPORT = 'basketball_nba';
const ODDS_API_BOOKMAKERS = ['draftkings', 'fanduel', 'betmgm', 'bet365'];
const BOOKMAKER_LABELS = { draftkings: 'DraftKings', fanduel: 'FanDuel', betmgm: 'BetMGM', 'bet365': 'bet365' };

const useOddsApi = (teamName = 'Toronto Raptors') => {
  const [liveOdds, setLiveOdds] = React.useState(null);
  const [loading, setLoading] = React.useState(false);
  const [error, setError] = React.useState(null);
  const [lastFetch, setLastFetch] = React.useState(null);
  const [remaining, setRemaining] = React.useState(null);

  const apiKey = React.useMemo(() => atob('NjAwM2I1NmE1NWY5ODVhN2Y5ODIyMDQ1NTEwYzllN2Q='), []);

  const fetchOdds = React.useCallback(async () => {
    const key = atob('NjAwM2I1NmE1NWY5ODVhN2Y5ODIyMDQ1NTEwYzllN2Q=');
    setLoading(true);
    setError(null);
    try {
      const url = `${ODDS_API_BASE}/sports/${ODDS_API_SPORT}/odds/?apiKey=${key}&regions=us&markets=h2h,spreads,totals&oddsFormat=american&bookmakers=${ODDS_API_BOOKMAKERS.join(',')}`;
      const res = await fetch(url);
      if (res.status === 401) { setError('Odds API monthly quota reached â€” lines refresh next billing cycle'); setLoading(false); return; }
      if (!res.ok) throw new Error(`API error ${res.status}`);
      setRemaining(res.headers.get('x-requests-remaining'));
      const data = await res.json();
      // Find Raptors game(s)
      const raptorsGames = data.filter(g => g.home_team === teamName || g.away_team === teamName);
      if (raptorsGames.length === 0) { setError('Lines not yet posted â€” odds typically appear 1-2 days before tip-off'); setLoading(false); return; }
      const game = raptorsGames[0];
      const isHome = game.home_team === teamName;
      const opponent = isHome ? game.away_team : game.home_team;

      // Parse bookmaker odds into our format
      const books = {};
      game.bookmakers.forEach(bk => {
        const label = BOOKMAKER_LABELS[bk.key] || bk.title;
        const h2h = bk.markets.find(m => m.key === 'h2h');
        const spreads = bk.markets.find(m => m.key === 'spreads');
        const totals = bk.markets.find(m => m.key === 'totals');
        const torH2H = h2h?.outcomes?.find(o => o.name === teamName);
        const oppH2H = h2h?.outcomes?.find(o => o.name !== teamName);
        const torSpread = spreads?.outcomes?.find(o => o.name === teamName);
        const torTotal = totals?.outcomes?.find(o => o.name === 'Over');
        const torTotalU = totals?.outcomes?.find(o => o.name === 'Under');
        books[label] = {
          spread: { line: torSpread?.point || 0, vig: torSpread?.price || -110 },
          ml: { raptors: torH2H?.price || 0, opp: oppH2H?.price || 0 },
          ou: { line: torTotal?.point || 0, overVig: torTotal?.price || -110, underVig: torTotalU?.price || -110 },
          updated: new Date(bk.last_update).toLocaleTimeString([], { hour: 'numeric', minute: '2-digit' })
        };
      });

      // Update BETTING_INTEL.odds in place
      BETTING_INTEL.odds.books = books;
      BETTING_INTEL.odds.opponent = opponent.split(' ').pop().substring(0,3).toUpperCase();
      BETTING_INTEL.odds.gameTime = game.commence_time;
      BETTING_INTEL.odds._live = true;
      BETTING_INTEL.odds._gameId = game.id;

      setLiveOdds({ books, opponent, gameTime: game.commence_time, gameId: game.id });
      setLastFetch(new Date());
    } catch (e) {
      setError(e.message);
    }
    setLoading(false);
  }, [teamName]);

  // Auto-fetch on mount, then every 5 min
  React.useEffect(() => {
    fetchOdds();
    const interval = setInterval(() => {
      fetchOdds();
    }, 5 * 60 * 1000);
    return () => clearInterval(interval);
  }, [fetchOdds]);

  return { liveOdds, loading, error, lastFetch, remaining, fetchOdds };
};

// API key embedded (obfuscated)

const BettingHubWidget = ({ isDark = true, game }) => {
  const { liveOdds, loading, error, lastFetch, remaining, fetchOdds } = useOddsApi();
  const bookCount = Object.keys(BETTING_INTEL.odds.books).length;
  const isLive = BETTING_INTEL.odds._live;

  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-sm font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Target className="w-4 h-4 text-emerald-400" /> Betting Intelligence Hub
        </h3>
        <div className="flex items-center gap-2">
          {isLive && (
            <span className="flex items-center gap-1 text-[9px] text-emerald-400">
              <span className="w-1.5 h-1.5 bg-emerald-400 rounded-full animate-pulse" /> LIVE
            </span>
          )}
          {loading && <span className="text-[9px] text-amber-400 animate-pulse">Fetching...</span>}
          <span className={`text-[9px] px-2 py-0.5 rounded-full ${isDark ? 'bg-emerald-500/20 text-emerald-400' : 'bg-emerald-50 text-emerald-600'} font-bold`}>
            {bookCount} Books
          </span>
        </div>
      </div>
      {lastFetch && (
        <div className={`flex items-center justify-between text-[9px] mb-2 ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>
          <span>Updated: {lastFetch.toLocaleTimeString()}</span>
          <div className="flex items-center gap-2">
            {remaining && <span>Credits: {remaining}</span>}
            <button onClick={fetchOdds} aria-label="Refresh betting odds" className="text-emerald-400 hover:text-emerald-300 underline">Refresh</button>
          </div>
        </div>
      )}
      {error && !isLive && !error.includes('not yet posted') && (
        <div className={`text-[9px] mb-2 px-2 py-1 rounded ${isDark ? 'bg-amber-500/10 text-amber-400' : 'bg-amber-50 text-amber-600'}`}>
          â³ {error}
        </div>
      )}
      <LiveOddsTickerWidget isDark={isDark} />
      <div className="space-y-2">
        <BettingSection title="Model Prediction" icon={<Target className="w-3 h-3 text-emerald-400" />} isDark={isDark} defaultOpen={true}>
          <BettingModelWidget isDark={isDark} />
        </BettingSection>
        <BettingSection title="Odds Comparison" icon={<BarChart2 className="w-3 h-3 text-blue-400" />} isDark={isDark} defaultOpen={true}>
          <OddsComparisonWidget isDark={isDark} />
        </BettingSection>
        <BettingSection title="Sharp Money Tracker" icon={<DollarSign className="w-3 h-3 text-green-400" />} isDark={isDark} defaultOpen={false}>
          <SharpMoneyWidget isDark={isDark} />
        </BettingSection>
        <BettingSection title="ATS Trends" icon={<TrendingUp className="w-3 h-3 text-raptors-red" />} isDark={isDark} defaultOpen={false}>
          <ATSTrendsWidget isDark={isDark} />
        </BettingSection>
        <BettingSection title="Over/Under Trends" icon={<Activity className="w-3 h-3 text-amber-400" />} isDark={isDark} defaultOpen={false}>
          <OverUnderTrendsWidget isDark={isDark} />
        </BettingSection>
        <BettingSection title="Player Props" icon={<Users className="w-3 h-3 text-purple-400" />} isDark={isDark} defaultOpen={false}>
          <PlayerPropsInsightWidget isDark={isDark} />
        </BettingSection>
        <BettingSection title="Prop Builder" icon={<Sliders className="w-3 h-3 text-cyan-400" />} isDark={isDark} defaultOpen={false}>
          <PropBuilderWidget isDark={isDark} />
        </BettingSection>
        <BettingSection title="Situational Angles" icon={<Compass className="w-3 h-3 text-orange-400" />} isDark={isDark} defaultOpen={false}>
          <SituationalAnglesWidget isDark={isDark} />
        </BettingSection>
      </div>
    </div>
  );
};

// Playoff Picture Widget
const PlayoffPictureWidget = ({ isDark = true }) => {
  const eastStandings = [
    { seed: 1, team: 'Cavaliers', record: '40-14', gb: 0 },
    { seed: 2, team: 'Celtics', record: '37-17', gb: 3 },
    { seed: 3, team: 'Knicks', record: '35-19', gb: 5 },
    { seed: 4, team: 'Bucks', record: '33-21', gb: 7 },
    { seed: 5, team: 'Pacers', record: '33-22', gb: 7.5 },
    { seed: 6, team: 'Raptors', record: '32-22', gb: 8, highlight: true },
    { seed: 7, team: 'Magic', record: '31-23', gb: 9 },
    { seed: 8, team: 'Hawks', record: '29-25', gb: 11 },
    { seed: 9, team: '76ers', record: '27-27', gb: 13 },
    { seed: 10, team: 'Heat', record: '26-28', gb: 14 },
  ];
  const raptors = eastStandings.find(t => t.highlight);
  const gamesPlayed = 54;
  const gamesRemaining = 82 - gamesPlayed;
  const wins = 32;
  const magicNumber = Math.max(1, gamesRemaining - (wins - 26) + 1);
  const matchupOpp = eastStandings.find(t => t.seed === 3);

  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Trophy className="w-3 h-3 text-amber-400" /> Playoff Picture
        </h3>
        <span className="text-[9px] px-1.5 py-0.5 rounded bg-green-500/20 text-green-400 font-bold">IN â€” 6th</span>
      </div>

      <div className="grid grid-cols-3 gap-2 text-center mb-3">
        <div className={`p-2 rounded-lg ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`}>
          <div className={`text-xl font-black text-green-400`}>6th</div>
          <div className={`text-[8px] ${isDark ? 'text-slate-500' : 'text-slate-400'} uppercase`}>East Seed</div>
        </div>
        <div className={`p-2 rounded-lg ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`}>
          <div className="text-xl font-black text-purple-400">{magicNumber}</div>
          <div className={`text-[8px] ${isDark ? 'text-slate-500' : 'text-slate-400'} uppercase`}>Magic #</div>
        </div>
        <div className={`p-2 rounded-lg ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`}>
          <div className="text-xl font-black text-orange-400">{gamesRemaining}</div>
          <div className={`text-[8px] ${isDark ? 'text-slate-500' : 'text-slate-400'} uppercase`}>Games Left</div>
        </div>
      </div>

      {/* If season ended today */}
      <div className={`p-2.5 rounded-lg mb-3 ${isDark ? 'bg-gradient-to-r from-raptors-red/10 to-purple-900/20 border border-raptors-red/20' : 'bg-red-50 border border-red-100'}`}>
        <div className={`text-[9px] font-bold uppercase mb-1 ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>ðŸ† If Season Ended Today</div>
        <div className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>
          (6) Raptors vs (3) {matchupOpp.team}
        </div>
        <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>First Round â€” Best of 7</div>
      </div>

      {/* Mini standings */}
      <div className={`text-[9px] font-bold uppercase mb-1.5 ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>East Standings Nearby</div>
      <div className="space-y-1">
        {eastStandings.filter(t => t.seed >= 4 && t.seed <= 8).map(t => (
          <div key={t.seed} className={`flex items-center gap-2 px-2 py-1 rounded ${t.highlight ? (isDark ? 'bg-raptors-red/15 border border-raptors-red/30' : 'bg-red-50 border border-red-200') : ''}`}>
            <span className={`text-[10px] font-bold w-3 ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{t.seed}</span>
            <span className={`text-[10px] font-semibold flex-1 ${t.highlight ? 'text-raptors-red' : (isDark ? 'text-slate-300' : 'text-slate-600')}`}>{t.team}</span>
            <span className={`text-[10px] ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>{t.record}</span>
          </div>
        ))}
      </div>

      {/* Tiebreaker note */}
      <div className={`mt-2.5 p-2 rounded-lg ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`}>
        <div className={`text-[9px] font-bold uppercase mb-1 ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>âš–ï¸ Tiebreaker Scenarios</div>
        <div className={`text-[9px] leading-relaxed ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>
          â€¢ TOR holds tiebreaker vs IND (3-1 season series)<br/>
          â€¢ ORL holds tiebreaker vs TOR (2-1, 1 game left)<br/>
          â€¢ TOR/MIL split â€” division record is tiebreaker
        </div>
      </div>
    </div>
  );
};

// ============ TEAM LEADERS WIDGET ============
const TeamLeadersWidget = ({ isDark = true }) => {
  const categories = [
    { label: 'PPG', key: 'ppg', color: '#CE1141' },
    { label: 'RPG', key: 'rpg', color: '#3E2680' },
    { label: 'APG', key: 'apg', color: '#22c55e' },
    { label: 'SPG', key: 'spg', color: '#f59e0b' },
    { label: 'BPG', key: 'bpg', color: '#6366f1' },
    { label: '3P%', key: 'threePtPct', color: '#06b6d4' },
  ];

  const leaders = categories.map(cat => {
    const sorted = [...RAPTORS_ROSTER].filter(p => p.seasonStats && p.seasonStats[cat.key] > 0).sort((a, b) => b.seasonStats[cat.key] - a.seasonStats[cat.key]);
    const top3 = sorted.slice(0, 3);
    const maxVal = top3[0]?.seasonStats[cat.key] || 1;
    return { ...cat, players: top3, max: maxVal };
  });

  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center gap-2 mb-3">
        <BarChart3 className="w-3.5 h-3.5 text-raptors-red" />
        <h3 className={`text-xs font-bold uppercase ${isDark ? 'text-white' : 'text-slate-800'}`}>Team Leaders</h3>
      </div>
      <div className="space-y-3">
        {leaders.map((cat, ci) => (
          <div key={ci}>
            <div className={`text-[9px] font-bold uppercase mb-1 ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>{cat.label}</div>
            <div className="space-y-1">
              {cat.players.map((p, pi) => (
                <div key={pi} className="flex items-center gap-2">
                  <span className={`text-[9px] w-3 font-bold ${pi === 0 ? 'text-amber-400' : isDark ? 'text-slate-500' : 'text-slate-400'}`}>{pi + 1}</span>
                  <span className={`text-[10px] font-medium w-20 truncate ${isDark ? 'text-slate-300' : 'text-slate-600'}`}>{p.name.split(' ').pop()}</span>
                  <div className="flex-1 h-2.5 rounded-full overflow-hidden" style={{background: isDark ? 'rgba(30,41,59,0.8)' : '#e2e8f0'}}>
                    <div className="h-full rounded-full progress-fill" style={{width: `${(p.seasonStats[cat.key] / cat.max) * 100}%`, background: cat.color, opacity: 1 - pi * 0.25}}></div>
                  </div>
                  <span className={`text-[10px] font-bold w-8 text-right ${pi === 0 ? 'text-white' : isDark ? 'text-slate-400' : 'text-slate-500'}`}>{p.seasonStats[cat.key]}</span>
                </div>
              ))}
            </div>
          </div>
        ))}
      </div>
    </div>
  );
};

// ============ SALARY CAP WIDGET ============
const SalaryCapWidget = ({ isDark = true }) => {
  const capData = {
    salaryCap: 140,
    luxuryTax: 170,
    totalSalary: 152.3,
    topContracts: [
      { name: 'Scottie Barnes', salary: 35.6, years: '4yr' },
      { name: 'RJ Barrett', salary: 25.3, years: '3yr' },
      { name: 'Immanuel Quickley', salary: 18.9, years: '4yr' },
      { name: 'Jakob Poeltl', salary: 16.0, years: '2yr' },
      { name: 'Chris Paul', salary: 16.4, years: 'Exp' },
    ]
  };
  const capUsedPct = (capData.totalSalary / capData.luxuryTax) * 100;
  const capLinePct = (capData.salaryCap / capData.luxuryTax) * 100;
  const overCap = capData.totalSalary - capData.salaryCap;
  const underTax = capData.luxuryTax - capData.totalSalary;

  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <DollarSign className="w-3.5 h-3.5 text-green-400" /> Salary Cap
        </h3>
        <span className={`text-[9px] px-1.5 py-0.5 rounded font-bold ${underTax > 0 ? 'bg-green-500/20 text-green-400' : 'bg-red-500/20 text-red-400'}`}>
          {underTax > 0 ? `$${underTax.toFixed(1)}M under tax` : 'IN TAX'}
        </span>
      </div>

      {/* Visual bar */}
      <div className="relative mb-3">
        <div className={`h-5 rounded-full overflow-hidden ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`}>
          <div className="h-full rounded-full bg-gradient-to-r from-green-500 via-yellow-500 to-red-500 progress-fill" style={{width: `${Math.min(capUsedPct, 100)}%`}}></div>
        </div>
        {/* Cap line marker */}
        <div className="absolute top-0 h-5 border-l-2 border-dashed border-white/50" style={{left: `${capLinePct}%`}}>
          <span className={`absolute -top-4 -translate-x-1/2 text-[7px] font-bold ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>CAP</span>
        </div>
        <div className="absolute top-0 right-0 h-5 border-l-2 border-dashed border-red-400/50">
          <span className={`absolute -top-4 -translate-x-1/2 text-[7px] font-bold text-red-400`}>TAX</span>
        </div>
      </div>

      <div className="grid grid-cols-3 gap-2 text-center mb-3">
        <div className={`p-1.5 rounded-lg ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`}>
          <div className={`text-sm font-black ${isDark ? 'text-white' : 'text-slate-800'}`}>${capData.totalSalary}M</div>
          <div className={`text-[7px] ${isDark ? 'text-slate-500' : 'text-slate-400'} uppercase`}>Total</div>
        </div>
        <div className={`p-1.5 rounded-lg ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`}>
          <div className="text-sm font-black text-orange-400">+${overCap.toFixed(1)}M</div>
          <div className={`text-[7px] ${isDark ? 'text-slate-500' : 'text-slate-400'} uppercase`}>Over Cap</div>
        </div>
        <div className={`p-1.5 rounded-lg ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`}>
          <div className="text-sm font-black text-green-400">${underTax.toFixed(1)}M</div>
          <div className={`text-[7px] ${isDark ? 'text-slate-500' : 'text-slate-400'} uppercase`}>Tax Room</div>
        </div>
      </div>

      <div className={`text-[9px] font-bold uppercase mb-1.5 ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>Top 5 Contracts</div>
      <div className="space-y-1.5">
        {capData.topContracts.map((c, i) => (
          <div key={i} className="flex items-center gap-2">
            <span className={`text-[10px] font-medium flex-1 truncate ${isDark ? 'text-slate-300' : 'text-slate-600'}`}>{c.name}</span>
            <span className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{c.years}</span>
            <span className={`text-[10px] font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>${c.salary}M</span>
          </div>
        ))}
      </div>
    </div>
  );
};

// ============ FRANCHISE HISTORY WIDGET ============
const FranchiseHistoryWidget = ({ isDark = true }) => {
  const milestones = [
    { year: '1995', event: 'Franchise Founded', icon: 'ðŸ¦–', detail: 'Expansion team begins play' },
    { year: '2001', event: 'First Division Title', icon: 'ðŸ†', detail: 'Vince Carter era peak' },
    { year: '2014', event: 'Atlantic Division Champs', icon: 'ðŸ¥‡', detail: 'Lowry-DeRozan era begins' },
    { year: '2019', event: 'NBA CHAMPIONS', icon: 'ðŸ’', detail: 'Kawhi Leonard\'s historic run' },
    { year: '2020', event: 'Bubble Season in Tampa', icon: 'ðŸ«§', detail: '53-19 regular season' },
  ];
  const retiredJerseys = [
    { number: '10', name: 'DeMar DeRozan' },
    { number: '7', name: 'Kyle Lowry' },
    { number: '15', name: 'Vince Carter' },
  ];
  const allStars = [
    'Vince Carter', 'Chris Bosh', 'Kyle Lowry', 'DeMar DeRozan',
    'Pascal Siakam', 'Scottie Barnes', 'Fred VanVleet'
  ];

  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center gap-2 mb-3">
        <Award className="w-3.5 h-3.5 text-amber-400" />
        <h3 className={`text-xs font-bold uppercase ${isDark ? 'text-white' : 'text-slate-800'}`}>Franchise History</h3>
      </div>

      {/* Timeline */}
      <div className="relative pl-4 mb-3 space-y-2">
        <div className={`absolute left-1.5 top-1 bottom-1 w-px ${isDark ? 'bg-slate-700' : 'bg-slate-200'}`}></div>
        {milestones.map((m, i) => (
          <div key={i} className="relative flex items-start gap-2">
            <div className="absolute -left-2.5 top-0.5 w-2 h-2 rounded-full bg-raptors-red ring-2 ring-offset-1" style={{ringColor: isDark ? '#0a0e17' : '#f8fafc'}}></div>
            <div className="flex-1 ml-1">
              <div className="flex items-center gap-1.5">
                <span className="text-[9px]">{m.icon}</span>
                <span className={`text-[10px] font-bold ${m.year === '2019' ? 'text-amber-400' : isDark ? 'text-white' : 'text-slate-800'}`}>{m.year}</span>
                <span className={`text-[10px] font-semibold ${m.year === '2019' ? 'text-amber-400' : isDark ? 'text-slate-300' : 'text-slate-600'}`}>{m.event}</span>
              </div>
              <div className={`text-[8px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{m.detail}</div>
            </div>
          </div>
        ))}
      </div>

      {/* Retired jerseys */}
      <div className={`p-2.5 rounded-lg mb-2.5 ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`}>
        <div className={`text-[9px] font-bold uppercase mb-1.5 ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>ðŸ‘• Retired Jerseys</div>
        <div className="flex gap-3 justify-center">
          {retiredJerseys.map((j, i) => (
            <div key={i} className="text-center">
              <div className="w-8 h-10 rounded-md bg-gradient-to-b from-raptors-red to-raptors-red/70 flex items-center justify-center mb-0.5">
                <span className="text-white text-xs font-black">#{j.number}</span>
              </div>
              <div className={`text-[8px] font-medium ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>{j.name.split(' ').pop()}</div>
            </div>
          ))}
        </div>
      </div>

      {/* All-Stars */}
      <div className={`text-[9px] font-bold uppercase mb-1 ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>â­ All-Star Raptors ({allStars.length})</div>
      <div className="flex flex-wrap gap-1">
        {allStars.map((name, i) => (
          <span key={i} className={`text-[9px] px-1.5 py-0.5 rounded-full ${isDark ? 'bg-amber-400/10 text-amber-400' : 'bg-amber-50 text-amber-600'}`}>{name}</span>
        ))}
      </div>
    </div>
  );
};

// Season Grades Widget
const SeasonGradesWidget = ({ isDark = true }) => {
  const grades = [
    { category: 'Offense', grade: 'B+', color: 'text-green-400' },
    { category: 'Defense', grade: 'B-', color: 'text-yellow-400' },
    { category: 'Clutch', grade: 'A-', color: 'text-green-400' },
    { category: 'Development', grade: 'A', color: 'text-emerald-400' }
  ];
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Award className="w-3 h-3 text-amber-400" /> Season Grades
        </h3>
      </div>
      
      <div className="grid grid-cols-2 gap-2">
        {grades.map((g, i) => (
          <div key={i} className={`p-2 rounded-lg text-center ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`}>
            <div className={`text-xl font-black ${g.color}`}>{g.grade}</div>
            <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{g.category}</div>
          </div>
        ))}
      </div>
    </div>
  );
};

// Schedule Strength Widget
const ScheduleStrengthWidget = ({ isDark = true }) => {
  const strength = {
    remaining: 0.485,
    rank: 22,
    toughGames: 8,
    easyGames: 17
  };
  
  const difficultyColor = strength.remaining < 0.5 ? 'text-green-400' : 'text-red-400';
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Swords className="w-3 h-3 text-red-400" /> Schedule Strength
        </h3>
        <span className={`text-[9px] ${difficultyColor}`}>#{strength.rank}</span>
      </div>
      
      <div className="text-center mb-3">
        <div className={`text-2xl font-black ${difficultyColor}`}>{(strength.remaining * 100).toFixed(1)}%</div>
        <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'} uppercase`}>Remaining SOS</div>
      </div>
      
      <div className={`grid grid-cols-2 gap-2 text-[10px] ${isDark ? 'text-slate-300' : 'text-slate-600'}`}>
        <div className="flex justify-between">
          <span>Tough Games</span>
          <span className="font-bold text-red-400">{strength.toughGames}</span>
        </div>
        <div className="flex justify-between">
          <span>Easy Games</span>
          <span className="font-bold text-green-400">{strength.easyGames}</span>
        </div>
      </div>
    </div>
  );
};

// Player Milestones Widget
const MilestonesWidget = ({ isDark = true }) => {
  const milestones = [
    { player: 'Scottie', milestone: '5,000 career pts', progress: 4850, target: 5000 },
    { player: 'RJ', milestone: '1,000 career AST', progress: 982, target: 1000 }
  ];
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Star className="w-3 h-3 text-yellow-400" /> Milestones
        </h3>
      </div>
      
      <div className="space-y-3">
        {milestones.map((m, i) => {
          const pct = (m.progress / m.target) * 100;
          const remaining = m.target - m.progress;
          return (
            <div key={i}>
              <div className="flex justify-between text-[10px] mb-1">
                <span className={`font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{m.player}</span>
                <span className={isDark ? 'text-slate-400' : 'text-slate-500'}>{remaining} to go</span>
              </div>
              <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'} mb-1`}>{m.milestone}</div>
              <div className={`h-2 rounded-full overflow-hidden ${isDark ? 'bg-cmd-border' : 'bg-light-border'}`}>
                <div 
                  className="h-full bg-gradient-to-r from-yellow-500 to-amber-400 rounded-full"
                  style={{width: `${pct}%`}}
                />
              </div>
            </div>
          );
        })}
      </div>
    </div>
  );
};

// Division Rivals Widget
const DivisionRivalsWidget = ({ isDark = true }) => {
  const atlantic = [
    { team: 'Celtics', record: '0-2', emoji: 'â˜˜ï¸' },
    { team: '76ers', record: '1-1', emoji: 'ðŸ””' },
    { team: 'Nets', record: '2-1', emoji: 'ðŸŒ' },
    { team: 'Knicks', record: '1-2', emoji: 'ðŸ—½' }
  ];
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Swords className="w-3 h-3 text-blue-400" /> Atlantic Division
        </h3>
      </div>
      
      <div className="space-y-2">
        {atlantic.map((r, i) => (
          <div key={i} className="flex items-center justify-between text-[10px]">
            <span className="flex items-center gap-1">
              <span>{r.emoji}</span>
              <span className={isDark ? 'text-slate-300' : 'text-slate-600'}>{r.team}</span>
            </span>
            <span className={`font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{r.record}</span>
          </div>
        ))}
      </div>
    </div>
  );
};

// Signature Wins Widget
const SignatureWinsWidget = ({ isDark = true }) => {
  const wins = [
    { vs: 'Thunder', date: 'Jan 12', score: '118-115', note: 'SGA held to 22' },
    { vs: 'Bucks', date: 'Jan 28', score: '121-108', note: 'Scottie 35pts' },
    { vs: 'Celtics', date: 'Feb 2', score: '112-105', note: 'Road upset' }
  ];
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Trophy className="w-3 h-3 text-yellow-400" /> Signature Wins
        </h3>
      </div>
      
      <div className="space-y-2">
        {wins.map((w, i) => (
          <div key={i} className={`p-2 rounded-lg ${isDark ? 'bg-green-500/10' : 'bg-green-500/5'}`}>
            <div className="flex justify-between items-center">
              <span className={`text-[10px] font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>vs {w.vs}</span>
              <span className="text-[10px] text-green-400 font-bold">{w.score}</span>
            </div>
            <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{w.date} â€¢ {w.note}</div>
          </div>
        ))}
      </div>
    </div>
  );
};

// TV Schedule Widget
const TVScheduleWidget = ({ isDark = true, game }) => {
  if (!game || game.status !== 'upcoming') return null;
  
  const broadcast = {
    canadian: ['TSN', 'TSN 4'],
    us: game.opponent === 'Bulls' ? ['NBA TV'] : [],
    streaming: ['NBA League Pass']
  };
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Radio className="w-3 h-3 text-blue-400" /> Where to Watch
        </h3>
      </div>
      
      <div className="space-y-2 text-[10px]">
        {broadcast.canadian.length > 0 && (
          <div className="flex items-center gap-2">
            <span className={isDark ? 'text-slate-400' : 'text-slate-500'}>ðŸ‡¨ðŸ‡¦</span>
            <span className={`font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{broadcast.canadian.join(', ')}</span>
          </div>
        )}
        {broadcast.us.length > 0 && (
          <div className="flex items-center gap-2">
            <span className={isDark ? 'text-slate-400' : 'text-slate-500'}>ðŸ‡ºðŸ‡¸</span>
            <span className={`font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{broadcast.us.join(', ')}</span>
          </div>
        )}
        <div className="flex items-center gap-2">
          <span className={isDark ? 'text-slate-400' : 'text-slate-500'}>ðŸ“±</span>
          <span className={`font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{broadcast.streaming.join(', ')}</span>
        </div>
      </div>
    </div>
  );
};

// Game Day Checklist Widget
const GameDayChecklistWidget = ({ isDark = true, game }) => {
  const [checked, setChecked] = useState({});
  
  if (!game || game.status !== 'upcoming') return null;
  
  const items = [
    { id: 'jersey', label: 'Wear Raptors gear', emoji: 'ðŸ‘•' },
    { id: 'snacks', label: 'Stock up on snacks', emoji: 'ðŸ¿' },
    { id: 'friends', label: 'Text the group chat', emoji: 'ðŸ“±' },
    { id: 'predictions', label: 'Make your predictions', emoji: 'ðŸŽ¯' }
  ];
  
  const toggle = (id) => setChecked(prev => ({ ...prev, [id]: !prev[id] }));
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <LayoutTemplate className="w-3 h-3 text-green-400" /> Game Day Checklist
        </h3>
      </div>
      
      <div className="space-y-2">
        {items.map((item) => (
          <button
            key={item.id}
            onClick={() => toggle(item.id)}
            className={`w-full flex items-center gap-2 p-2 rounded-lg text-[10px] transition-all ${
              checked[item.id] 
                ? `${isDark ? 'bg-green-500/20' : 'bg-green-500/10'} line-through opacity-60` 
                : `${isDark ? 'bg-cmd-bg hover:bg-cmd-card' : 'bg-light-card hover:bg-slate-200'}`
            }`}
          >
            <span>{checked[item.id] ? 'âœ…' : item.emoji}</span>
            <span className={isDark ? 'text-slate-300' : 'text-slate-600'}>{item.label}</span>
          </button>
        ))}
      </div>
    </div>
  );
};

// Social Buzz Widget
const SocialBuzzWidget = ({ isDark = true }) => {
  const tweets = [
    { user: '@RaptorsFan416', text: "Scottie is HIM! ðŸ”¥", likes: 234 },
    { user: '@NorthSideBall', text: "Barnes for All-Star next year ðŸ’¯", likes: 189 },
    { user: '@WeTheNorthCrew', text: "6 game streak LFG! ðŸ¦–", likes: 156 }
  ];
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Twitter className="w-3 h-3 text-blue-400" /> Fan Buzz
        </h3>
      </div>
      
      <div className="space-y-2">
        {tweets.map((t, i) => (
          <div key={i} className={`p-2 rounded-lg ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`}>
            <div className={`text-[9px] font-bold text-blue-400 mb-1`}>{t.user}</div>
            <div className={`text-[10px] ${isDark ? 'text-slate-300' : 'text-slate-600'} mb-1`}>{t.text}</div>
            <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>â¤ï¸ {t.likes}</div>
          </div>
        ))}
      </div>
    </div>
  );
};

// Team Chemistry Widget
const TeamChemistryWidget = ({ isDark = true }) => {
  const chemistry = {
    overall: 78,
    offense: 82,
    defense: 74,
    communication: 80,
    momentum: 85
  };
  
  const ChemBar = ({ label, value }) => (
    <div className="space-y-1">
      <div className="flex justify-between text-[10px]">
        <span className={isDark ? 'text-slate-400' : 'text-slate-500'}>{label}</span>
        <span className={`font-bold ${value >= 80 ? 'text-green-400' : value >= 60 ? 'text-yellow-400' : 'text-red-400'}`}>{value}</span>
      </div>
      <div className={`h-1.5 rounded-full overflow-hidden ${isDark ? 'bg-cmd-border' : 'bg-light-border'}`}>
        <div 
          className={`h-full rounded-full ${value >= 80 ? 'bg-green-500' : value >= 60 ? 'bg-yellow-500' : 'bg-red-500'}`}
          style={{width: `${value}%`}}
        />
      </div>
    </div>
  );

  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Heart className="w-3 h-3 text-pink-400" /> Team Chemistry
        </h3>
        <span className={`text-lg font-black ${chemistry.overall >= 75 ? 'text-green-400' : 'text-yellow-400'}`}>{chemistry.overall}</span>
      </div>
      
      <div className="space-y-2">
        <ChemBar label="Offense" value={chemistry.offense} />
        <ChemBar label="Defense" value={chemistry.defense} />
        <ChemBar label="Communication" value={chemistry.communication} />
        <ChemBar label="Momentum" value={chemistry.momentum} />
      </div>
    </div>
  );
};

// Record Breakdown Widget
const RecordBreakdownWidget = ({ isDark = true }) => {
  const records = [
    { label: 'vs East', record: '18-21', pct: 46.2 },
    { label: 'vs West', record: '7-11', pct: 38.9 },
    { label: 'vs .500+', record: '8-18', pct: 30.8 },
    { label: 'vs <.500', record: '17-14', pct: 54.8 },
    { label: 'OT Games', record: '2-1', pct: 66.7 },
    { label: '1-Poss Games', record: '6-8', pct: 42.9 }
  ];
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <BarChart3 className="w-3 h-3 text-cyan-400" /> Record Splits
        </h3>
      </div>
      
      <div className="grid grid-cols-2 gap-2">
        {records.map((r, i) => (
          <div key={i} className={`p-2 rounded-lg text-center ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`}>
            <div className={`text-xs font-black ${r.pct >= 50 ? 'text-green-400' : 'text-red-400'}`}>{r.record}</div>
            <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{r.label}</div>
          </div>
        ))}
      </div>
    </div>
  );
};

// Lineup Combos Widget
const LineupCombosWidget = ({ isDark = true }) => {
  const lineups = [
    { players: 'Barnes â€¢ Barrett â€¢ Quickley â€¢ Dick â€¢ Poeltl', tag: 'Starting 5', mins: 248, netRtg: 8.2, ortg: 118.5, drtg: 110.3 },
    { players: 'Barnes â€¢ Barrett â€¢ Quickley â€¢ Brown â€¢ Poeltl', tag: 'Alt Start', mins: 156, netRtg: 5.5, ortg: 116.0, drtg: 110.5 },
    { players: 'Mitchell â€¢ Brown â€¢ Olynyk â€¢ Boucher â€¢ Fernando', tag: 'Bench Mob', mins: 112, netRtg: -1.8, ortg: 108.2, drtg: 110.0 },
    { players: 'Barnes â€¢ Barrett â€¢ Dick â€¢ Olynyk â€¢ Quickley', tag: 'Small Ball', mins: 98, netRtg: 6.8, ortg: 119.0, drtg: 112.2 },
    { players: 'Quickley â€¢ Dick â€¢ Brown â€¢ Boucher â€¢ Poeltl', tag: 'Closing', mins: 72, netRtg: 3.4, ortg: 114.5, drtg: 111.1 }
  ];
  const maxAbs = Math.max(...lineups.map(l => Math.abs(l.netRtg)));
  const [expanded, setExpanded] = useState(null);

  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Users className="w-3.5 h-3.5 text-indigo-400" /> Lineup Combinations
        </h3>
        <span className={`text-[8px] px-1.5 py-0.5 rounded ${isDark ? 'bg-cmd-bg text-slate-400' : 'bg-light-card text-slate-500'}`}>Net Rtg</span>
      </div>
      
      <div className="space-y-1.5">
        {lineups.map((l, i) => (
          <div key={i} className={`rounded-lg overflow-hidden cursor-pointer transition-all ${isDark ? 'hover:bg-cmd-bg/80' : 'hover:bg-light-card/80'}`} onClick={() => setExpanded(expanded === i ? null : i)}>
            <div className={`p-2 ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`}>
              <div className="flex items-center justify-between mb-1">
                <div className="flex items-center gap-1.5">
                  <span className={`text-[8px] font-bold px-1 py-0.5 rounded ${isDark ? 'bg-indigo-500/20 text-indigo-400' : 'bg-indigo-100 text-indigo-600'}`}>{l.tag}</span>
                  <span className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{l.mins} min</span>
                </div>
                <span className={`text-xs font-black ${l.netRtg > 0 ? 'text-green-400' : 'text-red-400'}`}>
                  {l.netRtg > 0 ? '+' : ''}{l.netRtg}
                </span>
              </div>
              {/* Horizontal bar */}
              <div className="relative h-2.5 rounded-full overflow-hidden" style={{ background: isDark ? '#1e293b' : '#e2e8f0' }}>
                <div className="absolute top-0 h-full rounded-full transition-all duration-700"
                     style={{
                       width: `${(Math.abs(l.netRtg) / maxAbs) * 50}%`,
                       left: l.netRtg >= 0 ? '50%' : `${50 - (Math.abs(l.netRtg) / maxAbs) * 50}%`,
                       background: l.netRtg >= 0 ? 'linear-gradient(90deg, #22c55e, #4ade80)' : 'linear-gradient(90deg, #f87171, #ef4444)'
                     }}/>
                <div className="absolute top-0 left-1/2 w-px h-full" style={{ background: isDark ? '#475569' : '#94a3b8' }}/>
              </div>
              {expanded === i && (
                <div className="mt-2 pt-2 border-t animate-fade-in" style={{ borderColor: isDark ? '#1e293b' : '#e2e8f0' }}>
                  <div className={`text-[8px] ${isDark ? 'text-slate-400' : 'text-slate-500'} mb-1`}>{l.players}</div>
                  <div className="flex gap-3">
                    <span className={`text-[9px] ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>ORtg: <b className={isDark ? 'text-white' : 'text-slate-800'}>{l.ortg}</b></span>
                    <span className={`text-[9px] ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>DRtg: <b className={isDark ? 'text-white' : 'text-slate-800'}>{l.drtg}</b></span>
                  </div>
                </div>
              )}
            </div>
          </div>
        ))}
      </div>
    </div>
  );
};

// Defensive Assignments Widget
const DefensiveAssignmentsWidget = ({ isDark = true, opponent }) => {
  const opponentData = OPPONENT_DATA[opponent];
  if (!opponentData) return null;
  
  const topScorer = opponentData.roster.sort((a, b) => (b.seasonStats?.ppg || 0) - (a.seasonStats?.ppg || 0))[0];
  
  const assignments = [
    { defender: 'Scottie Barnes', assignment: topScorer?.name || 'Top Scorer', rating: 'A' },
    { defender: 'RJ Barrett', assignment: 'Secondary', rating: 'B+' },
    { defender: 'Gradey Dick', assignment: '3PT Threat', rating: 'B' }
  ];
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Shield className="w-3 h-3 text-blue-400" /> Defensive Keys
        </h3>
      </div>
      
      <div className="space-y-2">
        {assignments.map((a, i) => (
          <div key={i} className="flex items-center justify-between text-[10px]">
            <div>
              <span className={`font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{a.defender}</span>
              <span className={isDark ? 'text-slate-500' : 'text-slate-400'}> â†’ </span>
              <span className={isDark ? 'text-slate-300' : 'text-slate-600'}>{a.assignment}</span>
            </div>
            <span className={`px-1.5 py-0.5 rounded text-[9px] font-bold ${
              a.rating.startsWith('A') ? 'bg-green-500/20 text-green-400' : 'bg-yellow-500/20 text-yellow-400'
            }`}>{a.rating}</span>
          </div>
        ))}
      </div>
    </div>
  );
};

// Momentum Tracker Widget
const MomentumTrackerWidget = ({ isDark = true }) => {
  const momentum = [
    { game: -5, result: 'W', margin: 8 },
    { game: -4, result: 'L', margin: -12 },
    { game: -3, result: 'W', margin: 5 },
    { game: -2, result: 'W', margin: 15 },
    { game: -1, result: 'W', margin: 3 }
  ];
  
  const currentMomentum = momentum.filter(m => m.result === 'W').length / momentum.length * 100;
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <TrendingUp className="w-3 h-3 text-green-400" /> Momentum
        </h3>
        <span className={`text-sm font-black ${currentMomentum >= 60 ? 'text-green-400' : 'text-yellow-400'}`}>
          {currentMomentum.toFixed(0)}%
        </span>
      </div>
      
      <div className="flex justify-between items-end h-12 gap-1">
        {momentum.map((m, i) => (
          <div 
            key={i} 
            className={`flex-1 rounded-t ${m.result === 'W' ? 'bg-green-500' : 'bg-red-500'}`}
            style={{height: `${Math.min(Math.abs(m.margin) * 3, 100)}%`}}
            title={`${m.result} by ${Math.abs(m.margin)}`}
          />
        ))}
      </div>
      <div className="flex justify-between mt-1">
        {momentum.map((m, i) => (
          <span key={i} className={`text-[8px] flex-1 text-center ${m.result === 'W' ? 'text-green-400' : 'text-red-400'}`}>
            {m.result}
          </span>
        ))}
      </div>
    </div>
  );
};

// Player Hot/Cold Widget
const PlayerFormWidget = ({ isDark = true }) => {
  const players = RAPTORS_ROSTER.filter(p => p.form === 'hot' || p.form === 'cold').slice(0, 4);
  
  if (players.length === 0) return null;
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Flame className="w-3 h-3 text-orange-400" /> Player Form
        </h3>
      </div>
      
      <div className="grid grid-cols-2 gap-2">
        {players.map((p, i) => (
          <div key={i} className={`p-2 rounded-lg text-center ${
            p.form === 'hot' ? (isDark ? 'bg-orange-500/10' : 'bg-orange-500/5') : (isDark ? 'bg-blue-500/10' : 'bg-blue-500/5')
          }`}>
            <div className="text-lg mb-1">{p.form === 'hot' ? 'ðŸ”¥' : 'â„ï¸'}</div>
            <div className={`text-[10px] font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{p.name.split(' ')[1]}</div>
            <div className={`text-[9px] ${p.form === 'hot' ? 'text-orange-400' : 'text-blue-400'}`}>
              L5: {p.last5?.ppg || '--'} PPG
            </div>
          </div>
        ))}
      </div>
    </div>
  );
};

// Points Distribution Widget
const PointsDistributionWidget = ({ isDark = true }) => {
  const distribution = {
    paint: 48.2,
    midrange: 14.5,
    threePoint: 37.3
  };
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Target className="w-3 h-3 text-purple-400" /> Scoring Zones
        </h3>
      </div>
      
      <div className="space-y-2">
        <div>
          <div className="flex justify-between text-[10px] mb-1">
            <span className={isDark ? 'text-slate-400' : 'text-slate-500'}>Paint</span>
            <span className="font-bold text-raptors-red">{distribution.paint}%</span>
          </div>
          <div className={`h-2 rounded-full overflow-hidden ${isDark ? 'bg-cmd-border' : 'bg-light-border'}`}>
            <div className="h-full bg-raptors-red rounded-full" style={{width: `${distribution.paint}%`}} />
          </div>
        </div>
        <div>
          <div className="flex justify-between text-[10px] mb-1">
            <span className={isDark ? 'text-slate-400' : 'text-slate-500'}>Mid-Range</span>
            <span className="font-bold text-yellow-400">{distribution.midrange}%</span>
          </div>
          <div className={`h-2 rounded-full overflow-hidden ${isDark ? 'bg-cmd-border' : 'bg-light-border'}`}>
            <div className="h-full bg-yellow-400 rounded-full" style={{width: `${distribution.midrange}%`}} />
          </div>
        </div>
        <div>
          <div className="flex justify-between text-[10px] mb-1">
            <span className={isDark ? 'text-slate-400' : 'text-slate-500'}>3-Point</span>
            <span className="font-bold text-green-400">{distribution.threePoint}%</span>
          </div>
          <div className={`h-2 rounded-full overflow-hidden ${isDark ? 'bg-cmd-border' : 'bg-light-border'}`}>
            <div className="h-full bg-green-400 rounded-full" style={{width: `${distribution.threePoint}%`}} />
          </div>
        </div>
      </div>
    </div>
  );
};

// Assist Leaders Widget
const AssistLeadersWidget = ({ isDark = true }) => {
  const leaders = RAPTORS_ROSTER
    .filter(p => p.seasonStats?.apg)
    .sort((a, b) => b.seasonStats.apg - a.seasonStats.apg)
    .slice(0, 3);
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Share className="w-3 h-3 text-blue-400" /> Assist Leaders
        </h3>
      </div>
      
      <div className="space-y-2">
        {leaders.map((p, i) => (
          <div key={i} className="flex items-center justify-between">
            <div className="flex items-center gap-2">
              <span className={`text-[10px] font-bold ${i === 0 ? 'text-yellow-400' : isDark ? 'text-slate-400' : 'text-slate-500'}`}>
                {i + 1}.
              </span>
              <span className={`text-[10px] ${isDark ? 'text-slate-300' : 'text-slate-600'}`}>{p.name.split(' ')[1]}</span>
            </div>
            <span className={`text-[10px] font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{p.seasonStats.apg} APG</span>
          </div>
        ))}
      </div>
    </div>
  );
};

// Rebound Battle Widget
const ReboundBattleWidget = ({ isDark = true }) => {
  const rebounding = {
    orb: 10.8,
    drb: 34.2,
    oppOrb: 9.5,
    oppDrb: 32.8,
    totalAdv: 2.7
  };
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <ArrowUpDown className="w-3 h-3 text-orange-400" /> Rebound Battle
        </h3>
        <span className={`text-sm font-bold ${rebounding.totalAdv > 0 ? 'text-green-400' : 'text-red-400'}`}>
          {rebounding.totalAdv > 0 ? '+' : ''}{rebounding.totalAdv}
        </span>
      </div>
      
      <div className="grid grid-cols-2 gap-2 text-center">
        <div className={`p-2 rounded-lg ${isDark ? 'bg-green-500/10' : 'bg-green-500/5'}`}>
          <div className="text-lg font-black text-green-400">{rebounding.orb}</div>
          <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>ORB</div>
        </div>
        <div className={`p-2 rounded-lg ${isDark ? 'bg-blue-500/10' : 'bg-blue-500/5'}`}>
          <div className="text-lg font-black text-blue-400">{rebounding.drb}</div>
          <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>DRB</div>
        </div>
      </div>
    </div>
  );
};

// Usage Rate Widget
const UsageRateWidget = ({ isDark = true }) => {
  const usageLeaders = RAPTORS_ROSTER
    .filter(p => p.advanced?.usg)
    .sort((a, b) => b.advanced.usg - a.advanced.usg)
    .slice(0, 4);
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Gauge className="w-3 h-3 text-purple-400" /> Usage Rate
        </h3>
      </div>
      
      <div className="space-y-2">
        {usageLeaders.map((p, i) => (
          <div key={i}>
            <div className="flex justify-between text-[10px] mb-1">
              <span className={isDark ? 'text-slate-300' : 'text-slate-600'}>{p.name.split(' ')[1]}</span>
              <span className={`font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{p.advanced.usg}%</span>
            </div>
            <div className={`h-1.5 rounded-full overflow-hidden ${isDark ? 'bg-cmd-border' : 'bg-light-border'}`}>
              <div 
                className="h-full bg-gradient-to-r from-purple-500 to-pink-500 rounded-full"
                style={{width: `${(p.advanced.usg / 35) * 100}%`}}
              />
            </div>
          </div>
        ))}
      </div>
    </div>
  );
};

// Turnover Analysis Widget
const TurnoverWidget = ({ isDark = true }) => {
  const toData = {
    perGame: 13.8,
    rank: 18,
    liveTO: 8.2,
    deadTO: 5.6,
    ptsOffTO: 15.4,
    oppPtsOffTO: 17.2
  };
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <RefreshCcw className="w-3 h-3 text-red-400" /> Turnovers
        </h3>
        <span className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>#{toData.rank}</span>
      </div>
      
      <div className="text-center mb-3">
        <div className={`text-2xl font-black ${toData.perGame < 14 ? 'text-green-400' : 'text-red-400'}`}>{toData.perGame}</div>
        <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'} uppercase`}>Per Game</div>
      </div>
      
      <div className={`grid grid-cols-2 gap-2 text-[10px] ${isDark ? 'text-slate-300' : 'text-slate-600'}`}>
        <div className="flex justify-between">
          <span>Live TO</span>
          <span className="font-bold text-red-400">{toData.liveTO}</span>
        </div>
        <div className="flex justify-between">
          <span>Dead TO</span>
          <span className="font-bold text-yellow-400">{toData.deadTO}</span>
        </div>
        <div className="flex justify-between">
          <span>Pts Off TO</span>
          <span className="font-bold">{toData.ptsOffTO}</span>
        </div>
        <div className="flex justify-between">
          <span>Opp Pts Off</span>
          <span className="font-bold">{toData.oppPtsOffTO}</span>
        </div>
      </div>
    </div>
  );
};

// Free Throw Widget
const FreeThrowWidget = ({ isDark = true }) => {
  const ftData = {
    ftPct: 78.5,
    ftaPerGame: 22.4,
    ftr: 24.8,
    rank: 14,
    clutchFT: 82.1
  };
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Target className="w-3 h-3 text-cyan-400" /> Free Throws
        </h3>
      </div>
      
      <div className="grid grid-cols-2 gap-2 text-center mb-3">
        <div className={`p-2 rounded-lg ${isDark ? 'bg-cyan-500/10' : 'bg-cyan-500/5'}`}>
          <div className={`text-xl font-black ${ftData.ftPct >= 78 ? 'text-green-400' : 'text-yellow-400'}`}>{ftData.ftPct}%</div>
          <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>FT%</div>
        </div>
        <div className={`p-2 rounded-lg ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`}>
          <div className={`text-xl font-black ${isDark ? 'text-white' : 'text-slate-800'}`}>{ftData.ftaPerGame}</div>
          <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>FTA/G</div>
        </div>
      </div>
      
      <div className={`text-[10px] ${isDark ? 'text-slate-400' : 'text-slate-500'} text-center`}>
        Clutch FT: <span className="font-bold text-green-400">{ftData.clutchFT}%</span>
      </div>
    </div>
  );
};

// Season Comparison Widget
const SeasonComparisonWidget = ({ isDark = true }) => {
  const comparison = {
    thisYear: { w: 25, l: 32, ppg: 111.5, oppg: 112.8 },
    lastYear: { w: 25, l: 57, ppg: 108.2, oppg: 114.5 },
    paceFor: { w: 36, l: 46 }
  };
  
  const improved = comparison.thisYear.ppg > comparison.lastYear.ppg;
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <History className="w-3 h-3 text-amber-400" /> vs Last Year
        </h3>
        <span className={`text-[9px] px-1.5 py-0.5 rounded ${improved ? 'bg-green-500/20 text-green-400' : 'bg-red-500/20 text-red-400'}`}>
          {improved ? 'â†‘ Better' : 'â†“ Worse'}
        </span>
      </div>
      
      <div className="space-y-2 text-[10px]">
        <div className="flex justify-between">
          <span className={isDark ? 'text-slate-400' : 'text-slate-500'}>Record (same pt)</span>
          <div>
            <span className="font-bold text-green-400">{comparison.thisYear.w}-{comparison.thisYear.l}</span>
            <span className={isDark ? 'text-slate-600' : 'text-slate-400'}> vs </span>
            <span className="font-bold text-red-400">{comparison.lastYear.w}-{comparison.lastYear.l}</span>
          </div>
        </div>
        <div className="flex justify-between">
          <span className={isDark ? 'text-slate-400' : 'text-slate-500'}>PPG</span>
          <div>
            <span className={`font-bold ${comparison.thisYear.ppg > comparison.lastYear.ppg ? 'text-green-400' : 'text-red-400'}`}>
              {comparison.thisYear.ppg}
            </span>
            <span className={isDark ? 'text-slate-600' : 'text-slate-400'}> vs </span>
            <span className={isDark ? 'text-slate-300' : 'text-slate-600'}>{comparison.lastYear.ppg}</span>
          </div>
        </div>
        <div className={`pt-2 border-t ${isDark ? 'border-cmd-border' : 'border-light-border'} flex justify-between`}>
          <span className={isDark ? 'text-slate-400' : 'text-slate-500'}>Pace for</span>
          <span className={`font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{comparison.paceFor.w}-{comparison.paceFor.l}</span>
        </div>
      </div>
    </div>
  );
};

// Foul Trouble Widget
const FoulTroubleWidget = ({ isDark = true }) => {
  const foulRisks = [
    { player: 'Poeltl', foulsPerGame: 3.2, risk: 'High' },
    { player: 'Barnes', foulsPerGame: 2.8, risk: 'Med' },
    { player: 'Olynyk', foulsPerGame: 2.5, risk: 'Med' }
  ];
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <AlertTriangle className="w-3 h-3 text-yellow-400" /> Foul Watch
        </h3>
      </div>
      
      <div className="space-y-2">
        {foulRisks.map((p, i) => (
          <div key={i} className="flex items-center justify-between text-[10px]">
            <span className={isDark ? 'text-slate-300' : 'text-slate-600'}>{p.player}</span>
            <div className="flex items-center gap-2">
              <span className={isDark ? 'text-slate-400' : 'text-slate-500'}>{p.foulsPerGame} F/G</span>
              <span className={`px-1.5 py-0.5 rounded text-[9px] font-bold ${
                p.risk === 'High' ? 'bg-red-500/20 text-red-400' : 'bg-yellow-500/20 text-yellow-400'
              }`}>{p.risk}</span>
            </div>
          </div>
        ))}
      </div>
    </div>
  );
};

// Fantasy Projections Widget
const FantasyProjectionsWidget = ({ isDark = true }) => {
  const projections = [
    { player: 'Scottie Barnes', dkPts: 45.2, fdPts: 42.8, value: 'A' },
    { player: 'RJ Barrett', dkPts: 32.5, fdPts: 30.1, value: 'B+' },
    { player: 'Immanuel Quickley', dkPts: 28.8, fdPts: 26.5, value: 'B' }
  ];
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Sparkles className="w-3 h-3 text-green-400" /> DFS Projections
        </h3>
      </div>
      
      <div className="space-y-2">
        {projections.map((p, i) => (
          <div key={i} className={`p-2 rounded-lg ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`}>
            <div className="flex justify-between items-center mb-1">
              <span className={`text-[10px] font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{p.player.split(' ')[1]}</span>
              <span className={`px-1.5 py-0.5 rounded text-[9px] font-bold ${
                p.value.startsWith('A') ? 'bg-green-500/20 text-green-400' : 'bg-yellow-500/20 text-yellow-400'
              }`}>{p.value}</span>
            </div>
            <div className="flex justify-between text-[9px]">
              <span className={isDark ? 'text-slate-400' : 'text-slate-500'}>DK: {p.dkPts}</span>
              <span className={isDark ? 'text-slate-400' : 'text-slate-500'}>FD: {p.fdPts}</span>
            </div>
          </div>
        ))}
      </div>
    </div>
  );
};

// Timeout Tracker Widget
const TimeoutTrackerWidget = ({ isDark = true }) => {
  const timeouts = {
    remaining: 5,
    total: 7,
    avgUsedQ1: 0.8,
    avgUsedQ4: 2.2
  };
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Timer className="w-3 h-3 text-blue-400" /> Timeout Usage
        </h3>
      </div>
      
      <div className="flex justify-center gap-1 mb-3">
        {Array.from({ length: timeouts.total }).map((_, i) => (
          <div
            key={i}
            className={`w-6 h-6 rounded-full flex items-center justify-center text-[10px] font-bold ${
              i < timeouts.remaining 
                ? 'bg-blue-500 text-white' 
                : `${isDark ? 'bg-cmd-border' : 'bg-light-border'} ${isDark ? 'text-slate-600' : 'text-slate-400'}`
            }`}
          >
            {i + 1}
          </div>
        ))}
      </div>
      
      <div className={`grid grid-cols-2 gap-2 text-[10px] text-center ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>
        <div>Q1 Avg: {timeouts.avgUsedQ1}</div>
        <div>Q4 Avg: {timeouts.avgUsedQ4}</div>
      </div>
    </div>
  );
};

// Three Point Shooting Widget
const ThreePointWidget = ({ isDark = true }) => {
  const threeData = {
    made: 13.2,
    attempted: 38.5,
    pct: 34.3,
    rank: 22,
    corner3Pct: 38.2,
    aboveBreak: 33.1
  };
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Target className="w-3 h-3 text-green-400" /> 3PT Shooting
        </h3>
        <span className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>#{threeData.rank}</span>
      </div>
      
      <div className="text-center mb-3">
        <div className={`text-2xl font-black ${threeData.pct >= 35 ? 'text-green-400' : 'text-yellow-400'}`}>{threeData.pct}%</div>
        <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{threeData.made}/{threeData.attempted} 3PM/A</div>
      </div>
      
      <div className={`grid grid-cols-2 gap-2 text-[10px] ${isDark ? 'text-slate-300' : 'text-slate-600'}`}>
        <div className="flex justify-between">
          <span>Corner 3</span>
          <span className="font-bold text-green-400">{threeData.corner3Pct}%</span>
        </div>
        <div className="flex justify-between">
          <span>Above Break</span>
          <span className="font-bold">{threeData.aboveBreak}%</span>
        </div>
      </div>
    </div>
  );
};

// Plus/Minus Leaders Widget
const PlusMinusWidget = ({ isDark = true }) => {
  const leaders = RAPTORS_ROSTER
    .filter(p => p.seasonStats?.plusMinus !== undefined)
    .sort((a, b) => b.seasonStats.plusMinus - a.seasonStats.plusMinus)
    .slice(0, 5);
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <TrendingUp className="w-3 h-3 text-green-400" /> +/- Leaders
        </h3>
      </div>
      
      <div className="space-y-2">
        {leaders.map((p, i) => (
          <div key={i} className="flex items-center justify-between text-[10px]">
            <span className={isDark ? 'text-slate-300' : 'text-slate-600'}>{p.name.split(' ')[1]}</span>
            <span className={`font-bold ${p.seasonStats.plusMinus > 0 ? 'text-green-400' : 'text-red-400'}`}>
              {p.seasonStats.plusMinus > 0 ? '+' : ''}{p.seasonStats.plusMinus}
            </span>
          </div>
        ))}
      </div>
    </div>
  );
};

// Bench Production Widget
const BenchProductionWidget = ({ isDark = true }) => {
  const bench = {
    ppg: 38.5,
    rank: 12,
    topScorer: 'Boucher',
    topPts: 9.2,
    pctOfTotal: 34.5
  };
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Users className="w-3 h-3 text-orange-400" /> Bench Mob
        </h3>
        <span className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>#{bench.rank}</span>
      </div>
      
      <div className="text-center mb-3">
        <div className={`text-2xl font-black ${bench.ppg >= 35 ? 'text-green-400' : 'text-yellow-400'}`}>{bench.ppg}</div>
        <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'} uppercase`}>Bench PPG</div>
      </div>
      
      <div className={`text-[10px] ${isDark ? 'text-slate-300' : 'text-slate-600'} space-y-1`}>
        <div className="flex justify-between">
          <span>Top Scorer</span>
          <span className="font-bold">{bench.topScorer} ({bench.topPts})</span>
        </div>
        <div className="flex justify-between">
          <span>% of Total</span>
          <span className="font-bold">{bench.pctOfTotal}%</span>
        </div>
      </div>
    </div>
  );
};

// Fast Break Points Widget
const FastBreakWidget = ({ isDark = true }) => {
  const fastBreak = {
    scored: 14.8,
    allowed: 12.5,
    diff: 2.3,
    rank: 8
  };
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Zap className="w-3 h-3 text-yellow-400" /> Fast Break
        </h3>
        <span className={`text-sm font-bold ${fastBreak.diff > 0 ? 'text-green-400' : 'text-red-400'}`}>
          +{fastBreak.diff}
        </span>
      </div>
      
      <div className="grid grid-cols-2 gap-2 text-center">
        <div className={`p-2 rounded-lg ${isDark ? 'bg-green-500/10' : 'bg-green-500/5'}`}>
          <div className="text-lg font-black text-green-400">{fastBreak.scored}</div>
          <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>Scored</div>
        </div>
        <div className={`p-2 rounded-lg ${isDark ? 'bg-red-500/10' : 'bg-red-500/5'}`}>
          <div className="text-lg font-black text-red-400">{fastBreak.allowed}</div>
          <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>Allowed</div>
        </div>
      </div>
    </div>
  );
};

// Paint Scoring Widget
const PaintScoringWidget = ({ isDark = true }) => {
  const paint = {
    scored: 52.4,
    allowed: 48.2,
    diff: 4.2,
    rank: 6,
    pct: 46.8
  };
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Target className="w-3 h-3 text-raptors-red" /> Paint Scoring
        </h3>
        <span className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>#{paint.rank}</span>
      </div>
      
      <div className="text-center mb-3">
        <div className="text-2xl font-black text-raptors-red">{paint.scored}</div>
        <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'} uppercase`}>PIP/G</div>
      </div>
      
      <div className={`text-[10px] ${isDark ? 'text-slate-300' : 'text-slate-600'} space-y-1`}>
        <div className="flex justify-between">
          <span>Allowed</span>
          <span className="font-bold">{paint.allowed}</span>
        </div>
        <div className="flex justify-between">
          <span>Differential</span>
          <span className={`font-bold ${paint.diff > 0 ? 'text-green-400' : 'text-red-400'}`}>+{paint.diff}</span>
        </div>
      </div>
    </div>
  );
};

// Second Chance Points Widget
const SecondChanceWidget = ({ isDark = true }) => {
  const secondChance = {
    scored: 12.8,
    allowed: 10.5,
    diff: 2.3,
    orbPct: 28.5
  };
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <RefreshCcw className="w-3 h-3 text-blue-400" /> 2nd Chance
        </h3>
        <span className={`text-sm font-bold ${secondChance.diff > 0 ? 'text-green-400' : 'text-red-400'}`}>
          +{secondChance.diff}
        </span>
      </div>
      
      <div className="grid grid-cols-2 gap-2 text-center">
        <div className={`p-2 rounded-lg ${isDark ? 'bg-blue-500/10' : 'bg-blue-500/5'}`}>
          <div className="text-lg font-black text-blue-400">{secondChance.scored}</div>
          <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>Scored</div>
        </div>
        <div className={`p-2 rounded-lg ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`}>
          <div className={`text-lg font-black ${isDark ? 'text-white' : 'text-slate-800'}`}>{secondChance.orbPct}%</div>
          <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>ORB%</div>
        </div>
      </div>
    </div>
  );
};

// Offensive Sets Widget
const OffensiveSetsWidget = ({ isDark = true }) => {
  const sets = [
    { name: 'Pick & Roll', freq: 28.5, ppp: 0.98 },
    { name: 'Transition', freq: 18.2, ppp: 1.12 },
    { name: 'Isolation', freq: 12.5, ppp: 0.92 },
    { name: 'Post-Up', freq: 8.2, ppp: 0.88 },
    { name: 'Spot-Up', freq: 22.1, ppp: 1.05 }
  ];
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <LayoutTemplate className="w-3 h-3 text-purple-400" /> Offensive Sets
        </h3>
      </div>
      
      <div className="space-y-2">
        {sets.map((s, i) => (
          <div key={i} className="flex items-center justify-between text-[10px]">
            <span className={isDark ? 'text-slate-300' : 'text-slate-600'}>{s.name}</span>
            <div className="flex items-center gap-2">
              <span className={isDark ? 'text-slate-500' : 'text-slate-400'}>{s.freq}%</span>
              <span className={`font-bold ${s.ppp >= 1.0 ? 'text-green-400' : 'text-yellow-400'}`}>{s.ppp} PPP</span>
            </div>
          </div>
        ))}
      </div>
    </div>
  );
};

// Crunch Time Lineup Widget
const CrunchTimeWidget = ({ isDark = true }) => {
  const lineup = ['Barnes', 'Barrett', 'Quickley', 'Dick', 'Poeltl'];
  const stats = { netRtg: 8.5, mins: 42, record: '6-3' };
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Timer className="w-3 h-3 text-red-400" /> Closing 5
        </h3>
        <span className={`text-[9px] px-1.5 py-0.5 rounded bg-green-500/20 text-green-400 font-bold`}>{stats.record}</span>
      </div>
      
      <div className="flex flex-wrap gap-1 justify-center mb-3">
        {lineup.map((p, i) => (
          <span key={i} className={`text-[9px] px-2 py-1 rounded ${isDark ? 'bg-cmd-bg' : 'bg-light-card'} ${isDark ? 'text-white' : 'text-slate-800'}`}>
            {p}
          </span>
        ))}
      </div>
      
      <div className={`text-center text-[10px] ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>
        Net Rtg: <span className="font-bold text-green-400">+{stats.netRtg}</span> â€¢ {stats.mins} min
      </div>
    </div>
  );
};

// Defensive Efficiency Widget
const DefensiveEfficiencyWidget = ({ isDark = true }) => {
  const defense = {
    drtg: 111.8,
    rank: 15,
    rimProtection: 64.2,
    perimeter: 35.8,
    transition: 12.5
  };
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Shield className="w-3 h-3 text-blue-400" /> Defense
        </h3>
        <span className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>#{defense.rank}</span>
      </div>
      
      <div className="text-center mb-3">
        <div className={`text-2xl font-black ${defense.drtg < 112 ? 'text-green-400' : 'text-yellow-400'}`}>{defense.drtg}</div>
        <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'} uppercase`}>Def Rtg</div>
      </div>
      
      <div className={`space-y-1 text-[10px] ${isDark ? 'text-slate-300' : 'text-slate-600'}`}>
        <div className="flex justify-between">
          <span>Rim Protection</span>
          <span className={`font-bold ${defense.rimProtection < 65 ? 'text-green-400' : 'text-yellow-400'}`}>{defense.rimProtection}%</span>
        </div>
        <div className="flex justify-between">
          <span>Perimeter D</span>
          <span className={`font-bold ${defense.perimeter < 36 ? 'text-green-400' : 'text-yellow-400'}`}>{defense.perimeter}%</span>
        </div>
        <div className="flex justify-between">
          <span>Trans Pts Allowed</span>
          <span className="font-bold">{defense.transition}</span>
        </div>
      </div>
    </div>
  );
};

// Steals & Blocks Leaders Widget
const StealsBlocksWidget = ({ isDark = true }) => {
  const stealLeaders = RAPTORS_ROSTER.filter(p => p.seasonStats?.spg).sort((a, b) => b.seasonStats.spg - a.seasonStats.spg).slice(0, 3);
  const blockLeaders = RAPTORS_ROSTER.filter(p => p.seasonStats?.bpg).sort((a, b) => b.seasonStats.bpg - a.seasonStats.bpg).slice(0, 3);
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Shield className="w-3 h-3 text-red-400" /> Steals & Blocks
        </h3>
      </div>
      
      <div className="grid grid-cols-2 gap-3">
        <div>
          <div className={`text-[9px] font-bold ${isDark ? 'text-slate-400' : 'text-slate-500'} mb-1 uppercase`}>Steals</div>
          {stealLeaders.map((p, i) => (
            <div key={i} className="flex justify-between text-[10px]">
              <span className={isDark ? 'text-slate-300' : 'text-slate-600'}>{p.name.split(' ')[1]}</span>
              <span className="font-bold text-green-400">{p.seasonStats.spg}</span>
            </div>
          ))}
        </div>
        <div>
          <div className={`text-[9px] font-bold ${isDark ? 'text-slate-400' : 'text-slate-500'} mb-1 uppercase`}>Blocks</div>
          {blockLeaders.map((p, i) => (
            <div key={i} className="flex justify-between text-[10px]">
              <span className={isDark ? 'text-slate-300' : 'text-slate-600'}>{p.name.split(' ')[1]}</span>
              <span className="font-bold text-blue-400">{p.seasonStats.bpg}</span>
            </div>
          ))}
        </div>
      </div>
    </div>
  );
};

// Rookie Watch Widget
const RookieWatchWidget = ({ isDark = true }) => {
  const rookies = [
    { name: 'Ja\'Kobe Walter', ppg: 4.2, rpg: 1.5, grade: 'B-' },
    { name: 'Jamal Shead', ppg: 3.8, rpg: 1.2, grade: 'C+' }
  ];
  
  if (rookies.length === 0) return null;
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Star className="w-3 h-3 text-yellow-400" /> Rookie Watch
        </h3>
      </div>
      
      <div className="space-y-2">
        {rookies.map((r, i) => (
          <div key={i} className={`p-2 rounded-lg ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`}>
            <div className="flex justify-between items-center mb-1">
              <span className={`text-[10px] font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{r.name}</span>
              <span className={`px-1.5 py-0.5 rounded text-[9px] font-bold ${
                r.grade.startsWith('A') || r.grade.startsWith('B') ? 'bg-green-500/20 text-green-400' : 'bg-yellow-500/20 text-yellow-400'
              }`}>{r.grade}</span>
            </div>
            <div className={`text-[9px] ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>
              {r.ppg} PPG â€¢ {r.rpg} RPG
            </div>
          </div>
        ))}
      </div>
    </div>
  );
};

// Monthly Performance Widget
const MonthlyPerformanceWidget = ({ isDark = true }) => {
  const months = [
    { month: 'Oct', record: '3-4', ppg: 108.2 },
    { month: 'Nov', record: '8-7', ppg: 110.5 },
    { month: 'Dec', record: '6-9', ppg: 109.8 },
    { month: 'Jan', record: '7-8', ppg: 112.4 },
    { month: 'Feb', record: '1-4', ppg: 114.2 }
  ];
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Calendar className="w-3 h-3 text-blue-400" /> By Month
        </h3>
      </div>
      
      <div className="space-y-2">
        {months.map((m, i) => {
          const [w, l] = m.record.split('-').map(Number);
          const pct = w / (w + l);
          return (
            <div key={i} className="flex items-center justify-between text-[10px]">
              <span className={isDark ? 'text-slate-400' : 'text-slate-500'}>{m.month}</span>
              <div className="flex items-center gap-2">
                <span className={`font-bold ${pct >= 0.5 ? 'text-green-400' : 'text-red-400'}`}>{m.record}</span>
                <span className={isDark ? 'text-slate-500' : 'text-slate-400'}>{m.ppg}</span>
              </div>
            </div>
          );
        })}
      </div>
    </div>
  );
};

// Opponent Scouting Widget
const OpponentScoutingWidget = ({ isDark = true, opponent }) => {
  const opponentData = OPPONENT_DATA[opponent];
  if (!opponentData) return null;
  
  const topPlayer = opponentData.roster.sort((a, b) => (b.seasonStats?.ppg || 0) - (a.seasonStats?.ppg || 0))[0];
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Eye className="w-3 h-3 text-orange-400" /> Scout: {opponent}
        </h3>
      </div>
      
      <div className="space-y-2">
        <div className={`p-2 rounded-lg ${isDark ? 'bg-orange-500/10' : 'bg-orange-500/5'}`}>
          <div className={`text-[9px] ${isDark ? 'text-slate-400' : 'text-slate-500'} uppercase mb-1`}>Key Threat</div>
          <div className={`text-[10px] font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>
            {topPlayer?.name} ({topPlayer?.seasonStats?.ppg} PPG)
          </div>
        </div>
        
        <div className={`text-[10px] ${isDark ? 'text-slate-300' : 'text-slate-600'}`}>
          <div className={`font-bold ${isDark ? 'text-slate-400' : 'text-slate-500'} text-[9px] uppercase mb-1`}>Tendencies</div>
          <ul className="list-disc list-inside space-y-0.5">
            {opponentData.tendencies?.slice(0, 3).map((t, i) => (
              <li key={i}>{t}</li>
            ))}
          </ul>
        </div>
      </div>
    </div>
  );
};

// Win Shares Widget
const WinSharesWidget = ({ isDark = true }) => {
  const leaders = [
    { name: 'Scottie Barnes', ws: 4.2 },
    { name: 'RJ Barrett', ws: 2.8 },
    { name: 'Jakob Poeltl', ws: 2.5 },
    { name: 'Immanuel Quickley', ws: 2.1 }
  ];
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Award className="w-3 h-3 text-emerald-400" /> Win Shares
        </h3>
      </div>
      
      <div className="space-y-2">
        {leaders.map((p, i) => (
          <div key={i}>
            <div className="flex justify-between text-[10px] mb-1">
              <span className={isDark ? 'text-slate-300' : 'text-slate-600'}>{p.name.split(' ')[1]}</span>
              <span className="font-bold text-emerald-400">{p.ws}</span>
            </div>
            <div className={`h-1.5 rounded-full overflow-hidden ${isDark ? 'bg-cmd-border' : 'bg-light-border'}`}>
              <div 
                className="h-full bg-gradient-to-r from-emerald-500 to-green-400 rounded-full"
                style={{width: `${(p.ws / 5) * 100}%`}}
              />
            </div>
          </div>
        ))}
      </div>
    </div>
  );
};

// Contract Situations Widget
const ContractWidget = ({ isDark = true }) => {
  const contracts = [
    { name: 'Chris Boucher', status: 'Expiring', value: '$9.5M' },
    { name: 'Bruce Brown', status: 'Player Opt', value: '$23M' },
    { name: 'Kelly Olynyk', status: 'Expiring', value: '$13M' }
  ];
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Gavel className="w-3 h-3 text-green-400" /> Contract Watch
        </h3>
      </div>
      
      <div className="space-y-2">
        {contracts.map((c, i) => (
          <div key={i} className="flex items-center justify-between text-[10px]">
            <span className={isDark ? 'text-slate-300' : 'text-slate-600'}>{c.name}</span>
            <div className="flex items-center gap-2">
              <span className={`px-1.5 py-0.5 rounded text-[9px] ${
                c.status === 'Expiring' ? 'bg-red-500/20 text-red-400' : 'bg-yellow-500/20 text-yellow-400'
              }`}>{c.status}</span>
              <span className="font-bold text-green-400">{c.value}</span>
            </div>
          </div>
        ))}
      </div>
    </div>
  );
};

// AI Prediction Breakdown Widget
const PredictionBreakdownWidget = ({ isDark = true, opponent }) => {
  const factors = [
    { name: 'Home Court', impact: '+5%', positive: true },
    { name: 'Rest Advantage', impact: '+3%', positive: true },
    { name: 'H2H Record', impact: '+2%', positive: true },
    { name: 'Injuries', impact: '-4%', positive: false },
    { name: 'Back-to-Back', impact: '0%', positive: true }
  ];
  
  const totalProb = 58;
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Brain className="w-3 h-3 text-purple-400" /> Win Factors
        </h3>
        <span className={`text-sm font-black ${totalProb >= 50 ? 'text-green-400' : 'text-red-400'}`}>{totalProb}%</span>
      </div>
      
      <div className="space-y-1">
        {factors.map((f, i) => (
          <div key={i} className="flex items-center justify-between text-[10px]">
            <span className={isDark ? 'text-slate-300' : 'text-slate-600'}>{f.name}</span>
            <span className={`font-bold ${f.positive ? 'text-green-400' : 'text-red-400'}`}>{f.impact}</span>
          </div>
        ))}
      </div>
    </div>
  );
};

// Minutes Distribution Widget
const MinutesDistributionWidget = ({ isDark = true }) => {
  const players = [
    { name: 'Barnes', mins: 36.2, pct: 90 },
    { name: 'Barrett', mins: 34.5, pct: 86 },
    { name: 'Quickley', mins: 32.8, pct: 82 },
    { name: 'Dick', mins: 28.4, pct: 71 },
    { name: 'Poeltl', mins: 27.2, pct: 68 }
  ];
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Clock className="w-3 h-3 text-cyan-400" /> Minutes
        </h3>
      </div>
      
      <div className="space-y-2">
        {players.map((p, i) => (
          <div key={i}>
            <div className="flex justify-between text-[10px] mb-1">
              <span className={isDark ? 'text-slate-300' : 'text-slate-600'}>{p.name}</span>
              <span className="font-bold">{p.mins}</span>
            </div>
            <div className={`h-1.5 rounded-full overflow-hidden ${isDark ? 'bg-cmd-border' : 'bg-light-border'}`}>
              <div className="h-full bg-cyan-500 rounded-full" style={{width: `${p.pct}%`}} />
            </div>
          </div>
        ))}
      </div>
    </div>
  );
};

// Record by Day Widget
const RecordByDayWidget = ({ isDark = true }) => {
  const days = [
    { day: 'Mon', record: '4-2' },
    { day: 'Tue', record: '3-4' },
    { day: 'Wed', record: '5-3' },
    { day: 'Thu', record: '2-5' },
    { day: 'Fri', record: '4-6' },
    { day: 'Sat', record: '5-6' },
    { day: 'Sun', record: '2-6' }
  ];
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Calendar className="w-3 h-3 text-indigo-400" /> By Day
        </h3>
      </div>
      
      <div className="grid grid-cols-7 gap-1 text-center">
        {days.map((d, i) => {
          const [w, l] = d.record.split('-').map(Number);
          const pct = w / (w + l);
          return (
            <div key={i} className={`p-1 rounded ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`}>
              <div className={`text-[8px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{d.day}</div>
              <div className={`text-[10px] font-bold ${pct >= 0.5 ? 'text-green-400' : 'text-red-400'}`}>{d.record}</div>
            </div>
          );
        })}
      </div>
    </div>
  );
};

// Comeback Tracker Widget
const ComebackTrackerWidget = ({ isDark = true }) => {
  const comebacks = {
    largestComeback: 18,
    largestDeficit: 24,
    winsWhenTrailingQ3: '3-12',
    winsWhenLeadingQ3: '18-8'
  };
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <TrendingUp className="w-3 h-3 text-green-400" /> Comebacks
        </h3>
      </div>
      
      <div className="grid grid-cols-2 gap-2 text-center mb-3">
        <div className={`p-2 rounded-lg ${isDark ? 'bg-green-500/10' : 'bg-green-500/5'}`}>
          <div className="text-lg font-black text-green-400">{comebacks.largestComeback}</div>
          <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>Largest W</div>
        </div>
        <div className={`p-2 rounded-lg ${isDark ? 'bg-red-500/10' : 'bg-red-500/5'}`}>
          <div className="text-lg font-black text-red-400">{comebacks.largestDeficit}</div>
          <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>Largest L</div>
        </div>
      </div>
      
      <div className={`space-y-1 text-[10px] ${isDark ? 'text-slate-300' : 'text-slate-600'}`}>
        <div className="flex justify-between">
          <span>Trailing after Q3</span>
          <span className="font-bold text-red-400">{comebacks.winsWhenTrailingQ3}</span>
        </div>
        <div className="flex justify-between">
          <span>Leading after Q3</span>
          <span className="font-bold text-green-400">{comebacks.winsWhenLeadingQ3}</span>
        </div>
      </div>
    </div>
  );
};

// National TV Widget
const NationalTVWidget = ({ isDark = true }) => {
  const tvRecord = {
    espn: '2-3',
    tnt: '1-2',
    nbatv: '3-4',
    overall: '6-9'
  };
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Radio className="w-3 h-3 text-purple-400" /> Nat'l TV
        </h3>
        <span className={`text-[9px] font-bold text-red-400`}>{tvRecord.overall}</span>
      </div>
      
      <div className={`grid grid-cols-3 gap-2 text-[10px] text-center ${isDark ? 'text-slate-300' : 'text-slate-600'}`}>
        <div className={`p-1 rounded ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`}>
          <div className={isDark ? 'text-slate-500' : 'text-slate-400'}>ESPN</div>
          <div className="font-bold">{tvRecord.espn}</div>
        </div>
        <div className={`p-1 rounded ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`}>
          <div className={isDark ? 'text-slate-500' : 'text-slate-400'}>TNT</div>
          <div className="font-bold">{tvRecord.tnt}</div>
        </div>
        <div className={`p-1 rounded ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`}>
          <div className={isDark ? 'text-slate-500' : 'text-slate-400'}>NBATV</div>
          <div className="font-bold">{tvRecord.nbatv}</div>
        </div>
      </div>
    </div>
  );
};

// Team Age Widget
const TeamAgeWidget = ({ isDark = true }) => {
  const age = {
    average: 25.2,
    youngest: 'Ja\'Kobe Walter (19)',
    oldest: 'Jakob Poeltl (29)',
    rank: 8
  };
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Users className="w-3 h-3 text-blue-400" /> Team Age
        </h3>
        <span className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>#{age.rank} youngest</span>
      </div>
      
      <div className="text-center mb-3">
        <div className={`text-2xl font-black ${isDark ? 'text-white' : 'text-slate-800'}`}>{age.average}</div>
        <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'} uppercase`}>Avg Age</div>
      </div>
      
      <div className={`space-y-1 text-[10px] ${isDark ? 'text-slate-300' : 'text-slate-600'}`}>
        <div className="flex justify-between">
          <span>Youngest</span>
          <span className="font-bold text-green-400">{age.youngest}</span>
        </div>
        <div className="flex justify-between">
          <span>Oldest</span>
          <span className="font-bold">{age.oldest}</span>
        </div>
      </div>
    </div>
  );
};

// Shot Clock Efficiency Widget
const ShotClockWidget = ({ isDark = true }) => {
  const shotClock = {
    early: { pct: 18.5, efg: 48.2 }, // 0-7 sec
    mid: { pct: 52.8, efg: 54.5 }, // 7-14 sec
    late: { pct: 28.7, efg: 46.8 } // 14-24 sec
  };
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Timer className="w-3 h-3 text-orange-400" /> Shot Clock
        </h3>
      </div>
      
      <div className="grid grid-cols-3 gap-2 text-center">
        <div className={`p-2 rounded-lg ${isDark ? 'bg-green-500/10' : 'bg-green-500/5'}`}>
          <div className="text-[9px] text-green-400 font-bold mb-1">Early</div>
          <div className={`text-xs font-black ${isDark ? 'text-white' : 'text-slate-800'}`}>{shotClock.early.efg}%</div>
          <div className={`text-[8px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>eFG</div>
        </div>
        <div className={`p-2 rounded-lg ${isDark ? 'bg-blue-500/10' : 'bg-blue-500/5'}`}>
          <div className="text-[9px] text-blue-400 font-bold mb-1">Mid</div>
          <div className={`text-xs font-black ${isDark ? 'text-white' : 'text-slate-800'}`}>{shotClock.mid.efg}%</div>
          <div className={`text-[8px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>eFG</div>
        </div>
        <div className={`p-2 rounded-lg ${isDark ? 'bg-orange-500/10' : 'bg-orange-500/5'}`}>
          <div className="text-[9px] text-orange-400 font-bold mb-1">Late</div>
          <div className={`text-xs font-black ${isDark ? 'text-white' : 'text-slate-800'}`}>{shotClock.late.efg}%</div>
          <div className={`text-[8px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>eFG</div>
        </div>
      </div>
    </div>
  );
};

// Venue Stats Widget
const VenueStatsWidget = ({ isDark = true }) => {
  const venues = [
    { arena: 'MSG', record: '2-1', ppg: 115.2 },
    { arena: 'United Center', record: '1-1', ppg: 108.5 },
    { arena: 'TD Garden', record: '0-2', ppg: 102.4 }
  ];
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Home className="w-3 h-3 text-teal-400" /> Road Venues
        </h3>
      </div>
      
      <div className="space-y-2">
        {venues.map((v, i) => {
          const [w, l] = v.record.split('-').map(Number);
          return (
            <div key={i} className="flex items-center justify-between text-[10px]">
              <span className={isDark ? 'text-slate-300' : 'text-slate-600'}>{v.arena}</span>
              <div className="flex items-center gap-2">
                <span className={`font-bold ${w > l ? 'text-green-400' : w < l ? 'text-red-400' : 'text-yellow-400'}`}>{v.record}</span>
                <span className={isDark ? 'text-slate-500' : 'text-slate-400'}>{v.ppg}</span>
              </div>
            </div>
          );
        })}
      </div>
    </div>
  );
};

// Double-Double Tracker Widget
const DoublDoubleWidget = ({ isDark = true }) => {
  const ddLeaders = [
    { name: 'Scottie Barnes', count: 18, type: 'PTS-REB' },
    { name: 'Jakob Poeltl', count: 12, type: 'PTS-REB' },
    { name: 'RJ Barrett', count: 5, type: 'PTS-AST' }
  ];
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Award className="w-3 h-3 text-amber-400" /> Double-Doubles
        </h3>
      </div>
      
      <div className="space-y-2">
        {ddLeaders.map((p, i) => (
          <div key={i} className="flex items-center justify-between text-[10px]">
            <span className={isDark ? 'text-slate-300' : 'text-slate-600'}>{p.name.split(' ')[1]}</span>
            <div className="flex items-center gap-2">
              <span className={`px-1.5 py-0.5 rounded text-[8px] ${isDark ? 'bg-cmd-bg text-slate-400' : 'bg-light-card text-slate-500'}`}>{p.type}</span>
              <span className="font-bold text-amber-400">{p.count}</span>
            </div>
          </div>
        ))}
      </div>
    </div>
  );
};

// Big Games Widget (30+ pt games)
const BigGamesWidget = ({ isDark = true }) => {
  const bigGames = [
    { player: 'Scottie Barnes', games: 8, high: 38 },
    { player: 'RJ Barrett', games: 4, high: 35 },
    { player: 'Immanuel Quickley', games: 2, high: 32 }
  ];
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Flame className="w-3 h-3 text-orange-400" /> 30+ Point Games
        </h3>
      </div>
      
      <div className="space-y-2">
        {bigGames.map((p, i) => (
          <div key={i} className={`p-2 rounded-lg ${isDark ? 'bg-orange-500/10' : 'bg-orange-500/5'}`}>
            <div className="flex justify-between items-center">
              <span className={`text-[10px] font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{p.player.split(' ')[1]}</span>
              <span className="text-[10px] font-bold text-orange-400">{p.games}x</span>
            </div>
            <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>Season high: {p.high} pts</div>
          </div>
        ))}
      </div>
    </div>
  );
};

// Record by Margin Widget
const RecordByMarginWidget = ({ isDark = true }) => {
  const margins = {
    blowoutWins: { record: '8-0', margin: '+15' },
    closeWins: { record: '8-8', margin: '1-5' },
    closeLosses: { record: '6-10', margin: '1-5' },
    blowoutLosses: { record: '0-12', margin: '-15' }
  };
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <BarChart3 className="w-3 h-3 text-purple-400" /> By Margin
        </h3>
      </div>
      
      <div className="grid grid-cols-2 gap-2">
        <div className={`p-2 rounded-lg text-center ${isDark ? 'bg-green-500/10' : 'bg-green-500/5'}`}>
          <div className="text-xs font-black text-green-400">{margins.blowoutWins.record}</div>
          <div className={`text-[8px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>Blowout W</div>
        </div>
        <div className={`p-2 rounded-lg text-center ${isDark ? 'bg-yellow-500/10' : 'bg-yellow-500/5'}`}>
          <div className="text-xs font-black text-yellow-400">{margins.closeWins.record}</div>
          <div className={`text-[8px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>Close W</div>
        </div>
        <div className={`p-2 rounded-lg text-center ${isDark ? 'bg-orange-500/10' : 'bg-orange-500/5'}`}>
          <div className="text-xs font-black text-orange-400">{margins.closeLosses.record}</div>
          <div className={`text-[8px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>Close L</div>
        </div>
        <div className={`p-2 rounded-lg text-center ${isDark ? 'bg-red-500/10' : 'bg-red-500/5'}`}>
          <div className="text-xs font-black text-red-400">{margins.blowoutLosses.record}</div>
          <div className={`text-[8px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>Blowout L</div>
        </div>
      </div>
    </div>
  );
};

// Half Performance Widget
const HalfPerformanceWidget = ({ isDark = true }) => {
  const halves = {
    first: { ppg: 55.2, oppg: 54.8, margin: 0.4 },
    second: { ppg: 56.3, oppg: 58.0, margin: -1.7 }
  };
  
  const betterHalf = halves.first.margin > halves.second.margin ? '1st' : '2nd';
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <LayoutTemplate className="w-3 h-3 text-blue-400" /> Half Performance
        </h3>
        <span className={`text-[9px] px-1.5 py-0.5 rounded bg-blue-500/20 text-blue-400`}>{betterHalf} Half Team</span>
      </div>
      
      <div className="grid grid-cols-2 gap-2">
        <div className={`p-2 rounded-lg text-center ${halves.first.margin > 0 ? (isDark ? 'bg-green-500/10' : 'bg-green-500/5') : (isDark ? 'bg-cmd-bg' : 'bg-light-card')}`}>
          <div className={`text-sm font-black ${halves.first.margin > 0 ? 'text-green-400' : isDark ? 'text-white' : 'text-slate-800'}`}>
            {halves.first.margin > 0 ? '+' : ''}{halves.first.margin}
          </div>
          <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>1st Half</div>
          <div className={`text-[8px] ${isDark ? 'text-slate-600' : 'text-slate-400'}`}>{halves.first.ppg} vs {halves.first.oppg}</div>
        </div>
        <div className={`p-2 rounded-lg text-center ${halves.second.margin > 0 ? (isDark ? 'bg-green-500/10' : 'bg-green-500/5') : (isDark ? 'bg-cmd-bg' : 'bg-light-card')}`}>
          <div className={`text-sm font-black ${halves.second.margin > 0 ? 'text-green-400' : 'text-red-400'}`}>
            {halves.second.margin > 0 ? '+' : ''}{halves.second.margin}
          </div>
          <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>2nd Half</div>
          <div className={`text-[8px] ${isDark ? 'text-slate-600' : 'text-slate-400'}`}>{halves.second.ppg} vs {halves.second.oppg}</div>
        </div>
      </div>
    </div>
  );
};

// Travel Schedule Widget
const TravelWidget = ({ isDark = true }) => {
  const travel = {
    totalMiles: 28500,
    gamesOnRoad: 29,
    longestTrip: '5 games (West Coast)',
    nextTrip: '2 games'
  };
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Plane className="w-3 h-3 text-sky-400" /> Travel Log
        </h3>
      </div>
      
      <div className="text-center mb-3">
        <div className={`text-xl font-black ${isDark ? 'text-white' : 'text-slate-800'}`}>{(travel.totalMiles / 1000).toFixed(1)}K</div>
        <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'} uppercase`}>Miles Traveled</div>
      </div>
      
      <div className={`space-y-1 text-[10px] ${isDark ? 'text-slate-300' : 'text-slate-600'}`}>
        <div className="flex justify-between">
          <span>Road Games</span>
          <span className="font-bold">{travel.gamesOnRoad}</span>
        </div>
        <div className="flex justify-between">
          <span>Longest Trip</span>
          <span className="font-bold">{travel.longestTrip}</span>
        </div>
      </div>
    </div>
  );
};

// Starter vs Bench Widget
const StarterVsBenchWidget = ({ isDark = true }) => {
  const comparison = {
    starters: { ppg: 72.8, plus: 2.5, mins: 168 },
    bench: { ppg: 38.5, plus: -1.2, mins: 72 }
  };
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Users className="w-3 h-3 text-violet-400" /> Starters vs Bench
        </h3>
      </div>
      
      <div className="grid grid-cols-2 gap-2">
        <div className={`p-2 rounded-lg text-center ${isDark ? 'bg-violet-500/10' : 'bg-violet-500/5'}`}>
          <div className="text-xs font-bold text-violet-400 mb-1">Starters</div>
          <div className={`text-lg font-black ${isDark ? 'text-white' : 'text-slate-800'}`}>{comparison.starters.ppg}</div>
          <div className={`text-[9px] ${comparison.starters.plus > 0 ? 'text-green-400' : 'text-red-400'}`}>
            +/-: {comparison.starters.plus > 0 ? '+' : ''}{comparison.starters.plus}
          </div>
        </div>
        <div className={`p-2 rounded-lg text-center ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`}>
          <div className={`text-xs font-bold ${isDark ? 'text-slate-400' : 'text-slate-500'} mb-1`}>Bench</div>
          <div className={`text-lg font-black ${isDark ? 'text-white' : 'text-slate-800'}`}>{comparison.bench.ppg}</div>
          <div className={`text-[9px] ${comparison.bench.plus > 0 ? 'text-green-400' : 'text-red-400'}`}>
            +/-: {comparison.bench.plus > 0 ? '+' : ''}{comparison.bench.plus}
          </div>
        </div>
      </div>
    </div>
  );
};

// Efficiency Leaders Widget
const EfficiencyWidget = ({ isDark = true }) => {
  const leaders = [
    { name: 'Scottie Barnes', per: 21.8, ts: 57.2 },
    { name: 'Jakob Poeltl', per: 18.5, ts: 62.4 },
    { name: 'RJ Barrett', per: 17.5, ts: 54.8 }
  ];
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Gauge className="w-3 h-3 text-emerald-400" /> Efficiency
        </h3>
      </div>
      
      <div className="space-y-2">
        {leaders.map((p, i) => (
          <div key={i} className={`p-2 rounded-lg ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`}>
            <div className="flex justify-between items-center mb-1">
              <span className={`text-[10px] font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{p.name.split(' ')[1]}</span>
            </div>
            <div className="flex justify-between text-[9px]">
              <span className={isDark ? 'text-slate-400' : 'text-slate-500'}>PER: <span className="text-emerald-400 font-bold">{p.per}</span></span>
              <span className={isDark ? 'text-slate-400' : 'text-slate-500'}>TS%: <span className="text-cyan-400 font-bold">{p.ts}%</span></span>
            </div>
          </div>
        ))}
      </div>
    </div>
  );
};

// Assist to Turnover Widget
const AstToWidget = ({ isDark = true }) => {
  const leaders = [
    { name: 'Quickley', ast: 6.2, to: 2.1, ratio: 2.95 },
    { name: 'Barnes', ast: 5.6, to: 2.7, ratio: 2.07 },
    { name: 'Barrett', ast: 3.5, to: 1.6, ratio: 2.19 }
  ];
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <ArrowRightLeft className="w-3 h-3 text-blue-400" /> AST/TO
        </h3>
      </div>
      
      <div className="space-y-2">
        {leaders.map((p, i) => (
          <div key={i} className="flex items-center justify-between text-[10px]">
            <span className={isDark ? 'text-slate-300' : 'text-slate-600'}>{p.name}</span>
            <div className="flex items-center gap-2">
              <span className={isDark ? 'text-slate-500' : 'text-slate-400'}>{p.ast}/{p.to}</span>
              <span className={`font-bold ${p.ratio >= 2.5 ? 'text-green-400' : 'text-yellow-400'}`}>{p.ratio.toFixed(2)}</span>
            </div>
          </div>
        ))}
      </div>
    </div>
  );
};

// Predicted Score Widget
const PredictedScoreWidget = ({ isDark = true, opponent }) => {
  const prediction = {
    raptors: 112,
    opponent: 108,
    confidence: 62
  };
  
  return (
    <div className={`${isDark ? 'glass-card border-green-500/30' : 'bg-white border border-green-300 shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Brain className="w-3 h-3 text-green-400" /> Predicted Score
        </h3>
        <span className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{prediction.confidence}% conf</span>
      </div>
      
      <div className="flex items-center justify-center gap-4">
        <div className="text-center">
          <div className="text-2xl font-black text-raptors-red">{prediction.raptors}</div>
          <div className={`text-[10px] ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>TOR</div>
        </div>
        <div className={`text-xl font-bold ${isDark ? 'text-slate-600' : 'text-slate-400'}`}>-</div>
        <div className="text-center">
          <div className={`text-2xl font-black ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>{prediction.opponent}</div>
          <div className={`text-[10px] ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>{opponent?.slice(0,3) || 'OPP'}</div>
        </div>
      </div>
      
      <div className={`mt-3 text-center text-[10px] ${isDark ? 'text-green-400' : 'text-green-600'}`}>
        Raptors by {prediction.raptors - prediction.opponent} ðŸ€
      </div>
    </div>
  );
};

// Key Stats to Watch Widget
const KeyStatsWidget = ({ isDark = true, opponent }) => {
  const keyStats = [
    { stat: 'Transition D', why: `${opponent} ranks 5th in fast break pts` },
    { stat: 'Rebounding', why: 'Must win the boards' },
    { stat: '3PT Defense', why: 'Contest every shot' }
  ];
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Eye className="w-3 h-3 text-amber-400" /> Keys to Watch
        </h3>
      </div>
      
      <div className="space-y-2">
        {keyStats.map((k, i) => (
          <div key={i} className={`p-2 rounded-lg ${isDark ? 'bg-amber-500/10' : 'bg-amber-500/5'}`}>
            <div className={`text-[10px] font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{i + 1}. {k.stat}</div>
            <div className={`text-[9px] ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>{k.why}</div>
          </div>
        ))}
      </div>
    </div>
  );
};

// Points Off Assists Widget
const PointsOffAssistsWidget = ({ isDark = true }) => {
  const stats = {
    ptsOffAst: 62.5,
    pctAssisted: 56.2,
    rank: 14
  };
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Share className="w-3 h-3 text-cyan-400" /> Team Ball
        </h3>
        <span className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>#{stats.rank}</span>
      </div>
      
      <div className="grid grid-cols-2 gap-2 text-center">
        <div className={`p-2 rounded-lg ${isDark ? 'bg-cyan-500/10' : 'bg-cyan-500/5'}`}>
          <div className="text-xl font-black text-cyan-400">{stats.ptsOffAst}</div>
          <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>Pts Off AST</div>
        </div>
        <div className={`p-2 rounded-lg ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`}>
          <div className={`text-xl font-black ${isDark ? 'text-white' : 'text-slate-800'}`}>{stats.pctAssisted}%</div>
          <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>Assisted FG</div>
        </div>
      </div>
    </div>
  );
};

// vs League Average Widget
const VsLeagueAvgWidget = ({ isDark = true }) => {
  const comparison = [
    { stat: 'PPG', team: 111.5, league: 114.2, diff: -2.7 },
    { stat: 'RPG', team: 45.0, league: 43.8, diff: 1.2 },
    { stat: '3P%', team: 34.3, league: 36.1, diff: -1.8 },
    { stat: 'APG', team: 26.2, league: 25.8, diff: 0.4 }
  ];
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <BarChart3 className="w-3 h-3 text-indigo-400" /> vs League Avg
        </h3>
      </div>
      
      <div className="space-y-2">
        {comparison.map((c, i) => (
          <div key={i} className="flex items-center justify-between text-[10px]">
            <span className={isDark ? 'text-slate-400' : 'text-slate-500'}>{c.stat}</span>
            <div className="flex items-center gap-2">
              <span className={`font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{c.team}</span>
              <span className={`${c.diff > 0 ? 'text-green-400' : 'text-red-400'}`}>
                ({c.diff > 0 ? '+' : ''}{c.diff.toFixed(1)})
              </span>
            </div>
          </div>
        ))}
      </div>
    </div>
  );
};

// Fan Prediction Widget
const FanPredictionWidget = ({ isDark = true }) => {
  const [userPrediction, setUserPrediction] = useState(null);
  
  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <MessageCircle className="w-3 h-3 text-pink-400" /> Your Pick
        </h3>
      </div>
      
      {userPrediction ? (
        <div className="text-center">
          <div className={`text-xl font-black ${userPrediction === 'raptors' ? 'text-raptors-red' : isDark ? 'text-slate-400' : 'text-slate-600'}`}>
            {userPrediction === 'raptors' ? 'Raptors W! ðŸ¦–' : 'Loss ðŸ˜¢'}
          </div>
          <button
            onClick={() => setUserPrediction(null)}
            className={`mt-2 text-[10px] ${isDark ? 'text-slate-500 hover:text-slate-300' : 'text-slate-400 hover:text-slate-600'}`}
          >
            Change pick
          </button>
        </div>
      ) : (
        <div className="grid grid-cols-2 gap-2">
          <button
            onClick={() => setUserPrediction('raptors')}
            className={`p-3 rounded-lg text-center transition-all hover:scale-105 ${isDark ? 'bg-raptors-red/20 hover:bg-raptors-red/30' : 'bg-raptors-red/10 hover:bg-raptors-red/20'}`}
          >
            <span className="text-lg">ðŸ¦–</span>
            <div className={`text-[10px] font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>Raptors W</div>
          </button>
          <button
            onClick={() => setUserPrediction('loss')}
            className={`p-3 rounded-lg text-center transition-all hover:scale-105 ${isDark ? 'bg-cmd-bg hover:bg-cmd-card' : 'bg-light-card hover:bg-slate-200'}`}
          >
            <span className="text-lg">ðŸ˜¢</span>
            <div className={`text-[10px] font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>Loss</div>
          </button>
        </div>
      )}
    </div>
  );
};

// Fun Facts Ticker
const FunFactsTicker = ({ isDark = true }) => {
  const [currentFact, setCurrentFact] = useState(0);
  
  useEffect(() => {
    const interval = setInterval(() => {
      setCurrentFact(prev => (prev + 1) % FUN_FACTS.length);
    }, 5000);
    return () => clearInterval(interval);
  }, []);

  return (
    <div className={`${isDark ? 'bg-gradient-to-r from-raptors-red/10 via-raptors-purple/10 to-raptors-red/10' : 'bg-gradient-to-r from-raptors-red/5 via-raptors-purple/5 to-raptors-red/5'} px-4 py-2 text-center`}>
      <div className="flex items-center justify-center gap-2">
        <Sparkles className={`w-3 h-3 ${isDark ? 'text-yellow-400' : 'text-yellow-500'}`} />
        <span className={`text-xs ${isDark ? 'text-slate-300' : 'text-slate-600'}`} key={currentFact} style={{animation: 'fade-in 0.5s ease-out'}}>
          {FUN_FACTS[currentFact]}
        </span>
        <Sparkles className={`w-3 h-3 ${isDark ? 'text-yellow-400' : 'text-yellow-500'}`} />
      </div>
    </div>
  );
};

// Team Salary Cap Widget
const TeamSalaryWidget = ({ isDark = true, teamName = 'Raptors', opponentName }) => {
  const [showOpponent, setShowOpponent] = useState(false);
  const currentTeam = showOpponent && opponentName ? opponentName : teamName;
  const salaryData = TEAM_SALARIES[currentTeam];
  
  if (!salaryData) return null;
  
  const capPct = (salaryData.total / NBA_SALARY_CAP.cap) * 100;
  const taxPct = (salaryData.total / NBA_SALARY_CAP.luxuryTax) * 100;
  const isOverCap = salaryData.total > NBA_SALARY_CAP.cap;
  const isOverTax = salaryData.total > NBA_SALARY_CAP.luxuryTax;
  
  // Get top 5 paid players
  const topPlayers = Object.entries(salaryData.roster)
    .sort((a, b) => b[1].salary - a[1].salary)
    .slice(0, 5);

  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4 overflow-hidden`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <span className="text-green-400">ðŸ’°</span> Team Salary
        </h3>
        {opponentName && TEAM_SALARIES[opponentName] && (
          <button 
            onClick={() => setShowOpponent(!showOpponent)}
            className={`text-[9px] px-2 py-1 rounded ${isDark ? 'bg-cmd-bg hover:bg-cmd-card' : 'bg-light-card hover:bg-slate-200'} transition-colors`}
          >
            {showOpponent ? 'TOR' : opponentName.slice(0, 3).toUpperCase()}
          </button>
        )}
      </div>
      
      {/* Total Salary */}
      <div className={`text-center p-3 rounded-xl mb-3 ${isDark ? 'bg-gradient-to-br from-green-500/10 to-emerald-500/5 border border-green-500/20' : 'bg-green-50 border border-green-200'}`}>
        <div className={`text-2xl font-black ${isDark ? 'text-green-400' : 'text-green-600'}`}>{formatSalary(salaryData.total)}</div>
        <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'} uppercase`}>Total Payroll 2025-26</div>
      </div>
      
      {/* Cap Situation */}
      <div className="space-y-2 mb-3">
        <div>
          <div className="flex justify-between items-center text-[10px] mb-1">
            <span className={isDark ? 'text-slate-400' : 'text-slate-500'}>Salary Cap ({formatSalary(NBA_SALARY_CAP.cap)})</span>
            <span className={`font-bold ${isOverCap ? 'text-red-400' : 'text-green-400'}`}>{capPct.toFixed(0)}%</span>
          </div>
          <div className={`h-2 rounded-full overflow-hidden ${isDark ? 'bg-cmd-border' : 'bg-light-border'}`}>
            <div 
              className={`h-full rounded-full transition-all ${isOverCap ? 'bg-red-500' : 'bg-green-500'}`}
              style={{width: `${Math.min(capPct, 100)}%`, boxShadow: isOverCap ? '0 0 10px rgba(239,68,68,0.5)' : '0 0 10px rgba(34,197,94,0.5)'}}
            />
          </div>
        </div>
        <div>
          <div className="flex justify-between items-center text-[10px] mb-1">
            <span className={isDark ? 'text-slate-400' : 'text-slate-500'}>Luxury Tax ({formatSalary(NBA_SALARY_CAP.luxuryTax)})</span>
            <span className={`font-bold ${isOverTax ? 'text-amber-400' : 'text-slate-400'}`}>{taxPct.toFixed(0)}%</span>
          </div>
          <div className={`h-2 rounded-full overflow-hidden ${isDark ? 'bg-cmd-border' : 'bg-light-border'}`}>
            <div 
              className={`h-full rounded-full transition-all ${isOverTax ? 'bg-amber-500' : 'bg-slate-500'}`}
              style={{width: `${Math.min(taxPct, 100)}%`}}
            />
          </div>
        </div>
      </div>
      
      {/* Cap Space / Tax Bill */}
      <div className="grid grid-cols-2 gap-2 mb-3">
        <div className={`text-center p-2 rounded-lg ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`}>
          <div className={`text-sm font-mono font-bold ${salaryData.capSpace > 0 ? 'text-green-400' : 'text-red-400'}`}>
            {salaryData.capSpace > 0 ? '+' : ''}{formatSalary(salaryData.capSpace)}
          </div>
          <div className={`text-[8px] ${isDark ? 'text-slate-500' : 'text-slate-400'} uppercase`}>Cap Space</div>
        </div>
        <div className={`text-center p-2 rounded-lg ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`}>
          <div className={`text-sm font-mono font-bold ${salaryData.luxuryTaxBill > 0 ? 'text-amber-400' : 'text-green-400'}`}>
            {formatSalary(salaryData.luxuryTaxBill)}
          </div>
          <div className={`text-[8px] ${isDark ? 'text-slate-500' : 'text-slate-400'} uppercase`}>Tax Bill</div>
        </div>
      </div>
      
      {/* Top Paid Players */}
      <div className={`border-t ${isDark ? 'border-cmd-border' : 'border-light-border'} pt-3`}>
        <div className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'} uppercase mb-2`}>Top 5 Contracts</div>
        <div className="space-y-1.5">
          {topPlayers.map(([playerId, contract], i) => {
            // Try to find player name using the helper function
            let playerName = findPlayerName(playerId, currentTeam);
            
            // Fallback to contract type + salary tier
            if (!playerName) {
              const salaryTier = contract.salary > 30000000 ? 'Star' : contract.salary > 15000000 ? 'Starter' : 'Role';
              playerName = `${salaryTier} Player`;
            }
            return (
              <div key={playerId} className="flex items-center justify-between text-[10px]">
                <span className={`truncate max-w-[60%] ${isDark ? 'text-slate-300' : 'text-slate-600'}`}>
                  {i + 1}. {playerName.split(' ').pop()}
                </span>
                <span className={`font-mono font-bold ${isDark ? 'text-green-400' : 'text-green-600'}`}>{formatSalary(contract.salary)}</span>
              </div>
            );
          })}
        </div>
      </div>
    </div>
  );
};

// Quick Compare Modal
const QuickCompareWidget = ({ isDark = true }) => {
  const [player1, setPlayer1] = useState(RAPTORS_ROSTER[0]);
  const [player2, setPlayer2] = useState(RAPTORS_ROSTER[1]);
  
  const stats = ['ppg', 'rpg', 'apg'];
  const statLabels = { ppg: 'PPG', rpg: 'RPG', apg: 'APG' };

  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          <Swords className="w-3 h-3 text-orange-400" /> Quick Compare
          <span style={{fontSize:'0.5rem',background:'linear-gradient(135deg,#CE1141,#3E2680)',color:'#fff',padding:'1px 6px',borderRadius:'9999px',fontWeight:800,letterSpacing:'0.5px',marginLeft:'4px'}}>NEW</span>
        </h3>
      </div>
      <div className="flex gap-2 mb-3">
        <select 
          value={player1.id} 
          onChange={(e) => setPlayer1(RAPTORS_ROSTER.find(p => p.id === e.target.value) || RAPTORS_ROSTER[0])}
          className={`flex-1 text-xs p-1.5 rounded ${isDark ? 'bg-cmd-bg border-cmd-border text-white' : 'bg-light-card border-light-border text-slate-800'} border`}
        >
          {RAPTORS_ROSTER.slice(0, 8).map(p => <option key={p.id} value={p.id}>{p.name.split(' ').pop()}</option>)}
        </select>
        <span className={`text-xs font-bold ${isDark ? 'text-slate-500' : 'text-slate-400'} self-center`}>vs</span>
        <select 
          value={player2.id} 
          onChange={(e) => setPlayer2(RAPTORS_ROSTER.find(p => p.id === e.target.value) || RAPTORS_ROSTER[1])}
          className={`flex-1 text-xs p-1.5 rounded ${isDark ? 'bg-cmd-bg border-cmd-border text-white' : 'bg-light-card border-light-border text-slate-800'} border`}
        >
          {RAPTORS_ROSTER.slice(0, 8).map(p => <option key={p.id} value={p.id}>{p.name.split(' ').pop()}</option>)}
        </select>
      </div>
      <div className="space-y-2">
        {stats.map(stat => {
          const v1 = player1.seasonStats?.[stat] || 0;
          const v2 = player2.seasonStats?.[stat] || 0;
          const winner = v1 > v2 ? 1 : v2 > v1 ? 2 : 0;
          return (
            <div key={stat} className="flex items-center gap-2 text-xs">
              <span className={`w-8 font-mono font-bold text-right ${winner === 1 ? 'text-green-400' : isDark ? 'text-white' : 'text-slate-800'}`}>{v1.toFixed(1)}</span>
              <div className="flex-1 h-1.5 rounded-full overflow-hidden flex bg-cmd-border">
                <div className="bg-raptors-red h-full" style={{width: `${(v1 / (v1 + v2 || 1)) * 100}%`}}></div>
                <div className="bg-blue-500 h-full flex-1"></div>
              </div>
              <span className={`w-8 font-mono font-bold ${winner === 2 ? 'text-green-400' : isDark ? 'text-white' : 'text-slate-800'}`}>{v2.toFixed(1)}</span>
              <span className={`w-8 text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{statLabels[stat]}</span>
            </div>
          );
        })}
      </div>
    </div>
  );
};

// Loading Skeleton
const SkeletonCard = ({ isDark = true }) => (
  <div className={`${isDark ? 'bg-cmd-card' : 'bg-light-card'} rounded-xl p-4 animate-pulse`}>
    <div className={`h-4 ${isDark ? 'bg-cmd-border' : 'bg-light-border'} rounded w-3/4 mb-3`}></div>
    <div className={`h-3 ${isDark ? 'bg-cmd-border' : 'bg-light-border'} rounded w-1/2 mb-2`}></div>
    <div className={`h-3 ${isDark ? 'bg-cmd-border' : 'bg-light-border'} rounded w-2/3`}></div>
  </div>
);

// ============================================================
// TEAM STATS COMPARISON WIDGET (Head-to-Head)
// ============================================================
const TeamStatsComparisonWidget = ({ isDark = true, opponent }) => {
  const opponentData = OPPONENT_DATA[opponent];
  if (!opponent || !opponentData) return null;

  // Calculate opponent team averages from roster
  const oppRoster = opponentData.roster || [];
  const oppStats = {
    ppg: oppRoster.reduce((s, p) => s + (p.seasonStats?.ppg || 0), 0),
    rpg: oppRoster.reduce((s, p) => s + (p.seasonStats?.rpg || 0), 0),
    apg: oppRoster.reduce((s, p) => s + (p.seasonStats?.apg || 0), 0),
  };

  const stats = [
    { label: 'PPG', rap: RAPTORS_STATS.ppg, opp: oppStats.ppg > 0 ? oppStats.ppg.toFixed(1) : '108.5' },
    { label: 'RPG', rap: RAPTORS_STATS.rpg || 44.2, opp: oppStats.rpg > 0 ? oppStats.rpg.toFixed(1) : '42.8' },
    { label: 'APG', rap: RAPTORS_STATS.apg || 26.8, opp: oppStats.apg > 0 ? oppStats.apg.toFixed(1) : '24.5' },
    { label: 'FG%', rap: RAPTORS_STATS.fgPct || 47.5, opp: 46.2 },
    { label: '3P%', rap: RAPTORS_STATS.threePtPct || 36.2, opp: 35.1 },
    { label: 'Record', rap: `${RAPTORS_STATS.wins}-${RAPTORS_STATS.losses}`, opp: null, isRecord: true },
  ];

  return (
    <div className={`${isDark ? 'premium-glass' : 'bg-white border border-light-border shadow-lg'} rounded-2xl p-4`}>
      <div className="flex items-center gap-2 mb-3">
        <BarChart3 className="w-4 h-4 text-raptors-red" />
        <h3 className={`text-xs font-bold uppercase ${isDark ? 'text-white' : 'text-slate-800'}`}>Head-to-Head Stats</h3>
      </div>
      <div className="flex justify-between items-center mb-3 text-[10px] font-bold uppercase">
        <span className="text-raptors-red">Raptors</span>
        <span className={isDark ? 'text-slate-500' : 'text-slate-400'}>vs</span>
        <span className="text-blue-400">{opponent}</span>
      </div>
      <div className="space-y-2">
        {stats.filter(s => !s.isRecord).map(({ label, rap, opp }) => {
          const rapVal = parseFloat(rap);
          const oppVal = parseFloat(opp);
          const total = rapVal + oppVal || 1;
          const rapPct = (rapVal / total) * 100;
          const rapWins = rapVal > oppVal;
          return (
            <div key={label}>
              <div className="flex justify-between text-[10px] mb-0.5">
                <span className={`font-mono font-bold ${rapWins ? 'text-green-400' : isDark ? 'text-white' : 'text-slate-700'}`}>{typeof rap === 'number' ? rap.toFixed(1) : rap}</span>
                <span className={`${isDark ? 'text-slate-500' : 'text-slate-400'} font-bold`}>{label}</span>
                <span className={`font-mono font-bold ${!rapWins ? 'text-green-400' : isDark ? 'text-white' : 'text-slate-700'}`}>{typeof opp === 'number' ? opp.toFixed(1) : opp}</span>
              </div>
              <div className="flex h-1.5 rounded-full overflow-hidden gap-0.5">
                <div className="bg-raptors-red rounded-full transition-all duration-700" style={{width: `${rapPct}%`}}></div>
                <div className="bg-blue-500 rounded-full flex-1"></div>
              </div>
            </div>
          );
        })}
        {/* Record row */}
        <div className="flex justify-between items-center pt-1 border-t border-cmd-border/50">
          <span className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{RAPTORS_STATS.wins}-{RAPTORS_STATS.losses}</span>
          <span className={`text-[10px] font-bold ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>RECORD</span>
          <span className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>â€”</span>
        </div>
      </div>
    </div>
  );
};

// ============================================================
// SEASON TRACKER WIDGET
// ============================================================
const SeasonTrackerWidget = ({ isDark = true, games }) => {
  // Compute monthly records and streak from completed games
  const completedGames = games.filter(g => g.status === 'completed' && g.result);
  
  const monthlyRecords = {};
  completedGames.forEach(g => {
    const month = g.date.split(' ')[0]; // "Jan", "Feb", etc.
    if (!monthlyRecords[month]) monthlyRecords[month] = { wins: 0, losses: 0 };
    if (g.result.startsWith('W')) monthlyRecords[month].wins++;
    else monthlyRecords[month].losses++;
  });

  // Current streak
  let streakCount = 0;
  let streakType = '';
  for (let i = completedGames.length - 1; i >= 0; i--) {
    const isWin = completedGames[i].result.startsWith('W');
    const type = isWin ? 'W' : 'L';
    if (streakType === '') streakType = type;
    if (type === streakType) streakCount++;
    else break;
  }

  // Last 15 games
  const last15 = completedGames.slice(-15);

  return (
    <div className={`${isDark ? 'premium-glass' : 'bg-white border border-light-border shadow-lg'} rounded-2xl p-4`}>
      <div className="flex items-center gap-2 mb-3">
        <History className="w-4 h-4 text-purple-400" />
        <h3 className={`text-xs font-bold uppercase ${isDark ? 'text-white' : 'text-slate-800'}`}>Season Tracker</h3>
      </div>
      
      {/* Current Streak */}
      <div className={`flex items-center gap-2 mb-3 p-2 rounded-lg ${streakType === 'W' ? 'bg-green-500/10 border border-green-500/20' : 'bg-red-500/10 border border-red-500/20'}`}>
        <Flame className={`w-4 h-4 ${streakType === 'W' ? 'text-green-400' : 'text-red-400'}`} />
        <span className={`text-xs font-bold ${streakType === 'W' ? 'text-green-400' : 'text-red-400'}`}>
          {streakCount} Game {streakType === 'W' ? 'Win' : 'Loss'} Streak
        </span>
      </div>

      {/* Monthly Records */}
      <div className="mb-3">
        <div className={`text-[10px] font-bold uppercase mb-1.5 ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>Monthly</div>
        <div className="grid grid-cols-2 gap-1">
          {Object.entries(monthlyRecords).map(([month, rec]) => (
            <div key={month} className={`flex items-center justify-between px-2 py-1 rounded ${isDark ? 'bg-cmd-bg' : 'bg-light-card'} text-[10px]`}>
              <span className={`font-bold ${isDark ? 'text-slate-300' : 'text-slate-600'}`}>{month}</span>
              <span className={`font-mono font-bold ${rec.wins > rec.losses ? 'text-green-400' : rec.wins < rec.losses ? 'text-red-400' : isDark ? 'text-white' : 'text-slate-700'}`}>{rec.wins}-{rec.losses}</span>
            </div>
          ))}
        </div>
      </div>

      {/* Win/Loss Timeline - Last 15 */}
      <div>
        <div className={`text-[10px] font-bold uppercase mb-1.5 ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>Last 15 Games</div>
        <div className="flex gap-1 flex-wrap">
          {last15.map((g, i) => {
            const isWin = g.result.startsWith('W');
            return (
              <div
                key={i}
                title={`${g.date} vs ${g.opponent}: ${g.result}`}
                className={`w-4 h-4 rounded-full ${isWin ? 'bg-green-500' : 'bg-red-500'} cursor-default transition-transform hover:scale-125`}
              ></div>
            );
          })}
        </div>
      </div>
    </div>
  );
};

// ============================================================
// RAPTORS PULSE (News Feed) WIDGET
// ============================================================
const RaptorsPulseWidget = ({ isDark = true }) => {
  const categoryColors = {
    'Trade Rumor': 'bg-orange-500/20 text-orange-400 border-orange-500/30',
    'Injury': 'bg-red-500/20 text-red-400 border-red-500/30',
    'Recap': 'bg-green-500/20 text-green-400 border-green-500/30',
    'Analysis': 'bg-blue-500/20 text-blue-400 border-blue-500/30',
    'Award': 'bg-yellow-500/20 text-yellow-400 border-yellow-500/30',
    'Feature': 'bg-purple-500/20 text-purple-400 border-purple-500/30',
  };

  return (
    <div className={`${isDark ? 'premium-glass' : 'bg-white border border-light-border shadow-lg'} rounded-2xl p-4`}>
      <div className="flex items-center gap-2 mb-3">
        <Radio className="w-4 h-4 text-raptors-red animate-pulse" />
        <h3 className={`text-xs font-bold uppercase ${isDark ? 'text-white' : 'text-slate-800'}`}>Raptors Pulse</h3>
      </div>
      <div className="space-y-2 max-h-64 overflow-y-auto custom-scrollbar pr-1">
        {RAPTORS_NEWS.map(item => (
          <div key={item.id} className={`p-2.5 rounded-lg ${isDark ? 'bg-cmd-bg/80 hover:bg-cmd-card' : 'bg-light-card hover:bg-slate-200'} transition-colors cursor-default`}>
            <div className="flex items-start justify-between gap-2 mb-1">
              <span className={`text-[11px] font-semibold leading-tight ${isDark ? 'text-white' : 'text-slate-800'}`}>{item.headline}</span>
            </div>
            <div className="flex items-center gap-2 flex-wrap">
              <span className={`text-[9px] px-1.5 py-0.5 rounded border font-bold ${categoryColors[item.category] || 'bg-slate-500/20 text-slate-400 border-slate-500/30'}`}>{item.category}</span>
              <span className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{item.source}</span>
              <span className={`text-[9px] ${isDark ? 'text-slate-600' : 'text-slate-300'}`}>â€¢</span>
              <span className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{item.timeAgo}</span>
            </div>
          </div>
        ))}
      </div>
    </div>
  );
};

// Scroll to Top Button
const ScrollToTop = ({ isDark = true }) => {
  const [isVisible, setIsVisible] = useState(false);
  
  useEffect(() => {
    const toggleVisibility = () => {
      const scrollContainer = document.querySelector('.custom-scrollbar');
      if (scrollContainer && scrollContainer.scrollTop > 300) {
        setIsVisible(true);
      } else {
        setIsVisible(false);
      }
    };
    
    const scrollContainer = document.querySelector('.custom-scrollbar');
    if (scrollContainer) {
      scrollContainer.addEventListener('scroll', toggleVisibility);
      return () => scrollContainer.removeEventListener('scroll', toggleVisibility);
    }
  }, []);

  const scrollToTop = () => {
    const scrollContainer = document.querySelector('.custom-scrollbar');
    if (scrollContainer) {
      scrollContainer.scrollTo({ top: 0, behavior: 'smooth' });
    }
  };

  if (!isVisible) return null;

  return (
    <button
      onClick={scrollToTop}
      className={`fixed bottom-20 right-4 z-40 p-3 rounded-full shadow-lg transition-all transform hover:scale-110 ${isDark ? 'bg-raptors-red text-white shadow-raptors-red/30' : 'bg-raptors-red text-white shadow-raptors-red/30'}`}
      title="Scroll to top"
    >
      <ChevronUp className="w-5 h-5" />
    </button>
  );
};

// ============================================================
// DRAFT WATCH WIDGET
// ============================================================
const DraftWatchWidget = ({ isDark = true }) => {
  const [activeTab, setActiveTab] = useState('prospects');
  const prospects = DRAFT_DATA.prospects;
  const tankWatch = DRAFT_DATA.tankWatch;
  const lotteryOdds = DRAFT_DATA.lotteryOdds;
  
  return (
    <div className={`${isDark ? 'premium-glass' : 'bg-white border border-light-border shadow-lg'} rounded-2xl p-4`}>
      <div className="flex items-center gap-2 mb-3">
        <Target className="w-4 h-4 text-raptors-red" />
        <h3 className={`text-xs font-bold uppercase ${isDark ? 'text-white' : 'text-slate-800'}`}>ðŸŽ¯ Draft Watch 2026</h3>
        <div className={`text-[9px] ${isDark ? 'text-slate-400' : 'text-slate-500'} mt-1`}>Raptors own their 2026 1st â€” projected late 1st round (~21st pick). Top prospects for lottery teams:</div>
      </div>
      
      {/* Projected Pick Card */}
      <div className={`${isDark ? 'bg-gradient-to-r from-raptors-red/20 to-raptors-purple/20 border border-raptors-red/30' : 'bg-raptors-red/5 border border-raptors-red/20'} rounded-xl p-3 mb-3`}>
        <div className="flex justify-between items-center">
          <div>
            <div className={`text-[10px] uppercase ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>Current Record</div>
            <div className={`text-lg font-black ${isDark ? 'text-white' : 'text-slate-800'}`}>{RAPTORS_STATS.wins}-{RAPTORS_STATS.losses}</div>
          </div>
          <div className="text-center">
            <div className={`text-[10px] uppercase ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>Projected Pick</div>
            <div className="text-2xl font-black text-raptors-red">#{DRAFT_DATA.raptorsRecord.projectedSeed > 10 ? 'N/A' : DRAFT_DATA.raptorsRecord.projectedSeed}</div>
          </div>
          <div className="text-right">
            <div className={`text-[10px] uppercase ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>Lottery Odds</div>
            <div className={`text-sm font-bold ${isDark ? 'text-yellow-400' : 'text-yellow-600'}`}>
              {DRAFT_DATA.raptorsRecord.projectedSeed <= 14 ? `${lotteryOdds[DRAFT_DATA.raptorsRecord.projectedSeed - 1]?.first}%` : 'N/A'}
            </div>
          </div>
        </div>
      </div>

      {/* Tabs */}
      <div className="flex gap-1 mb-3">
        {['prospects', 'odds', 'tank'].map(tab => (
          <button key={tab} onClick={() => setActiveTab(tab)}
            className={`flex-1 text-[10px] font-bold uppercase py-1.5 rounded-lg transition-all ${activeTab === tab 
              ? 'bg-raptors-red text-white' 
              : isDark ? 'bg-cmd-bg text-slate-400 hover:text-white' : 'bg-light-card text-slate-500 hover:text-slate-800'}`}>
            {tab === 'prospects' ? 'â­ Prospects' : tab === 'odds' ? 'ðŸŽ² Odds' : 'ðŸ“‰ Tank'}
          </button>
        ))}
      </div>

      {/* Prospects Tab */}
      {activeTab === 'prospects' && (
        <div className="space-y-2 max-h-[400px] overflow-y-auto custom-scrollbar pr-1">
          {prospects.map((p, i) => (
            <div key={i} className={`${isDark ? 'bg-cmd-bg/80 hover:bg-cmd-card' : 'bg-light-card hover:bg-slate-200'} rounded-xl p-3 transition-all cursor-pointer group`}>
              <div className="flex items-start gap-3">
                <div className={`w-10 h-10 rounded-full ${isDark ? 'bg-cmd-card border border-cmd-border' : 'bg-slate-200 border border-slate-300'} flex items-center justify-center text-lg font-black flex-shrink-0`}>
                  <span className="text-raptors-red text-xs">#{i + 1}</span>
                </div>
                <div className="flex-1 min-w-0">
                  <div className="flex items-center gap-1.5">
                    <span className={`text-sm font-bold ${isDark ? 'text-white' : 'text-slate-800'} truncate`}>{p.emoji} {p.name}</span>
                  </div>
                  <div className={`text-[10px] ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>{p.school} Â· {p.position} Â· Range: {p.projected}</div>
                  <div className={`text-[10px] ${isDark ? 'text-slate-500' : 'text-slate-400'} mt-0.5`}>{p.stats}</div>
                  <div className="flex items-center gap-1 mt-1">
                    <span className={`text-[9px] px-1.5 py-0.5 rounded-full ${isDark ? 'bg-raptors-red/20 text-raptors-red' : 'bg-raptors-red/10 text-raptors-red'}`}>
                      Comp: {p.comparison}
                    </span>
                  </div>
                </div>
              </div>
            </div>
          ))}
        </div>
      )}

      {/* Lottery Odds Tab */}
      {activeTab === 'odds' && (
        <div className="space-y-1.5 max-h-[400px] overflow-y-auto custom-scrollbar pr-1">
          <div className={`text-[10px] ${isDark ? 'text-slate-500' : 'text-slate-400'} mb-2`}>NBA Draft Lottery Probabilities</div>
          {lotteryOdds.map((o) => (
            <div key={o.seed} className="flex items-center gap-2">
              <span className={`text-[10px] w-6 text-right font-bold ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>#{o.seed}</span>
              <div className="flex-1 h-4 bg-cmd-bg rounded-full overflow-hidden relative">
                <div className="h-full rounded-full bg-gradient-to-r from-raptors-red to-raptors-purple transition-all" style={{ width: `${o.first * 5}%` }}></div>
                <span className={`absolute inset-0 flex items-center justify-center text-[9px] font-bold ${isDark ? 'text-white' : 'text-slate-700'}`}>{o.first}%</span>
              </div>
              <span className={`text-[9px] w-12 ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>Top 4: {o.top4}%</span>
            </div>
          ))}
        </div>
      )}

      {/* Tank Watch Tab */}
      {activeTab === 'tank' && (
        <div className="space-y-1.5 max-h-[400px] overflow-y-auto custom-scrollbar pr-1">
          <div className={`text-[10px] ${isDark ? 'text-slate-500' : 'text-slate-400'} mb-2`}>Teams competing for lottery position</div>
          {tankWatch.map((t, i) => (
            <div key={i} className={`flex items-center gap-2 p-2 rounded-lg ${isDark ? 'bg-cmd-bg/80' : 'bg-light-card'}`}>
              <span className={`text-[10px] font-bold w-4 ${isDark ? 'text-yellow-400' : 'text-yellow-600'}`}>#{t.lotteryPos}</span>
              <span className={`text-xs font-bold flex-1 ${isDark ? 'text-white' : 'text-slate-800'}`}>{t.team}</span>
              <span className={`text-[10px] ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>{t.wins}-{t.losses}</span>
              <span className={`text-[10px] font-bold ${isDark ? 'text-slate-300' : 'text-slate-600'}`}>{t.pct}</span>
              <div className="w-16 h-2 bg-cmd-bg rounded-full overflow-hidden">
                <div className="h-full bg-gradient-to-r from-green-500 to-red-500 rounded-full" style={{ width: `${(1 - (t.wins / (t.wins + t.losses))) * 100}%` }}></div>
              </div>
            </div>
          ))}
        </div>
      )}
    </div>
  );
};

// ============================================================
// PLAYER DETAIL MODAL
// ============================================================
const PlayerDetailModal = ({ player, isDark = true, onClose }) => {
  // Keyboard: Escape to close
  React.useEffect(() => {
    const handler = (e) => { if (e.key === 'Escape') onClose(); };
    window.addEventListener('keydown', handler);
    return () => window.removeEventListener('keydown', handler);
  }, [onClose]);

  if (!player) return null;
  
  const stats = player.seasonStats || {};
  const last5 = PLAYER_LAST_5_GAMES[player.name] || [];
  
  // Position averages for comparison
  const posAvg = {
    PG: { ppg: 15.2, rpg: 3.8, apg: 6.4, fgPct: 44.5 },
    SG: { ppg: 16.8, rpg: 3.5, apg: 3.2, fgPct: 45.0 },
    SF: { ppg: 15.5, rpg: 5.2, apg: 2.8, fgPct: 46.2 },
    PF: { ppg: 14.8, rpg: 6.8, apg: 2.5, fgPct: 48.0 },
    C: { ppg: 12.5, rpg: 8.5, apg: 2.0, fgPct: 55.0 },
  };
  const pos = player.position?.replace(/\/.*/, '') || 'SF';
  const avg = posAvg[pos] || posAvg.SF;
  
  const compStats = [
    { label: 'PPG', val: stats.ppg, avg: avg.ppg },
    { label: 'RPG', val: stats.rpg, avg: avg.rpg },
    { label: 'APG', val: stats.apg, avg: avg.apg },
    { label: 'FG%', val: stats.fgPct, avg: avg.fgPct },
  ];

  return (
    <div className="fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in" role="dialog" aria-modal="true" aria-label={`Player details for ${player.name}`} onClick={onClose}>
      <div className={`${isDark ? 'bg-cmd-surface border-cmd-border' : 'bg-white border-light-border'} border rounded-2xl max-w-lg w-full max-h-[85vh] overflow-y-auto shadow-2xl transform transition-all`}
        onClick={e => e.stopPropagation()} style={{animation: 'slide-up 0.3s ease-out'}}>
        {/* Header */}
        <div className="relative p-5 bg-gradient-to-r from-raptors-red/30 to-raptors-purple/20 rounded-t-2xl">
          <button onClick={onClose} aria-label="Close player details" className={`absolute top-3 right-3 p-1.5 rounded-full ${isDark ? 'hover:bg-white/10 text-white' : 'hover:bg-black/10 text-slate-700'} transition-colors`}>
            <X className="w-5 h-5" />
          </button>
          <div className="flex items-center gap-4">
            <div className={`w-16 h-16 rounded-full ${isDark ? 'bg-cmd-bg border-2 border-raptors-red/50' : 'bg-light-card border-2 border-raptors-red/30'} flex items-center justify-center`}>
              <span className="text-2xl font-black text-raptors-red">#{player.number}</span>
            </div>
            <div>
              <h2 className={`text-xl font-black ${isDark ? 'text-white' : 'text-slate-800'}`}>{player.name}</h2>
              <div className={`text-sm ${isDark ? 'text-slate-300' : 'text-slate-600'}`}>{player.position} Â· #{player.number}</div>
            </div>
          </div>
        </div>
        
        {/* Season Averages */}
        <div className="p-4">
          <h4 className={`text-xs font-bold uppercase mb-2 ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>Season Averages</h4>
          <div className="grid grid-cols-4 gap-2 mb-4">
            {[
              { label: 'PPG', val: stats.ppg },
              { label: 'RPG', val: stats.rpg },
              { label: 'APG', val: stats.apg },
              { label: 'FG%', val: stats.fgPct },
              { label: '3P%', val: stats.threePtPct },
              { label: 'FT%', val: stats.ftPct },
              { label: 'SPG', val: stats.spg },
              { label: '+/-', val: stats.plusMinus },
            ].map((s, i) => (
              <div key={i} className={`${isDark ? 'bg-cmd-bg' : 'bg-light-card'} rounded-lg p-2 text-center`}>
                <div className={`text-[10px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{s.label}</div>
                <div className={`text-sm font-black ${isDark ? 'text-white' : 'text-slate-800'}`}>{s.val ?? 'â€”'}</div>
              </div>
            ))}
          </div>
          
          {/* Last 5 Games */}
          {last5.length > 0 && (
            <>
              <h4 className={`text-xs font-bold uppercase mb-2 ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>Last 5 Games</h4>
              <div className="space-y-1 mb-4">
                <div className={`grid grid-cols-7 text-[9px] font-bold uppercase ${isDark ? 'text-slate-500' : 'text-slate-400'} px-2`}>
                  <span>Date</span><span>OPP</span><span>PTS</span><span>REB</span><span>AST</span><span>FG</span><span>W/L</span>
                </div>
                {last5.map((g, i) => (
                  <div key={i} className={`grid grid-cols-7 text-[10px] px-2 py-1.5 rounded-lg ${isDark ? 'bg-cmd-bg/50 text-slate-300' : 'bg-light-card text-slate-600'}`}>
                    <span>{g.date}</span>
                    <span className="font-bold">{g.opp}</span>
                    <span className="font-bold">{g.pts}</span>
                    <span>{g.reb}</span>
                    <span>{g.ast}</span>
                    <span>{g.fgm}/{g.fga}</span>
                    <span className={g.result === 'W' ? 'text-green-500 font-bold' : 'text-red-400 font-bold'}>{g.result}</span>
                  </div>
                ))}
              </div>
            </>
          )}
          
          {/* Shot Chart Placeholder */}
          <h4 className={`text-xs font-bold uppercase mb-2 ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>Shot Chart</h4>
          <div className={`${isDark ? 'bg-cmd-bg border border-cmd-border' : 'bg-light-card border border-light-border'} rounded-xl p-8 mb-4 flex items-center justify-center`}>
            <div className="text-center">
              <Target className={`w-8 h-8 mx-auto mb-2 ${isDark ? 'text-slate-600' : 'text-slate-300'}`} />
              <span className={`text-xs ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>Shot chart coming soon</span>
            </div>
          </div>
          
          {/* Vs Position Average */}
          <h4 className={`text-xs font-bold uppercase mb-2 ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>vs {pos} Average</h4>
          <div className="space-y-2">
            {compStats.map((c, i) => {
              const diff = (c.val || 0) - c.avg;
              const pct = Math.min(((c.val || 0) / (c.avg * 2)) * 100, 100);
              return (
                <div key={i} className="flex items-center gap-2">
                  <span className={`text-[10px] w-8 font-bold ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>{c.label}</span>
                  <div className="flex-1 h-3 bg-cmd-bg rounded-full overflow-hidden relative">
                    <div className={`h-full rounded-full ${diff >= 0 ? 'bg-green-500' : 'bg-red-500'}`} style={{ width: `${pct}%` }}></div>
                  </div>
                  <span className={`text-[10px] font-bold w-12 text-right ${diff >= 0 ? 'text-green-500' : 'text-red-400'}`}>
                    {diff >= 0 ? '+' : ''}{diff.toFixed(1)}
                  </span>
                </div>
              );
            })}
          </div>
        </div>
      </div>
    </div>
  );
};

// ============================================================
// INJURY DASHBOARD WIDGET
// ============================================================
const InjuryDashboardWidget = ({ isDark = true }) => {
  const statusColors = {
    Out: { bg: 'bg-red-500/20', text: 'text-red-400', border: 'border-red-500/30' },
    Doubtful: { bg: 'bg-orange-500/20', text: 'text-orange-400', border: 'border-orange-500/30' },
    Questionable: { bg: 'bg-yellow-500/20', text: 'text-yellow-400', border: 'border-yellow-500/30' },
    Probable: { bg: 'bg-green-500/20', text: 'text-green-400', border: 'border-green-500/30' },
  };
  
  const totalGamesOut = INJURY_DATA.reduce((sum, p) => sum + p.gamesOut, 0);
  
  return (
    <div className={`${isDark ? 'premium-glass' : 'bg-white border border-light-border shadow-lg'} rounded-2xl p-4`}>
      <div className="flex items-center justify-between mb-3">
        <div className="flex items-center gap-2">
          <Heart className="w-4 h-4 text-red-500" />
          <h3 className={`text-xs font-bold uppercase ${isDark ? 'text-white' : 'text-slate-800'}`}>ðŸ¥ Injury Dashboard</h3>
        </div>
        <span className={`text-[10px] px-2 py-0.5 rounded-full ${isDark ? 'bg-red-500/20 text-red-400' : 'bg-red-50 text-red-600'}`}>
          {totalGamesOut} total games missed
        </span>
      </div>
      
      <div className="space-y-2">
        {INJURY_DATA.map((p, i) => {
          const sc = statusColors[p.status] || statusColors.Out;
          const impactWidth = (p.impact / 10) * 100;
          
          return (
            <div key={i} className={`${isDark ? 'bg-cmd-bg/80' : 'bg-light-card'} rounded-xl p-3`}>
              <div className="flex items-start justify-between mb-1.5">
                <div>
                  <span className={`text-sm font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{p.player}</span>
                  <div className={`text-[10px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{p.injury}</div>
                </div>
                <span className={`text-[10px] font-bold px-2 py-0.5 rounded-full ${sc.bg} ${sc.text} border ${sc.border}`}>
                  {p.status}
                </span>
              </div>
              
              {/* Impact Bar */}
              <div className="flex items-center gap-2 mb-1.5">
                <span className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>Impact</span>
                <div className={`flex-1 h-1.5 ${isDark ? 'bg-cmd-card' : 'bg-slate-200'} rounded-full overflow-hidden`}>
                  <div className={`h-full rounded-full ${p.impact >= 8 ? 'bg-red-500' : p.impact >= 5 ? 'bg-yellow-500' : 'bg-green-500'}`} style={{ width: `${impactWidth}%` }}></div>
                </div>
                <span className={`text-[9px] font-bold ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>{p.ppg} PPG</span>
              </div>
              
              {/* Return Timeline */}
              <div className="flex items-center justify-between">
                <span className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>
                  Est. return: <span className={`font-bold ${isDark ? 'text-slate-300' : 'text-slate-600'}`}>{p.returnDate}</span>
                </span>
                <span className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>
                  {p.gamesOut} games missed
                </span>
              </div>
            </div>
          );
        })}
      </div>
    </div>
  );
};

// APP (ROOT)
// ============================================================
// Section Navigation Bar
const SectionNav = ({ isDark = true }) => {
  const { toggle } = React.useContext(ThemeContext);
  const sections = [
    { id: 'sec-hero', label: 'ðŸ  Hero', key: '1' },
    { id: 'sec-matchup', label: 'âš”ï¸ Matchup', key: '2' },
    { id: 'sec-standings', label: 'ðŸ† Standings', key: '3' },
    { id: 'sec-draft', label: 'ðŸ“‹ Draft Watch', key: '4' },
    { id: 'sec-trade', label: 'ðŸ’¼ Trade Room', key: '5' },
    { id: 'sec-analytics', label: 'ðŸ“Š Analytics', key: '6' },
    { id: 'sec-schedule', label: 'ðŸ“… Schedule', key: '7' },
  ];
  const handlePrint = () => {
    window.print();
  };
  return (
    <nav className="section-nav flex items-center gap-1 no-print" role="navigation" aria-label="Section navigation">
      {sections.map((s, i) => (
        <a key={i} href={`#${s.id}`} aria-label={`Jump to ${s.label.replace(/[^\w\s]/g, '').trim()} section (${s.key})`} onClick={(e) => { e.preventDefault(); const el = document.getElementById(s.id); if (el) el.scrollIntoView({ behavior: 'smooth' }); else document.getElementById('main-content')?.scrollIntoView({ behavior: 'smooth' }); }}>
          {s.label}
        </a>
      ))}
      <div className="ml-auto flex items-center gap-1 flex-shrink-0">
        <button onClick={handlePrint} className={`flex items-center gap-1 px-3 py-1.5 rounded-full text-[0.7rem] font-bold uppercase tracking-wide transition-all ${isDark ? 'bg-cmd-bg/80 border border-cmd-border text-slate-400 hover:text-white hover:bg-cmd-card' : 'bg-light-card border border-light-border text-slate-500 hover:text-slate-800 hover:bg-slate-200'}`} aria-label="Print report (P)" title="Print Report (P)">
          ðŸ–¨ï¸ Print
        </button>
        <button onClick={toggle} className={`flex items-center gap-1.5 px-3 py-1.5 rounded-full text-[0.7rem] font-bold uppercase tracking-wide transition-all ${isDark ? 'bg-yellow-500/10 border border-yellow-500/30 text-yellow-400 hover:bg-yellow-500/20' : 'bg-blue-500/10 border border-blue-500/30 text-blue-600 hover:bg-blue-500/20'}`} aria-label={isDark ? 'Switch to light mode (D)' : 'Switch to dark mode (D)'} title={isDark ? 'Light Mode (D)' : 'Dark Mode (D)'}>
          {isDark ? 'â˜€ï¸ Light' : 'ðŸŒ™ Dark'}
        </button>
      </div>
    </nav>
  );
};

// Skeleton Loading Placeholder
const SkeletonBlock = ({ rows = 5 }) => (
  <div className="p-4 space-y-3">
    {Array.from({ length: rows }).map((_, i) => (
      <div key={i} className="skeleton-row">
        <div className="skeleton-bar" style={{ width: '2rem', height: '0.875rem' }}></div>
        <div className="skeleton-bar" style={{ flex: 1, height: '0.875rem', opacity: 1 - i * 0.1 }}></div>
      </div>
    ))}
  </div>
);

// ============================================================
// INTERACTIVE ENGAGEMENT WIDGETS (v10.7)
// ============================================================

// 1. Game Prediction Poll Widget
const GamePredictionPoll = ({ isDark = true }) => {
  const STORAGE_KEY = 'raptors_prediction_feb11';
  const [vote, setVote] = useState(() => {
    try { return JSON.parse(localStorage.getItem(STORAGE_KEY)); } catch { return null; }
  });
  const [confidence, setConfidence] = useState(() => {
    try { return parseInt(localStorage.getItem(STORAGE_KEY + '_conf')) || 5; } catch { return 5; }
  });
  const [allVotes, setAllVotes] = useState(() => {
    try { return JSON.parse(localStorage.getItem(STORAGE_KEY + '_all')) || { yes: 47, no: 23 }; } catch { return { yes: 47, no: 23 }; }
  });

  const handleVote = (choice) => {
    if (vote) return;
    const updated = { ...allVotes, [choice]: allVotes[choice] + 1 };
    setAllVotes(updated);
    setVote(choice);
    localStorage.setItem(STORAGE_KEY, JSON.stringify(choice));
    localStorage.setItem(STORAGE_KEY + '_conf', confidence);
    localStorage.setItem(STORAGE_KEY + '_all', JSON.stringify(updated));
  };

  const total = allVotes.yes + allVotes.no;
  const yesPct = total > 0 ? Math.round((allVotes.yes / total) * 100) : 50;
  const noPct = 100 - yesPct;

  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <div className="flex items-center justify-between mb-3">
        <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase`}>
          ðŸ—³ï¸ Game Prediction
        </h3>
        <span className={`text-[9px] px-2 py-0.5 rounded-full ${isDark ? 'bg-raptors-red/20 text-raptors-red' : 'bg-raptors-red/10 text-raptors-red'} font-bold`}>LIVE</span>
      </div>
      <p className={`text-sm font-medium mb-3 ${isDark ? 'text-white' : 'text-slate-800'}`}>
        Will the Raptors beat the Pistons on Feb 11? ðŸ¦–ðŸ€
      </p>
      <div className="flex gap-2 mb-3">
        <button onClick={() => handleVote('yes')} disabled={!!vote}
          className={`flex-1 py-2 rounded-lg text-sm font-bold transition-all ${vote === 'yes' ? 'bg-green-500 text-white scale-105' : vote ? 'bg-green-500/10 text-green-400 opacity-60' : isDark ? 'bg-green-500/20 text-green-400 hover:bg-green-500/40 hover:scale-105' : 'bg-green-100 text-green-700 hover:bg-green-200'}`}>
          âœ… YES
        </button>
        <button onClick={() => handleVote('no')} disabled={!!vote}
          className={`flex-1 py-2 rounded-lg text-sm font-bold transition-all ${vote === 'no' ? 'bg-red-500 text-white scale-105' : vote ? 'bg-red-500/10 text-red-400 opacity-60' : isDark ? 'bg-red-500/20 text-red-400 hover:bg-red-500/40 hover:scale-105' : 'bg-red-100 text-red-700 hover:bg-red-200'}`}>
          âŒ NO
        </button>
      </div>
      {vote && (
        <div className="animate-fade-in">
          <div className="flex justify-between text-[10px] mb-1">
            <span className={isDark ? 'text-green-400' : 'text-green-600'}>Yes {yesPct}%</span>
            <span className={isDark ? 'text-red-400' : 'text-red-600'}>No {noPct}%</span>
          </div>
          <div className={`w-full h-3 rounded-full overflow-hidden flex ${isDark ? 'bg-cmd-bg' : 'bg-light-card'}`}>
            <div className="bg-green-500 h-full transition-all duration-700" style={{ width: `${yesPct}%` }}></div>
            <div className="bg-red-500 h-full flex-1"></div>
          </div>
          <div className={`text-[10px] text-center mt-1 ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{total} votes</div>
        </div>
      )}
      <div className="mt-3">
        <label className={`text-[10px] font-bold uppercase ${isDark ? 'text-slate-400' : 'text-slate-500'} flex justify-between`}>
          <span>Confidence Meter</span>
          <span className="text-raptors-red">{confidence}/10</span>
        </label>
        <input type="range" min="1" max="10" value={confidence}
          onChange={(e) => { setConfidence(parseInt(e.target.value)); if (vote) localStorage.setItem(STORAGE_KEY + '_conf', e.target.value); }}
          className="w-full h-1.5 mt-1 rounded-full appearance-none cursor-pointer"
          style={{ background: `linear-gradient(to right, #CE1141 ${(confidence - 1) * 11.1}%, ${isDark ? '#1e293b' : '#e2e8f0'} ${(confidence - 1) * 11.1}%)` }}
        />
      </div>
    </div>
  );
};

// 2. Player Comparison Tool
const PlayerComparisonTool = ({ isDark = true }) => {
  const [p1Idx, setP1Idx] = useState(0);
  const [p2Idx, setP2Idx] = useState(3);
  const players = RAPTORS_ROSTER.filter(p => p.seasonStats);
  const p1 = players[p1Idx] || players[0];
  const p2 = players[p2Idx] || players[1];
  const categories = [
    { key: 'ppg', label: 'PPG' },
    { key: 'rpg', label: 'RPG' },
    { key: 'apg', label: 'APG' },
    { key: 'fgPct', label: 'FG%' },
    { key: 'threePtPct', label: '3P%' },
  ];

  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase mb-3`}>
        ðŸ“Š Player Comparison Tool
      </h3>
      <div className="flex gap-2 mb-4">
        <select value={p1Idx} onChange={e => setP1Idx(parseInt(e.target.value))}
          className={`flex-1 text-xs p-1.5 rounded ${isDark ? 'bg-cmd-bg border-cmd-border text-white' : 'bg-light-card border-light-border text-slate-800'} border`}>
          {players.map((p, i) => <option key={p.id} value={i}>{p.name}</option>)}
        </select>
        <span className={`text-xs font-bold self-center ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>vs</span>
        <select value={p2Idx} onChange={e => setP2Idx(parseInt(e.target.value))}
          className={`flex-1 text-xs p-1.5 rounded ${isDark ? 'bg-cmd-bg border-cmd-border text-white' : 'bg-light-card border-light-border text-slate-800'} border`}>
          {players.map((p, i) => <option key={p.id} value={i}>{p.name}</option>)}
        </select>
      </div>
      <div className="space-y-3">
        {categories.map(({ key, label }) => {
          const v1 = p1.seasonStats?.[key] || 0;
          const v2 = p2.seasonStats?.[key] || 0;
          const max = Math.max(v1, v2, 1);
          return (
            <div key={key}>
              <div className="flex justify-between text-[10px] mb-1">
                <span className={`font-bold ${v1 >= v2 ? 'text-green-400' : isDark ? 'text-white' : 'text-slate-700'}`}>{v1.toFixed(1)}</span>
                <span className={`font-bold uppercase ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>{label}</span>
                <span className={`font-bold ${v2 >= v1 ? 'text-green-400' : isDark ? 'text-white' : 'text-slate-700'}`}>{v2.toFixed(1)}</span>
              </div>
              <div className="flex gap-1 h-2.5">
                <div className="flex-1 flex justify-end">
                  <div className={`h-full rounded-l-full bg-raptors-red transition-all duration-700`}
                    style={{ width: `${(v1 / max) * 100}%` }}></div>
                </div>
                <div className="flex-1">
                  <div className={`h-full rounded-r-full bg-blue-500 transition-all duration-700`}
                    style={{ width: `${(v2 / max) * 100}%` }}></div>
                </div>
              </div>
            </div>
          );
        })}
      </div>
      <div className={`flex justify-between mt-3 pt-2 border-t ${isDark ? 'border-cmd-border' : 'border-light-border'} text-[10px]`}>
        <span className="text-raptors-red font-bold">#{p1.number} {p1.name.split(' ').pop()}</span>
        <span className="text-blue-400 font-bold">#{p2.number} {p2.name.split(' ').pop()}</span>
      </div>
    </div>
  );
};

// 3. Season Milestones Timeline
const SeasonTimelineWidget = ({ isDark = true }) => {
  const milestones = [
    { date: 'Oct 22', label: 'Season Opener', desc: 'Raptors tip off 2025-26 season', icon: 'ðŸ€', done: true },
    { date: 'Nov 8', label: 'First Win Streak', desc: '4-game winning streak begins', icon: 'ðŸ”¥', done: true },
    { date: 'Dec 15', label: 'CP3 Acquired', desc: 'Chris Paul trade from Spurs', icon: 'ðŸ¤', done: true },
    { date: 'Feb 6', label: 'Trade Deadline', desc: 'TJD acquired from Warriors', icon: 'ðŸ“‹', done: true },
    { date: 'Feb 16', label: 'All-Star Break', desc: 'Scottie Barnes All-Star nod', icon: 'â­', done: false },
    { date: 'Now', label: 'Current Position', desc: '25-32 Â· 11th in East', icon: 'ðŸ“', done: false, current: true },
  ];

  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase mb-4`}>
        ðŸ“… Season Milestones
      </h3>
      <div className="relative pl-6">
        <div className={`absolute left-2 top-0 bottom-0 w-0.5 ${isDark ? 'bg-cmd-border' : 'bg-light-border'}`}></div>
        {milestones.map((m, i) => (
          <div key={i} className="relative mb-4 last:mb-0">
            <div className={`absolute -left-4 w-3 h-3 rounded-full border-2 ${m.current ? 'bg-raptors-red border-raptors-red animate-pulse' : m.done ? 'bg-green-500 border-green-500' : isDark ? 'bg-cmd-bg border-cmd-border-light' : 'bg-white border-light-border-light'}`}></div>
            <div className={`text-[9px] font-bold uppercase ${m.current ? 'text-raptors-red' : isDark ? 'text-slate-500' : 'text-slate-400'}`}>{m.date}</div>
            <div className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'}`}>{m.icon} {m.label}</div>
            <div className={`text-[10px] ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>{m.desc}</div>
          </div>
        ))}
      </div>
    </div>
  );
};

// 4. Quick Quiz Widget
const RaptorsQuizWidget = ({ isDark = true }) => {
  const questions = [
    { q: "Who did the Raptors acquire from the Spurs?", options: ["Chris Paul", "Victor Wembanyama", "Keldon Johnson", "Devin Vassell"], answer: 0 },
    { q: "What is Jakob Poeltl's jersey number?", options: ["25", "42", "19", "7"], answer: 2 },
    { q: "Who was acquired from the Warriors at the trade deadline?", options: ["Kuminga", "Trayce Jackson-Davis", "Wiggins", "Moody"], answer: 1 },
    { q: "What pick was Scottie Barnes in the 2021 draft?", options: ["1st", "2nd", "4th", "7th"], answer: 2 },
    { q: "Which Raptor leads the team in assists per game?", options: ["Scottie Barnes", "Immanuel Quickley", "RJ Barrett", "Chris Paul"], answer: 1 },
  ];

  const QUIZ_KEY = 'raptors_quiz_state';
  const [current, setCurrent] = useState(0);
  const [score, setScore] = useState(0);
  const [selected, setSelected] = useState(null);
  const [finished, setFinished] = useState(() => {
    try { return JSON.parse(localStorage.getItem(QUIZ_KEY))?.finished || false; } catch { return false; }
  });
  const [savedScore, setSavedScore] = useState(() => {
    try { return JSON.parse(localStorage.getItem(QUIZ_KEY))?.score || 0; } catch { return 0; }
  });

  const handleAnswer = (idx) => {
    if (selected !== null) return;
    setSelected(idx);
    const correct = idx === questions[current].answer;
    const newScore = correct ? score + 1 : score;
    if (correct) setScore(newScore);
    setTimeout(() => {
      if (current + 1 >= questions.length) {
        setFinished(true);
        setSavedScore(newScore);
        localStorage.setItem(QUIZ_KEY, JSON.stringify({ finished: true, score: newScore }));
      } else {
        setCurrent(current + 1);
        setSelected(null);
      }
    }, 1000);
  };

  const reset = () => {
    setCurrent(0); setScore(0); setSelected(null); setFinished(false);
    localStorage.removeItem(QUIZ_KEY);
  };

  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase mb-3`}>
        ðŸ§  Test Your Raptors Knowledge
        <span style={{fontSize:'0.5rem',background:'linear-gradient(135deg,#CE1141,#3E2680)',color:'#fff',padding:'1px 6px',borderRadius:'9999px',fontWeight:800,letterSpacing:'0.5px',marginLeft:'4px'}}>NEW</span>
      </h3>
      {finished ? (
        <div className="text-center animate-fade-in">
          <div className="text-3xl mb-2">{savedScore >= 4 ? 'ðŸ†' : savedScore >= 2 ? 'ðŸ‘' : 'ðŸ“š'}</div>
          <div className={`text-lg font-black ${isDark ? 'text-white' : 'text-slate-800'}`}>{savedScore}/{questions.length}</div>
          <div className={`text-xs mb-3 ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>
            {savedScore === 5 ? 'Perfect! True Raptors fan!' : savedScore >= 3 ? 'Nice! You know your Raptors!' : 'Keep watching â€” you\'ll get there!'}
          </div>
          <button onClick={reset} className="text-[10px] font-bold text-raptors-red hover:underline">ðŸ”„ Try Again</button>
        </div>
      ) : (
        <div className="animate-fade-in">
          <div className="flex justify-between mb-2">
            <span className={`text-[10px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>Q{current + 1}/{questions.length}</span>
            <span className={`text-[10px] font-bold text-green-400`}>Score: {score}</span>
          </div>
          <p className={`text-sm font-medium mb-3 ${isDark ? 'text-white' : 'text-slate-800'}`}>{questions[current].q}</p>
          <div className="space-y-1.5">
            {questions[current].options.map((opt, i) => {
              const isCorrect = i === questions[current].answer;
              const isSelected = selected === i;
              let cls = isDark ? 'bg-cmd-bg hover:bg-cmd-card' : 'bg-light-card hover:bg-light-border';
              if (selected !== null) {
                if (isCorrect) cls = 'bg-green-500/20 border-green-500/50';
                else if (isSelected) cls = 'bg-red-500/20 border-red-500/50';
              }
              return (
                <button key={i} onClick={() => handleAnswer(i)} disabled={selected !== null}
                  className={`w-full text-left text-xs p-2 rounded-lg transition-all border border-transparent ${cls} ${isDark ? 'text-white' : 'text-slate-800'}`}>
                  {opt} {selected !== null && isCorrect && 'âœ…'} {selected !== null && isSelected && !isCorrect && 'âŒ'}
                </button>
              );
            })}
          </div>
        </div>
      )}
    </div>
  );
};

// 5. Social Share Buttons
const SocialShareWidget = ({ isDark = true }) => {
  const shareText = "Check out the Raptors Intel dashboard! ðŸ€ðŸ¦–";
  const shareUrl = "https://rajkcho.github.io/raptorsintel/";
  const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(shareText)}&url=${encodeURIComponent(shareUrl)}`;

  const copyLink = () => {
    navigator.clipboard.writeText(shareUrl).then(() => {
      const btn = document.getElementById('copy-link-btn');
      if (btn) { btn.textContent = 'âœ… Copied!'; setTimeout(() => btn.textContent = 'ðŸ”— Copy Link', 2000); }
    });
  };

  return (
    <div className={`${isDark ? 'glass-card' : 'bg-white border border-light-border shadow-lg rounded-2xl'} p-4`}>
      <h3 className={`text-xs font-bold ${isDark ? 'text-white' : 'text-slate-800'} flex items-center gap-2 uppercase mb-3`}>
        ðŸ“¤ Share Raptors Intel
      </h3>
      <div className="flex gap-2">
        <a href={twitterUrl} target="_blank" rel="noopener noreferrer"
          className={`flex-1 flex items-center justify-center gap-1.5 py-2 rounded-lg text-xs font-bold transition-all hover:scale-105 ${isDark ? 'bg-[#1DA1F2]/20 text-[#1DA1F2] hover:bg-[#1DA1F2]/40' : 'bg-[#1DA1F2]/10 text-[#1DA1F2] hover:bg-[#1DA1F2]/20'}`}>
          ð• Post
        </a>
        <button id="copy-link-btn" onClick={copyLink}
          className={`flex-1 py-2 rounded-lg text-xs font-bold transition-all hover:scale-105 ${isDark ? 'bg-slate-700/50 text-slate-300 hover:bg-slate-600/50' : 'bg-slate-200 text-slate-700 hover:bg-slate-300'}`}>
          ðŸ”— Copy Link
        </button>
      </div>
    </div>
  );
};

// ============================================================
// HEAD-TO-HEAD WIDGET (Raptors vs Pistons - Division Rivals)
// ============================================================
const HeadToHeadWidget = ({ isDark = true }) => {
  return (
    <div className={`${isDark ? 'premium-glass' : 'bg-white border border-light-border shadow-lg'} rounded-2xl p-4`}>
      <div className="flex items-center gap-2 mb-3">
        <span className="text-lg">âš”ï¸</span>
        <h3 className={`text-xs font-bold uppercase ${isDark ? 'text-white' : 'text-slate-800'}`}>Historical Head-to-Head</h3>
      </div>
      <div className="flex items-center justify-between mb-3">
        <div className="text-center flex-1">
          <div className={`text-2xl font-black ${isDark ? 'text-white' : 'text-slate-800'}`}>ðŸ¦–</div>
          <div className={`text-xs font-bold ${isDark ? 'text-slate-300' : 'text-slate-700'}`}>Raptors</div>
        </div>
        <div className={`text-xs font-bold px-3 py-1 rounded-full ${isDark ? 'bg-raptors-red/20 text-raptors-red' : 'bg-raptors-red/10 text-raptors-red'}`}>VS</div>
        <div className="text-center flex-1">
          <div className={`text-2xl font-black ${isDark ? 'text-white' : 'text-slate-800'}`}>ðŸ€</div>
          <div className={`text-xs font-bold ${isDark ? 'text-slate-300' : 'text-slate-700'}`}>Pistons</div>
        </div>
      </div>
      <div className={`text-center text-[10px] uppercase font-bold mb-2 ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>Atlantic Division Rivals</div>
      <div className={`${isDark ? 'bg-cmd-bg/50' : 'bg-slate-50'} rounded-lg p-3 mb-3`}>
        <div className={`text-xs font-bold mb-2 ${isDark ? 'text-slate-400' : 'text-slate-600'}`}>All-Time Series</div>
        <div className="flex justify-between items-center">
          <div className="text-center">
            <div className={`text-lg font-black text-green-400`}>~85</div>
            <div className={`text-[10px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>TOR Wins</div>
          </div>
          <div className={`text-[10px] ${isDark ? 'text-slate-600' : 'text-slate-400'}`}>â€”</div>
          <div className="text-center">
            <div className={`text-lg font-black text-red-400`}>~75</div>
            <div className={`text-[10px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>DET Wins</div>
          </div>
        </div>
      </div>
      <div className={`${isDark ? 'bg-cmd-bg/50' : 'bg-slate-50'} rounded-lg p-3`}>
        <div className={`text-xs font-bold mb-2 ${isDark ? 'text-slate-400' : 'text-slate-600'}`}>Season Series</div>
        <div className={`text-[11px] ${isDark ? 'text-slate-400' : 'text-slate-500'} text-center italic`}>
          Season series data loads from <a href="https://www.espn.com/nba/team/schedule/_/name/tor" target="_blank" rel="noopener" className="text-raptors-red underline">ESPN</a>
        </div>
      </div>
      <div className={`mt-2 text-[10px] text-center ${isDark ? 'text-slate-600' : 'text-slate-400'}`}>Both teams joined the Atlantic Division in 1995</div>
    </div>
  );
};

// ============================================================
// PLAYER SPOTLIGHT CAROUSEL
// ============================================================
const PlayerSpotlightCarousel = ({ isDark = true }) => {
  const [activeIdx, setActiveIdx] = useState(0);
  const players = [
    { name: 'Scottie Barnes', number: 4, pos: 'F', img: 'https://cdn.nba.com/headshots/nba/latest/1040x760/1630567.png', stats: { ppg: '19.6', rpg: '7.8', apg: '5.4' }, fact: '"All-Star starter in 2024 â€” youngest Raptor ever selected."' },
    { name: 'RJ Barrett', number: 9, pos: 'G/F', img: 'https://cdn.nba.com/headshots/nba/latest/1040x760/1629628.png', stats: { ppg: '21.8', rpg: '6.4', apg: '4.1' }, fact: '"Canadian homecoming â€” Mississauga native traded to Toronto in 2023."' },
    { name: 'Jakob Poeltl', number: 19, pos: 'C', img: 'https://cdn.nba.com/headshots/nba/latest/1040x760/1627751.png', stats: { ppg: '11.5', rpg: '8.6', apg: '2.5' }, fact: '"Returned to Toronto in 2023 â€” the prodigal big man."' },
    { name: 'Immanuel Quickley', number: 5, pos: 'G', img: 'https://cdn.nba.com/headshots/nba/latest/1040x760/1630193.png', stats: { ppg: '18.6', rpg: '4.8', apg: '6.8' }, fact: '"Acquired with RJ Barrett â€” instant fan favourite."' },
  ];

  useEffect(() => {
    const timer = setInterval(() => setActiveIdx(i => (i + 1) % players.length), 5000);
    return () => clearInterval(timer);
  }, []);

  const p = players[activeIdx];
  return (
    <div className={`${isDark ? 'premium-glass' : 'bg-white border border-light-border shadow-lg'} rounded-2xl p-4 overflow-hidden`}>
      <div className="flex items-center gap-2 mb-3">
        <span className="text-lg">ðŸŒŸ</span>
        <h3 className={`text-xs font-bold uppercase ${isDark ? 'text-white' : 'text-slate-800'}`}>Player Spotlight</h3>
        <div className="ml-auto flex gap-1">
          {players.map((_, i) => (
            <button key={i} onClick={() => setActiveIdx(i)} className={`w-2 h-2 rounded-full transition-all ${i === activeIdx ? 'bg-raptors-red scale-125' : isDark ? 'bg-slate-600' : 'bg-slate-300'}`} aria-label={`Show player ${i+1}`} />
          ))}
        </div>
      </div>
      <div style={{ position: 'relative', minHeight: '180px' }}>
        {players.map((pl, i) => (
          <div key={pl.name} style={{ position: 'absolute', inset: 0, opacity: i === activeIdx ? 1 : 0, transition: 'opacity 0.6s ease', pointerEvents: i === activeIdx ? 'auto' : 'none' }}>
            <div className="flex gap-3 items-center mb-3">
              <img src={pl.img} alt={pl.name} className="w-16 h-16 rounded-full object-cover border-2 border-raptors-red" loading="lazy" style={{ objectPosition: 'top' }} />
              <div>
                <div className={`text-sm font-extrabold ${isDark ? 'text-white' : 'text-slate-800'}`}>{pl.name}</div>
                <div className={`text-[10px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>#{pl.number} Â· {pl.pos}</div>
              </div>
            </div>
            <div className="grid grid-cols-3 gap-2 mb-3">
              {Object.entries(pl.stats).map(([k, v]) => (
                <div key={k} className={`text-center ${isDark ? 'bg-cmd-bg/50' : 'bg-slate-50'} rounded-lg py-2`}>
                  <div className={`text-sm font-black stat-counter ${isDark ? 'text-white' : 'text-slate-800'}`} data-target={parseFloat(v)}>{v}</div>
                  <div className={`text-[10px] uppercase font-bold ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{k}</div>
                </div>
              ))}
            </div>
            <div className={`text-[11px] italic ${isDark ? 'text-slate-400' : 'text-slate-500'} leading-relaxed`}>{pl.fact}</div>
          </div>
        ))}
      </div>
    </div>
  );
};

// ============================================================
// FAN ENGAGEMENT STATS WIDGET
// ============================================================
const FanEngagementWidget = ({ isDark = true }) => {
  const [visits, setVisits] = useState(0);
  const [sessionTime, setSessionTime] = useState(0);
  const [predictions, setPredictions] = useState(0);

  useEffect(() => {
    // Visit counter
    const v = parseInt(localStorage.getItem('raptors-intel-visits') || '0') + 1;
    localStorage.setItem('raptors-intel-visits', v.toString());
    setVisits(v);

    // Predictions count
    const pollKeys = Object.keys(localStorage).filter(k => k.startsWith('raptors-') && (k.includes('poll') || k.includes('predict') || k.includes('vote')));
    setPredictions(pollKeys.length);

    // Session timer
    const start = Date.now();
    const interval = setInterval(() => {
      setSessionTime(Math.floor((Date.now() - start) / 60000));
    }, 10000);
    return () => clearInterval(interval);
  }, []);

  const stats = [
    { label: 'Visits', value: visits, icon: 'ðŸ‘ï¸' },
    { label: 'Minutes', value: sessionTime, icon: 'â±ï¸' },
    { label: 'Predictions', value: predictions, icon: 'ðŸŽ¯' },
  ];

  return (
    <div className={`${isDark ? 'premium-glass' : 'bg-white border border-light-border shadow-lg'} rounded-2xl p-4`}>
      <div className="flex items-center gap-2 mb-3">
        <span className="text-lg">ðŸ“Š</span>
        <h3 className={`text-xs font-bold uppercase ${isDark ? 'text-white' : 'text-slate-800'}`}>Your Fan Stats</h3>
      </div>
      <div className="grid grid-cols-3 gap-2">
        {stats.map(s => (
          <div key={s.label} className={`text-center ${isDark ? 'bg-cmd-bg/50' : 'bg-slate-50'} rounded-lg py-2 px-1`}>
            <div className="text-lg">{s.icon}</div>
            <div className={`text-sm font-black ${isDark ? 'text-white' : 'text-slate-800'}`}>{s.value}</div>
            <div className={`text-[10px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{s.label}</div>
          </div>
        ))}
      </div>
    </div>
  );
};

// ============================================================
// DYNAMIC TIME-BASED BACKGROUND (applied to body via useEffect in App)
// ============================================================
function applyDynamicBackground() {
  const hour = new Date().getHours();
  let gradient;
  if (hour >= 6 && hour < 12) {
    gradient = 'linear-gradient(135deg, #0a0e17 0%, #1a1408 30%, #0f0d06 60%, #0a0e17 100%)';
  } else if (hour >= 12 && hour < 18) {
    gradient = 'linear-gradient(135deg, #0a0e17 0%, #0e1219 40%, #0a0e17 100%)';
  } else if (hour >= 18 && hour < 24) {
    gradient = 'linear-gradient(135deg, #0a0e17 0%, #0d0a1a 35%, #110a20 65%, #0a0e17 100%)';
  } else {
    gradient = 'linear-gradient(135deg, #050810 0%, #070a12 40%, #050810 100%)';
  }
  document.body.style.background = gradient;
  document.body.style.backgroundAttachment = 'fixed';
  document.body.style.minHeight = '100vh';
}

// ============================================================
// ANIMATED STATS COUNTER (Intersection Observer)
// ============================================================
function initAnimatedCounters() {
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting && !entry.target.dataset.counted) {
        entry.target.dataset.counted = 'true';
        const target = parseFloat(entry.target.dataset.target);
        if (isNaN(target)) return;
        const duration = 1200;
        const start = performance.now();
        const isDecimal = String(target).includes('.');
        const decPlaces = isDecimal ? (String(target).split('.')[1] || '').length : 0;
        const animate = (now) => {
          const elapsed = now - start;
          const progress = Math.min(elapsed / duration, 1);
          const eased = 1 - Math.pow(1 - progress, 3);
          const current = eased * target;
          entry.target.textContent = isDecimal ? current.toFixed(decPlaces) : Math.round(current).toString();
          if (progress < 1) requestAnimationFrame(animate);
        };
        entry.target.textContent = isDecimal ? '0.' + '0'.repeat(decPlaces) : '0';
        requestAnimationFrame(animate);
      }
    });
  }, { threshold: 0.3 });
  document.querySelectorAll('.stat-counter[data-target]').forEach(el => observer.observe(el));
}

function App() {
  const [games, setGames] = useState([]);
  const [selectedGame, setSelectedGame] = useState(null);
  const [loadingSchedule, setLoadingSchedule] = useState(true);
  const [isDark, setIsDark] = useState(() => {
    if (typeof window !== 'undefined') {
      const saved = localStorage.getItem('raptors-intel-theme');
      return saved ? saved === 'dark' : true;
    }
    return true;
  });
  const [showReminder, setShowReminder] = useState(false);
  const [showShare, setShowShare] = useState(false);
  const [showKeyboardHelp, setShowKeyboardHelp] = useState(false);
  const [gameDayMode, setGameDayMode] = useState(false);
  const [raptorsLive, setRaptorsLive] = useState(false);

  // Check for live Raptors game and auto-enable game day mode
  useEffect(() => {
    let mounted = true;
    const checkLive = async () => {
      const data = await fetchEnhancedScoreboard();
      if (mounted && data.live) {
        setRaptorsLive(true);
        setGameDayMode(true);
      } else if (mounted) {
        setRaptorsLive(false);
      }
    };
    checkLive();
    const interval = setInterval(checkLive, 30000);
    return () => { mounted = false; clearInterval(interval); };
  }, []);

  const toggleTheme = () => {
    setIsDark(prev => {
      const newVal = !prev;
      localStorage.setItem('raptors-intel-theme', newVal ? 'dark' : 'light');
      return newVal;
    });
  };

  const [selectedPlayer, setSelectedPlayer] = useState(null);
  const [showEasterEgg, setShowEasterEgg] = useState(false);
  const konamiRef = useRef([]);
  const konamiCode = ['ArrowUp', 'ArrowUp', 'ArrowDown', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'ArrowLeft', 'ArrowRight', 'b', 'a'];

  // Keyboard shortcuts
  useEffect(() => {
    const handleKeydown = (e) => {
      // Konami code detection
      konamiRef.current.push(e.key);
      if (konamiRef.current.length > 10) konamiRef.current.shift();
      if (konamiRef.current.join(',') === konamiCode.join(',')) {
        setShowEasterEgg(true);
        konamiRef.current = [];
        setTimeout(() => setShowEasterEgg(false), 5000);
      }

      if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;

      if (e.key === '?' && !e.ctrlKey && !e.metaKey) {
        setShowKeyboardHelp(prev => !prev);
      }
      // Section jump: 1-7
      const sectionIds = ['sec-hero', 'sec-matchup', 'sec-standings', 'sec-draft', 'sec-trade', 'sec-analytics', 'sec-schedule'];
      const secIdx = parseInt(e.key) - 1;
      if (secIdx >= 0 && secIdx < sectionIds.length && !e.ctrlKey && !e.metaKey) {
        const el = document.getElementById(sectionIds[secIdx]);
        if (el) el.scrollIntoView({ behavior: 'smooth' });
        else document.getElementById('main-content')?.scrollIntoView({ behavior: 'smooth' });
      }
      if ((e.key === 'd' || e.key === 'D') && !e.ctrlKey && !e.metaKey) {
        toggleTheme();
      }
      if ((e.key === 'p' || e.key === 'P') && !e.ctrlKey && !e.metaKey) {
        window.print();
      }
      if (e.key === 'Escape') {
        setShowKeyboardHelp(false);
        setShowReminder(false);
        setShowShare(false);
        setShowEasterEgg(false);
        setSelectedPlayer(null);
      }
      if (e.key === 'ArrowDown' && !e.repeat) {
        e.preventDefault();
        const idx = games.findIndex(g => g.id === selectedGame?.id);
        if (idx < games.length - 1) setSelectedGame(games[idx + 1]);
      }
      if (e.key === 'ArrowUp' && !e.repeat) {
        e.preventDefault();
        const idx = games.findIndex(g => g.id === selectedGame?.id);
        if (idx > 0) setSelectedGame(games[idx - 1]);
      }
    };
    window.addEventListener('keydown', handleKeydown);
    return () => window.removeEventListener('keydown', handleKeydown);
  }, [games, selectedGame]);

  useEffect(() => {
    const init = async () => {
      const { games: fetchedGames } = await fetchRaptorsSchedule();
      setGames(fetchedGames);
      const nextGame = fetchedGames.find(g => g.status === 'upcoming');
      if (nextGame) setSelectedGame(nextGame);
      else if (fetchedGames.length > 0) setSelectedGame(fetchedGames[0]);
      setLoadingSchedule(false);
    };
    init();
  }, []);

  // Dynamic time-based background + animated counters
  useEffect(() => {
    if (isDark) applyDynamicBackground();
    else {
      document.body.style.background = '';
      document.body.style.backgroundAttachment = '';
    }
    const counterTimer = setTimeout(initAnimatedCounters, 1500);
    const counterObserver = setInterval(initAnimatedCounters, 3000);
    return () => { clearTimeout(counterTimer); clearInterval(counterObserver); };
  }, [isDark]);

  // Parallax scroll effect for hero/header
  useEffect(() => {
    const handleScroll = () => {
      const hero = document.querySelector('.parallax-hero');
      if (hero) {
        const scrollY = window.scrollY || document.documentElement.scrollTop;
        hero.style.transform = `translateY(${scrollY * 0.3}px)`;
        hero.style.opacity = Math.max(0.6, 1 - scrollY / 600);
      }
    };
    window.addEventListener('scroll', handleScroll, { passive: true });
    return () => window.removeEventListener('scroll', handleScroll);
  }, []);

  // Share function
  const handleShare = async (platform) => {
    const url = window.location.href;
    const text = selectedGame ? `Check out the Raptors vs ${selectedGame.opponent} scouting report on Raptors Intel! ðŸ¦–ðŸ€` : 'Check out Raptors Intel - the ultimate game day scouting dashboard!';
    
    if (platform === 'copy') {
      await navigator.clipboard.writeText(url);
      alert('Link copied to clipboard!');
    } else if (platform === 'twitter') {
      window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(url)}`, '_blank');
    } else if (platform === 'facebook') {
      window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`, '_blank');
    }
    setShowShare(false);
  };

  // Set reminder
  const handleSetReminder = () => {
    if (selectedGame && selectedGame.status === 'upcoming') {
      const gameDate = new Date(selectedGame.date + ' 2026 ' + selectedGame.time);
      const reminderTime = new Date(gameDate.getTime() - 60 * 60 * 1000); // 1 hour before
      const calendarUrl = `https://calendar.google.com/calendar/render?action=TEMPLATE&text=Raptors vs ${selectedGame.opponent}&dates=${gameDate.toISOString().replace(/[-:]/g, '').split('.')[0]}Z/${new Date(gameDate.getTime() + 3*60*60*1000).toISOString().replace(/[-:]/g, '').split('.')[0]}Z&details=Game at ${selectedGame.venue}&location=${selectedGame.venue}`;
      window.open(calendarUrl, '_blank');
    }
    setShowReminder(false);
  };

  const themeClasses = isDark 
    ? 'bg-cmd-bg text-slate-200' 
    : 'bg-light-bg text-slate-800';
  
  const navClasses = isDark
    ? 'border-cmd-border bg-cmd-surface/90'
    : 'border-light-border bg-light-surface/90';

  // Confetti state for win streaks
  const [showConfetti, setShowConfetti] = useState(false);
  
  useEffect(() => {
    // Trigger confetti on page load if there's a win streak
    if (RAPTORS_STATS.streak.startsWith('W') && parseInt(RAPTORS_STATS.streak.slice(1)) >= 3) {
      setTimeout(() => setShowConfetti(true), 1000);
      setTimeout(() => setShowConfetti(false), 4000);
    }
  }, []);

  return (
    <ThemeContext.Provider value={{ isDark, toggle: toggleTheme }}>
    <a href="#main-content" className="skip-link">Skip to main content</a>
    <div className="print-header"><h1>Raptors Intel Scouting Report</h1><p>{new Date().toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}</p></div>
    <div className={`min-h-screen ${themeClasses} ${!isDark ? 'light' : ''} font-sans selection:bg-raptors-red selection:text-white flex flex-col overflow-x-hidden transition-colors duration-300 ${isDark ? 'gradient-mesh' : ''} ${gameDayMode && isDark ? 'gameday-bg' : ''}`} role="application" aria-label="Raptors Intel Dashboard">
      {/* Animated Background Elements */}
      {isDark && <ParticleSystem isDark={isDark} />}
      {isDark && <GradientOrbs isDark={isDark} />}
      {isDark && <CourtBackground isDark={isDark} />}
      {isDark && <AnimatedBlobs isDark={isDark} />}
      <CursorGlow isDark={isDark} />
      
      {/* Confetti for win streaks */}
      <ConfettiSystem active={showConfetti} />
      
      <nav className={`border-b ${navClasses} backdrop-blur-xl flex-shrink-0 z-30 relative parallax-hero`} style={{backgroundAttachment: 'fixed'}}>
        <div className="absolute bottom-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-raptors-red/50 to-transparent"></div>
        <div className="w-full max-w-[98%] mx-auto px-4 h-16 flex items-center justify-between">
          <div className="flex items-center gap-3">
             <div className={`w-12 h-12 ${isDark ? 'bg-cmd-bg' : 'bg-light-card'} rounded-full flex items-center justify-center p-1.5 border-2 border-raptors-red/50 shadow-lg shadow-raptors-red/20 animate-glow-pulse relative overflow-hidden`}>
               <div className="absolute inset-0 bg-gradient-to-br from-raptors-red/20 to-transparent"></div>
               <img src="https://cdn.nba.com/logos/nba/1610612761/primary/L/logo.svg" alt="Raptors Logo" loading="lazy" className="w-full h-full object-contain relative z-10" style={{filter: isDark ? 'drop-shadow(0 0 8px rgba(206,17,65,0.5))' : 'none'}} />
             </div>
             <div className="flex flex-col">
               <span className={`text-xl font-black tracking-tight ${isDark ? 'text-white' : 'text-slate-800'}`}>RAPTORS <span className={`text-raptors-red ${isDark ? 'neon-text' : ''}`}>INTEL</span></span>
               <span className={`text-[9px] uppercase tracking-widest ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>Game Day Scouting</span>
             </div>
          </div>
          <div className="flex items-center gap-4">
            <div className="hidden md:flex items-center gap-4">
              <div className={`flex items-center gap-2 px-3 py-1.5 rounded-full ${isDark ? 'bg-cmd-bg/80 border border-cmd-border' : 'bg-light-card border border-light-border'}`}>
                <LiveIndicator />
                <span className={`text-xs font-medium ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>{LIVE_VIEWERS} viewing</span>
              </div>
              <div className={`flex items-center gap-3 px-4 py-1.5 rounded-full ${isDark ? 'bg-gradient-to-r from-raptors-red/10 to-raptors-purple/10 border border-raptors-red/20' : 'bg-raptors-red/5 border border-raptors-red/20'}`}>
                <div className="text-xs"><span className={isDark ? 'text-slate-400' : 'text-slate-500'}>Record:</span> <span className={`font-black ${isDark ? 'text-white' : 'text-slate-800'}`}>{RAPTORS_STATS.wins}-{RAPTORS_STATS.losses}</span></div>
                <div className="w-px h-4 bg-raptors-red/30"></div>
                <div className="text-xs flex items-center gap-1">
                  <span className={isDark ? 'text-slate-400' : 'text-slate-500'}>Streak:</span> 
                  <span className="font-black text-green-500 flex items-center gap-1">
                    {RAPTORS_STATS.streak.startsWith('W') && <span className="animate-bounce">ðŸ”¥</span>}
                    {RAPTORS_STATS.streak}
                  </span>
                </div>
              </div>
              {gameDayMode && (
                <div className={`gameday-badge ${raptorsLive ? 'gameday-badge-live' : ''} px-3 py-1.5 rounded-full bg-raptors-red text-white text-xs font-black tracking-wider shadow-lg shadow-raptors-red/40`}>
                  {raptorsLive ? 'ðŸ”´ LIVE GAME' : 'ðŸ”¥ GAME DAY'}
                </div>
              )}
            </div>
            <div className="flex items-center gap-1">
              {/* Export Button */}
              <ExportButton game={selectedGame} isDark={isDark} />
              {/* Reminder Button */}
              <button onClick={() => setShowReminder(true)} className={`p-2 rounded-lg transition-all ${isDark ? 'hover:bg-cmd-card text-slate-400 hover:text-white' : 'hover:bg-light-card text-slate-500 hover:text-slate-800'}`} title="Set Reminder">
                <Bell className="w-4 h-4" />
              </button>
              {/* Share Button */}
              <button onClick={() => setShowShare(true)} className={`p-2 rounded-lg transition-all ${isDark ? 'hover:bg-cmd-card text-slate-400 hover:text-white' : 'hover:bg-light-card text-slate-500 hover:text-slate-800'}`} title="Share">
                <Share className="w-4 h-4" />
              </button>
              {/* Game Day Mode Toggle */}
              <button onClick={() => setGameDayMode(prev => !prev)} className={`p-2 rounded-lg transition-all ${gameDayMode ? 'bg-raptors-red/20 text-raptors-red' : isDark ? 'hover:bg-cmd-card text-slate-400 hover:text-raptors-red' : 'hover:bg-light-card text-slate-500 hover:text-raptors-red'}`} title={gameDayMode ? 'Disable Game Day Mode' : 'Enable Game Day Mode'}>
                <Flame className="w-4 h-4" />
              </button>
              {/* Theme Toggle */}
              <button onClick={toggleTheme} className={`p-2 rounded-lg transition-all ${isDark ? 'hover:bg-cmd-card text-slate-400 hover:text-yellow-400' : 'hover:bg-light-card text-slate-500 hover:text-blue-600'}`} title={isDark ? 'Switch to Light Mode' : 'Switch to Dark Mode'}>
                {isDark ? <Sun className="w-4 h-4" /> : <Moon className="w-4 h-4" />}
              </button>
              {/* Keyboard Shortcuts */}
              <button onClick={() => setShowKeyboardHelp(true)} className={`p-2 rounded-lg transition-all hidden md:block ${isDark ? 'hover:bg-cmd-card text-slate-400 hover:text-white' : 'hover:bg-light-card text-slate-500 hover:text-slate-800'}`} title="Keyboard Shortcuts">
                <span className="text-xs font-mono">?</span>
              </button>
            </div>
          </div>
        </div>
      </nav>

      {/* Sticky Section Navigation */}
      {/* SectionNav removed in v13.0 */}

      {/* Keyboard Shortcuts Modal */}
      {showKeyboardHelp && (
        <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70 backdrop-blur-sm" onClick={() => setShowKeyboardHelp(false)}>
          <div className={`${isDark ? 'bg-cmd-surface border-cmd-border' : 'bg-white border-light-border'} border rounded-2xl p-6 max-w-sm w-full shadow-2xl`} onClick={e => e.stopPropagation()}>
            <h3 className={`text-lg font-bold ${isDark ? 'text-white' : 'text-slate-800'} mb-4 flex items-center gap-2`}>âŒ¨ï¸ Keyboard Shortcuts</h3>
            <div className="space-y-2.5 text-sm">
              {[
                ['Jump to section', '1 â€“ 7'],
                ['Toggle dark/light mode', 'D'],
                ['Print report', 'P'],
                ['Next game', 'â†“'],
                ['Previous game', 'â†‘'],
                ['Close modals', 'Esc'],
                ['Show shortcuts', '?'],
              ].map(([label, key]) => (
                <div key={key} className="flex justify-between"><span className={isDark ? 'text-slate-400' : 'text-slate-600'}>{label}</span><kbd className={`px-2 py-1 rounded ${isDark ? 'bg-cmd-bg text-white' : 'bg-light-card text-slate-800'} font-mono text-xs`}>{key}</kbd></div>
              ))}
            </div>
            <button onClick={() => setShowKeyboardHelp(false)} className="mt-4 w-full py-2 bg-raptors-red text-white rounded-lg font-bold hover:bg-raptors-red/90 transition-colors">Got it!</button>
          </div>
        </div>
      )}

      {/* Share Modal */}
      {showShare && (
        <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70 backdrop-blur-sm" onClick={() => setShowShare(false)}>
          <div className={`${isDark ? 'bg-cmd-surface border-cmd-border' : 'bg-white border-light-border'} border rounded-2xl p-6 max-w-sm w-full shadow-2xl`} onClick={e => e.stopPropagation()}>
            <h3 className={`text-lg font-bold ${isDark ? 'text-white' : 'text-slate-800'} mb-4 flex items-center gap-2`}>ðŸ“¤ Share This Report</h3>
            <div className="grid grid-cols-3 gap-3">
              <button onClick={() => handleShare('twitter')} className={`p-4 rounded-xl ${isDark ? 'bg-cmd-bg hover:bg-cmd-card' : 'bg-light-card hover:bg-slate-200'} transition-colors flex flex-col items-center gap-2`}>
                <Twitter className="w-6 h-6 text-blue-400" />
                <span className="text-xs">Twitter</span>
              </button>
              <button onClick={() => handleShare('facebook')} className={`p-4 rounded-xl ${isDark ? 'bg-cmd-bg hover:bg-cmd-card' : 'bg-light-card hover:bg-slate-200'} transition-colors flex flex-col items-center gap-2`}>
                <Facebook className="w-6 h-6 text-blue-600" />
                <span className="text-xs">Facebook</span>
              </button>
              <button onClick={() => handleShare('copy')} className={`p-4 rounded-xl ${isDark ? 'bg-cmd-bg hover:bg-cmd-card' : 'bg-light-card hover:bg-slate-200'} transition-colors flex flex-col items-center gap-2`}>
                <Copy className="w-6 h-6 text-slate-400" />
                <span className="text-xs">Copy Link</span>
              </button>
            </div>
          </div>
        </div>
      )}

      {/* Easter Egg */}
      {showEasterEgg && (
        <div className="fixed inset-0 z-[100] flex items-center justify-center bg-black/90 backdrop-blur-lg animate-fade-in" onClick={() => setShowEasterEgg(false)}>
          <div className="text-center">
            <div className="text-8xl mb-6 animate-bounce">ðŸ¦–</div>
            <div className="text-4xl font-black text-raptors-red mb-4 neon-text" style={{animation: 'glow-pulse 1s ease-in-out infinite'}}>WE THE NORTH!</div>
            <div className="text-xl text-white mb-2">ðŸ† 2019 NBA CHAMPIONS ðŸ†</div>
            <div className="text-slate-400 text-sm">You found the secret! Press ESC to close.</div>
            <div className="mt-6 flex justify-center gap-4 text-4xl">
              {['ðŸ¦–', 'ðŸ€', 'ðŸ', 'ðŸ”´', 'âš«'].map((e, i) => (
                <span key={i} style={{animation: `bounce 0.5s ease-in-out ${i * 0.1}s infinite`}}>{e}</span>
              ))}
            </div>
          </div>
        </div>
      )}

      {/* Player Detail Modal */}
      {selectedPlayer && <PlayerDetailModal player={selectedPlayer} isDark={isDark} onClose={() => setSelectedPlayer(null)} />}

      {/* Live Game Banner (shows when Raptors game is in progress) */}
      <LiveGameBanner isDark={isDark} />

      {/* Live Score Ticker */}
      <LiveScoreTicker isDark={isDark} />
      
      {/* Fun Facts Ticker */}
      <FunFactsTicker isDark={isDark} />
      
      {/* Hero Stats Bar */}
      <div id="sec-hero" role="region" aria-label="Hero stats">
      <HeroStatsBar isDark={isDark} />
      
      {/* Quick Stats Dashboard */}
      <QuickStatsDashboard isDark={isDark} />
      </div>

      {/* Reminder Modal */}
      {showReminder && (
        <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70 backdrop-blur-sm" onClick={() => setShowReminder(false)}>
          <div className={`${isDark ? 'bg-cmd-surface border-cmd-border' : 'bg-white border-light-border'} border rounded-2xl p-6 max-w-sm w-full shadow-2xl`} onClick={e => e.stopPropagation()}>
            <h3 className={`text-lg font-bold ${isDark ? 'text-white' : 'text-slate-800'} mb-4 flex items-center gap-2`}>ðŸ”” Set Game Reminder</h3>
            {selectedGame?.status === 'upcoming' ? (
              <>
                <p className={`text-sm ${isDark ? 'text-slate-400' : 'text-slate-600'} mb-4`}>
                  Add <strong>Raptors vs {selectedGame.opponent}</strong> on <strong>{selectedGame.date}</strong> to your calendar?
                </p>
                <button onClick={handleSetReminder} className="w-full py-3 bg-raptors-red text-white rounded-lg font-bold hover:bg-raptors-red/90 transition-colors flex items-center justify-center gap-2">
                  <Calendar className="w-4 h-4" /> Add to Google Calendar
                </button>
              </>
            ) : (
              <p className={`text-sm ${isDark ? 'text-slate-400' : 'text-slate-600'}`}>Select an upcoming game to set a reminder.</p>
            )}
          </div>
        </div>
      )}
      <main id="main-content" className="flex-1 w-full max-w-[98%] mx-auto px-4 py-4" role="main" aria-label="Raptors Intel main content">
        <div className="grid grid-cols-12 gap-3">
          {/* Mobile sidebar toggle */}
          <div className="col-span-12 lg:hidden mb-2">
            <button 
              onClick={() => { const el = document.getElementById('sidebar-panel'); if(el) el.classList.toggle('mobile-sidebar-hidden'); }}
              className={`w-full flex items-center justify-center gap-2 py-3 rounded-xl text-sm font-semibold transition-all ${isDark ? 'bg-cmd-card border border-cmd-border text-slate-300 hover:border-raptors-red' : 'bg-white border border-light-border text-slate-700 hover:border-raptors-red'}`}
            >
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M3 12h18M3 6h18M3 18h18"/></svg>
              Quick Access
              <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M6 9l6 6 6-6"/></svg>
            </button>
          </div>
          {/* Slim Sidebar */}
          <div id="sidebar-panel" className="col-span-12 lg:col-span-2 space-y-1 pb-4 mobile-sidebar-hidden lg:!block" role="complementary" aria-label="Sidebar widgets" style={{position:'sticky',top:'1rem',alignSelf:'start',maxHeight:'calc(100vh - 2rem)',overflowY:'auto'}}>
            <ScheduleList games={games} onSelectGame={setSelectedGame} selectedGameId={selectedGame?.id} isDark={isDark} />
            <GameCountdown game={selectedGame} isDark={isDark} gameDayMode={gameDayMode} />
            <QuickStatsBar isDark={isDark} />
            <QuickStatsGrid isDark={isDark} />
            <SeasonProgress isDark={isDark} />
            <StreakCelebration streak={RAPTORS_STATS.streak} isDark={isDark} />
            <TeamLeadersWidget isDark={isDark} />
            <WidgetErrorBoundary name="Standings"><StandingsWidget isDark={isDark} /></WidgetErrorBoundary>
            <PlayoffPictureWidget isDark={isDark} />
            <InjuryReportWidget isDark={isDark} opponent={selectedGame?.opponent} />
            <InjuryDashboardWidget isDark={isDark} />
            <RestFatigueWidget isDark={isDark} />
            <DraftWatchWidget isDark={isDark} />
            <PowerRankingsWidget isDark={isDark} />
            <RaptorsPulseWidget isDark={isDark} />
            <RaptorsQuizWidget isDark={isDark} />
            <SocialShareWidget isDark={isDark} />
            <SocialLinksWidget isDark={isDark} />
            <RecentResultsWidget games={games} isDark={isDark} />
            <ArenaWidget isDark={isDark} />
            <AboutWidget isDark={isDark} />
          </div>
          {/* Main Content */}
          <div className="col-span-12 lg:col-span-10 pb-20 lg:pb-10">
              {/* Matchup Analyzer â€” full width above grid */}
              <div className="mb-0">
            {loadingSchedule ? (
              <div className={`h-64 flex flex-col items-center justify-center ${isDark ? 'glass-card' : 'bg-white border border-light-border rounded-2xl shadow-lg'}`}>
                <BasketballLoader size={60} />
                <p className={`font-medium ${isDark ? 'text-slate-400' : 'text-slate-600'} mt-4`}>Loading Season Data...</p>
                <div className="w-full max-w-md mt-6 px-8">
                  <SkeletonBlock rows={6} />
                </div>
              </div>
            ) : selectedGame ? (
              <WidgetErrorBoundary name="Matchup Analyzer"><MatchupAnalyzer game={selectedGame} isDark={isDark} /></WidgetErrorBoundary>
            ) : (
              <div className={`h-32 flex flex-col items-center justify-center ${isDark ? 'glass-card text-slate-500' : 'bg-white border border-light-border rounded-2xl shadow-lg text-slate-400'}`}><LayoutDashboard className="w-10 h-10 mb-2 opacity-30" /><p className="text-xs">Select a game from the calendar to open the scouting report.</p></div>
            )}
              </div>
              {/* ===== DASHBOARD GRID ===== */}
              <div className="flex items-center gap-3 mb-2 mt-3">
                <h2 className="text-2xl font-black text-white flex items-center gap-3 uppercase tracking-tight"><div className="bg-raptors-red p-2 rounded-lg shadow-lg shadow-raptors-red/30"><LayoutDashboard className="w-5 h-5 text-white" /></div>Advanced Analytics Dashboard</h2>
              </div>
              <div className="dashboard-grid">
                {/* Game Day â€” red accent */}
                {selectedGame && <div className="widget-wide dg-gameday"><TeamStatsComparisonWidget isDark={isDark} opponent={selectedGame.opponent} /></div>}
                {selectedGame && <div className="dg-gameday"><KeyMatchupsWidget opponent={selectedGame.opponent} isDark={isDark} /></div>}
                {selectedGame && <div className="dg-gameday"><KeyStatsWidget isDark={isDark} opponent={selectedGame.opponent} /></div>}
                <div className="dg-gameday"><HeadToHeadWidget isDark={isDark} /></div>
                <div className="dg-gameday"><HistoricalH2HWidget isDark={isDark} opponent={selectedGame?.opponent} /></div>
                {selectedGame && <div className="dg-gameday"><DefensiveAssignmentsWidget isDark={isDark} opponent={selectedGame.opponent} /></div>}
                {selectedGame && <div className="dg-gameday"><OpponentScoutingWidget isDark={isDark} opponent={selectedGame.opponent} /></div>}
                {selectedGame && <div className="dg-gameday"><PredictionBreakdownWidget isDark={isDark} opponent={selectedGame.opponent} /></div>}
                {selectedGame?.status === 'upcoming' && <div className="dg-gameday"><PredictedScoreWidget isDark={isDark} opponent={selectedGame.opponent} /></div>}
                {selectedGame?.status === 'upcoming' && <div className="dg-gameday"><ScorePredictorWidget isDark={isDark} opponent={selectedGame.opponent} /></div>}
                {selectedGame?.status === 'upcoming' && <div className="dg-gameday"><WidgetErrorBoundary name="Betting Hub"><BettingHubWidget isDark={isDark} game={selectedGame} /></WidgetErrorBoundary></div>}
                {selectedGame?.status === 'upcoming' && <div className="dg-gameday"><PlayerPropsWidget isDark={isDark} opponent={selectedGame?.opponent} /></div>}
                {selectedGame?.status === 'upcoming' && <div className="dg-gameday"><TVScheduleWidget isDark={isDark} game={selectedGame} /></div>}

                {/* Core Stats â€” blue accent */}
                <div className="dg-stats"><RecordBreakdownWidget isDark={isDark} /></div>
                <div className="dg-stats"><HomeAwaySplitsWidget isDark={isDark} nextGameHome={selectedGame?.home} /></div>
                <div className="dg-stats"><RecordByMarginWidget isDark={isDark} /></div>
                <div className="dg-stats"><HalfPerformanceWidget isDark={isDark} /></div>
                <div className="dg-stats"><MonthlyPerformanceWidget isDark={isDark} /></div>
                <div className="dg-stats"><BigGamesWidget isDark={isDark} /></div>
                <div className="dg-stats"><SignatureWinsWidget isDark={isDark} /></div>
                <div className="dg-stats"><VsLeagueAvgWidget isDark={isDark} /></div>

                {/* Player Analysis â€” green accent */}
                <div className="widget-tall dg-players"><PlayerSpotlightCarousel isDark={isDark} /></div>
                <div className="widget-tall dg-players">
                  <div className={`${isDark ? 'premium-glass' : 'bg-white border border-light-border shadow-lg'} rounded-md h-full overflow-hidden`} style={{padding:'6px'}}>
                  <div className="flex items-center gap-1 mb-1">
                    <Users className="w-3 h-3 text-raptors-red" />
                    <h3 className={`text-[9px] font-extrabold uppercase ${isDark ? 'text-white' : 'text-slate-800'}`}>Player Deep Dive</h3>
                  </div>
                  <div className="space-y-0.5 overflow-y-auto custom-scrollbar" style={{maxHeight:'calc(100% - 24px)'}}>
                    {RAPTORS_ROSTER.map((p) => (
                      <button key={p.id} onClick={() => setSelectedPlayer(p)} className={`w-full flex items-center gap-1 p-1 rounded text-left ${isDark ? 'hover:bg-cmd-card' : 'hover:bg-light-card'}`}>
                        <span className="text-[9px] font-bold w-4 text-raptors-red">#{p.number}</span>
                        <span className={`text-[10px] font-medium flex-1 truncate ${isDark ? 'text-slate-300' : 'text-slate-700'}`}>{p.name}</span>
                        <span className={`text-[9px] ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{p.seasonStats?.ppg}</span>
                        <ChevronRight className={`w-2.5 h-2.5 ${isDark ? 'text-slate-600' : 'text-slate-400'}`} />
                      </button>
                    ))}
                  </div>
                  </div>
                </div>
                <div className="dg-players"><UsageRateWidget isDark={isDark} /></div>
                <div className="dg-players"><MinutesDistributionWidget isDark={isDark} /></div>
                <div className="dg-players"><PlusMinusWidget isDark={isDark} /></div>
                <div className="dg-players"><WinSharesWidget isDark={isDark} /></div>
                <div className="widget-large dg-players"><PlayerComparisonTool isDark={isDark} /></div>
                <div className="dg-players"><FantasyProjectionsWidget isDark={isDark} /></div>

                {/* Analytics â€” purple accent */}
                <div className="widget-wide dg-analytics"><AdvancedStatsWidget isDark={isDark} /></div>
                <div className="widget-wide dg-analytics"><NetRatingWidget isDark={isDark} /></div>
                <div className="dg-analytics"><FourFactorsWidget isDark={isDark} opponent={selectedGame?.opponent} /></div>
                <div className="dg-analytics"><ClutchStatsWidget isDark={isDark} /></div>
                <div className="dg-analytics"><PaceEfficiencyWidget isDark={isDark} /></div>
                <div className="dg-analytics"><OffensiveSetsWidget isDark={isDark} /></div>
                <div className="dg-analytics"><DefensiveEfficiencyWidget isDark={isDark} /></div>
                <div className="dg-analytics"><CrunchTimeWidget isDark={isDark} /></div>
                <div className="dg-analytics"><EfficiencyWidget isDark={isDark} /></div>
                <div className="dg-analytics"><AstToWidget isDark={isDark} /></div>
                <div className="dg-analytics"><PacePredictorWidget isDark={isDark} opponent={selectedGame?.opponent} /></div>
                <div className="dg-analytics"><QuarterBreakdownWidget isDark={isDark} /></div>
                <div className="dg-analytics"><StreakProbabilityWidget isDark={isDark} streak={RAPTORS_STATS.streak} /></div>

                {/* On-Court â€” orange accent */}
                <div className="dg-oncourt"><PointsDistributionWidget isDark={isDark} /></div>
                <div className="dg-oncourt"><AssistLeadersWidget isDark={isDark} /></div>
                <div className="dg-oncourt"><PointsOffAssistsWidget isDark={isDark} /></div>
                <div className="dg-oncourt"><ThreePointWidget isDark={isDark} /></div>
                <div className="dg-oncourt"><FreeThrowWidget isDark={isDark} /></div>
                <div className="dg-oncourt"><FastBreakWidget isDark={isDark} /></div>
                <div className="dg-oncourt"><PaintScoringWidget isDark={isDark} /></div>
                <div className="dg-oncourt"><SecondChanceWidget isDark={isDark} /></div>
                <div className="dg-oncourt"><ShotChartWidget isDark={isDark} /></div>
                <div className="dg-oncourt"><MiniHeatMap isDark={isDark} /></div>
                <div className="dg-oncourt"><BenchProductionWidget isDark={isDark} /></div>
                <div className="dg-oncourt"><StarterVsBenchWidget isDark={isDark} /></div>
                <div className="widget-wide dg-oncourt"><LineupCombosWidget isDark={isDark} /></div>
                <div className="dg-oncourt"><StealsBlocksWidget isDark={isDark} /></div>
                <div className="dg-oncourt"><ReboundBattleWidget isDark={isDark} /></div>
                <div className="dg-oncourt"><TurnoverWidget isDark={isDark} /></div>

                {/* Season & FO â€” teal accent */}
                <div className="dg-season"><StandingsVisualizationWidget isDark={isDark} /></div>
                <div className="dg-season"><ScheduleStrengthWidget isDark={isDark} /></div>
                <div className="dg-season"><SeasonTrackerWidget isDark={isDark} games={games} /></div>
                <div className="widget-wide dg-season"><SeasonTimelineWidget isDark={isDark} /></div>
                <div className="dg-season"><MVPRaceWidget isDark={isDark} /></div>
                <div className="dg-season"><AllStarTrackerWidget isDark={isDark} /></div>
                <div className="dg-season"><TradeAnalysisWidget isDark={isDark} /></div>
                <div className="dg-season"><DraftPickWidget isDark={isDark} /></div>
                <div className="dg-season"><SalaryCapWidget isDark={isDark} /></div>
                <div className="dg-season"><TeamSalaryWidget isDark={isDark} teamName="Raptors" opponentName={selectedGame?.opponent} /></div>
                <div className="dg-season"><CoachInsightsWidget isDark={isDark} /></div>

                {/* Community â€” pink accent */}
                <div className="dg-community"><FanEngagementWidget isDark={isDark} /></div>
                <div className="dg-community"><GamePredictionPoll isDark={isDark} /></div>
                <div className="dg-community"><FanPollWidget isDark={isDark} /></div>
                <div className="dg-community"><StorylinesWidget isDark={isDark} /></div>
                <div className="dg-community"><SocialBuzzWidget isDark={isDark} /></div>
                <div className="dg-community"><TeamChemistryWidget isDark={isDark} /></div>
                <div className="dg-community"><MomentumTrackerWidget isDark={isDark} /></div>
              </div>
          </div>
        </div>
      </main>
      <ScrollToTop isDark={isDark} />
      <MobileBottomNav isDark={isDark} onThemeToggle={toggleTheme} onShare={() => setShowShare(true)} onReminder={() => setShowReminder(true)} />
      <footer className="polished-footer no-print">
        <div className="flex flex-col items-center gap-2">
          <div className="flex items-center gap-2 flex-wrap justify-center">
            <span className="font-bold text-raptors-red">RAPTORS INTEL</span>
            <span className={isDark ? 'text-slate-600' : 'text-slate-400'}>v13.3</span>
          </div>
          <p style={{margin:0}}>Built with ðŸ€ by Raptors Intel â€¢ Data from ESPN â€¢ Not affiliated with the NBA</p>
          <p style={{margin:0, fontSize:'0.65rem', opacity:0.6}}>Last Updated: {new Date().toLocaleString('en-US', { dateStyle: 'medium', timeStyle: 'short' })}</p>
          <button className="back-to-top" onClick={() => window.scrollTo({ top: 0, behavior: 'smooth' })}>â†‘ Back to Top</button>
        </div>
      </footer>
    </div>
    </ThemeContext.Provider>
  );
}

// ============================================================
// RENDER
// ============================================================
const rootElement = document.getElementById('root');
const root = ReactDOM.createRoot(rootElement);
root.render(<ErrorBoundary><App /></ErrorBoundary>);
    </script>
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('./sw.js').then(
          (reg) => console.log('SW registered:', reg.scope),
          (err) => console.warn('SW registration failed:', err)
        );
      });
    }
  </script>
  </body>
</html>
